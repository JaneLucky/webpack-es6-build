!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BIMEngine=t():e.BIMEngine=t()}(this,(function(){return t=[function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(131),i=n(212);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),r(e,i(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),r(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.r(t),n.d(t,"ACESFilmicToneMapping",(function(){return tt})),n.d(t,"AddEquation",(function(){return Ee})),n.d(t,"AddOperation",(function(){return Je})),n.d(t,"AdditiveAnimationBlendMode",(function(){return qn})),n.d(t,"AdditiveBlending",(function(){return we})),n.d(t,"AlphaFormat",(function(){return zt})),n.d(t,"AlwaysDepth",(function(){return He})),n.d(t,"AlwaysStencilFunc",(function(){return Mr})),n.d(t,"AmbientLight",(function(){return Kh})),n.d(t,"AmbientLightProbe",(function(){return xd})),n.d(t,"AnimationClip",(function(){return th})),n.d(t,"AnimationLoader",(function(){return lh})),n.d(t,"AnimationMixer",(function(){return qd})),n.d(t,"AnimationObjectGroup",(function(){return Wd})),n.d(t,"AnimationUtils",(function(){return Vu})),n.d(t,"ArcCurve",(function(){return vh})),n.d(t,"ArrayCamera",(function(){return Sl})),n.d(t,"ArrowHelper",(function(){return zp})),n.d(t,"Audio",(function(){return Pd})),n.d(t,"AudioAnalyser",(function(){return Nd})),n.d(t,"AudioContext",(function(){return vd})),n.d(t,"AudioListener",(function(){return Cd})),n.d(t,"AudioLoader",(function(){return gd})),n.d(t,"AxesHelper",(function(){return Np})),n.d(t,"AxisHelper",(function(){return Pf})),n.d(t,"BackSide",(function(){return fe})),n.d(t,"BasicDepthPacking",(function(){return ir})),n.d(t,"BasicShadowMap",(function(){return ce})),n.d(t,"BinaryTextureLoader",(function(){return zf})),n.d(t,"Bone",(function(){return cc})),n.d(t,"BooleanKeyframeTrack",(function(){return Yu})),n.d(t,"BoundingBoxHelper",(function(){return Rf})),n.d(t,"Box2",(function(){return np})),n.d(t,"Box3",(function(){return ei})),n.d(t,"Box3Helper",(function(){return Ip})),n.d(t,"BoxBufferGeometry",(function(){return ho})),n.d(t,"BoxGeometry",(function(){return ho})),n.d(t,"BoxHelper",(function(){return Rp})),n.d(t,"BufferAttribute",(function(){return Ea})),n.d(t,"BufferGeometry",(function(){return ja})),n.d(t,"BufferGeometryLoader",(function(){return od})),n.d(t,"ByteType",(function(){return Et})),n.d(t,"Cache",(function(){return nh})),n.d(t,"Camera",(function(){return go})),n.d(t,"CameraHelper",(function(){return Tp})),n.d(t,"CanvasRenderer",(function(){return Of})),n.d(t,"CanvasTexture",(function(){return Bc})),n.d(t,"CatmullRomCurve3",(function(){return _h})),n.d(t,"CineonToneMapping",(function(){return et})),n.d(t,"CircleBufferGeometry",(function(){return Uc})),n.d(t,"CircleGeometry",(function(){return Uc})),n.d(t,"ClampToEdgeWrapping",(function(){return ht})),n.d(t,"Clock",(function(){return Md})),n.d(t,"Color",(function(){return wa})),n.d(t,"ColorKeyframeTrack",(function(){return Zu})),n.d(t,"CompressedTexture",(function(){return Oc})),n.d(t,"CompressedTextureLoader",(function(){return ch})),n.d(t,"ConeBufferGeometry",(function(){return Vc})),n.d(t,"ConeGeometry",(function(){return Vc})),n.d(t,"CubeCamera",(function(){return xo})),n.d(t,"CubeReflectionMapping",(function(){return it})),n.d(t,"CubeRefractionMapping",(function(){return at})),n.d(t,"CubeTexture",(function(){return wo})),n.d(t,"CubeTextureLoader",(function(){return hh})),n.d(t,"CubeUVReflectionMapping",(function(){return lt})),n.d(t,"CubeUVRefractionMapping",(function(){return ct})),n.d(t,"CubicBezierCurve",(function(){return Th})),n.d(t,"CubicBezierCurve3",(function(){return Ah})),n.d(t,"CubicInterpolant",(function(){return Wu})),n.d(t,"CullFaceBack",(function(){return oe})),n.d(t,"CullFaceFront",(function(){return se})),n.d(t,"CullFaceFrontBack",(function(){return le})),n.d(t,"CullFaceNone",(function(){return ae})),n.d(t,"Curve",(function(){return fh})),n.d(t,"CurvePath",(function(){return Dh})),n.d(t,"CustomBlending",(function(){return Me})),n.d(t,"CustomToneMapping",(function(){return nt})),n.d(t,"CylinderBufferGeometry",(function(){return Hc})),n.d(t,"CylinderGeometry",(function(){return Hc})),n.d(t,"Cylindrical",(function(){return ep})),n.d(t,"DataTexture",(function(){return _o})),n.d(t,"DataTexture2DArray",(function(){return qo})),n.d(t,"DataTexture3D",(function(){return Xo})),n.d(t,"DataTextureLoader",(function(){return dh})),n.d(t,"DataUtils",(function(){return Fp})),n.d(t,"DecrementStencilOp",(function(){return dr})),n.d(t,"DecrementWrapStencilOp",(function(){return fr})),n.d(t,"DefaultLoadingManager",(function(){return ih})),n.d(t,"DepthFormat",(function(){return Ht})),n.d(t,"DepthStencilFormat",(function(){return Vt})),n.d(t,"DepthTexture",(function(){return Fc})),n.d(t,"DirectionalLight",(function(){return Qh})),n.d(t,"DirectionalLightHelper",(function(){return Mp})),n.d(t,"DiscreteInterpolant",(function(){return qu})),n.d(t,"DodecahedronBufferGeometry",(function(){return Wc})),n.d(t,"DodecahedronGeometry",(function(){return Wc})),n.d(t,"DoubleSide",(function(){return me})),n.d(t,"DstAlphaFactor",(function(){return ze})),n.d(t,"DstColorFactor",(function(){return Oe})),n.d(t,"DynamicBufferAttribute",(function(){return wf})),n.d(t,"DynamicCopyUsage",(function(){return Rr})),n.d(t,"DynamicDrawUsage",(function(){return Sr})),n.d(t,"DynamicReadUsage",(function(){return Lr})),n.d(t,"EdgesGeometry",(function(){return Zc})),n.d(t,"EdgesHelper",(function(){return If})),n.d(t,"EllipseCurve",(function(){return mh})),n.d(t,"EqualDepth",(function(){return We})),n.d(t,"EqualStencilFunc",(function(){return yr})),n.d(t,"EquirectangularReflectionMapping",(function(){return ot})),n.d(t,"EquirectangularRefractionMapping",(function(){return st})),n.d(t,"Euler",(function(){return zi})),n.d(t,"EventDispatcher",(function(){return zr})),n.d(t,"ExtrudeBufferGeometry",(function(){return mu})),n.d(t,"ExtrudeGeometry",(function(){return mu})),n.d(t,"FaceColors",(function(){return cf})),n.d(t,"FileLoader",(function(){return sh})),n.d(t,"FlatShading",(function(){return ve})),n.d(t,"Float16BufferAttribute",(function(){return Ia})),n.d(t,"Float32Attribute",(function(){return Lf})),n.d(t,"Float32BufferAttribute",(function(){return ka})),n.d(t,"Float64Attribute",(function(){return Cf})),n.d(t,"Float64BufferAttribute",(function(){return Da})),n.d(t,"FloatType",(function(){return Ct})),n.d(t,"Fog",(function(){return kl})),n.d(t,"FogExp2",(function(){return Il})),n.d(t,"Font",(function(){return pd})),n.d(t,"FontLoader",(function(){return md})),n.d(t,"FrontSide",(function(){return pe})),n.d(t,"Frustum",(function(){return So})),n.d(t,"GLBufferAttribute",(function(){return Zd})),n.d(t,"GLSL1",(function(){return kr})),n.d(t,"GLSL3",(function(){return Dr})),n.d(t,"GammaEncoding",(function(){return Kn})),n.d(t,"GreaterDepth",(function(){return qe})),n.d(t,"GreaterEqualDepth",(function(){return je})),n.d(t,"GreaterEqualStencilFunc",(function(){return _r})),n.d(t,"GreaterStencilFunc",(function(){return wr})),n.d(t,"GridHelper",(function(){return yp})),n.d(t,"Group",(function(){return Tl})),n.d(t,"HalfFloatType",(function(){return Pt})),n.d(t,"HemisphereLight",(function(){return Bh})),n.d(t,"HemisphereLightHelper",(function(){return gp})),n.d(t,"HemisphereLightProbe",(function(){return yd})),n.d(t,"IcosahedronBufferGeometry",(function(){return gu})),n.d(t,"IcosahedronGeometry",(function(){return gu})),n.d(t,"ImageBitmapLoader",(function(){return hd})),n.d(t,"ImageLoader",(function(){return uh})),n.d(t,"ImageUtils",(function(){return Gr})),n.d(t,"ImmediateRenderObject",(function(){return op})),n.d(t,"IncrementStencilOp",(function(){return hr})),n.d(t,"IncrementWrapStencilOp",(function(){return pr})),n.d(t,"InstancedBufferAttribute",(function(){return ad})),n.d(t,"InstancedBufferGeometry",(function(){return id})),n.d(t,"InstancedInterleavedBuffer",(function(){return Yd})),n.d(t,"InstancedMesh",(function(){return gc})),n.d(t,"Int16Attribute",(function(){return Ef})),n.d(t,"Int16BufferAttribute",(function(){return La})),n.d(t,"Int32Attribute",(function(){return Tf})),n.d(t,"Int32BufferAttribute",(function(){return Pa})),n.d(t,"Int8Attribute",(function(){return bf})),n.d(t,"Int8BufferAttribute",(function(){return Sa})),n.d(t,"IntType",(function(){return At})),n.d(t,"InterleavedBuffer",(function(){return zl})),n.d(t,"InterleavedBufferAttribute",(function(){return Ol})),n.d(t,"Interpolant",(function(){return Gu})),n.d(t,"InterpolateDiscrete",(function(){return Fn})),n.d(t,"InterpolateLinear",(function(){return Un})),n.d(t,"InterpolateSmooth",(function(){return Hn})),n.d(t,"InvertStencilOp",(function(){return mr})),n.d(t,"JSONLoader",(function(){return Bf})),n.d(t,"KeepStencilOp",(function(){return cr})),n.d(t,"KeyframeTrack",(function(){return Xu})),n.d(t,"LOD",(function(){return nc})),n.d(t,"LatheBufferGeometry",(function(){return yu})),n.d(t,"LatheGeometry",(function(){return yu})),n.d(t,"Layers",(function(){return Ni})),n.d(t,"LensFlare",(function(){return Uf})),n.d(t,"LessDepth",(function(){return Ve})),n.d(t,"LessEqualDepth",(function(){return Ge})),n.d(t,"LessEqualStencilFunc",(function(){return xr})),n.d(t,"LessStencilFunc",(function(){return gr})),n.d(t,"Light",(function(){return Oh})),n.d(t,"LightProbe",(function(){return td})),n.d(t,"Line",(function(){return Ec})),n.d(t,"Line3",(function(){return ap})),n.d(t,"LineBasicMaterial",(function(){return yc})),n.d(t,"LineCurve",(function(){return Lh})),n.d(t,"LineCurve3",(function(){return Ch})),n.d(t,"LineDashedMaterial",(function(){return Uu})),n.d(t,"LineLoop",(function(){return Lc})),n.d(t,"LinePieces",(function(){return sf})),n.d(t,"LineSegments",(function(){return Ac})),n.d(t,"LineStrip",(function(){return of})),n.d(t,"LinearEncoding",(function(){return Jn})),n.d(t,"LinearFilter",(function(){return yt})),n.d(t,"LinearInterpolant",(function(){return ju})),n.d(t,"LinearMipMapLinearFilter",(function(){return _t})),n.d(t,"LinearMipMapNearestFilter",(function(){return wt})),n.d(t,"LinearMipmapLinearFilter",(function(){return bt})),n.d(t,"LinearMipmapNearestFilter",(function(){return xt})),n.d(t,"LinearToneMapping",(function(){return Ke})),n.d(t,"Loader",(function(){return ah})),n.d(t,"LoaderUtils",(function(){return rd})),n.d(t,"LoadingManager",(function(){return rh})),n.d(t,"LogLuvEncoding",(function(){return er})),n.d(t,"LoopOnce",(function(){return Nn})),n.d(t,"LoopPingPong",(function(){return Bn})),n.d(t,"LoopRepeat",(function(){return On})),n.d(t,"LuminanceAlphaFormat",(function(){return Ft})),n.d(t,"LuminanceFormat",(function(){return Bt})),n.d(t,"MOUSE",(function(){return re})),n.d(t,"Material",(function(){return pa})),n.d(t,"MaterialLoader",(function(){return nd})),n.d(t,"Math",(function(){return Ur})),n.d(t,"MathUtils",(function(){return Ur})),n.d(t,"Matrix3",(function(){return Vr})),n.d(t,"Matrix4",(function(){return Si})),n.d(t,"MaxEquation",(function(){return Le})),n.d(t,"Mesh",(function(){return co})),n.d(t,"MeshBasicMaterial",(function(){return ba})),n.d(t,"MeshDepthMaterial",(function(){return yl})),n.d(t,"MeshDistanceMaterial",(function(){return xl})),n.d(t,"MeshFaceMaterial",(function(){return hf})),n.d(t,"MeshLambertMaterial",(function(){return Bu})),n.d(t,"MeshMatcapMaterial",(function(){return Fu})),n.d(t,"MeshNormalMaterial",(function(){return Ou})),n.d(t,"MeshPhongMaterial",(function(){return zu})),n.d(t,"MeshPhysicalMaterial",(function(){return Du})),n.d(t,"MeshStandardMaterial",(function(){return ku})),n.d(t,"MeshToonMaterial",(function(){return Nu})),n.d(t,"MinEquation",(function(){return Ae})),n.d(t,"MirroredRepeatWrapping",(function(){return dt})),n.d(t,"MixOperation",(function(){return Ze})),n.d(t,"MultiMaterial",(function(){return df})),n.d(t,"MultiplyBlending",(function(){return _e})),n.d(t,"MultiplyOperation",(function(){return Ye})),n.d(t,"NearestFilter",(function(){return pt})),n.d(t,"NearestMipMapLinearFilter",(function(){return gt})),n.d(t,"NearestMipMapNearestFilter",(function(){return mt})),n.d(t,"NearestMipmapLinearFilter",(function(){return vt})),n.d(t,"NearestMipmapNearestFilter",(function(){return ft})),n.d(t,"NeverDepth",(function(){return Ue})),n.d(t,"NeverStencilFunc",(function(){return vr})),n.d(t,"NoBlending",(function(){return ye})),n.d(t,"NoColors",(function(){return lf})),n.d(t,"NoToneMapping",(function(){return Qe})),n.d(t,"NormalAnimationBlendMode",(function(){return jn})),n.d(t,"NormalBlending",(function(){return xe})),n.d(t,"NotEqualDepth",(function(){return Xe})),n.d(t,"NotEqualStencilFunc",(function(){return br})),n.d(t,"NumberKeyframeTrack",(function(){return Ju})),n.d(t,"Object3D",(function(){return Ji})),n.d(t,"ObjectLoader",(function(){return sd})),n.d(t,"ObjectSpaceNormalMap",(function(){return sr})),n.d(t,"OctahedronBufferGeometry",(function(){return xu})),n.d(t,"OctahedronGeometry",(function(){return xu})),n.d(t,"OneFactor",(function(){return Pe})),n.d(t,"OneMinusDstAlphaFactor",(function(){return Ne})),n.d(t,"OneMinusDstColorFactor",(function(){return Be})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return De})),n.d(t,"OneMinusSrcColorFactor",(function(){return Ie})),n.d(t,"OrthographicCamera",(function(){return Zh})),n.d(t,"PCFShadowMap",(function(){return ue})),n.d(t,"PCFSoftShadowMap",(function(){return he})),n.d(t,"PMREMGenerator",(function(){return ef})),n.d(t,"ParametricBufferGeometry",(function(){return wu})),n.d(t,"ParametricGeometry",(function(){return wu})),n.d(t,"Particle",(function(){return ff})),n.d(t,"ParticleBasicMaterial",(function(){return gf})),n.d(t,"ParticleSystem",(function(){return mf})),n.d(t,"ParticleSystemMaterial",(function(){return yf})),n.d(t,"Path",(function(){return zh})),n.d(t,"PerspectiveCamera",(function(){return yo})),n.d(t,"Plane",(function(){return ea})),n.d(t,"PlaneBufferGeometry",(function(){return Lo})),n.d(t,"PlaneGeometry",(function(){return Lo})),n.d(t,"PlaneHelper",(function(){return kp})),n.d(t,"PointCloud",(function(){return pf})),n.d(t,"PointCloudMaterial",(function(){return vf})),n.d(t,"PointLight",(function(){return Yh})),n.d(t,"PointLightHelper",(function(){return pp})),n.d(t,"Points",(function(){return Dc})),n.d(t,"PointsMaterial",(function(){return Cc})),n.d(t,"PolarGridHelper",(function(){return xp})),n.d(t,"PolyhedronBufferGeometry",(function(){return Gc})),n.d(t,"PolyhedronGeometry",(function(){return Gc})),n.d(t,"PositionalAudio",(function(){return zd})),n.d(t,"PropertyBinding",(function(){return Gd})),n.d(t,"PropertyMixer",(function(){return Od})),n.d(t,"QuadraticBezierCurve",(function(){return Ph})),n.d(t,"QuadraticBezierCurve3",(function(){return Rh})),n.d(t,"Quaternion",(function(){return Jr})),n.d(t,"QuaternionKeyframeTrack",(function(){return Ku})),n.d(t,"QuaternionLinearInterpolant",(function(){return Qu})),n.d(t,"REVISION",(function(){return ne})),n.d(t,"RGBADepthPacking",(function(){return ar})),n.d(t,"RGBAFormat",(function(){return Ot})),n.d(t,"RGBAIntegerFormat",(function(){return Yt})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return yn})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return mn})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return vn})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return gn})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return xn})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return wn})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return sn})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return ln})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return cn})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return un})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return hn})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return dn})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return pn})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return fn})),n.d(t,"RGBA_BPTC_Format",(function(){return bn})),n.d(t,"RGBA_ETC2_EAC_Format",(function(){return on})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return nn})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return tn})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return Jt})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return Qt})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return Kt})),n.d(t,"RGBDEncoding",(function(){return rr})),n.d(t,"RGBEEncoding",(function(){return $n})),n.d(t,"RGBEFormat",(function(){return Ut})),n.d(t,"RGBFormat",(function(){return Nt})),n.d(t,"RGBIntegerFormat",(function(){return Xt})),n.d(t,"RGBM16Encoding",(function(){return nr})),n.d(t,"RGBM7Encoding",(function(){return tr})),n.d(t,"RGB_ETC1_Format",(function(){return rn})),n.d(t,"RGB_ETC2_Format",(function(){return an})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return en})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return $t})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return Zt})),n.d(t,"RGFormat",(function(){return jt})),n.d(t,"RGIntegerFormat",(function(){return qt})),n.d(t,"RawShaderMaterial",(function(){return Iu})),n.d(t,"Ray",(function(){return Ei})),n.d(t,"Raycaster",(function(){return Jd})),n.d(t,"RectAreaLight",(function(){return $h})),n.d(t,"RedFormat",(function(){return Gt})),n.d(t,"RedIntegerFormat",(function(){return Wt})),n.d(t,"ReinhardToneMapping",(function(){return $e})),n.d(t,"RepeatWrapping",(function(){return ut})),n.d(t,"ReplaceStencilOp",(function(){return ur})),n.d(t,"ReverseSubtractEquation",(function(){return Te})),n.d(t,"RingBufferGeometry",(function(){return bu})),n.d(t,"RingGeometry",(function(){return bu})),n.d(t,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return kn})),n.d(t,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Pn})),n.d(t,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return Rn})),n.d(t,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return In})),n.d(t,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return Dn})),n.d(t,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return zn})),n.d(t,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return _n})),n.d(t,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Mn})),n.d(t,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return En})),n.d(t,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return Sn})),n.d(t,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Tn})),n.d(t,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return An})),n.d(t,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Ln})),n.d(t,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Cn})),n.d(t,"Scene",(function(){return Dl})),n.d(t,"SceneUtils",(function(){return Ff})),n.d(t,"ShaderChunk",(function(){return Co})),n.d(t,"ShaderLib",(function(){return Ro})),n.d(t,"ShaderMaterial",(function(){return vo})),n.d(t,"ShadowMaterial",(function(){return Ru})),n.d(t,"Shape",(function(){return Nh})),n.d(t,"ShapeBufferGeometry",(function(){return _u})),n.d(t,"ShapeGeometry",(function(){return _u})),n.d(t,"ShapePath",(function(){return dd})),n.d(t,"ShapeUtils",(function(){return du})),n.d(t,"ShortType",(function(){return St})),n.d(t,"Skeleton",(function(){return dc})),n.d(t,"SkeletonHelper",(function(){return dp})),n.d(t,"SkinnedMesh",(function(){return lc})),n.d(t,"SmoothShading",(function(){return ge})),n.d(t,"Sphere",(function(){return vi})),n.d(t,"SphereBufferGeometry",(function(){return Mu})),n.d(t,"SphereGeometry",(function(){return Mu})),n.d(t,"Spherical",(function(){return $d})),n.d(t,"SphericalHarmonics3",(function(){return ed})),n.d(t,"SplineCurve",(function(){return Ih})),n.d(t,"SpotLight",(function(){return Gh})),n.d(t,"SpotLightHelper",(function(){return lp})),n.d(t,"Sprite",(function(){return Kl})),n.d(t,"SpriteMaterial",(function(){return Fl})),n.d(t,"SrcAlphaFactor",(function(){return ke})),n.d(t,"SrcAlphaSaturateFactor",(function(){return Fe})),n.d(t,"SrcColorFactor",(function(){return Re})),n.d(t,"StaticCopyUsage",(function(){return Pr})),n.d(t,"StaticDrawUsage",(function(){return Er})),n.d(t,"StaticReadUsage",(function(){return Ar})),n.d(t,"StereoCamera",(function(){return _d})),n.d(t,"StreamCopyUsage",(function(){return Ir})),n.d(t,"StreamDrawUsage",(function(){return Tr})),n.d(t,"StreamReadUsage",(function(){return Cr})),n.d(t,"StringKeyframeTrack",(function(){return $u})),n.d(t,"SubtractEquation",(function(){return Se})),n.d(t,"SubtractiveBlending",(function(){return be})),n.d(t,"TOUCH",(function(){return ie})),n.d(t,"TangentSpaceNormalMap",(function(){return or})),n.d(t,"TetrahedronBufferGeometry",(function(){return Eu})),n.d(t,"TetrahedronGeometry",(function(){return Eu})),n.d(t,"TextBufferGeometry",(function(){return Su})),n.d(t,"TextGeometry",(function(){return Su})),n.d(t,"Texture",(function(){return jr})),n.d(t,"TextureLoader",(function(){return ph})),n.d(t,"TorusBufferGeometry",(function(){return Tu})),n.d(t,"TorusGeometry",(function(){return Tu})),n.d(t,"TorusKnotBufferGeometry",(function(){return Au})),n.d(t,"TorusKnotGeometry",(function(){return Au})),n.d(t,"Triangle",(function(){return ha})),n.d(t,"TriangleFanDrawMode",(function(){return Zn})),n.d(t,"TriangleStripDrawMode",(function(){return Yn})),n.d(t,"TrianglesDrawMode",(function(){return Xn})),n.d(t,"TubeBufferGeometry",(function(){return Lu})),n.d(t,"TubeGeometry",(function(){return Lu})),n.d(t,"UVMapping",(function(){return rt})),n.d(t,"Uint16Attribute",(function(){return Sf})),n.d(t,"Uint16BufferAttribute",(function(){return Ca})),n.d(t,"Uint32Attribute",(function(){return Af})),n.d(t,"Uint32BufferAttribute",(function(){return Ra})),n.d(t,"Uint8Attribute",(function(){return _f})),n.d(t,"Uint8BufferAttribute",(function(){return Ta})),n.d(t,"Uint8ClampedAttribute",(function(){return Mf})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return Aa})),n.d(t,"Uniform",(function(){return Xd})),n.d(t,"UniformsLib",(function(){return Po})),n.d(t,"UniformsUtils",(function(){return mo})),n.d(t,"UnsignedByteType",(function(){return Mt})),n.d(t,"UnsignedInt248Type",(function(){return Dt})),n.d(t,"UnsignedIntType",(function(){return Lt})),n.d(t,"UnsignedShort4444Type",(function(){return Rt})),n.d(t,"UnsignedShort5551Type",(function(){return It})),n.d(t,"UnsignedShort565Type",(function(){return kt})),n.d(t,"UnsignedShortType",(function(){return Tt})),n.d(t,"VSMShadowMap",(function(){return de})),n.d(t,"Vector2",(function(){return Hr})),n.d(t,"Vector3",(function(){return Qr})),n.d(t,"Vector4",(function(){return Xr})),n.d(t,"VectorKeyframeTrack",(function(){return eh})),n.d(t,"Vertex",(function(){return xf})),n.d(t,"VertexColors",(function(){return uf})),n.d(t,"VideoTexture",(function(){return Nc})),n.d(t,"WebGL1Renderer",(function(){return Rl})),n.d(t,"WebGLCubeRenderTarget",(function(){return bo})),n.d(t,"WebGLMultisampleRenderTarget",(function(){return Zr})),n.d(t,"WebGLRenderTarget",(function(){return Yr})),n.d(t,"WebGLRenderTargetCube",(function(){return Nf})),n.d(t,"WebGLRenderer",(function(){return Pl})),n.d(t,"WebGLUtils",(function(){return El})),n.d(t,"WireframeGeometry",(function(){return Cu})),n.d(t,"WireframeHelper",(function(){return kf})),n.d(t,"WrapAroundEnding",(function(){return Wn})),n.d(t,"XHRLoader",(function(){return Df})),n.d(t,"ZeroCurvatureEnding",(function(){return Vn})),n.d(t,"ZeroFactor",(function(){return Ce})),n.d(t,"ZeroSlopeEnding",(function(){return Gn})),n.d(t,"ZeroStencilOp",(function(){return lr})),n.d(t,"sRGBEncoding",(function(){return Qn}));t=n(116);var r=n.n(t),i=(t=n(17),n.n(t)),a=(t=n(16),n.n(t)),o=(t=n(113),n.n(t)),s=(t=n(26),n.n(t)),l=(t=n(235),n.n(t)),c=(t=n(12),n.n(t)),u=(t=n(69),n.n(t)),h=(t=n(4),n.n(t)),d=(t=n(97),n.n(t)),p=(t=n(10),n.n(t)),f=(t=n(0),n.n(t)),m=(t=n(1),n.n(t)),v=(t=n(78),n.n(t)),g=(t=n(13),n.n(t)),y=(t=n(25),n.n(t)),x=(t=n(18),n.n(t)),w=(t=n(6),n.n(t)),b=(t=n(47),n.n(t)),_=(t=n(29),n.n(t)),M=(t=n(8),n.n(t)),E=(t=n(45),n.n(t)),S=(t=n(33),n.n(t)),T=(t=n(15),n.n(t)),A=(t=n(27),n.n(t)),L=(t=n(7),n.n(t)),C=(t=n(79),n.n(t)),P=(t=n(42),n.n(t)),R=(t=n(53),n.n(t)),I=(t=n(165),n.n(t)),k=(t=n(49),n.n(t)),D=(t=n(22),n.n(t)),z=(t=n(166),n.n(t)),N=(t=n(98),n.n(t)),O=(t=n(5),n.n(t)),B=(t=n(167),n.n(t)),F=(t=n(43),n.n(t)),U=(t=n(236),n.n(t)),H=(t=n(52),n.n(t)),V=(t=n(37),n.n(t)),G=(t=n(19),n.n(t)),W=(t=n(117),n.n(t)),j=(t=n(140),n.n(t)),q=(t=n(141),t=n.n(t),n(237)),X=n.n(q),Y=(q=n(80),n.n(q)),Z=(q=n(95),n.n(q)),J=(q=n(114),n.n(q)),Q=(q=n(44),n.n(q)),K=(q=n(11),n.n(q));function $(e,t){var n,r,o,s,l=void 0!==i.a&&a()(e)||e["@@iterator"];if(l)return r=!(n=!0),{s:function(){l=l.call(e)},n:function(){var e=l.next();return n=e.done,e},e:function(e){r=!0,o=e},f:function(){try{n||null==l.return||l.return()}finally{if(r)throw o}}};if(M()(e)||(l=function(e,t){var n;if(e)return"string"==typeof e?ee(e,t):"Map"===(n="Object"===(n=w()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?K()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return l&&(e=l),s=0,{s:t=function(){},n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function te(e){var t=function(){if("undefined"==typeof Reflect||!r.a)return!1;if(r.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(r()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p()(e);return n=t?(n=p()(this).constructor,r()(i,arguments,n)):i.apply(this,arguments),d()(this,n)}}var ne="126",re={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ie={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},ae=0,oe=1,se=2,le=3,ce=0,ue=1,he=2,de=3,pe=0,fe=1,me=2,ve=1,ge=2,ye=0,xe=1,we=2,be=3,_e=4,Me=5,Ee=100,Se=101,Te=102,Ae=103,Le=104,Ce=200,Pe=201,Re=202,Ie=203,ke=204,De=205,ze=206,Ne=207,Oe=208,Be=209,Fe=210,Ue=0,He=1,Ve=2,Ge=3,We=4,je=5,qe=6,Xe=7,Ye=0,Ze=1,Je=2,Qe=0,Ke=1,$e=2,et=3,tt=4,nt=5,rt=300,it=301,at=302,ot=303,st=304,lt=306,ct=307,ut=1e3,ht=1001,dt=1002,pt=1003,ft=1004,mt=1004,vt=1005,gt=1005,yt=1006,xt=1007,wt=1007,bt=1008,_t=1008,Mt=1009,Et=1010,St=1011,Tt=1012,At=1013,Lt=1014,Ct=1015,Pt=1016,Rt=1017,It=1018,kt=1019,Dt=1020,zt=1021,Nt=1022,Ot=1023,Bt=1024,Ft=1025,Ut=Ot,Ht=1026,Vt=1027,Gt=1028,Wt=1029,jt=1030,qt=1031,Xt=1032,Yt=1033,Zt=33776,Jt=33777,Qt=33778,Kt=33779,$t=35840,en=35841,tn=35842,nn=35843,rn=36196,an=37492,on=37496,sn=37808,ln=37809,cn=37810,un=37811,hn=37812,dn=37813,pn=37814,fn=37815,mn=37816,vn=37817,gn=37818,yn=37819,xn=37820,wn=37821,bn=36492,_n=37840,Mn=37841,En=37842,Sn=37843,Tn=37844,An=37845,Ln=37846,Cn=37847,Pn=37848,Rn=37849,In=37850,kn=37851,Dn=37852,zn=37853,Nn=2200,On=2201,Bn=2202,Fn=2300,Un=2301,Hn=2302,Vn=2400,Gn=2401,Wn=2402,jn=2500,qn=2501,Xn=0,Yn=1,Zn=2,Jn=3e3,Qn=3001,Kn=3007,$n=3002,er=3003,tr=3004,nr=3005,rr=3006,ir=3200,ar=3201,or=0,sr=1,lr=0,cr=7680,ur=7681,hr=7682,dr=7683,pr=34055,fr=34056,mr=5386,vr=512,gr=513,yr=514,xr=515,wr=516,br=517,_r=518,Mr=519,Er=35044,Sr=35048,Tr=35040,Ar=35045,Lr=35049,Cr=35041,Pr=35046,Rr=35050,Ir=35042,kr="100",Dr="300 es";function zr(){}g()(zr.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n,r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===y()(n=r[e]).call(n,t)&&r[e].push(t)},hasEventListener:function(e,t){var n;return void 0!==this._listeners&&void 0!==(n=this._listeners)[e]&&-1!==y()(n=n[e]).call(n,t)},removeEventListener:function(e,t){var n;void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(n=y()(e).call(e,t))&&x()(e).call(e,n,1)},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=w()(t).call(t,0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});for(var Nr=[],Or=0;Or<256;Or++)Nr[Or]=(Or<16?"0":"")+Or.toString(16);var Br,Fr=1234567,Ur={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Nr[255&e]+Nr[e>>8&255]+Nr[e>>16&255]+Nr[e>>24&255]+"-"+Nr[255&t]+Nr[t>>8&255]+"-"+Nr[t>>16&15|64]+Nr[t>>24&255]+"-"+Nr[63&n|128]+Nr[n>>8&255]+"-"+Nr[n>>16&255]+Nr[n>>24&255]+Nr[255&r]+Nr[r>>8&255]+Nr[r>>16&255]+Nr[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,r){return Ur.lerp(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Ur.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return((Fr=16807*(Fr=void 0!==e?e%2147483647:Fr)%2147483647)-1)/2147483646},degToRad:function(e){return e*Ur.DEG2RAD},radToDeg:function(e){return e*Ur.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),c=a((t+r)/2),u=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),p=a((r-t)/2),f=o((r-t)/2);switch(i){case"XYX":e.set(s*u,l*h,l*d,s*c);break;case"YZY":e.set(l*d,s*u,l*h,s*c);break;case"ZXZ":e.set(l*h,l*d,s*u,s*c);break;case"XZX":e.set(s*u,l*f,l*p,s*c);break;case"YXY":e.set(l*p,s*u,l*f,s*c);break;case"ZYZ":e.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}},Hr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;f()(this,e),this.x=t,this.y=n}return m()(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y;e=e.elements;return this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x;return t*t+(e=this.y-e.y)*e}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=(t=Math.sin(t),this.x-e.x),i=this.y-e.y;return this.x=r*n-i*t+e.x,this.y=r*t+i*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}(),Vr=(Hr.prototype.isVector2=!0,function(){function e(){f()(this,e),this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return m()(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l){var c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements;e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){e=e.elements,t=t.elements;var n=this.elements,r=e[0],i=e[3],a=e[6],o=e[1],s=e[4],l=e[7],c=e[2],u=e[5],h=(e=e[8],t[0]),d=t[3],p=t[6],f=t[1],m=t[4],v=t[7],g=t[2],y=t[5];t=t[8];return n[0]=r*h+i*f+a*g,n[3]=r*d+i*m+a*y,n[6]=r*p+i*v+a*t,n[1]=o*h+s*f+l*g,n[4]=o*d+s*m+l*y,n[7]=o*p+s*v+l*t,n[2]=c*h+u*f+e*g,n[5]=c*d+u*m+e*y,n[8]=c*p+u*v+e*t,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e,t=(e=this.elements)[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7];return t*a*(e=e[8])-t*o*l-n*i*e+n*o*s+r*i*l-r*a*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,h=o*s-c*i,d=l*i-a*s,p=t*u+n*h+r*d;return 0==p?this.set(0,0,0,0,0,0,0,0,0):(e[0]=u*(u=1/p),e[1]=(r*l-c*n)*u,e[2]=(o*n-r*a)*u,e[3]=h*u,e[4]=(c*t-r*s)*u,e[5]=(r*i-o*t)*u,e[6]=d*u,e[7]=(n*s-l*t)*u,e[8]=(a*t-n*i)*u,this)}},{key:"transpose",value:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,i,a,o){var s=Math.cos(i);i=Math.sin(i);return this.set(n*s,n*i,-n*(s*a+i*o)+a+e,-r*i,r*s,-r*(-i*a+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=(e=Math.sin(e),this.elements),r=n[0],i=n[3],a=n[6],o=n[1],s=n[4],l=n[7];return n[0]=t*r+e*o,n[3]=t*i+e*s,n[6]=t*a+e*l,n[1]=-e*r+t*o,n[4]=-e*i+t*s,n[7]=-e*a+t*l,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}()),Gr=(Vr.prototype.isMatrix3=!0,{getDataURL:function(e){var t;return/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement?e.src:2048<(t=e instanceof HTMLCanvasElement?e:((Br=void 0===Br?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):Br).width=e.width,Br.height=e.height,t=Br.getContext("2d"),e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),Br)).width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}}),Wr=0,jr=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ht,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ht,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:yt,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:bt,c=6<arguments.length&&void 0!==arguments[6]?arguments[6]:Ot,h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:Mt,d=8<arguments.length&&void 0!==arguments[8]?arguments[8]:1,p=9<arguments.length&&void 0!==arguments[9]?arguments[9]:Jn;return f()(this,n),e=t.call(this),b()(u()(e),"id",{value:Wr++}),e.uuid=Ur.generateUUID(),e.name="",e.image=r,e.mipmaps=[],e.mapping=i,e.wrapS=a,e.wrapT=o,e.magFilter=s,e.minFilter=l,e.anisotropy=d,e.format=c,e.internalFormat=null,e.type=h,e.offset=new Hr(0,0),e.repeat=new Hr(1,1),e.center=new Hr(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new Vr,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=p,e.version=0,e.onUpdate=null,e}return m()(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,_()(this).x,_()(this).y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){var t;return this.name=e.name,this.image=e.image,this.mipmaps=w()(t=e.mipmaps).call(t,0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),_()(this).copy(_()(e)),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[_()(this).x,_()(this).y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Ur.generateUUID()),!t&&void 0===e.images[r.uuid]){if(M()(r))for(var i=[],a=0,o=r.length;a<o;a++)r[a].isDataTexture?i.push(qr(r[a].image)):i.push(qr(r[a]));else i=qr(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping===rt){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case ut:e.x=e.x-Math.floor(e.x);break;case ht:e.x=e.x<0?0:1;break;case dt:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case ut:e.y=e.y-Math.floor(e.y);break;case ht:e.y=e.y<0?0:1;break;case dt:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}return e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(zr);function qr(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?Gr.getDataURL(e):e.data?{data:w()(Array.prototype).call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}jr.DEFAULT_IMAGE=void 0,jr.DEFAULT_MAPPING=rt,jr.prototype.isTexture=!0;var Xr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;f()(this,e),this.x=t,this.y=n,this.z=r,this.w=i}return m()(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=this.w;e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,i,a,o,s,l,c,u,h=(e=e.elements)[0],d=e[4],p=e[8],f=e[1],m=e[5],v=e[9],g=e[2],y=e[6];e=e[10];return Math.abs(d-f)<.01&&Math.abs(p-g)<.01&&Math.abs(v-y)<.01?Math.abs(d+f)<.1&&Math.abs(p+g)<.1&&Math.abs(v+y)<.1&&Math.abs(h+m+e-3)<.1?this.set(1,0,0,0):(i=Math.PI,o=(e+1)/2,s=(d+f)/4,l=(p+g)/4,c=(v+y)/4,(a=(m+1)/2)<(u=(h+1)/2)&&o<u?r=u<.01?(t=0,n=.707106781):(n=s/(t=Math.sqrt(u)),l/t):o<a?r=a<.01?(n=0,t=.707106781):(t=s/(n=Math.sqrt(a)),c/n):o<.01?(n=t=.707106781,r=0):(t=l/(r=Math.sqrt(o)),n=c/r),this.set(t,n,r,i)):(u=Math.sqrt((y-v)*(y-v)+(p-g)*(p-g)+(f-d)*(f-d)),Math.abs(u)<.001&&(u=1),this.x=(y-v)/u,this.y=(p-g)/u,this.z=(f-d)/u,this.w=Math.acos((h+m+e-1)/2)),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}(),Yr=(Xr.prototype.isVector4=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i){var a;return f()(this,n),(a=t.call(this)).width=e,a.height=r,a.depth=1,a.scissor=new Xr(0,0,e,r),a.scissorTest=!1,a.viewport=new Xr(0,0,e,r),a.texture=new jr(void 0,(i=i||{}).mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),a.texture.image={},a.texture.image.width=e,a.texture.image.height=r,a.texture.image.depth=1,a.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,a.texture.minFilter=void 0!==i.minFilter?i.minFilter:yt,a.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,a.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,a.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,a}return m()(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(zr)),Zr=(Yr.prototype.isWebGLRenderTarget=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i){return f()(this,n),(e=t.call(this,e,r,i)).samples=4,e}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(Yr)),Jr=(Zr.prototype.isWebGLMultisampleRenderTarget=!0,function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;f()(this,e),this._x=t,this._y=n,this._z=r,this._w=i}return m()(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=(e=Math.cos,Math.sin),s=e(n/2),l=e(r/2),c=e(i/2),u=o(n/2),h=o(r/2),d=o(i/2);switch(a){case"XYZ":this._x=u*l*c+s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c-u*h*d;break;case"YXZ":this._x=u*l*c+s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c+u*h*d;break;case"ZXY":this._x=u*l*c-s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c-u*h*d;break;case"ZYX":this._x=u*l*c-s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c+u*h*d;break;case"YZX":this._x=u*l*c+s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c-u*h*d;break;case"XZY":this._x=u*l*c-s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c+u*h*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){t/=2;var n=Math.sin(t);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(t),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=(e=e.elements)[0],n=e[4],r=e[8],i=e[1],a=e[5],o=e[9],s=e[2],l=e[6],c=t+a+(e=e[10]);return 0<c?(c=.5/Math.sqrt(c+1),this._w=.25/c,this._x=(l-o)*c,this._y=(r-s)*c,this._z=(i-n)*c):a<t&&e<t?(c=2*Math.sqrt(1+t-a-e),this._w=(l-o)/c,this._x=.25*c,this._y=(n+i)/c,this._z=(r+s)/c):e<a?(c=2*Math.sqrt(1+a-t-e),this._w=(r-s)/c,this._x=(n+i)/c,this._y=.25*c,this._z=(o+l)/c):(c=2*Math.sqrt(1+e-t-a),this._w=(i-n)/c,this._x=(r+s)/c,this._y=(o+l)/c,this._z=.25*c),this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(Ur.clamp(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);return 0!==n&&(t=Math.min(1,t/n),this.slerp(e,t)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(e=1/e),this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,i=e._z,a=(e=e._w,t._x),o=t._y,s=t._z;t=t._w;return this._x=n*t+e*a+r*s-i*o,this._y=r*t+e*o+i*a-n*s,this._z=i*t+e*s+n*o-r*a,this._w=e*t-n*a-r*o-i*s,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0!==t){if(1===t)return this.copy(e);var n,r=this._x,i=this._y,a=this._z,o=this._w,s=o*e._w+r*e._x+i*e._y+a*e._z;s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),1<=s?(this._w=o,this._x=r,this._y=i,this._z=a):((e=1-s*s)<=E.a?(this._w=(n=1-t)*o+t*this._w,this._x=n*r+t*this._x,this._y=n*i+t*this._y,this._z=n*a+t*this._z,this.normalize()):(n=Math.sqrt(e),e=Math.atan2(n,s),s=Math.sin((1-t)*e)/n,t=Math.sin(t*e)/n,this._w=o*s+this._w*t,this._x=r*s+this._x*t,this._y=i*s+this._y*t,this._z=a*s+this._z*t),this._onChangeCallback())}return this}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return n.copy(e).slerp(t,r)}},{key:"slerpFlat",value:function(e,t,n,r,i,a,o){var s,l,c,u=n[r+0],h=n[r+1],d=n[r+2],p=(n=n[r+3],r=i[a+0],i[a+1]),f=i[a+2];i=i[a+3];0===o?(e[t+0]=u,e[t+1]=h,e[t+2]=d,e[t+3]=n):1===o?(e[t+0]=r,e[t+1]=p,e[t+2]=f,e[t+3]=i):(n===i&&u===r&&h===p&&d===f||(a=1-o,s=0<=(l=u*r+h*p+d*f+n*i)?1:-1,(c=1-l*l)>E.a&&(c=Math.sqrt(c),l=Math.atan2(c,l*s),a=Math.sin(a*l)/c,o=Math.sin(o*l)/c),u=u*a+r*(l=o*s),h=h*a+p*l,d=d*a+f*l,n=n*a+i*l,a===1-o&&(u*=c=1/Math.sqrt(u*u+h*h+d*d+n*n),h*=c,d*=c,n*=c)),e[t]=u,e[t+1]=h,e[t+2]=d,e[t+3]=n)}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],c=(n=n[r+3],r=i[a],i[a+1]),u=i[a+2];i=i[a+3];return e[t]=o*i+n*r+s*u-l*c,e[t+1]=s*i+n*c+l*r-o*u,e[t+2]=l*i+n*u+o*c-s*r,e[t+3]=n*i-o*r-s*c-l*u,e}}]),e}()),Qr=(Jr.prototype.isQuaternion=!0,function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;f()(this,e),this.x=t,this.y=n,this.z=r}return m()(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion($r.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion($r.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;return this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,i=1/((e=e.elements)[3]*t+e[7]*n+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i,this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i,this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=(e=e.w)*t+a*r-o*n,l=e*n+o*t-i*r,c=e*r+i*n-a*t;t=-i*t-a*n-o*r;return this.x=s*e+t*-i+l*-o-c*-a,this.y=l*e+t*-a+c*-i-s*-o,this.z=c*e+t*-o+s*-a-l*-i,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z;e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,i=(e=e.z,t.x),a=t.y;t=t.z;return this.x=r*t-e*a,this.y=e*i-n*t,this.z=n*a-r*i,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();return 0===t?this.set(0,0,0):(t=e.dot(this)/t,this.copy(e).multiplyScalar(t))}},{key:"projectOnPlane",value:function(e){return Kr.copy(this).projectOnVector(e),this.sub(Kr)}},{key:"reflect",value:function(e){return this.sub(Kr.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:(e=this.dot(e)/t,Math.acos(Ur.clamp(e,-1,1)))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();e=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=e,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}()),Kr=(Qr.prototype.isVector3=!0,new Qr),$r=new Jr,ei=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr(1/0,1/0,1/0),n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr(-1/0,-1/0,-1/0);f()(this,e),this.min=t,this.max=n}return m()(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],u=e[s+1],h=e[s+2];c<t&&(t=c),u<n&&(n=u),h<r&&(r=h),i<c&&(i=c),a<u&&(a=u),o<h&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var c=e.getX(s),u=e.getY(s),h=e.getZ(s);c<t&&(t=c),u<n&&(n=u),h<r&&(r=h),i<c&&(i=c),a<u&&(a=u),o<h&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){return t=ni.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Qr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Qr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);for(var t=e.geometry,n=(void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),ri.copy(t.boundingBox),ri.applyMatrix4(e.matrixWorld),this.union(ri)),e.children),r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Qr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,ni),ni.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x);return 0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){return!this.isEmpty()&&(this.getCenter(ui),hi.subVectors(this.max,ui),ii.subVectors(e.a,ui),ai.subVectors(e.b,ui),oi.subVectors(e.c,ui),si.subVectors(ai,ii),li.subVectors(oi,ai),ci.subVectors(ii,oi),!!fi([0,-si.z,si.y,0,-li.z,li.y,0,-ci.z,ci.y,si.z,0,-si.x,li.z,0,-li.x,ci.z,0,-ci.x,-si.y,si.x,0,-li.y,li.x,0,-ci.y,ci.x,0],ii,ai,oi,hi))&&!!fi([1,0,0,0,1,0,0,0,1],ii,ai,oi,hi)&&(di.crossVectors(si,li),fi([di.x,di.y,di.z],ii,ai,oi,hi))}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Qr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return ni.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(ni).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(ti[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ti[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ti[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ti[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ti[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ti[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ti[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ti[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ti)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),ti=(ei.prototype.isBox3=!0,[new Qr,new Qr,new Qr,new Qr,new Qr,new Qr,new Qr,new Qr]),ni=new Qr,ri=new ei,ii=new Qr,ai=new Qr,oi=new Qr,si=new Qr,li=new Qr,ci=new Qr,ui=new Qr,hi=new Qr,di=new Qr,pi=new Qr;function fi(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){pi.fromArray(e,a);var s=i.x*Math.abs(pi.x)+i.y*Math.abs(pi.y)+i.z*Math.abs(pi.z),l=t.dot(pi),c=n.dot(pi),u=r.dot(pi);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}var mi=new ei,vi=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;f()(this,e),this.center=t,this.radius=n}return m()(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){for(var n=this.center,r=(void 0!==t?n.copy(t):mi.setFromPoints(e).getCenter(n),0),i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Qr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new ei),this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),gi=new Qr,yi=new Qr,xi=new Qr,wi=new Qr,bi=new Qr,_i=new Qr,Mi=new Qr,Ei=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr(0,0,-1);f()(this,e),this.origin=t,this.direction=n}return m()(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Qr),t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,gi)),this}},{key:"closestPointToPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Qr),t.subVectors(e,this.origin),(e=t.dot(this.direction))<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=gi.subVectors(e,this.origin).dot(this.direction);return(t<0?this.origin:(gi.copy(this.direction).multiplyScalar(t).add(this.origin),gi)).distanceToSquared(e)}},{key:"distanceSqToSegment",value:function(e,t,n,r){yi.copy(e).add(t).multiplyScalar(.5),xi.copy(t).sub(e).normalize(),wi.copy(this.origin).sub(yi);e=.5*e.distanceTo(t),t=-this.direction.dot(xi);var i,a,o,s=wi.dot(this.direction),l=-wi.dot(xi),c=wi.lengthSq(),u=Math.abs(1-t*t);return u=0<u?(a=t*s-l,o=e*u,0<=(i=t*l-s)?-o<=a?a<=o?(i*=u=1/u)*(i+t*(a*=u)+2*s)+a*(t*i+a+2*l)+c:(a=e,-(i=Math.max(0,-(t*a+s)))*i+a*(a+2*l)+c):(a=-e,-(i=Math.max(0,-(t*a+s)))*i+a*(a+2*l)+c):a<=-o?-(i=Math.max(0,-(-t*e+s)))*i+(a=0<i?-e:Math.min(Math.max(-e,-l),e))*(a+2*l)+c:a<=o?(i=0,(a=Math.min(Math.max(-e,-l),e))*(a+2*l)+c):-(i=Math.max(0,-(t*e+s)))*i+(a=0<i?e:Math.min(Math.max(-e,-l),e))*(a+2*l)+c):(a=0<t?-e:e,-(i=Math.max(0,-(t*a+s)))*i+a*(a+2*l)+c),n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(xi).multiplyScalar(a).add(yi),u}},{key:"intersectSphere",value:function(e,t){gi.subVectors(e.center,this.origin);var n=gi.dot(this.direction),r=gi.dot(gi)-n*n;return(e=e.radius*e.radius)<r||(r=n+(e=Math.sqrt(e-r)),(n-=e)<0&&r<0)?null:n<0?this.at(r,t):this.at(n,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(e=-(this.origin.dot(e.normal)+e.constant)/t)?e:null}},{key:"intersectPlane",value:function(e,t){return null===(e=this.distanceToPlane(e))?null:this.at(e,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,i,a=1/this.direction.x,o=1/this.direction.y,s=1/this.direction.z,l=this.origin;a=0<=a?(n=(e.min.x-l.x)*a,(e.max.x-l.x)*a):(n=(e.max.x-l.x)*a,(e.min.x-l.x)*a);return(o=0<=o?(i=(e.min.y-l.y)*o,(e.max.y-l.y)*o):(i=(e.max.y-l.y)*o,(e.min.y-l.y)*o))<n||a<i||((n<i||n!=n)&&(n=i),(o<a||a!=a)&&(a=o),(i=0<=s?(r=(e.min.z-l.z)*s,(e.max.z-l.z)*s):(r=(e.max.z-l.z)*s,(e.min.z-l.z)*s))<n)||a<r||((n<r||n!=n)&&(n=r),(a=i<a||a!=a?i:a)<0)?null:this.at(0<=n?n:a,t)}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,gi)}},{key:"intersectTriangle",value:function(e,t,n,r,i){var a;if(bi.subVectors(t,e),_i.subVectors(n,e),Mi.crossVectors(bi,_i),0<(t=this.direction.dot(Mi))){if(r)return null;a=1}else{if(!(t<0))return null;a=-1,t=-t}return wi.subVectors(this.origin,e),(n=a*this.direction.dot(_i.crossVectors(wi,_i)))<0||(r=a*this.direction.dot(bi.cross(wi)))<0||t<n+r||(e=-a*wi.dot(Mi))<0?null:this.at(e/t,i)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Si=function(){function e(){f()(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return m()(e,[{key:"set",value:function(e,t,n,r,i,a,o,s,l,c,u,h,d,p,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements;e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this}},{key:"copyPosition",value:function(e){var t=this.elements;e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this}},{key:"setFromMatrix3",value:function(e){return e=e.elements,this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Ti.setFromMatrixColumn(e,0).length(),i=1/Ti.setFromMatrixColumn(e,1).length();e=1/Ti.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,a=this.elements,o=e.x,s=e.y,l=e.z,c=Math.cos(o),u=(o=Math.sin(o),Math.cos(s)),h=(s=Math.sin(s),Math.cos(l));l=Math.sin(l);return"XYZ"===e.order?(n=c*h,r=c*l,i=o*h,t=o*l,a[0]=u*h,a[4]=-u*l,a[8]=s,a[1]=r+i*s,a[5]=n-t*s,a[9]=-o*u,a[2]=t-n*s,a[6]=i+r*s,a[10]=c*u):"YXZ"===e.order?(t=u*l,n=s*h,a[0]=(i=u*h)+(r=s*l)*o,a[4]=n*o-t,a[8]=c*s,a[1]=c*l,a[5]=c*h,a[9]=-o,a[2]=t*o-n,a[6]=r+i*o,a[10]=c*u):"ZXY"===e.order?(t=u*l,n=s*h,a[0]=(r=u*h)-(i=s*l)*o,a[4]=-c*l,a[8]=n+t*o,a[1]=t+n*o,a[5]=c*h,a[9]=i-r*o,a[2]=-c*s,a[6]=o,a[10]=c*u):"ZYX"===e.order?(t=c*h,n=c*l,i=o*h,r=o*l,a[0]=u*h,a[4]=i*s-n,a[8]=t*s+r,a[1]=u*l,a[5]=r*s+t,a[9]=n*s-i,a[2]=-s,a[6]=o*u,a[10]=c*u):"YZX"===e.order?(r=c*u,t=c*s,n=o*u,i=o*s,a[0]=u*h,a[4]=i-r*l,a[8]=n*l+t,a[1]=l,a[5]=c*h,a[9]=-o*h,a[2]=-s*h,a[6]=t*l+n,a[10]=r-i*l):"XZY"===e.order&&(t=c*u,n=c*s,r=o*u,i=o*s,a[0]=u*h,a[4]=-l,a[8]=s*h,a[1]=t*l+i,a[5]=c*h,a[9]=n*l-r,a[2]=r*l-n,a[6]=o*h,a[10]=i*l+t),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Li,e,Ci)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Ii.subVectors(e,t),0===Ii.lengthSq()&&(Ii.z=1),Ii.normalize(),Pi.crossVectors(n,Ii),0===Pi.lengthSq()&&(1===Math.abs(n.z)?Ii.x+=1e-4:Ii.z+=1e-4,Ii.normalize(),Pi.crossVectors(n,Ii)),Pi.normalize(),Ri.crossVectors(Ii,Pi),r[0]=Pi.x,r[4]=Ri.x,r[8]=Ii.x,r[1]=Pi.y,r[5]=Ri.y,r[9]=Ii.y,r[2]=Pi.z,r[6]=Ri.z,r[10]=Ii.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){e=e.elements,t=t.elements;var n=this.elements,r=e[0],i=e[4],a=e[8],o=e[12],s=e[1],l=e[5],c=e[9],u=e[13],h=e[2],d=e[6],p=e[10],f=e[14],m=e[3],v=e[7],g=e[11],y=(e=e[15],t[0]),x=t[4],w=t[8],b=t[12],_=t[1],M=t[5],E=t[9],S=t[13],T=t[2],A=t[6],L=t[10],C=t[14],P=t[3],R=t[7],I=t[11];t=t[15];return n[0]=r*y+i*_+a*T+o*P,n[4]=r*x+i*M+a*A+o*R,n[8]=r*w+i*E+a*L+o*I,n[12]=r*b+i*S+a*C+o*t,n[1]=s*y+l*_+c*T+u*P,n[5]=s*x+l*M+c*A+u*R,n[9]=s*w+l*E+c*L+u*I,n[13]=s*b+l*S+c*C+u*t,n[2]=h*y+d*_+p*T+f*P,n[6]=h*x+d*M+p*A+f*R,n[10]=h*w+d*E+p*L+f*I,n[14]=h*b+d*S+p*C+f*t,n[3]=m*y+v*_+g*T+e*P,n[7]=m*x+v*M+g*A+e*R,n[11]=m*w+v*E+g*L+e*I,n[15]=m*b+v*S+g*C+e*t,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*l*u-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*c-i*s*c)+e[11]*(+t*l*u-t*o*d-i*a*u+n*a*d+i*o*c-n*l*c)+e[15]*(-r*o*c-t*s*u+t*o*h+r*a*u-n*a*h+n*s*c)}},{key:"transpose",value:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],v=e[15],g=u*m*l-f*h*l+f*s*d-o*m*d-u*s*v+o*h*v,y=p*h*l-c*m*l-p*s*d+a*m*d+c*s*v-a*h*v,x=c*f*l-p*u*l+p*o*d-a*f*d-c*o*v+a*u*v,w=p*u*s-c*f*s-p*o*h+a*f*h+c*o*m-a*u*m,b=t*g+n*y+r*x+i*w;return 0==b?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=g*(g=1/b),e[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*v-n*h*v)*g,e[2]=(o*m*i-f*s*i+f*r*l-n*m*l-o*r*v+n*s*v)*g,e[3]=(u*s*i-o*h*i-u*r*l+n*h*l+o*r*d-n*s*d)*g,e[4]=y*g,e[5]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*v+t*h*v)*g,e[6]=(p*s*i-a*m*i-p*r*l+t*m*l+a*r*v-t*s*v)*g,e[7]=(a*h*i-c*s*i+c*r*l-t*h*l-a*r*d+t*s*d)*g,e[8]=x*g,e[9]=(p*u*i-c*f*i-p*n*d+t*f*d+c*n*v-t*u*v)*g,e[10]=(a*f*i-p*o*i+p*n*l-t*f*l-a*n*v+t*o*v)*g,e[11]=(c*o*i-a*u*i-c*n*l+t*u*l+a*n*d-t*o*d)*g,e[12]=w*g,e[13]=(c*f*r-p*u*r+p*n*h-t*f*h-c*n*m+t*u*m)*g,e[14]=(p*o*r-a*f*r-p*n*s+t*f*s+a*n*m-t*o*m)*g,e[15]=(a*u*r-c*o*r+c*n*s-t*u*s-a*n*h+t*o*h)*g,this)}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y;e=e.z;return t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this}},{key:"getMaxScaleOnAxis",value:function(){var e=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e);e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e);e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e);e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=(t=Math.sin(t),1-n),i=e.x,a=e.y,o=(e=e.z,r*i),s=r*a;return this.set(o*i+n,o*a-t*e,o*e+t*a,0,o*a+t*e,s*a+n,s*e-t*i,0,o*e-t*a,s*e+t*i,r*e*e+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,i=(o=t._x)*(u=o+o),a=o*(h=(l=t._y)+l),o=o*(d=(c=t._z)+c),s=l*h,l=l*d,c=c*d,u=(t=t._w)*u,h=t*h,d=(t=t*d,n.x),p=n.y;n=n.z;return r[0]=(1-(s+c))*d,r[1]=(a+t)*d,r[2]=(o-h)*d,r[3]=0,r[4]=(a-t)*p,r[5]=(1-(i+c))*p,r[6]=(l+u)*p,r[7]=0,r[8]=(o+h)*n,r[9]=(l-u)*n,r[10]=(1-(i+s))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,i=Ti.set(r[0],r[1],r[2]).length(),a=Ti.set(r[4],r[5],r[6]).length(),o=Ti.set(r[8],r[9],r[10]).length(),s=(e=(this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Ai.copy(this),1/i),r=1/a,1/o);return Ai.elements[0]*=e,Ai.elements[1]*=e,Ai.elements[2]*=e,Ai.elements[4]*=r,Ai.elements[5]*=r,Ai.elements[6]*=r,Ai.elements[8]*=s,Ai.elements[9]*=s,Ai.elements[10]*=s,t.setFromRotationMatrix(Ai),n.x=i,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(n-r),l=(t+e)/(t-e);n=(n+r)/(n-r),r=-(a+i)/(a-i),a=-2*a*i/(a-i);return o[0]=2*i/(t-e),o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=s,o[9]=n,o[13]=0,o[2]=0,o[6]=0,o[10]=r,o[14]=a,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),l=1/(n-r),c=1/(a-i);t=(t+e)*s,e=(n+r)*l,n=(a+i)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-t,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-e,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-n,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}(),Ti=(Si.prototype.isMatrix4=!0,new Qr),Ai=new Si,Li=new Qr(0,0,0),Ci=new Qr(1,1,1),Pi=new Qr,Ri=new Qr,Ii=new Qr,ki=new Si,Di=new Jr,zi=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;f()(this,e),this._x=t,this._y=n,this._z=r,this._order=i}return m()(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t,n){var r=Ur.clamp,i=(e=e.elements)[0],a=e[4],o=e[8],s=e[1],l=e[5],c=e[9],u=e[2],h=e[6],d=e[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return ki.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ki,t,n)}},{key:"setFromVector3",value:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)}},{key:"reorder",value:function(e){return Di.setFromEuler(this),this.setFromQuaternion(Di,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new Qr(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}(),Ni=(zi.prototype.isEuler=!0,zi.DefaultOrder="XYZ",zi.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],function(){function e(){f()(this,e),this.mask=1}return m()(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}}]),e}()),Oi=0,Bi=new Qr,Fi=new Jr,Ui=new Si,Hi=new Qr,Vi=new Qr,Gi=new Qr,Wi=new Jr,ji=new Qr(1,0,0),qi=new Qr(0,1,0),Xi=new Qr(0,0,1),Yi={type:"added"},Zi={type:"removed"};function Ji(){b()(this,"id",{value:Oi++}),this.uuid=Ur.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ji.DefaultUp.clone();var e=new Qr,t=new zi,n=new Jr,r=new Qr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),S()(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Si},normalMatrix:{value:new Vr}}),this.matrix=new Si,this.matrixWorld=new Si,this.matrixAutoUpdate=Ji.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ni,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Ji.DefaultUp=new Qr(0,1,0),Ji.DefaultMatrixAutoUpdate=!0,Ji.prototype=g()(T()(zr.prototype),{constructor:Ji,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Fi.setFromAxisAngle(e,t),this.quaternion.multiply(Fi),this},rotateOnWorldAxis:function(e,t){return Fi.setFromAxisAngle(e,t),this.quaternion.premultiply(Fi),this},rotateX:function(e){return this.rotateOnAxis(ji,e)},rotateY:function(e){return this.rotateOnAxis(qi,e)},rotateZ:function(e){return this.rotateOnAxis(Xi,e)},translateOnAxis:function(e,t){return Bi.copy(e).applyQuaternion(this.quaternion),this.position.add(Bi.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(ji,e)},translateY:function(e){return this.translateOnAxis(qi,e)},translateZ:function(e){return this.translateOnAxis(Xi,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(Ui.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?Hi.copy(e):Hi.set(e,t,n),e=this.parent,this.updateWorldMatrix(!0,!1),Vi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ui.lookAt(Vi,Hi,this.up):Ui.lookAt(Hi,Vi,this.up),this.quaternion.setFromRotationMatrix(Ui),e&&(Ui.extractRotation(e.matrixWorld),Fi.setFromRotationMatrix(Ui),this.quaternion.premultiply(Fi.invert()))},add:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.add(arguments[t]);else e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),(e.parent=this).children.push(e),e.dispatchEvent(Yi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this},remove:function(e){if(1<arguments.length)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);else{var n,r=y()(r=this.children).call(r,e);-1!==r&&(e.parent=null,x()(n=this.children).call(n,r,1),e.dispatchEvent(Zi))}return this},clear:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(Zi)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),Ui.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ui.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ui),this.add(e),e.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Qr),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Jr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Vi,e,Gi),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Qr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Vi,Wi,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Qr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t,n,r,i,a,o=void 0===e||"string"==typeof e,s={},l=(o&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},s.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),{});function c(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),"{}"!==A()(this.userData)&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){l.geometry=c(e.geometries,this.geometry);var u=this.geometry.parameters;if(void 0!==u&&void 0!==u.shapes){var h=u.shapes;if(M()(h))for(var d=0,p=h.length;d<p;d++){var f=h[d];c(e.shapes,f)}else c(e.shapes,h)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton)&&(c(e.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid),void 0!==this.material)if(M()(this.material)){for(var m=[],v=0,g=this.material.length;v<g;v++)m.push(c(e.materials,this.material[v]));l.material=m}else l.material=c(e.materials,this.material);if(0<this.children.length){l.children=[];for(var y=0;y<this.children.length;y++)l.children.push(this.children[y].toJSON(e).object)}if(0<this.animations.length){l.animations=[];for(var x=0;x<this.animations.length;x++){var w=this.animations[x];l.animations.push(c(e.animations,w))}}return o&&(u=b(e.geometries),o=b(e.materials),t=b(e.textures),n=b(e.images),r=b(e.shapes),i=b(e.skeletons),a=b(e.animations),0<u.length&&(s.geometries=u),0<o.length&&(s.materials=o),0<t.length&&(s.textures=t),0<n.length&&(s.images=n),0<r.length&&(s.shapes=r),0<i.length&&(s.skeletons=i),0<a.length)&&(s.animations=a),s.object=l,s;function b(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(A()(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Qi=new Qr,Ki=new Qr,$i=new Vr,ea=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr(1,0,0),n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;f()(this,e),this.normal=t,this.constant=n}return m()(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){return n=Qi.subVectors(n,t).cross(Ki.subVectors(e,t)).normalize(),this.setFromNormalAndCoplanarPoint(n,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Qr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Qr);var n=e.delta(Qi),r=this.normal.dot(n);return 0===r?0===this.distanceToPoint(e.start)?t.copy(e.start):void 0:(r=-(e.start.dot(this.normal)+this.constant)/r)<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start);e=this.distanceToPoint(e.end);return t<0&&0<e||e<0&&0<t}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Qr),e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){return t=t||$i.getNormalMatrix(e),e=this.coplanarPoint(Qi).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize(),this.constant=-e.dot(t),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ta=(ea.prototype.isPlane=!0,new Qr),na=new Qr,ra=new Qr,ia=new Qr,aa=new Qr,oa=new Qr,sa=new Qr,la=new Qr,ca=new Qr,ua=new Qr,ha=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Qr;f()(this,e),this.a=t,this.b=n,this.c=r}return m()(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return ta.subVectors(this.c,this.b),na.subVectors(this.a,this.b),.5*ta.cross(na).length()}},{key:"getMidpoint",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Qr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new ea),e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Qr);var n=this.a,r=this.b,i=this.c,a=(aa.subVectors(r,n),oa.subVectors(i,n),la.subVectors(e,n),aa.dot(la)),o=oa.dot(la);if(a<=0&&o<=0)return t.copy(n);ca.subVectors(e,r);var s=aa.dot(ca),l=oa.dot(ca);if(0<=s&&l<=s)return t.copy(r);var c=a*l-s*o;if(c<=0&&0<=a&&s<=0)return u=a/(a-s),t.copy(n).addScaledVector(aa,u);ua.subVectors(e,i);e=aa.dot(ua);var u,h,d=oa.dot(ua);return 0<=d&&e<=d?t.copy(i):(a=e*o-a*d)<=0&&0<=o&&d<=0?(h=o/(o-d),t.copy(n).addScaledVector(oa,h)):(o=s*d-e*l)<=0&&0<=l-s&&0<=e-d?(sa.subVectors(i,r),h=(l-s)/(l-s+(e-d)),t.copy(r).addScaledVector(sa,h)):(u=a*(i=1/(o+a+c)),h=c*i,t.copy(n).addScaledVector(aa,u).addScaledVector(oa,h))}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){return void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Qr),r.subVectors(n,t),ta.subVectors(e,t),r.cross(ta),0<(n=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,i){ta.subVectors(r,t),na.subVectors(n,t),ra.subVectors(e,t);r=ta.dot(ta),n=ta.dot(na),e=ta.dot(ra),t=na.dot(na);var a=na.dot(ra),o=r*t-n*n;return void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Qr),0==o?i.set(-2,-1,-1):i.set(1-(t=(t*e-n*a)*(i=1/o))-(o=(r*a-n*e)*i),o,t)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,ia),0<=ia.x&&0<=ia.y&&ia.x+ia.y<=1}},{key:"getUV",value:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,ia),s.set(0,0),s.addScaledVector(i,ia.x),s.addScaledVector(a,ia.y),s.addScaledVector(o,ia.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return ta.subVectors(n,t),na.subVectors(e,t),ta.cross(na).dot(r)<0}}]),e}(),da=0;function pa(){b()(this,"id",{value:da++}),this.uuid=Ur.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=xe,this.side=pe,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ke,this.blendDst=De,this.blendEquation=Ee,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Ge,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Mr,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=cr,this.stencilZFail=cr,this.stencilZPass=cr,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}pa.prototype=g()(T()(zr.prototype),{constructor:pa,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n,r=e[t];void 0===r?console.warn("THREE.Material: '"+t+"' parameter is undefined."):"shading"===t?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===ve):void 0===(n=this[t])?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}},toJSON:function(e){var t=void 0===e||"string"==typeof e,n=(t&&(e={textures:{},images:{}}),{metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}});function r(e){var t,n=[];for(t in e){var r=e[t];delete r.metadata,n.push(r)}return n}return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),L()(this)&&L()(this).isTexture&&(n.map=L()(this).toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity)&&(n.envMapIntensity=this.envMapIntensity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==xe&&(n.blending=this.blending),this.side!==pe&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==A()(this.userData)&&(n.userData=this.userData),t&&(t=r(e.textures),e=r(e.images),0<t.length&&(n.textures=t),0<e.length)&&(n.images=e),n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t)for(var r=t.length,i=(n=new Array(r),0);i!==r;++i)n[i]=t[i].clone();return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(A()(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),b()(pa.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var fa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ma={h:0,s:0,l:0},va={h:0,s:0,l:0};function ga(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function ya(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function xa(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var wa=function(){function e(t,n,r){return f()(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return m()(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){return e=Ur.euclideanModulo(e,1),t=Ur.clamp(t,0,1),n=Ur.clamp(n,0,1),0===t?this.r=this.g=this.b=n:(this.r=ga(t=2*n-(n=n<=.5?n*(1+t):n+t-n*t),n,e+1/3),this.g=ga(t,n,e),this.b=ga(t,n,e-1/3)),this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&C()(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(l=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var n,r,i,a,o=l[1],s=l[2];switch(o){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,P()(n[1],10))/255,this.g=Math.min(255,P()(n[2],10))/255,this.b=Math.min(255,P()(n[3],10))/255,t(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,P()(n[1],10))/100,this.g=Math.min(100,P()(n[2],10))/100,this.b=Math.min(100,P()(n[3],10))/100,t(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r=C()(n[1])/360,i=P()(n[2],10)/100,a=P()(n[3],10)/100,t(n[4]),this.setHSL(r,i,a)}}else if(l=/^\#([A-Fa-f\d]+)$/.exec(e)){var l=(o=l[1]).length;if(3===l)return this.r=P()(o.charAt(0)+o.charAt(0),16)/255,this.g=P()(o.charAt(1)+o.charAt(1),16)/255,this.b=P()(o.charAt(2)+o.charAt(2),16)/255,this;if(6===l)return this.r=P()(o.charAt(0)+o.charAt(1),16)/255,this.g=P()(o.charAt(2)+o.charAt(3),16)/255,this.b=P()(o.charAt(4)+o.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=fa[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=0<(t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2)?1/t:1;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=ya(e.r),this.g=ya(e.g),this.b=ya(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=xa(e.r),this.g=xa(e.g),this.b=xa(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){var e;return w()(e="000000"+this.getHex().toString(16)).call(e,-6)}},{key:"getHSL",value:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n=this.r,r=this.g,i=this.b,a=Math.max(n,r,i),o=Math.min(n,r,i),s=(o+a)/2;if(o===a)c=t=0;else{var l=a-o,c=s<=.5?l/(a+o):l/(2-a-o);switch(a){case n:t=(r-i)/l+(r<i?6:0);break;case r:t=(i-n)/l+2;break;case i:t=(n-r)/l+4}t/=6}return e.h=t,e.s=c,e.l=s,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(ma),ma.h+=e,ma.s+=t,ma.l+=n,this.setHSL(ma.h,ma.s,ma.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(ma),e.getHSL(va);e=Ur.lerp(ma.h,va.h,t);var n=Ur.lerp(ma.s,va.s,t);t=Ur.lerp(ma.l,va.l,t);return this.setHSL(e,n,t),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}(),ba=(wa.NAMES=fa,wa.prototype.isColor=!0,wa.prototype.r=1,wa.prototype.g=1,wa.prototype.b=1,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new wa(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=Ye,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=L()(e),this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}]),n}(pa)),_a=(ba.prototype.isMeshBasicMaterial=!0,new Qr),Ma=new Hr;function Ea(e,t,n){if(M()(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Er,this.updateRange={offset:0,count:-1},this.version=0}function Sa(e,t,n){Ea.call(this,new Int8Array(e),t,n)}function Ta(e,t,n){Ea.call(this,new Uint8Array(e),t,n)}function Aa(e,t,n){Ea.call(this,new Uint8ClampedArray(e),t,n)}function La(e,t,n){Ea.call(this,new Int16Array(e),t,n)}function Ca(e,t,n){Ea.call(this,new Uint16Array(e),t,n)}function Pa(e,t,n){Ea.call(this,new Int32Array(e),t,n)}function Ra(e,t,n){Ea.call(this,new Uint32Array(e),t,n)}function Ia(e,t,n){Ea.call(this,new Uint16Array(e),t,n)}function ka(e,t,n){Ea.call(this,new Float32Array(e),t,n)}function Da(e,t,n){Ea.call(this,new Float64Array(e),t,n)}function za(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}b()(Ea.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),g()(Ea.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new wa),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new Hr),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Qr),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Xr),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)Ma.fromBufferAttribute(this,t),Ma.applyMatrix3(e),this.setXY(t,Ma.x,Ma.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)_a.fromBufferAttribute(this,r),_a.applyMatrix3(e),this.setXYZ(r,_a.x,_a.y,_a.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)_a.x=this.getX(t),_a.y=this.getY(t),_a.z=this.getZ(t),_a.applyMatrix4(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)_a.x=this.getX(t),_a.y=this.getY(t),_a.z=this.getZ(t),_a.applyNormalMatrix(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)_a.x=this.getX(t),_a.y=this.getY(t),_a.z=this.getZ(t),_a.transformDirection(e),this.setXYZ(t,_a.x,_a.y,_a.z);return this},set:function(e){return this.array.set(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:w()(Array.prototype).call(this.array),normalized:this.normalized}}}),(Sa.prototype=T()(Ea.prototype)).constructor=Sa,(Ta.prototype=T()(Ea.prototype)).constructor=Ta,(Aa.prototype=T()(Ea.prototype)).constructor=Aa,(La.prototype=T()(Ea.prototype)).constructor=La,Ca.prototype=T()(Ea.prototype),Ca.prototype.constructor=Ca,(Pa.prototype=T()(Ea.prototype)).constructor=Pa,Ra.prototype=T()(Ea.prototype),Ra.prototype.constructor=Ra,((Ia.prototype=T()(Ea.prototype)).constructor=Ia).prototype.isFloat16BufferAttribute=!0,(ka.prototype=T()(Ea.prototype)).constructor=ka,(Da.prototype=T()(Ea.prototype)).constructor=Da;var Na={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Oa(e,t){return new Na[e](t)}var Ba=0,Fa=new Si,Ua=new Ji,Ha=new Qr,Va=new ei,Ga=new ei,Wa=new Qr;function ja(){b()(this,"id",{value:Ba++}),this.uuid=Ur.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}ja.prototype=g()(T()(zr.prototype),{constructor:ja,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return M()(e)?this.index=new(65535<za(e)?Ra:Ca)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t){this.groups.push({start:e,count:t,materialIndex:2<arguments.length&&void 0!==arguments[2]?arguments[2]:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t,n=(void 0!==(t=(void 0!==(t=this.attributes.position)&&(t.applyMatrix4(e),t.needsUpdate=!0),this.attributes.normal))&&(n=(new Vr).getNormalMatrix(e),t.applyNormalMatrix(n),t.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Fa.makeRotationX(e),this.applyMatrix4(Fa),this},rotateY:function(e){return Fa.makeRotationY(e),this.applyMatrix4(Fa),this},rotateZ:function(e){return Fa.makeRotationZ(e),this.applyMatrix4(Fa),this},translate:function(e,t,n){return Fa.makeTranslation(e,t,n),this.applyMatrix4(Fa),this},scale:function(e,t,n){return Fa.makeScale(e,t,n),this.applyMatrix4(Fa),this},lookAt:function(e){return Ua.lookAt(e),Ua.updateMatrix(),this.applyMatrix4(Ua.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ha).negate(),this.translate(Ha.x,Ha.y,Ha.z),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ka(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new ei);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Qr(-1/0,-1/0,-1/0),new Qr(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Va.setFromBufferAttribute(i),this.morphTargetsRelative?(Wa.addVectors(this.boundingBox.min,Va.min),this.boundingBox.expandByPoint(Wa),Wa.addVectors(this.boundingBox.max,Va.max),this.boundingBox.expandByPoint(Wa)):(this.boundingBox.expandByPoint(Va.min),this.boundingBox.expandByPoint(Va.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new vi);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Qr,1/0);else if(e){var n=this.boundingSphere.center;if(Va.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];Ga.setFromBufferAttribute(a),this.morphTargetsRelative?(Wa.addVectors(Va.min,Ga.min),Va.expandByPoint(Wa),Wa.addVectors(Va.max,Ga.max),Va.expandByPoint(Wa)):(Va.expandByPoint(Ga.min),Va.expandByPoint(Ga.max))}Va.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)Wa.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Wa));if(t)for(var c=0,u=t.length;c<u;c++)for(var h=t[c],d=this.morphTargetsRelative,p=0,f=h.count;p<f;p++)Wa.fromBufferAttribute(h,p),d&&(Ha.fromBufferAttribute(e,p),Wa.add(Ha)),o=Math.max(o,n.distanceToSquared(Wa));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{for(var n=e.array,r=t.position.array,i=t.normal.array,a=t.uv.array,o=r.length/3,s=(void 0===t.tangent&&this.setAttribute("tangent",new Ea(new Float32Array(4*o),4)),t.tangent.array),l=[],c=[],u=0;u<o;u++)l[u]=new Qr,c[u]=new Qr;for(var h,d,p,f,m=new Qr,v=new Qr,g=new Qr,y=new Hr,x=new Hr,w=new Hr,b=new Qr,_=new Qr,M=this.groups,E=0,S=(M=0===M.length?[{start:0,count:n.length}]:M).length;E<S;++E)for(var T=M[E],A=T.start,L=A,C=A+T.count;L<C;L+=3)h=n[L+0],d=n[L+1],p=n[L+2],void 0,m.fromArray(r,3*h),v.fromArray(r,3*d),g.fromArray(r,3*p),y.fromArray(a,2*h),x.fromArray(a,2*d),w.fromArray(a,2*p),v.sub(m),g.sub(m),x.sub(y),w.sub(y),f=1/(x.x*w.y-w.x*x.y),isFinite(f)&&(b.copy(v).multiplyScalar(w.y).addScaledVector(g,-x.y).multiplyScalar(f),_.copy(g).multiplyScalar(x.x).addScaledVector(v,-w.x).multiplyScalar(f),l[h].add(b),l[d].add(b),l[p].add(b),c[h].add(_),c[d].add(_),c[p].add(_));for(var P=new Qr,R=new Qr,I=new Qr,k=new Qr,D=0,z=M.length;D<z;++D)for(var N=M[D],O=N.start,B=O,F=O+N.count;B<F;B+=3)U(n[B+0]),U(n[B+1]),U(n[B+2])}function U(e){I.fromArray(i,3*e),k.copy(I);var t=l[e];P.copy(t),P.sub(I.multiplyScalar(I.dot(t))).normalize(),R.crossVectors(k,t),t=R.dot(c[e])<0?-1:1,s[4*e]=P.x,s[4*e+1]=P.y,s[4*e+2]=P.z,s[4*e+3]=t}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Ea(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new Qr,o=new Qr,s=new Qr,l=new Qr,c=new Qr,u=new Qr,h=new Qr,d=new Qr;if(e)for(var p=0,f=e.count;p<f;p+=3){var m=e.getX(p+0),v=e.getX(p+1),g=e.getX(p+2);a.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,v),u.fromBufferAttribute(n,g),l.add(h),c.add(h),u.add(h),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z),n.setXYZ(g,u.x,u.y,u.z)}else for(var y=0,x=t.count;y<x;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n,r=this.attributes;for(n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,a=(o=e.attributes[n]).array,o=o.itemSize*t,s=Math.min(a.length,i.length-o),l=0,c=o;l<s;l++,c++)i[c]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Wa.fromBufferAttribute(e,t),Wa.normalize(),e.setXYZ(t,Wa.x,Wa.y,Wa.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=(e=e.normalized,new n.constructor(t.length*r)),a=0,o=0,s=0,l=t.length;s<l;s++){a=t[s]*r;for(var c=0;c<r;c++)i[o++]=n[a++]}return new Ea(i,r,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t,n=new ja,r=this.index.array,i=this.attributes;for(t in i){var a=e(i[t],r);n.setAttribute(t,a)}var o,s=this.morphAttributes;for(o in s){for(var l=[],c=s[o],u=0,h=c.length;u<h;u++){var d=e(c[u],r);l.push(d)}n.morphAttributes[o]=l}n.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,f=0,m=p.length;f<m;f++){var v=p[f];n.addGroup(v.start,v.count,v.materialIndex)}return n},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<R()(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t,n=this.parameters;for(t in n)void 0!==n[t]&&(e[t]=n[t])}else{e.data={attributes:{}};var r,i=this.index,a=(null!==i&&(e.data.index={type:i.array.constructor.name,array:w()(Array.prototype).call(i.array)}),this.attributes);for(r in a){var o=a[r],s=o.toJSON(e.data);""!==o.name&&(s.name=o.name),e.data.attributes[r]=s}var l,c={},u=!1;for(l in this.morphAttributes){for(var h=this.morphAttributes[l],d=[],p=0,f=h.length;p<f;p++){var m=h[p],v=m.toJSON(e.data);""!==m.name&&(v.name=m.name),d.push(v)}0<d.length&&(c[l]=d,u=!0)}u&&(e.data.morphAttributes=c,e.data.morphTargetsRelative=this.morphTargetsRelative),0<(i=this.groups).length&&(e.data.groups=JSON.parse(A()(i))),null!==(i=this.boundingSphere)&&(e.data.boundingSphere={center:i.center.toArray(),radius:i.radius})}return e},clone:function(){return(new ja).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t,n={},r=(this.name=e.name,e.index),i=(null!==r&&this.setIndex(r.clone(n)),e.attributes);for(t in i){var a=i[t];this.setAttribute(t,a.clone(n))}var o,s=e.morphAttributes;for(o in s){for(var l=[],c=s[o],u=0,h=c.length;u<h;u++)l.push(c[u].clone(n));this.morphAttributes[o]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,p=0,f=d.length;p<f;p++){var m=d[p];this.addGroup(m.start,m.count,m.materialIndex)}return null!==(r=e.boundingBox)&&(this.boundingBox=r.clone()),null!==(r=e.boundingSphere)&&(this.boundingSphere=r.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var qa=new Si,Xa=new Ei,Ya=new vi,Za=new Qr,Ja=new Qr,Qa=new Qr,Ka=new Qr,$a=new Qr,eo=new Qr,to=new Qr,no=new Qr,ro=new Qr,io=new Hr,ao=new Hr,oo=new Hr,so=new Qr,lo=new Qr;function co(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ja,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new ba;Ji.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function uo(e,t,n,r,i,a,o,s,l,c,u,h){Za.fromBufferAttribute(i,c),Ja.fromBufferAttribute(i,u),Qa.fromBufferAttribute(i,h);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){to.set(0,0,0),no.set(0,0,0),ro.set(0,0,0);for(var p=0,f=a.length;p<f;p++){var m=d[p],v=a[p];0!==m&&(Ka.fromBufferAttribute(v,c),$a.fromBufferAttribute(v,u),eo.fromBufferAttribute(v,h),o?(to.addScaledVector(Ka,m),no.addScaledVector($a,m),ro.addScaledVector(eo,m)):(to.addScaledVector(Ka.sub(Za),m),no.addScaledVector($a.sub(Ja),m),ro.addScaledVector(eo.sub(Qa),m)))}Za.add(to),Ja.add(no),Qa.add(ro)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(c,Za),e.boneTransform(u,Ja),e.boneTransform(h,Qa)),i=e,e=n,n=r,r=Za,x=Ja,y=Qa,g=so;var g,y,x=null===(n=(t=t).side===fe?n.intersectTriangle(y,x,r,!0,g):n.intersectTriangle(r,x,y,t.side!==me,g))||(lo.copy(g),lo.applyMatrix4(i.matrixWorld),(r=e.ray.origin.distanceTo(lo))<e.near)||r>e.far?null:{distance:r,point:lo.clone(),object:i};return x&&(s&&(io.fromBufferAttribute(s,c),ao.fromBufferAttribute(s,u),oo.fromBufferAttribute(s,h),x.uv=ha.getUV(so,Za,Ja,Qa,io,ao,oo,new Hr)),l&&(io.fromBufferAttribute(l,c),ao.fromBufferAttribute(l,u),oo.fromBufferAttribute(l,h),x.uv2=ha.getUV(so,Za,Ja,Qa,io,ao,oo,new Hr)),y={a:c,b:u,c:h,normal:new Qr,materialIndex:0},ha.getNormal(Za,Ja,Qa,y.normal),x.face=y),x}co.prototype=g()(T()(Ji.prototype),{constructor:co,isMesh:!0,copy:function(e){var t;return Ji.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=w()(t=e.morphTargetInfluences).call(t)),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=g()({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=R()(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),Ya.copy(n.boundingSphere),Ya.applyMatrix4(i),!1!==e.ray.intersectsSphere(Ya)&&(qa.copy(i).invert(),Xa.copy(e.ray).applyMatrix4(qa),null===n.boundingBox||!1!==Xa.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var a=n.index,o=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==a)if(M()(r))for(var p=0,f=h.length;p<f;p++)for(var m=h[p],v=r[m.materialIndex],g=Math.max(m.start,d.start),y=Math.min(m.start+m.count,d.start+d.count);g<y;g+=3){var x,w=a.getX(g),b=a.getX(g+1),_=a.getX(g+2);(x=uo(this,v,e,Xa,o,s,l,c,u,w,b,_))&&(x.faceIndex=Math.floor(g/3),x.face.materialIndex=m.materialIndex,t.push(x))}else for(var E=Math.max(0,d.start),S=Math.min(a.count,d.start+d.count);E<S;E+=3){var T=a.getX(E),A=a.getX(E+1),L=a.getX(E+2);(x=uo(this,r,e,Xa,o,s,l,c,u,T,A,L))&&(x.faceIndex=Math.floor(E/3),t.push(x))}else if(void 0!==o)if(M()(r))for(var C=0,P=h.length;C<P;C++)for(var R=h[C],I=r[R.materialIndex],k=Math.max(R.start,d.start),D=Math.min(R.start+R.count,d.start+d.count);k<D;k+=3)(x=uo(this,I,e,Xa,o,s,l,c,u,k,k+1,k+2))&&(x.faceIndex=Math.floor(k/3),x.face.materialIndex=R.materialIndex,t.push(x));else for(var z=Math.max(0,d.start),N=Math.min(o.count,d.start+d.count);z<N;z+=3)(x=uo(this,r,e,Xa,o,s,l,c,u,z,z+1,z+2))&&(x.faceIndex=Math.floor(z/3),t.push(x))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var ho=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,c=(f()(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:i,depth:a,widthSegments:o,heightSegments:s,depthSegments:l},u()(e)),h=(o=Math.floor(o),s=Math.floor(s),l=Math.floor(l),[]),d=[],p=[],m=[],v=0,g=0;function y(e,t,n,r,i,a,o,s,l,u,f){for(var y=a/l,x=o/u,w=a/2,b=o/2,_=s/2,M=l+1,E=u+1,S=0,T=0,A=new Qr,L=0;L<E;L++)for(var C=L*x-b,P=0;P<M;P++)A[e]=(P*y-w)*r,A[t]=C*i,A[n]=_,d.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=0<s?1:-1,p.push(A.x,A.y,A.z),m.push(P/l),m.push(1-L/u),S+=1;for(var R=0;R<u;R++)for(var I=0;I<l;I++){var k=v+I+M*R,D=v+I+M*(R+1),z=v+(I+1)+M*(R+1),N=v+(I+1)+M*R;h.push(k,D,N),h.push(D,z,N),T+=6}c.addGroup(g,T,f),g+=T,v+=S}return y("z","y","x",-1,-1,a,i,r,l,s,0),y("z","y","x",1,-1,a,i,-r,l,s,1),y("x","z","y",1,1,r,a,i,o,l,2),y("x","z","y",1,-1,r,a,-i,o,l,3),y("x","y","z",1,-1,r,i,a,o,s,4),y("x","y","z",-1,-1,r,i,-a,o,s,5),e.setIndex(h),e.setAttribute("position",new ka(d,3)),e.setAttribute("normal",new ka(p,3)),e.setAttribute("uv",new ka(m,2)),e}return m()(n)}(ja);function po(e){var t,n={};for(t in e)for(var r in n[t]={},e[t]){var i=e[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?n[t][r]=i.clone():M()(i)?n[t][r]=w()(i).call(i):n[t][r]=i}return n}function fo(e){for(var t={},n=0;n<e.length;n++){var r,i=po(e[n]);for(r in i)t[r]=i[r]}return t}var mo={clone:po,merge:fo};function vo(e){pa.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function go(){Ji.call(this),this.type="Camera",this.matrixWorldInverse=new Si,this.projectionMatrix=new Si,this.projectionMatrixInverse=new Si}function yo(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:50,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2e3;go.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}((vo.prototype=T()(pa.prototype)).constructor=vo).prototype.isShaderMaterial=!0,vo.prototype.copy=function(e){return pa.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=po(e.uniforms),this.defines=g()({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=g()({},e.extensions),this.glslVersion=e.glslVersion,this},vo.prototype.toJSON=function(e){var t,n=pa.prototype.toJSON.call(this,e);for(t in n.glslVersion=this.glslVersion,n.uniforms={},this.uniforms){var r=this.uniforms[t].value;r&&r.isTexture?n.uniforms[t]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?n.uniforms[t]={type:"c",value:r.getHex()}:r&&r.isVector2?n.uniforms[t]={type:"v2",value:r.toArray()}:r&&r.isVector3?n.uniforms[t]={type:"v3",value:r.toArray()}:r&&r.isVector4?n.uniforms[t]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?n.uniforms[t]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?n.uniforms[t]={type:"m4",value:r.toArray()}:n.uniforms[t]={value:r}}0<R()(this.defines).length&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;var i,a={};for(i in this.extensions)!0===this.extensions[i]&&(a[i]=!0);return 0<R()(a).length&&(n.extensions=a),n},go.prototype=g()(T()(Ji.prototype),{constructor:go,isCamera:!0,copy:function(e,t){return Ji.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Qr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Ji.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){Ji.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),yo.prototype=g()(T()(go.prototype),{constructor:yo,isPerspectiveCamera:!0,copy:function(e,t){return go.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:g()({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*Ur.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ur.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ur.RAD2DEG*Math.atan(Math.tan(.5*Ur.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e,t=this.near,n=t*Math.tan(.5*Ur.DEG2RAD*this.fov)/this.zoom,r=2*n,i=this.aspect*r,a=-.5*i,o=this.view,s=(null!==this.view&&this.view.enabled&&(s=o.fullWidth,e=o.fullHeight,a+=o.offsetX*i/s,n-=o.offsetY*r/e,i*=o.width/s,r*=o.height/e),this.filmOffset);0!==s&&(a+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,n,n-r,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){return(e=Ji.prototype.toJSON.call(this,e)).object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=g()({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});var xo=function(e){h()(n,e);var t=te(n);function n(e,r,i){var a;return f()(this,n),(a=t.call(this)).type="CubeCamera",!0!==i.isWebGLCubeRenderTarget?(console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),d()(a)):(a.renderTarget=i,(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,-1,0),i.lookAt(new Qr(1,0,0)),a.add(i),(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,-1,0),i.lookAt(new Qr(-1,0,0)),a.add(i),(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,0,1),i.lookAt(new Qr(0,1,0)),a.add(i),(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,0,-1),i.lookAt(new Qr(0,-1,0)),a.add(i),(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,-1,0),i.lookAt(new Qr(0,0,1)),a.add(i),(i=new yo(90,1,e,r)).layers=a.layers,i.up.set(0,-1,0),i.lookAt(new Qr(0,0,-1)),a.add(i),a)}return m()(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=(c=l()(this.children,6))[0],i=c[1],a=c[2],o=c[3],s=c[4],c=c[5],u=e.xr.enabled,h=e.getRenderTarget(),d=(e.xr.enabled=!1,n.texture.generateMipmaps);n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(h),e.xr.enabled=u}}]),n}(Ji),wo=function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,u,h){return f()(this,n),(e=t.call(this,e=void 0!==e?e:[],r=void 0!==r?r:it,i,a,o,s,l=void 0!==l?l:Nt,c,u,h))._needsFlipEnvMap=!0,e.flipY=!1,e}return m()(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(jr),bo=(wo.prototype.isCubeTexture=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i){return f()(this,n),I()(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),(i=t.call(this,e,e,r)).texture=new wo(void 0,(r=r||{}).mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:yt,i.texture._needsFlipEnvMap=!1,i}return m()(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=Ot,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new ho(5,5,5);(n=new vo({name:"CubemapFromEquirect",uniforms:po(n),vertexShader:r,fragmentShader:i,side:fe,blending:ye})).uniforms.tEquirect.value=t,r=new co(a,n),i=t.minFilter;return t.minFilter===bt&&(t.minFilter=yt),new xo(1,10,this).update(e,r),t.minFilter=i,r.geometry.dispose(),r.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}]),n}(Yr)),_o=(bo.prototype.isWebGLCubeRenderTarget=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,u,h,d,p){return f()(this,n),(s=t.call(this,null,s,l,c,u,h,a,o,d,p)).image={data:e||null,width:r||1,height:i||1},s.magFilter=void 0!==u?u:pt,s.minFilter=void 0!==h?h:pt,s.generateMipmaps=!1,s.flipY=!1,s.unpackAlignment=1,s.needsUpdate=!0,s}return m()(n)}(jr)),Mo=(_o.prototype.isDataTexture=!0,new vi),Eo=new Qr,So=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ea,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new ea,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new ea,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new ea,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:new ea,o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:new ea;f()(this,e),this.planes=[t,n,r,i,a,o]}return m()(e,[{key:"set",value:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=(e=e.elements)[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],v=e[14];e=e[15];return t[0].setComponents(a-n,c-o,p-u,e-f).normalize(),t[1].setComponents(a+n,c+o,p+u,e+f).normalize(),t[2].setComponents(a+r,c+s,p+h,e+m).normalize(),t[3].setComponents(a-r,c-s,p-h,e-m).normalize(),t[4].setComponents(a-i,c-l,p-d,e-v).normalize(),t[5].setComponents(a+i,c+l,p+d,e+v).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Mo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mo)}},{key:"intersectsSprite",value:function(e){return Mo.center.set(0,0,0),Mo.radius=.7071067811865476,Mo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mo)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Eo.x=(0<r.normal.x?e.max:e.min).x,Eo.y=(0<r.normal.y?e.max:e.min).y,Eo.z=(0<r.normal.z?e.max:e.min).z,r.distanceToPoint(Eo)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function To(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Ao(e,t){var n=t.isWebGL2,r=new k.a;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){var a,o,s,l,c,u;t.isGLBufferAttribute?(!(a=r.get(t))||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}):(t.isInterleavedBufferAttribute&&(t=t.data),void 0===(a=r.get(t))?r.set(t,(s=i,l=(o=t).array,c=o.usage,u=e.createBuffer(),e.bindBuffer(s,u),e.bufferData(s,l,c),o.onUploadCallback(),s=5126,l instanceof Float32Array?s=5126:l instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):l instanceof Uint16Array?o.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:l instanceof Int16Array?s=5122:l instanceof Uint32Array?s=5125:l instanceof Int32Array?s=5124:l instanceof Int8Array?s=5120:l instanceof Uint8Array&&(s=5121),{buffer:u,type:s,bytesPerElement:l.BYTES_PER_ELEMENT,version:o.version})):a.version<t.version&&(c=a.buffer,u=i,l=(s=t).array,s=s.updateRange,e.bindBuffer(u,c),-1===s.count?e.bufferSubData(u,0,l):(n?e.bufferSubData(u,s.offset*l.BYTES_PER_ELEMENT,l,s.offset,s.count):e.bufferSubData(u,s.offset*l.BYTES_PER_ELEMENT,l.subarray(s.offset,s.offset+s.count)),s.count=-1),a.version=t.version))}}}var Lo=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=(f()(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:i,widthSegments:a,heightSegments:o},r/2),l=i/2,c=Math.floor(a),u=Math.floor(o),h=c+1,d=u+1,p=r/c,m=i/u,v=[],g=[],y=[],x=[],w=0;w<d;w++)for(var b=w*m-l,_=0;_<h;_++)g.push(_*p-s,-b,0),y.push(0,0,1),x.push(_/c),x.push(1-w/u);for(var M=0;M<u;M++)for(var E=0;E<c;E++){var S=E+h*(M+1),T=E+1+h*(M+1),A=E+1+h*M;v.push(E+h*M,S,A),v.push(S,T,A)}return e.setIndex(v),e.setAttribute("position",new ka(g,3)),e.setAttribute("normal",new ka(y,3)),e.setAttribute("uv",new ka(x,2)),e}return m()(n)}(ja),Co={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Po={common:{diffuse:{value:new wa(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Vr},uv2Transform:{value:new Vr},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Hr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wa(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wa(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Vr}},sprite:{diffuse:{value:new wa(15658734)},opacity:{value:1},center:{value:new Hr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Vr}}},Ro={basic:{uniforms:fo([Po.common,Po.specularmap,Po.envmap,Po.aomap,Po.lightmap,Po.fog]),vertexShader:Co.meshbasic_vert,fragmentShader:Co.meshbasic_frag},lambert:{uniforms:fo([Po.common,Po.specularmap,Po.envmap,Po.aomap,Po.lightmap,Po.emissivemap,Po.fog,Po.lights,{emissive:{value:new wa(0)}}]),vertexShader:Co.meshlambert_vert,fragmentShader:Co.meshlambert_frag},phong:{uniforms:fo([Po.common,Po.specularmap,Po.envmap,Po.aomap,Po.lightmap,Po.emissivemap,Po.bumpmap,Po.normalmap,Po.displacementmap,Po.fog,Po.lights,{emissive:{value:new wa(0)},specular:{value:new wa(1118481)},shininess:{value:30}}]),vertexShader:Co.meshphong_vert,fragmentShader:Co.meshphong_frag},standard:{uniforms:fo([Po.common,Po.envmap,Po.aomap,Po.lightmap,Po.emissivemap,Po.bumpmap,Po.normalmap,Po.displacementmap,Po.roughnessmap,Po.metalnessmap,Po.fog,Po.lights,{emissive:{value:new wa(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Co.meshphysical_vert,fragmentShader:Co.meshphysical_frag},toon:{uniforms:fo([Po.common,Po.aomap,Po.lightmap,Po.emissivemap,Po.bumpmap,Po.normalmap,Po.displacementmap,Po.gradientmap,Po.fog,Po.lights,{emissive:{value:new wa(0)}}]),vertexShader:Co.meshtoon_vert,fragmentShader:Co.meshtoon_frag},matcap:{uniforms:fo([Po.common,Po.bumpmap,Po.normalmap,Po.displacementmap,Po.fog,{matcap:{value:null}}]),vertexShader:Co.meshmatcap_vert,fragmentShader:Co.meshmatcap_frag},points:{uniforms:fo([Po.points,Po.fog]),vertexShader:Co.points_vert,fragmentShader:Co.points_frag},dashed:{uniforms:fo([Po.common,Po.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Co.linedashed_vert,fragmentShader:Co.linedashed_frag},depth:{uniforms:fo([Po.common,Po.displacementmap]),vertexShader:Co.depth_vert,fragmentShader:Co.depth_frag},normal:{uniforms:fo([Po.common,Po.bumpmap,Po.normalmap,Po.displacementmap,{opacity:{value:1}}]),vertexShader:Co.normal_vert,fragmentShader:Co.normal_frag},sprite:{uniforms:fo([Po.sprite,Po.fog]),vertexShader:Co.sprite_vert,fragmentShader:Co.sprite_frag},background:{uniforms:{uvTransform:{value:new Vr},t2D:{value:null}},vertexShader:Co.background_vert,fragmentShader:Co.background_frag},cube:{uniforms:fo([Po.envmap,{opacity:{value:1}}]),vertexShader:Co.cube_vert,fragmentShader:Co.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Co.equirect_vert,fragmentShader:Co.equirect_frag},distanceRGBA:{uniforms:fo([Po.common,Po.displacementmap,{referencePosition:{value:new Qr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Co.distanceRGBA_vert,fragmentShader:Co.distanceRGBA_frag},shadow:{uniforms:fo([Po.lights,Po.fog,{color:{value:new wa(0)},opacity:{value:1}}]),vertexShader:Co.shadow_vert,fragmentShader:Co.shadow_frag}};function Io(e,t,n,r,i){var a,o,s=new wa(0),l=0,c=null,u=0,h=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;s.set(e),d(s,l=t)},getClearAlpha:function(){return l},setClearAlpha:function(e){d(s,l=e)},render:function(n,i,p,f){(i=!0===i.isScene?i.background:null)&&i.isTexture&&(i=t.get(i));var m=(m=e.xr).getSession&&m.getSession();null===(i=m&&"additive"===m.environmentBlendMode?null:i)?d(s,l):i&&i.isColor&&(d(i,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),i&&(i.isCubeTexture||i.isWebGLCubeRenderTarget||i.mapping===lt)?(void 0===o&&((o=new co(new ho(1,1,1),new vo({name:"BackgroundCubeMaterial",uniforms:po(Ro.cube.uniforms),vertexShader:Ro.cube.vertexShader,fragmentShader:Ro.cube.fragmentShader,side:fe,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},b()(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),i.isWebGLCubeRenderTarget&&(i=i.texture),o.material.uniforms.envMap.value=i,o.material.uniforms.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,c===i&&u===i.version&&h===e.toneMapping||(o.material.needsUpdate=!0,u=(c=i).version,h=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):i&&i.isTexture&&(void 0===a&&((a=new co(new Lo(2,2),new vo({name:"BackgroundMaterial",uniforms:po(Ro.background.uniforms),vertexShader:Ro.background.vertexShader,fragmentShader:Ro.background.fragmentShader,side:pe,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),b()(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),!0===(a.material.uniforms.t2D.value=i).matrixAutoUpdate&&i.updateMatrix(),a.material.uniforms.uvTransform.value.copy(i.matrix),c===i&&u===i.version&&h===e.toneMapping||(a.material.needsUpdate=!0,u=(c=i).version,h=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function ko(e,t,n,r){var i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=d(null),c=l;function u(t){if(r.isWebGL2)return e.bindVertexArray(t);a.bindVertexArrayOES(t)}function h(t){if(r.isWebGL2)return e.deleteVertexArray(t);a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)r[a]=n[a]=t[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=c.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,i){var a=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function v(){for(var t=c.newAttributes,n=c.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function y(){x(),c!==l&&u((c=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,y,x){var w=!1;if(o){var b=function(t,n,i){i=!0===i.wireframe;var o=s[t.id];return void 0===o&&(o={},s[t.id]=o),void 0===(t=o[n.id])&&(t={},o[n.id]=t),void 0===(o=t[i])&&(o=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),t[i]=o),o}(y,h,l);if(c!==b&&u((c=b).object),w=function(e,t){var n,r=c.attributes,i=e.attributes,a=0;for(n in i){var o=r[n],s=i[n];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;a++}return c.attributesNum!==a||c.index!==t}(y,x)){b=x;var _,M={},E=y.attributes,S=0;for(_ in E){var T=E[_],A={};(A.attribute=T).data&&(A.data=T.data),M[_]=A,S++}c.attributes=M,c.attributesNum=S,c.index=b}}else b=!0===l.wireframe,c.geometry===y.id&&c.program===h.id&&c.wireframe===b||(c.geometry=y.id,c.program=h.id,c.wireframe=b,w=!0);!0===i.isInstancedMesh&&(w=!0),null!==x&&n.update(x,34963),w&&(function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){p();var l,c=s.attributes,u=o.getAttributes(),h=a.defaultAttributeValues;for(l in u){var d=u[l];if(0<=d){var y=c[l];if(void 0!==y){var x,w=y.normalized,b=y.itemSize;void 0!==(T=n.get(y))&&(S=T.buffer,x=T.type,T=T.bytesPerElement,y.isInterleavedBufferAttribute?(_=(E=y.data).stride,M=y.offset,E&&E.isInstancedInterleavedBuffer?(m(d,E.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=E.meshPerAttribute*E.count)):f(d),e.bindBuffer(34962,S),g(d,b,x,w,_*T,M*T)):(y.isInstancedBufferAttribute?(m(d,y.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=y.meshPerAttribute*y.count)):f(d),e.bindBuffer(34962,S),g(d,b,x,w,0,0)))}else if("instanceMatrix"===l){var _,M,E=n.get(i.instanceMatrix);void 0!==E&&(_=E.buffer,M=E.type,m(d+0,1),m(d+1,1),m(d+2,1),m(d+3,1),e.bindBuffer(34962,_),e.vertexAttribPointer(d+0,4,M,!1,64,0),e.vertexAttribPointer(d+1,4,M,!1,64,16),e.vertexAttribPointer(d+2,4,M,!1,64,32),e.vertexAttribPointer(d+3,4,M,!1,64,48))}else if("instanceColor"===l){var S,T;void 0!==(T=n.get(i.instanceColor))&&(y=T.buffer,S=T.type,m(d,1),e.bindBuffer(34962,y),e.vertexAttribPointer(d,3,S,!1,12,0))}else if(void 0!==h){var A=h[l];if(void 0!==A)switch(A.length){case 2:e.vertexAttrib2fv(d,A);break;case 3:e.vertexAttrib3fv(d,A);break;case 4:e.vertexAttrib4fv(d,A);break;default:e.vertexAttrib1fv(d,A)}}}}v()}}(i,l,h,y),null!==x)&&e.bindBuffer(34963,n.get(x).buffer)},reset:y,resetDefaultState:x,dispose:function(){for(var e in y(),s){var t,n=s[e];for(t in n){var r,i=n[t];for(r in i)h(i[r].object),delete i[r];delete n[t]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t,n=s[e.id];for(t in n){var r,i=n[t];for(r in i)h(i[r].object),delete i[r];delete n[t]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s)if(void 0!==(t=s[t])[e.id]){var n,r=t[e.id];for(n in r)h(r[n].object),delete r[n];delete t[e.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:v}}function Do(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,c;if(a)l=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,r,o,s),n.update(o,i,s)}}}function zo(e,t,n){var r;function i(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=((s=i(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s),!0===n.logarithmicDepthBuffer),l=(n=e.getParameter(34930),e.getParameter(35660)),c=e.getParameter(3379),u=e.getParameter(34076),h=e.getParameter(34921),d=e.getParameter(36347),p=e.getParameter(36348),f=e.getParameter(36349),m=0<l,v=a||t.has("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){var n;return r=void 0===r?!0===t.has("EXT_texture_filter_anisotropic")?(n=t.get("EXT_texture_filter_anisotropic"),e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)):0:r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:s,maxTextures:n,maxVertexTextures:l,maxTextureSize:c,maxCubemapSize:u,maxAttributes:h,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:v,floatVertexTextures:m&&v,maxSamples:a?e.getParameter(36183):0}}function No(e){var t=this,n=null,r=0,i=!1,a=!1,o=new ea,s=new Vr,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=0<r),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){var a=null!==e?e.length:0,c=null;if(0!==a){if(c=l.value,!0!==i||null===c){i=r+4*a;var u=n.matrixWorldInverse;s.getNormalMatrix(u),(null===c||c.length<i)&&(c=new Float32Array(i));for(var h=0,d=r;h!==a;++h,d+=4)o.copy(e[h]).applyMatrix4(u,s),o.normal.toArray(c,d),c[d+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=u(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,c()},this.setState=function(t,o,s){var h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows;t=e.get(t);if(!i||null===h||0===h.length||a&&!p)a?u(null):c();else{var f=4*(p=a?0:r),m=t.clippingState||null;l.value=m;m=u(h,o,f,s);for(var v=0;v!==f;++v)m[v]=n[v];t.clippingState=m,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=p}}}function Oo(e){var t=new k.a;function n(e,t){return t===ot?e.mapping=it:t===st&&(e.mapping=at),e}function r(e){var n=((e=e.target).removeEventListener("dispose",r),t.get(e));void 0!==n&&(t.delete(e),n.dispose())}return{get:function(i){if(i&&i.isTexture){var a,o=i.mapping;if(o===ot||o===st)return t.has(i)?n(t.get(i).texture,i.mapping):(o=i.image)&&0<o.height?(a=e.getRenderTarget(),(o=new bo(o.height/2)).fromEquirectangularTexture(e,i),t.set(i,o),e.setRenderTarget(a),i.addEventListener("dispose",r),n(o.texture,i.mapping)):null}return i},dispose:function(){t=new k.a}}}function Bo(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Fo(e,t,n,r){var i={},a=new k.a;function o(e){var s,l=e.target;for(s in null!==l.index&&t.remove(l.index),l.attributes)t.remove(l.attributes[s]);l.removeEventListener("dispose",o),delete i[l.id],(e=a.get(l))&&(t.remove(e),a.delete(l)),r.releaseStatesOfGeometry(l),!0===l.isInstancedBufferGeometry&&delete l._maxInstanceCount,n.memory.geometries--}return{get:function(e,t){return!0!==i[t.id]&&(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n,r=e.attributes;for(n in r)t.update(r[n],34962);var i,a=e.morphAttributes;for(i in a)for(var o=a[i],s=0,l=o.length;s<l;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var n,r=a.get(e);return(!r||null!==(n=e.index)&&r.version<n.version)&&function(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r)for(var s=r.array,l=(o=r.version,0),c=s.length;l<c;l+=3){var u=s[l+0],h=s[l+1],d=s[l+2];n.push(u,h,h,d,d,u)}else{r=i.array,o=i.version;for(var p=0,f=r.length/3-1;p<f;p+=3){var m=p+0,v=p+1,g=p+2;n.push(m,v,v,g,g,m)}}(i=new(65535<za(n)?Ra:Ca)(n,1)).version=o,(r=a.get(e))&&t.remove(r),a.set(e,i)}(e),a.get(e)}}}function Uo(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,l,c){if(0!==c){var u,h;if(s)u=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](i,l,a,r*o,c),n.update(l,i,c)}}}function Ho(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Vo(e,t){return e[0]-t[0]}function Go(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Wo(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,a,o,s){var l=i.morphTargetInfluences,c=void 0===l?0:l.length;if(void 0===(u=t[a.id])){for(var u=[],h=0;h<c;h++)u[h]=[h,0];t[a.id]=u}for(var d=0;d<c;d++){var p=u[d];p[0]=d,p[1]=l[d]}D()(u).call(u,Go);for(var f=0;f<8;f++)f<c&&u[f][1]?(r[f][0]=u[f][0],r[f][1]=u[f][1]):(r[f][0]=z.a,r[f][1]=0);D()(r).call(r,Vo);for(var m=o.morphTargets&&a.morphAttributes.position,v=o.morphNormals&&a.morphAttributes.normal,g=0,y=0;y<8;y++){var x=(w=r[y])[0],w=w[1];x!==z.a&&w?(m&&a.getAttribute("morphTarget"+y)!==m[x]&&a.setAttribute("morphTarget"+y,m[x]),v&&a.getAttribute("morphNormal"+y)!==v[x]&&a.setAttribute("morphNormal"+y,v[x]),g+=n[y]=w):(m&&!0===a.hasAttribute("morphTarget"+y)&&a.deleteAttribute("morphTarget"+y),v&&!0===a.hasAttribute("morphNormal"+y)&&a.deleteAttribute("morphNormal"+y),n[y]=0)}i=a.morphTargetsRelative?1:1-g,s.getUniforms().setValue(e,"morphTargetBaseInfluence",i),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function jo(e,t,n,r){var i=new k.a;function a(e){(e=e.target).removeEventListener("dispose",a),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry;s=t.get(e,s);return i.get(s)!==o&&(t.update(s),i.set(s,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),n.update(e.instanceMatrix,34962),null!==e.instanceColor)&&n.update(e.instanceColor,34962),s},dispose:function(){i=new k.a}}}Ro.physical={uniforms:fo([Ro.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Hr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new wa(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Co.meshphysical_vert,fragmentShader:Co.meshphysical_frag};var qo=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;return f()(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=pt,e.minFilter=pt,e.wrapR=ht,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return m()(n)}(jr),Xo=(qo.prototype.isDataTexture2DArray=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;return f()(this,n),(e=t.call(this,null)).image={data:r,width:i,height:a,depth:o},e.magFilter=pt,e.minFilter=pt,e.wrapR=ht,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return m()(n)}(jr)),Yo=(Xo.prototype.isDataTexture3D=!0,new jr),Zo=new qo,Jo=new Xo,Qo=new wo,Ko=[],$o=[],es=new Float32Array(16),ts=new Float32Array(9),ns=new Float32Array(4);function rs(e,t,n){var r=e[0];if(r<=0||0<r)return e;var i=t*n,a=Ko[i];if(void 0===a&&(a=new Float32Array(i),Ko[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)e[o].toArray(a,s+=n)}return a}function is(e,t){if(e.length===t.length){for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return;return 1}}function as(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function os(e,t){var n=$o[t];void 0===n&&(n=new Int32Array(t),$o[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ss(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ls(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y):is(n,t)||(e.uniform2fv(this.addr,t),as(n,t))}function cs(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z):void 0!==t.r?n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b):is(n,t)||(e.uniform3fv(this.addr,t),as(n,t))}function us(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w):is(n,t)||(e.uniform4fv(this.addr,t),as(n,t))}function hs(e,t){var n=this.cache,r=t.elements;void 0===r?is(n,t)||(e.uniformMatrix2fv(this.addr,!1,t),as(n,t)):is(n,r)||(ns.set(r),e.uniformMatrix2fv(this.addr,!1,ns),as(n,r))}function ds(e,t){var n=this.cache,r=t.elements;void 0===r?is(n,t)||(e.uniformMatrix3fv(this.addr,!1,t),as(n,t)):is(n,r)||(ts.set(r),e.uniformMatrix3fv(this.addr,!1,ts),as(n,r))}function ps(e,t){var n=this.cache,r=t.elements;void 0===r?is(n,t)||(e.uniformMatrix4fv(this.addr,!1,t),as(n,t)):is(n,r)||(es.set(r),e.uniformMatrix4fv(this.addr,!1,es),as(n,r))}function fs(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Yo,i)}function ms(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Zo,i)}function vs(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Jo,i)}function gs(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Qo,i)}function ys(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function xs(e,t){var n=this.cache;is(n,t)||(e.uniform2iv(this.addr,t),as(n,t))}function ws(e,t){var n=this.cache;is(n,t)||(e.uniform3iv(this.addr,t),as(n,t))}function bs(e,t){var n=this.cache;is(n,t)||(e.uniform4iv(this.addr,t),as(n,t))}function _s(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Ms(e,t){e.uniform1fv(this.addr,t)}function Es(e,t){e.uniform1iv(this.addr,t)}function Ss(e,t){e.uniform2iv(this.addr,t)}function Ts(e,t){e.uniform3iv(this.addr,t)}function As(e,t){e.uniform4iv(this.addr,t)}function Ls(e,t){t=rs(t,this.size,2),e.uniform2fv(this.addr,t)}function Cs(e,t){t=rs(t,this.size,3),e.uniform3fv(this.addr,t)}function Ps(e,t){t=rs(t,this.size,4),e.uniform4fv(this.addr,t)}function Rs(e,t){t=rs(t,this.size,4),e.uniformMatrix2fv(this.addr,!1,t)}function Is(e,t){t=rs(t,this.size,9),e.uniformMatrix3fv(this.addr,!1,t)}function ks(e,t){t=rs(t,this.size,16),e.uniformMatrix4fv(this.addr,!1,t)}function Ds(e,t,n){var r=t.length,i=os(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||Yo,i[a])}function zs(e,t,n){var r=t.length,i=os(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||Qo,i[a])}function Ns(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ss;case 35664:return ls;case 35665:return cs;case 35666:return us;case 35674:return hs;case 35675:return ds;case 35676:return ps;case 5124:case 35670:return ys;case 35667:case 35671:return xs;case 35668:case 35672:return ws;case 35669:case 35673:return bs;case 5125:return _s;case 35678:case 36198:case 36298:case 36306:case 35682:return fs;case 35679:case 36299:case 36307:return vs;case 35680:case 36300:case 36308:case 36293:return gs;case 36289:case 36303:case 36311:case 36292:return ms}}(t.type)}function Os(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ms;case 35664:return Ls;case 35665:return Cs;case 35666:return Ps;case 35674:return Rs;case 35675:return Is;case 35676:return ks;case 5124:case 35670:return Es;case 35667:case 35671:return Ss;case 35668:case 35672:return Ts;case 35669:case 35673:return As;case 35678:case 36198:case 36298:case 36306:case 35682:return Ds;case 35680:case 36300:case 36308:case 36293:return zs}}(t.type)}function Bs(e){this.id=e,this.seq=[],this.map={}}Os.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),as(t,e)},Bs.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var Fs=/(\w+)(\])?(\[|\.)?/g;function Us(e,t){e.seq.push(t),L()(e)[t.id]=t}function Hs(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r),a=(p=d=h=u=s=a=void 0,i),o=e.getUniformLocation(t,i.name),s=this,l=a.name,c=l.length;for(Fs.lastIndex=0;;){var u=Fs.exec(l),h=Fs.lastIndex,d=u[1],p="]"===u[2];if(p&&(d|=0),void 0===(u=u[3])||"["===u&&h+2===c){Us(s,new(void 0===u?Ns:Os)(d,a,o));break}void 0===(p=L()(s)[d])&&Us(s,p=new Bs(d)),s=p}}}function Vs(e,t,n){return t=e.createShader(t),e.shaderSource(t,n),e.compileShader(t),t}Hs.prototype.setValue=function(e,t,n,r){void 0!==(t=L()(this)[t])&&t.setValue(e,n,r)},Hs.prototype.setOptional=function(e,t,n){void 0!==(t=t[n])&&this.setValue(e,n,t)},Hs.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},Hs.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var Gs=0;function Ws(e){switch(e){case Jn:return["Linear","( value )"];case Qn:return["sRGB","( value )"];case $n:return["RGBE","( value )"];case tr:return["RGBM","( value, 7.0 )"];case nr:return["RGBM","( value, 16.0 )"];case rr:return["RGBD","( value, 256.0 )"];case Kn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case er:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function js(e,t,n){var r=e.getShaderParameter(t,35713),i=N()(i=e.getShaderInfoLog(t)).call(i);return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function qs(e,t){return"vec4 "+e+"( vec4 value ) { return "+(t=Ws(t))[0]+"ToLinear"+t[1]+"; }"}function Xs(e){return""!==e}function Ys(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Zs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Js=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qs(e){return e.replace(Js,Ks)}function Ks(e,t){var n=Co[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Qs(n)}var $s=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,el=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function tl(e){return e.replace(el,rl).replace($s,nl)}function nl(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),rl(0,t,n,r)}function rl(e,t,n,r){for(var i="",a=P()(t);a<P()(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function il(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function al(e,t,n,r){var i,a,o,s,l,c=e.getContext(),u=n.defines,h=n.vertexShader,d=n.fragmentShader,p=(f="SHADOWMAP_TYPE_BASIC",(p=n).shadowMapType===ue?f="SHADOWMAP_TYPE_PCF":p.shadowMapType===he?f="SHADOWMAP_TYPE_PCF_SOFT":p.shadowMapType===de&&(f="SHADOWMAP_TYPE_VSM"),f),f=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case it:case at:t="ENVMAP_TYPE_CUBE";break;case lt:case ct:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),m=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case at:case ct:t="ENVMAP_MODE_REFRACTION"}return t}(n),v=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Ye:t="ENVMAP_BLENDING_MULTIPLY";break;case Ze:t="ENVMAP_BLENDING_MIX";break;case Je:t="ENVMAP_BLENDING_ADD"}return t}(n),g=0<e.gammaFactor?e.gammaFactor:1,y=n.isWebGL2?"":(y=[(y=n).extensionDerivatives||y.envMapCubeUV||y.bumpMap||y.tangentSpaceNormalMap||y.clearcoatNormalMap||y.flatShading||"physical"===y.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(y.extensionFragDepth||y.logarithmicDepthBuffer)&&y.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",y.extensionDrawBuffers&&y.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(y.extensionShaderTextureLOD||y.envMap)&&y.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""],O()(y).call(y,Xs).join("\n")),x=(u=function(e){var t,n=[];for(t in e){var r=e[t];!1!==r&&n.push("#define "+t+" "+r)}return n.join("\n")}(u),c.createProgram()),w=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(0<(a=O()(a=[u]).call(a,Xs).join("\n")).length&&(a+="\n"),0<(i=O()(i=[y,u]).call(i,Xs).join("\n")).length&&(i+="\n")):(a=O()(o=[il(n),"#define SHADER_NAME "+n.shaderName,u,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",L()(n)?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"]).call(o,Xs).join("\n"),i=O()(g=[y,il(n),"#define SHADER_NAME "+n.shaderName,u,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",L()(n)?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+m:"",n.envMap?"#define "+v:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Qe?"#define TONE_MAPPING":"",n.toneMapping!==Qe?Co.tonemapping_pars_fragment:"",n.toneMapping!==Qe?function(e,t){var n;switch(t){case Ke:n="Linear";break;case $e:n="Reinhard";break;case et:n="OptimizedCineon";break;case tt:n="ACESFilmic";break;case nt:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,n.toneMapping):"",n.dithering?"#define DITHERING":"",Co.encodings_pars_fragment,L()(n)?qs("mapTexelToLinear",n.mapEncoding):"",n.matcap?qs("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?qs("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?qs("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?qs("lightMapTexelToLinear",n.lightMapEncoding):"",(o="linearToOutputTexel",u=Ws(u=n.outputEncoding),"vec4 "+o+"( vec4 value ) { return LinearTo"+u[0]+u[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"]).call(g,Xs).join("\n")),h=Zs(Ys(Qs(h),n),n),d=Zs(Ys(Qs(d),n),n),h=tl(h),d=tl(d),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(w="#version 300 es\n",a=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+a,i=["#define varying in",n.glslVersion===Dr?"":"out highp vec4 pc_fragColor;",n.glslVersion===Dr?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i),f=w+a+h,m=w+i+d,v=Vs(c,35633,f),p=Vs(c,35632,m);return c.attachShader(x,v),c.attachShader(x,p),void 0!==n.index0AttributeName?c.bindAttribLocation(x,0,n.index0AttributeName):!0===n.morphTargets&&c.bindAttribLocation(x,0,"position"),c.linkProgram(x),e.debug.checkShaderErrors&&(u=N()(o=c.getProgramInfoLog(x)).call(o),h=N()(g=c.getShaderInfoLog(v)).call(g),d=N()(w=c.getShaderInfoLog(p)).call(w),!(m=f=!0)===c.getProgramParameter(x,35714)?(f=!1,e=js(c,v,"vertex"),g=js(c,p,"fragment"),console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(x,35715),"gl.getProgramInfoLog",u,e,g)):""!==u?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",u):""!==h&&""!==d||(m=!1),m)&&(this.diagnostics={runnable:f,programLog:u,vertexShader:{log:h,prefix:a},fragmentShader:{log:d,prefix:i}}),c.deleteShader(v),c.deleteShader(p),this.getUniforms=function(){return s=void 0===s?new Hs(c,x):s},this.getAttributes=function(){return l=void 0===l?function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(c,x):l},this.destroy=function(){r.releaseStatesOfProgram(this),c.deleteProgram(x),this.program=void 0},this.name=n.shaderName,this.id=Gs++,this.cacheKey=t,this.usedTimes=1,this.program=x,this.vertexShader=v,this.fragmentShader=p,this}function ol(e,t,n,r,i,a){var o=[],s=r.isWebGL2,l=r.logarithmicDepthBuffer,c=r.floatVertexTextures,u=r.maxVertexUniforms,h=r.vertexTextures,d=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function m(e){return e=e&&e.isTexture?e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e.texture.encoding):Jn}return{getParameters:function(i,o,f,v,g){var y,x,w,b=v.fog,_=(v=i.isMeshStandardMaterial?v.environment:null,v=t.get(i.envMap||v),p[i.type]),M=g.isSkinnedMesh?(M=(M=g).skeleton.bones,c?1024:(y=Math.floor((u-20)/4),(y=Math.min(y,M.length))<M.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+M.length+" bones. This GPU supports "+y+"."),0):y)):0,E=(null!==i.precision&&(d=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",d,"instead."),w=(_?(x=(y=Ro[_]).vertexShader,y):(x=i.vertexShader,i)).fragmentShader,e.getRenderTarget());return{isWebGL2:s,shaderID:_,shaderName:i.type,vertexShader:x,fragmentShader:w,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:d,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:h,outputEncoding:null!==E?m(E.texture):e.outputEncoding,map:!!L()(i),mapEncoding:m(L()(i)),matcap:!!i.matcap,matcapEncoding:m(i.matcap),envMap:!!v,envMapMode:v&&v.mapping,envMapEncoding:m(v),envMapCubeUV:!!v&&(v.mapping===lt||v.mapping===ct),lightMap:!!i.lightMap,lightMapEncoding:m(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:m(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:i.normalMapType===sr,tangentSpaceNormalMap:i.normalMapType===or,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(L()(i)||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(L()(i)||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!b,useFog:i.fog,fogExp2:b&&b.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:i.skinning&&0<M,maxBones:M,useVertexTexture:c,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<f.length,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:Qe,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===me,flipSided:i.side===fe,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<f.length;i++)n.push(t[f[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t=p[e.type];return t?(t=Ro[t],mo.clone(t.uniforms)):e.uniforms},acquireProgram:function(t,n){for(var r,a=0,s=o.length;a<s;a++){var l=o[a];if(l.cacheKey===n){++(r=l).usedTimes;break}}return void 0===r&&(r=new al(e,n,t,i),o.push(r)),r},releaseProgram:function(e){var t;0==--e.usedTimes&&(t=y()(o).call(o,e),o[t]=o[o.length-1],o.pop(),e.destroy())},programs:o}}function sl(){var e=new k.a;return{get:function(t){var n=e.get(t);return void 0===n&&e.set(t,n={}),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new k.a}}}function ll(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function cl(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ul(e){var t=[],n=0,r=[],i=[],a={id:-1};function o(r,i,o,s,l,c){var u=t[n],h=e.get(o);return void 0===u?(u={id:r.id,object:r,geometry:i,material:o,program:h.program||a,groupOrder:s,renderOrder:r.renderOrder,z:l,group:c},t[n]=u):(u.id=r.id,u.object=r,u.geometry=i,u.material=o,u.program=h.program||a,u.groupOrder=s,u.renderOrder=r.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:r,transparent:i,init:function(){n=0,i.length=r.length=0},push:function(e,t,n,a,s,l){e=o(e,t,n,a,s,l),(!0===n.transparent?i:r).push(e)},unshift:function(e,t,n,a,s,l){e=o(e,t,n,a,s,l),(!0===n.transparent?i:r).unshift(e)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){1<r.length&&D()(r).call(r,e||ll),1<i.length&&D()(i).call(i,t||cl)}}}function hl(e){var t=new k.a;return{get:function(n,r){var i;return!1===t.has(n)?(i=new ul(e),t.set(n,[i])):r>=t.get(n).length?(i=new ul(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new k.a}}}function dl(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Qr,color:new wa};break;case"SpotLight":n={position:new Qr,direction:new Qr,color:new wa,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Qr,color:new wa,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Qr,skyColor:new wa,groundColor:new wa};break;case"RectAreaLight":n={color:new wa,position:new Qr,halfWidth:new Qr,halfHeight:new Qr}}return e[t.id]=n}}}var pl=0;function fl(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function ml(e,t){for(var n,r=new dl,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hr};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Hr,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=0;o<9;o++)a.probe.push(new Qr);var s=new Qr,l=new Si,c=new Si;return{setup:function(n){for(var o=0,s=0,l=0,c=0;c<9;c++)a.probe[c].set(0,0,0);var u=0,h=0,d=0,p=0,f=0,m=0,v=0,g=0;D()(n).call(n,fl);for(var y=0,x=n.length;y<x;y++){var w,b,_,M,E=n[y],S=E.color,T=E.intensity,A=E.distance,C=E.shadow&&L()(E.shadow)?L()(E.shadow).texture:null;if(E.isAmbientLight)o+=S.r*T,s+=S.g*T,l+=S.b*T;else if(E.isLightProbe)for(var P=0;P<9;P++)a.probe[P].addScaledVector(E.sh.coefficients[P],T);else E.isDirectionalLight?((_=r.get(E)).color.copy(E.color).multiplyScalar(E.intensity),E.castShadow&&(w=E.shadow,(b=i.get(E)).shadowBias=w.bias,b.shadowNormalBias=w.normalBias,b.shadowRadius=w.radius,b.shadowMapSize=w.mapSize,a.directionalShadow[u]=b,a.directionalShadowMap[u]=C,a.directionalShadowMatrix[u]=E.shadow.matrix,m++),a.directional[u]=_,u++):E.isSpotLight?((w=r.get(E)).position.setFromMatrixPosition(E.matrixWorld),w.color.copy(S).multiplyScalar(T),w.distance=A,w.coneCos=Math.cos(E.angle),w.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),w.decay=E.decay,E.castShadow&&(b=E.shadow,(_=i.get(E)).shadowBias=b.bias,_.shadowNormalBias=b.normalBias,_.shadowRadius=b.radius,_.shadowMapSize=b.mapSize,a.spotShadow[d]=_,a.spotShadowMap[d]=C,a.spotShadowMatrix[d]=E.shadow.matrix,g++),a.spot[d]=w,d++):E.isRectAreaLight?((A=r.get(E)).color.copy(S).multiplyScalar(T),A.halfWidth.set(.5*E.width,0,0),A.halfHeight.set(0,.5*E.height,0),a.rectArea[p]=A,p++):E.isPointLight?((S=r.get(E)).color.copy(E.color).multiplyScalar(E.intensity),S.distance=E.distance,S.decay=E.decay,E.castShadow&&(A=E.shadow,(M=i.get(E)).shadowBias=A.bias,M.shadowNormalBias=A.normalBias,M.shadowRadius=A.radius,M.shadowMapSize=A.mapSize,M.shadowCameraNear=A.camera.near,M.shadowCameraFar=A.camera.far,a.pointShadow[h]=M,a.pointShadowMap[h]=C,a.pointShadowMatrix[h]=E.shadow.matrix,v++),a.point[h]=S,h++):E.isHemisphereLight&&((A=r.get(E)).skyColor.copy(E.color).multiplyScalar(T),A.groundColor.copy(E.groundColor).multiplyScalar(T),a.hemi[f]=A,f++)}0<p&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Po.LTC_FLOAT_1,a.rectAreaLTC2=Po.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Po.LTC_HALF_1,a.rectAreaLTC2=Po.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=o,a.ambient[1]=s,a.ambient[2]=l;var R=a.hash;R.directionalLength===u&&R.pointLength===h&&R.spotLength===d&&R.rectAreaLength===p&&R.hemiLength===f&&R.numDirectionalShadows===m&&R.numPointShadows===v&&R.numSpotShadows===g||(a.directional.length=u,a.spot.length=d,a.rectArea.length=p,a.point.length=h,a.hemi.length=f,a.directionalShadow.length=m,a.directionalShadowMap.length=m,a.pointShadow.length=v,a.pointShadowMap.length=v,a.spotShadow.length=g,a.spotShadowMap.length=g,a.directionalShadowMatrix.length=m,a.pointShadowMatrix.length=v,a.spotShadowMatrix.length=g,R.directionalLength=u,R.pointLength=h,R.spotLength=d,R.rectAreaLength=p,R.hemiLength=f,R.numDirectionalShadows=m,R.numPointShadows=v,R.numSpotShadows=g,a.version=pl++)},setupView:function(e,t){for(var n=0,r=0,i=0,o=0,u=0,h=t.matrixWorldInverse,d=0,p=e.length;d<p;d++){var f,m,v,g=e[d];g.isDirectionalLight?((f=a.directional[n]).direction.setFromMatrixPosition(g.matrixWorld),s.setFromMatrixPosition(g.target.matrixWorld),f.direction.sub(s),f.direction.transformDirection(h),n++):g.isSpotLight?((f=a.spot[i]).position.setFromMatrixPosition(g.matrixWorld),f.position.applyMatrix4(h),f.direction.setFromMatrixPosition(g.matrixWorld),s.setFromMatrixPosition(g.target.matrixWorld),f.direction.sub(s),f.direction.transformDirection(h),i++):g.isRectAreaLight?((m=a.rectArea[o]).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(h),c.identity(),l.copy(g.matrixWorld),l.premultiply(h),c.extractRotation(l),m.halfWidth.set(.5*g.width,0,0),m.halfHeight.set(0,.5*g.height,0),m.halfWidth.applyMatrix4(c),m.halfHeight.applyMatrix4(c),o++):g.isPointLight?((m=a.point[r]).position.setFromMatrixPosition(g.matrixWorld),m.position.applyMatrix4(h),r++):g.isHemisphereLight&&((v=a.hemi[u]).direction.setFromMatrixPosition(g.matrixWorld),v.direction.transformDirection(h),v.direction.normalize(),u++)}},state:a}}function vl(e,t){var n=new ml(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function gl(e,t){var n=new k.a;return{get:function(r){var i,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(i=new vl(e,t),n.set(r,[i])):a>=n.get(r).length?(i=new vl(e,t),n.get(r).push(i)):i=n.get(r)[a],i},dispose:function(){n=new k.a}}}var yl=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=ir,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=L()(e),this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(pa),xl=(yl.prototype.isMeshDepthMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new Qr,r.nearDistance=1,r.farDistance=1e3,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=L()(e),this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(pa)),wl=(xl.prototype.isMeshDistanceMaterial=!0,"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}");function bl(e,t,n){var r=new So,i=new Hr,a=new Hr,o=new Xr,s=[],l=[],c={},u={0:fe,1:pe,2:me},h=new vo({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Hr},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:wl}),d=h.clone(),p=(d.defines.HORIZONTAL_PASS=1,new ja),f=(p.setAttribute("position",new Ea(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3)),new co(p,h)),m=this;function v(e,t,n){var r=s[n=e<<0|t<<1|n<<2];return void 0===r&&(r=new yl({depthPacking:ar,morphTargets:e,skinning:t}),s[n]=r),r}function g(e,t,n){var r=l[n=e<<0|t<<1|n<<2];return void 0===r&&(r=new xl({morphTargets:e,skinning:t}),l[n]=r),r}function y(t,n,r,i,a,o,s){var l,h=null,d=v,p=t.customDepthMaterial;return!0===i.isPointLight&&(d=g,p=t.customDistanceMaterial),h=void 0===p?(!(l=!1)===r.morphTargets&&(l=n.morphAttributes&&n.morphAttributes.position&&0<n.morphAttributes.position.length),!(n=!1)===t.isSkinnedMesh&&(!0===r.skinning?n=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),d(l,n,!0===t.isInstancedMesh)):p,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length&&(d=h.uuid,l=r.uuid,void 0===(n=c[d])&&(c[d]=n={}),void 0===(t=n[l])&&(t=h.clone(),n[l]=t),h=t),h.visible=r.visible,h.wireframe=r.wireframe,h.side=s===de?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:u[r.side],h.clipShadows=r.clipShadows,h.clippingPlanes=r.clippingPlanes,h.clipIntersection=r.clipIntersection,h.wireframeLinewidth=r.wireframeLinewidth,h.linewidth=r.linewidth,!0===i.isPointLight&&!0===h.isMeshDistanceMaterial&&(h.referencePosition.setFromMatrixPosition(i.matrixWorld),h.nearDistance=a,h.farDistance=o),h}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ue,this.render=function(s,l,c){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==s.length){var u=e.getRenderTarget(),p=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),g=e.state;g.setBlending(ye),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);for(var x,w,b=0,_=s.length;b<_;b++){var E=s[b],S=E.shadow;if(void 0===S)console.warn("THREE.WebGLShadowMap:",E,"has no shadow.");else if(!1!==S.autoUpdate||!1!==S.needsUpdate){i.copy(S.mapSize);for(var T=S.getFrameExtents(),A=(i.multiply(T),a.copy(S.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(a.x=Math.floor(n/T.x),i.x=a.x*T.x,S.mapSize.x=a.x),i.y>n)&&(a.y=Math.floor(n/T.y),i.y=a.y*T.y,S.mapSize.y=a.y),null!==L()(S)||S.isPointLightShadow||this.type!==de||(S.map=new Yr(i.x,i.y,T={minFilter:yt,magFilter:yt,format:Ot}),L()(S).texture.name=E.name+".shadowMap",S.mapPass=new Yr(i.x,i.y,T),S.camera.updateProjectionMatrix()),null===L()(S)&&(S.map=new Yr(i.x,i.y,{minFilter:pt,magFilter:pt,format:Ot}),L()(S).texture.name=E.name+".shadowMap",S.camera.updateProjectionMatrix()),e.setRenderTarget(L()(S)),e.clear(),S.getViewportCount()),C=0;C<A;C++){var P=S.getViewport(C);o.set(a.x*P.x,a.y*P.y,a.x*P.z,a.y*P.w),g.viewport(o),S.updateMatrices(E,C),r=S.getFrustum(),function n(i,a,o,s,l){if(!1!==i.visible){var c=i.layers.test(a.layers);if(c&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&l===de)&&(!i.frustumCulled||r.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);var u=t.update(i),h=i.material;if(M()(h))for(var d=u.groups,p=0,f=d.length;p<f;p++){var m=d[p],v=h[m.materialIndex];v&&v.visible&&(v=y(i,u,v,s,o.near,o.far,l),e.renderBufferDirect(o,null,u,v,i,m))}else h.visible&&(c=y(i,u,h,s,o.near,o.far,l),e.renderBufferDirect(o,null,u,c,i,null))}for(var g=i.children,x=0,w=g.length;x<w;x++)n(g[x],a,o,s,l)}}(l,c,S.camera,E,this.type)}S.isPointLightShadow||this.type!==de||(T=S,x=c,void 0,w=t.update(f),h.uniforms.shadow_pass.value=L()(T).texture,h.uniforms.resolution.value=T.mapSize,h.uniforms.radius.value=T.radius,e.setRenderTarget(T.mapPass),e.clear(),e.renderBufferDirect(x,null,w,h,f,null),d.uniforms.shadow_pass.value=T.mapPass.texture,d.uniforms.resolution.value=T.mapSize,d.uniforms.radius.value=T.radius,e.setRenderTarget(L()(T)),e.clear(),e.renderBufferDirect(x,null,w,d,f,null)),S.needsUpdate=!1}}m.needsUpdate=!1,e.setRenderTarget(u,p,v)}}}function _l(e,t,n){n=n.isWebGL2;var r=new function(){var t=!1,n=new Xr,r=null,i=new Xr(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){(e?z:N)(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case Ue:e.depthFunc(512);break;case He:e.depthFunc(519);break;case Ve:e.depthFunc(513);break;case Ge:e.depthFunc(515);break;case We:e.depthFunc(514);break;case je:e.depthFunc(518);break;case qe:e.depthFunc(516);break;case Xe:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,i=r=n=null}}},a=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(e){t||(e?z:N)(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,c=l=s=o=a=i=r=n=null}}},o={},l=null,c=!1,u=null,h=null,d=null,p=null,f=null,m=null,v=null,g=!1,x=null,w=null,b=null,_=null,M=null,E=e.getParameter(35661),S=!1,T=0,A=e.getParameter(7938),L=(-1!==y()(A).call(A,"WebGL")?(T=C()(/^WebGL (\d)/.exec(A)[1]),S=1<=T):-1!==y()(A).call(A,"OpenGL ES")&&(T=C()(/^OpenGL ES (\d)/.exec(A)[1]),S=2<=T),null),P={},R=new Xr,I=new Xr;function k(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var D={};function z(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function N(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}D[3553]=k(3553,3553,1),D[34067]=k(34067,34069,6),r.setClear(0,0,0,1),i.setClear(1),a.setClear(0),z(2929),i.setFunc(Ge),U(!1),H(oe),z(2884),F(ye),A={},s()(A,Ee,32774),s()(A,Se,32778),s()(A,Te,32779);var O=A,B=(n?(O[Ae]=32775,O[Le]=32776):null!==(T=t.get("EXT_blend_minmax"))&&(O[Ae]=T.MIN_EXT,O[Le]=T.MAX_EXT),A={},s()(A,Ce,0),s()(A,Pe,1),s()(A,Re,768),s()(A,ke,770),s()(A,Fe,776),s()(A,Oe,774),s()(A,ze,772),s()(A,Ie,769),s()(A,De,771),s()(A,Be,775),s()(A,Ne,773),A);function F(t,n,r,i,a,o,s,l){if(t===ye)!0===c&&(N(3042),c=!1);else if(!1===c&&(z(3042),c=!0),t!==Me){if(t!==u||l!==g){if(h===Ee&&f===Ee||(e.blendEquation(32774),f=h=Ee),l)switch(t){case xe:e.blendFuncSeparate(1,771,1,771);break;case we:e.blendFunc(1,1);break;case be:e.blendFuncSeparate(0,0,769,771);break;case _e:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case xe:e.blendFuncSeparate(770,771,1,771);break;case we:e.blendFunc(770,1);break;case be:e.blendFunc(0,769);break;case _e:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=m=p=d=null,u=t,g=l}}else a=a||n,o=o||r,s=s||i,n===h&&a===f||(e.blendEquationSeparate(O[n],O[a]),h=n,f=a),r===d&&i===p&&o===m&&s===v||(e.blendFuncSeparate(B[r],B[i],B[o],B[s]),d=r,p=i,m=o,v=s),u=t,g=null}function U(t){x!==t&&(t?e.frontFace(2304):e.frontFace(2305),x=t)}function H(t){t!==ae?(z(2884),t!==w&&(t===oe?e.cullFace(1029):t===se?e.cullFace(1028):e.cullFace(1032))):N(2884),w=t}function V(t,n,r){t?(z(32823),_===n&&M===r||(e.polygonOffset(n,r),_=n,M=r)):N(32823)}function G(t){L!==(t=void 0===t?33984+E-1:t)&&(e.activeTexture(t),L=t)}return{buffers:{color:r,depth:i,stencil:a},enable:z,disable:N,useProgram:function(t){return l!==t&&(e.useProgram(t),l=t,!0)},setBlending:F,setMaterial:function(e,t){(e.side===me?N:z)(2884);var n=e.side===fe;U(n=t?!n:n),e.blending===xe&&!1===e.transparent?F(ye):F(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),t=e.stencilWrite;a.setTest(t),t&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),V(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:U,setCullFace:H,setLineWidth:function(t){t!==b&&(S&&e.lineWidth(t),b=t)},setPolygonOffset:V,setScissorTest:function(e){(e?z:N)(3089)},activeTexture:G,bindTexture:function(t,n){null===L&&G();var r=P[L];void 0===r&&(P[L]=r={type:void 0,texture:void 0}),r.type===t&&r.texture===n||(e.bindTexture(t,n||D[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=P[L];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===R.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),R.copy(t))},viewport:function(t){!1===I.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),I.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},g=c=!(P={}),M=_=b=w=x=v=m=f=p=d=h=u=l=L=null,r.reset(),i.reset(),a.reset()}}}function Ml(e,t,n,r,i,a,o){var l,c,u=i.isWebGL2,h=i.maxTextures,d=i.maxCubemapSize,p=i.maxTextureSize,f=i.maxSamples,m=new k.a,v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(l){}function g(e,t){return v?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function y(e,t,n,r){var i=1;return(i=e.width>r||e.height>r?r/Math.max(e.width,e.height):i)<1||!0===t?"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?(t=(r=t?Ur.floorPowerOfTwo:Math.floor)(i*e.width),r=r(i*e.height),void 0===c&&(c=g(t,r)),(i=n?g(t,r):c).width=t,i.height=r,i.getContext("2d").drawImage(e,0,0,t,r),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+t+"x"+r+")."),i):("data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e):e}function x(e){return Ur.isPowerOfTwo(e.width)&&Ur.isPowerOfTwo(e.height)}function w(e,t){return e.generateMipmaps&&t&&e.minFilter!==pt&&e.minFilter!==yt}function b(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=B()(Math.max(i,a))}function _(n,r,i){if(!1===u)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}return n=r,6403===r&&(5126===i&&(n=33326),5131===i&&(n=33325),5121===i)&&(n=33321),6407===r&&(5126===i&&(n=34837),5131===i&&(n=34843),5121===i)&&(n=32849),33325!==(n=6408===r&&(5126===i&&(n=34836),5131===i&&(n=34842),5121===i)?32856:n)&&33326!==n&&34842!==n&&34836!==n||t.get("EXT_color_buffer_float"),n}function M(e){return e===pt||e===ft||e===vt?9728:9729}function E(t){var n,i;(t=t.target).removeEventListener("dispose",E),n=t,void 0!==(i=r.get(n)).__webglInit&&(e.deleteTexture(i.__webglTexture),r.remove(n)),t.isVideoTexture&&m.delete(t),o.memory.textures--}function S(t){var n=((t=t.target).removeEventListener("dispose",S),t.texture),i=r.get(t),a=r.get(n);if(t){if(void 0!==a.__webglTexture&&e.deleteTexture(a.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++)e.deleteFramebuffer(i.__webglFramebuffer[s]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[s]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}o.memory.textures--}var T=0;function A(e,t){var i,a=r.get(e);if(e.isVideoTexture&&(i=e,s=o.render.frame,m.get(i)!==s)&&(m.set(i,s),i.update()),0<e.version&&a.__version!==e.version){var s=e.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void D(a,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,a.__webglTexture)}function L(t,i){var o=r.get(t);if(0<t.version&&o.__version!==t.version){var s=o,l=t;t=i;if(6===l.image.length){I(s,l),n.activeTexture(33984+t),n.bindTexture(34067,s.__webglTexture),e.pixelStorei(37440,l.flipY),e.pixelStorei(37441,l.premultiplyAlpha),e.pixelStorei(3317,l.unpackAlignment),e.pixelStorei(37443,0);for(var c=l&&(l.isCompressedTexture||l.image[0].isCompressedTexture),h=l.image[0]&&l.image[0].isDataTexture,p=[],f=0;f<6;f++)p[f]=c||h?h?l.image[f].image:l.image[f]:y(l.image[f],!1,!0,d);var m,v=x(t=p[0])||u,g=a.convert(l.format),M=a.convert(l.type),E=_(l.internalFormat,g,M);if(R(34067,l,v),c){for(var S=0;S<6;S++){m=p[S].mipmaps;for(var T=0;T<m.length;T++){var A=m[T];l.format!==Ot&&l.format!==Nt?null!==g?n.compressedTexImage2D(34069+S,T,E,A.width,A.height,0,A.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+S,T,E,A.width,A.height,0,g,M,A.data)}}s.__maxMipLevel=m.length-1}else{m=l.mipmaps;for(var L=0;L<6;L++)if(h){n.texImage2D(34069+L,0,E,p[L].width,p[L].height,0,g,M,p[L].data);for(var C=0;C<m.length;C++){var P=m[C].image[L].image;n.texImage2D(34069+L,C+1,E,P.width,P.height,0,g,M,P.data)}}else{n.texImage2D(34069+L,0,E,g,M,p[L]);for(var k=0;k<m.length;k++){var D=m[k];n.texImage2D(34069+L,k+1,E,g,M,D.image[L])}}s.__maxMipLevel=m.length}w(l,v)&&b(34067,l,t.width,t.height),s.__version=l.version,l.onUpdate&&l.onUpdate(l)}}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}l={},s()(l,ut,10497),s()(l,ht,33071),s()(l,dt,33648);var C=l,P=(l={},s()(l,pt,9728),s()(l,ft,9984),s()(l,vt,9986),s()(l,yt,9729),s()(l,xt,9985),s()(l,bt,9987),l);function R(n,a,o){o?(e.texParameteri(n,10242,C[a.wrapS]),e.texParameteri(n,10243,C[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[a.wrapR]),e.texParameteri(n,10240,P[a.magFilter]),e.texParameteri(n,10241,P[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===ht&&a.wrapT===ht||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,M(a.magFilter)),e.texParameteri(n,10241,M(a.minFilter)),a.minFilter!==pt&&a.minFilter!==yt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")&&(o=t.get("EXT_texture_filter_anisotropic"),a.type===Ct&&!1===t.has("OES_texture_float_linear")||!1===u&&a.type===Pt&&!1===t.has("OES_texture_half_float_linear")||(1<a.anisotropy||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy))}function I(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",E),t.__webglTexture=e.createTexture(),o.memory.textures++)}function D(t,r,i){var o,s=3553,l=(i=(r.isDataTexture2DArray&&(s=35866),r.isDataTexture3D&&(s=32879),I(t,r),n.activeTexture(33984+i),n.bindTexture(s,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0),i=r,!u&&(i.wrapS!==ht||i.wrapT!==ht||i.minFilter!==pt&&i.minFilter!==yt)&&!1===x(r.image)),x(i=y(r.image,i,!1,p))||u),c=a.convert(r.format),h=a.convert(r.type),d=_(r.internalFormat,c,h),f=(R(s,r,l),r.mipmaps);if(r.isDepthTexture)d=6402,u?d=r.type===Ct?36012:r.type===Lt?33190:r.type===Dt?35056:33189:r.type===Ct&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Ht&&6402===d&&r.type!==Tt&&r.type!==Lt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Tt,h=a.convert(r.type)),r.format===Vt&&6402===d&&(d=34041,r.type!==Dt)&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Dt,h=a.convert(r.type)),n.texImage2D(3553,0,d,i.width,i.height,0,c,h,null);else if(r.isDataTexture)if(0<f.length&&l){for(var m=0,v=f.length;m<v;m++)o=f[m],n.texImage2D(3553,m,d,o.width,o.height,0,c,h,o.data);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,d,i.width,i.height,0,c,h,i.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var g=0,M=f.length;g<M;g++)o=f[g],r.format!==Ot&&r.format!==Nt?null!==c?n.compressedTexImage2D(3553,g,d,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,g,d,o.width,o.height,0,c,h,o.data);t.__maxMipLevel=f.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,d,i.width,i.height,i.depth,0,c,h,i.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,d,i.width,i.height,i.depth,0,c,h,i.data),t.__maxMipLevel=0;else if(0<f.length&&l){for(var E=0,S=f.length;E<S;E++)o=f[E],n.texImage2D(3553,E,d,c,h,o);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,d,c,h,i),t.__maxMipLevel=0;w(r,l)&&b(s,r,i.width,i.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function z(t,i,o,s){var l=i.texture,c=a.convert(l.format),u=a.convert(l.type),h=_(l.internalFormat,c,u);32879===s||35866===s?n.texImage3D(s,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(s,0,h,i.width,i.height,0,c,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(l).__webglTexture,0),e.bindFramebuffer(36160,null)}function N(t,n,r){var i,o;e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer?(i=33189,r?((o=n.depthTexture)&&o.isDepthTexture&&(o.type===Ct?i=36012:o.type===Lt&&(i=33190)),o=O(n),e.renderbufferStorageMultisample(36161,o,i,n.width,n.height)):e.renderbufferStorage(36161,i,n.width,n.height),e.framebufferRenderbuffer(36160,36096,36161,t)):n.depthBuffer&&n.stencilBuffer?(r?(o=O(n),e.renderbufferStorageMultisample(36161,o,35056,n.width,n.height)):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)):(i=n.texture,o=a.convert(i.format),t=a.convert(i.type),i=_(i.internalFormat,o,t),r?(o=O(n),e.renderbufferStorageMultisample(36161,o,i,n.width,n.height)):e.renderbufferStorage(36161,i,n.width,n.height)),e.bindRenderbuffer(36161,null)}function O(e){return u&&e.isWebGLMultisampleRenderTarget?Math.min(f,e.samples):0}var F=!1,U=!1;this.allocateTextureUnit=function(){var e=T;return h<=e&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=L,this.setupRenderTarget=function(t){var i=t.texture,s=r.get(t),l=r.get(i),c=(t.addEventListener("dispose",S),l.__webglTexture=e.createTexture(),o.memory.textures++,!0===t.isWebGLCubeRenderTarget),h=!0===t.isWebGLMultisampleRenderTarget,d=i.isDataTexture3D||i.isDataTexture2DArray,p=x(t)||u;if(!u||i.format!==Nt||i.type!==Ct&&i.type!==Pt||(i.format=Ot,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){s.__webglFramebuffer=[];for(var f=0;f<6;f++)s.__webglFramebuffer[f]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer(),h&&(u?(s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer),h=a.convert(i.format),v=a.convert(i.type),h=_(i.internalFormat,h,v),v=O(t),e.renderbufferStorageMultisample(36161,v,h,t.width,t.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),N(s.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(c){n.bindTexture(34067,l.__webglTexture),R(34067,i,p);for(var m=0;m<6;m++)z(s.__webglFramebuffer[m],t,36064,34069+m);w(i,p)&&b(34067,i,t.width,t.height),n.bindTexture(34067,null)}else{var v=3553;d&&(u?v=i.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(v,l.__webglTexture),R(v,i,p),z(s.__webglFramebuffer,t,36064,v),w(i,p)&&b(3553,i,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&function(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");var a=n.__webglFramebuffer,o=t;if(o&&o.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,a),!o.depthTexture||!o.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(o.depthTexture).__webglTexture&&o.depthTexture.image.width===o.width&&o.depthTexture.image.height===o.height||(o.depthTexture.image.width=o.width,o.depthTexture.image.height=o.height,o.depthTexture.needsUpdate=!0),A(o.depthTexture,0),a=r.get(o.depthTexture).__webglTexture,o.depthTexture.format===Ht)e.framebufferTexture2D(36160,36096,3553,a,0);else{if(o.depthTexture.format!==Vt)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,a,0)}}else if(i){n.__webglDepthbuffer=[];for(var s=0;s<6;s++)e.bindFramebuffer(36160,n.__webglFramebuffer[s]),n.__webglDepthbuffer[s]=e.createRenderbuffer(),N(n.__webglDepthbuffer[s],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),N(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){var t,i,a=e.texture;w(a,x(e)||u)&&(t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(a).__webglTexture,n.bindTexture(t,i),b(t,a,e.width,e.height),n.bindTexture(t,null))},this.updateMultisampleRenderTarget=function(t){var n,i,a,o;t.isWebGLMultisampleRenderTarget&&(u?(n=r.get(t),e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer),i=t.width,a=t.height,o=16384,t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===U&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),U=!0),e=e.texture),L(e,t)}}function El(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===Mt)return 5121;if(e===Rt)return 32819;if(e===It)return 32820;if(e===kt)return 33635;if(e===Et)return 5120;if(e===St)return 5122;if(e===Tt)return 5123;if(e===At)return 5124;if(e===Lt)return 5125;if(e===Ct)return 5126;if(e===Pt)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===zt)return 6406;if(e===Nt)return 6407;if(e===Ot)return 6408;if(e===Bt)return 6409;if(e===Ft)return 6410;if(e===Ht)return 6402;if(e===Vt)return 34041;if(e===Gt)return 6403;if(e===Wt)return 36244;if(e===jt)return 33319;if(e===qt)return 33320;if(e===Xt)return 36248;if(e===Yt)return 36249;if(e===Zt||e===Jt||e===Qt||e===Kt){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===Zt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Jt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Qt)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Kt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===$t||e===en||e===tn||e===nn){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===$t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===en)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===tn)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===nn)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===rn)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===an||e===on)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===an)return n.COMPRESSED_RGB8_ETC2;if(e===on)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===sn||e===ln||e===cn||e===un||e===hn||e===dn||e===pn||e===fn||e===mn||e===vn||e===gn||e===yn||e===xn||e===wn||e===_n||e===Mn||e===En||e===Sn||e===Tn||e===An||e===Ln||e===Cn||e===Pn||e===Rn||e===In||e===kn||e===Dn||e===zn?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===bn?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===Dt?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Sl(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];yo.call(this),this.cameras=e}Sl.prototype=g()(T()(yo.prototype),{constructor:Sl,isArrayCamera:!0});var Tl=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this)).type="Group",e}return m()(n)}(Ji);function Al(){this._targetRay=null,this._grip=null,this._hand=null}function Ll(e,t){var n=this,r=null,i=1,a=null,s="local-floor",l=null,c=[],u=new U.a,h=new yo,d=(h.layers.enable(1),h.viewport=new Xr,new yo),p=(d.layers.enable(2),d.viewport=new Xr,[h,d]),f=new Sl,m=(f.layers.enable(1),f.layers.enable(2),null),g=null;function y(e){var t=u.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function x(){H()(u).call(u,(function(e,t){e.disconnect(t)})),u.clear(),g=m=null,e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function w(e){for(var t=r.inputSources,n=0;n<c.length;n++)u.set(t[n],c[n]);for(var i=0;i<e.removed.length;i++){var a=e.removed[i],o=u.get(a);o&&(o.dispatchEvent({type:"disconnected",data:a}),u.delete(a))}for(var s=0;s<e.added.length;s++){var l=e.added[s],h=u.get(l);h&&h.dispatchEvent({type:"connected",data:l})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=c[e];return void 0===t&&(t=new Al,c[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=c[e];return void 0===t&&(t=new Al,c[e]=t),t.getGripSpace()},this.getHand=function(e){var t=c[e];return void 0===t&&(t=new Al,c[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(){var e=o()(v.a.mark((function e(o){var l,c;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=o))e.next=24;else{if(r.addEventListener("select",y),r.addEventListener("selectstart",y),r.addEventListener("selectend",y),r.addEventListener("squeeze",y),r.addEventListener("squeezestart",y),r.addEventListener("squeezeend",y),r.addEventListener("end",x),r.addEventListener("inputsourceschange",w),!0!==(l=t.getContextAttributes()).xrCompatible)return e.next=14,t.makeXRCompatible();e.next=14}break;case 14:return c={antialias:l.antialias,alpha:l.alpha,depth:l.depth,stencil:l.stencil,framebufferScaleFactor:i},c=new XRWebGLLayer(r,t,c),r.updateRenderState({baseLayer:c}),e.next=19,r.requestReferenceSpace(s);case 19:a=e.sent,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var b=new Qr,_=new Qr;function M(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){f.near=d.near=h.near=e.near,f.far=d.far=h.far=e.far,m===f.near&&g===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),m=f.near,g=f.far);var t=e.parent,n=f.cameras;M(f,t);for(var i=0;i<n.length;i++)M(n[i],t);e.matrixWorld.copy(f.matrixWorld),e.matrix.copy(f.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var a,o,s,l,c,u,p,v,y,x,w=e.children,E=0,S=w.length;E<S;E++)w[E].updateMatrixWorld(!0);return 2===n.length?(e=f,a=h,o=d,b.setFromMatrixPosition(a.matrixWorld),_.setFromMatrixPosition(o.matrixWorld),s=b.distanceTo(_),l=a.projectionMatrix.elements,o=o.projectionMatrix.elements,c=l[14]/(l[10]-1),u=l[14]/(l[10]+1),p=(l[9]+1)/l[5],v=(l[9]-1)/l[5],y=c*(l=(l[8]-1)/l[0]),x=c*(o=(o[8]+1)/o[0]),l=(o=s/(o-l))*-l,a.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(l),e.translateZ(o),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),a=c+o,c=u+o,e.projectionMatrix.makePerspective(y-l,s-l+x,p*u/c*a,v*u/c*a,a,c)):f.projectionMatrix.copy(h.projectionMatrix),f};var E=null,S=new To;S.setAnimationLoop((function(t,n){if(null!==(l=n.getViewerPose(a))){var i=l.views,o=r.renderState.baseLayer,s=(e.setFramebuffer(o.framebuffer),!1);i.length!==f.cameras.length&&(s=!(f.cameras.length=0));for(var u=0;u<i.length;u++){var h=i[u],d=o.getViewport(h),m=p[u];m.matrix.fromArray(h.transform.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(d.x,d.y,d.width,d.height),0===u&&f.matrix.copy(m.matrix),!0===s&&f.cameras.push(m)}}for(var v=r.inputSources,g=0;g<c.length;g++){var y=c[g],x=v[g];y.update(x,n,a)}E&&E(t,n)})),this.setAnimationLoop=function(e){E=e},this.dispose=function(){}}function Cl(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),L()(n)&&(L()(t).value=L()(n)),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,a=e.get(n).envMap;a&&(t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio,void 0!==(a=e.get(a).__maxMipLevel))&&(t.maxMipLevel.value=a),n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),L()(n)?r=L()(n):n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(!0===(r=r.isWebGLRenderTarget?r.texture:r).matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(!0===(i=i.isWebGLRenderTarget?i.texture:i).matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===fe)&&(t.bumpScale.value*=-1),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===fe)&&t.normalScale.value.negate(),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a){var o,s,l,c,u,h,d,p,f,m,v,g;r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),v=e,(g=r).emissiveMap&&(v.emissiveMap.value=g.emissiveMap)):r.isMeshToonMaterial?(t(e,r),v=e,(g=r).gradientMap&&(v.gradientMap.value=g.gradientMap),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap),g.bumpMap&&(v.bumpMap.value=g.bumpMap,v.bumpScale.value=g.bumpScale,g.side===fe)&&(v.bumpScale.value*=-1),g.normalMap&&(v.normalMap.value=g.normalMap,v.normalScale.value.copy(g.normalScale),g.side===fe)&&v.normalScale.value.negate(),g.displacementMap&&(v.displacementMap.value=g.displacementMap,v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias)):r.isMeshPhongMaterial?(t(e,r),s=r,(o=e).specular.value.copy(s.specular),o.shininess.value=Math.max(s.shininess,1e-4),s.emissiveMap&&(o.emissiveMap.value=s.emissiveMap),s.bumpMap&&(o.bumpMap.value=s.bumpMap,o.bumpScale.value=s.bumpScale,s.side===fe)&&(o.bumpScale.value*=-1),s.normalMap&&(o.normalMap.value=s.normalMap,o.normalScale.value.copy(s.normalScale),s.side===fe)&&o.normalScale.value.negate(),s.displacementMap&&(o.displacementMap.value=s.displacementMap,o.displacementScale.value=s.displacementScale,o.displacementBias.value=s.displacementBias)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?(n(o=e,s=r),o.reflectivity.value=s.reflectivity,o.clearcoat.value=s.clearcoat,o.clearcoatRoughness.value=s.clearcoatRoughness,s.sheen&&o.sheen.value.copy(s.sheen),s.clearcoatMap&&(o.clearcoatMap.value=s.clearcoatMap),s.clearcoatRoughnessMap&&(o.clearcoatRoughnessMap.value=s.clearcoatRoughnessMap),s.clearcoatNormalMap&&(o.clearcoatNormalScale.value.copy(s.clearcoatNormalScale),o.clearcoatNormalMap.value=s.clearcoatNormalMap,s.side===fe)&&o.clearcoatNormalScale.value.negate(),o.transmission.value=s.transmission,s.transmissionMap&&(o.transmissionMap.value=s.transmissionMap)):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),f=e,(m=r).matcap&&(f.matcap.value=m.matcap),m.bumpMap&&(f.bumpMap.value=m.bumpMap,f.bumpScale.value=m.bumpScale,m.side===fe)&&(f.bumpScale.value*=-1),m.normalMap&&(f.normalMap.value=m.normalMap,f.normalScale.value.copy(m.normalScale),m.side===fe)&&f.normalScale.value.negate(),m.displacementMap&&(f.displacementMap.value=m.displacementMap,f.displacementScale.value=m.displacementScale,f.displacementBias.value=m.displacementBias)):r.isMeshDepthMaterial?(t(e,r),f=e,(m=r).displacementMap&&(f.displacementMap.value=m.displacementMap,f.displacementScale.value=m.displacementScale,f.displacementBias.value=m.displacementBias)):r.isMeshDistanceMaterial?(t(e,r),l=e,(c=r).displacementMap&&(l.displacementMap.value=c.displacementMap,l.displacementScale.value=c.displacementScale,l.displacementBias.value=c.displacementBias),l.referencePosition.value.copy(c.referencePosition),l.nearDistance.value=c.nearDistance,l.farDistance.value=c.farDistance):r.isMeshNormalMaterial?(t(e,r),l=e,(c=r).bumpMap&&(l.bumpMap.value=c.bumpMap,l.bumpScale.value=c.bumpScale,c.side===fe)&&(l.bumpScale.value*=-1),c.normalMap&&(l.normalMap.value=c.normalMap,l.normalScale.value.copy(c.normalScale),c.side===fe)&&l.normalScale.value.negate(),c.displacementMap&&(l.displacementMap.value=c.displacementMap,l.displacementScale.value=c.displacementScale,l.displacementBias.value=c.displacementBias)):r.isLineBasicMaterial?(p=r,(d=e).diffuse.value.copy(p.color),d.opacity.value=p.opacity,r.isLineDashedMaterial&&(d=r,(p=e).dashSize.value=d.dashSize,p.totalSize.value=d.dashSize+d.gapSize,p.scale.value=d.scale)):r.isPointsMaterial?(p=r,d=i,i=a,(a=e).diffuse.value.copy(p.color),a.opacity.value=p.opacity,a.size.value=p.size*d,a.scale.value=.5*i,L()(p)&&(L()(a).value=L()(p)),p.alphaMap&&(a.alphaMap.value=p.alphaMap),L()(p)?u=L()(p):p.alphaMap&&(u=p.alphaMap),void 0!==u&&(!0===u.matrixAutoUpdate&&u.updateMatrix(),a.uvTransform.value.copy(u.matrix))):r.isSpriteMaterial?(i=r,(a=e).diffuse.value.copy(i.color),a.opacity.value=i.opacity,a.rotation.value=i.rotation,L()(i)&&(L()(a).value=L()(i)),i.alphaMap&&(a.alphaMap.value=i.alphaMap),L()(i)?h=L()(i):i.alphaMap&&(h=i.alphaMap),void 0!==h&&(!0===h.matrixAutoUpdate&&h.updateMatrix(),a.uvTransform.value.copy(h.matrix))):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Pl(e){var t=void 0!==(e=e||{}).canvas?e.canvas:((n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",n),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,d=null,p=[],f=[],m=(this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Jn,this.physicallyCorrectLights=!1,this.toneMapping=Qe,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this),v=!1,g=null,y=0,x=0,b=null,_=null,E=-1,S=null,T=new Xr,A=new Xr,C=null,P=t.width,R=t.height,I=1,z=null,N=null,O=new Xr(0,0,P,R),B=new Xr(0,0,P,R),F=!1,U=new So,H=!1,G=!1,W=new Si,j=new Qr,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function X(){return null===b?I:1}var Y,Z,J,Q,K,$,ee,te,ne,re,ie,ae,oe,se,le,ce,ue,he,de,pe,fe,me=n;function ve(e,n){for(var r=0;r<e.length;r++){var i=e[r];if(null!==(i=t.getContext(i,n)))return i}return null}try{var ge={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",_e,!1),t.addEventListener("webglcontextrestored",Me,!1),null===me){var ye=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&ye.shift(),null===(me=ve(ye,ge)))throw ve(ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===me.getShaderPrecisionFormat&&(me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function xe(){Y=new Bo(me),Z=new zo(me,Y,e),Y.init(Z),pe=new El(0,Y,Z),(J=new _l(me,Y,Z)).scissor(A.copy(B).multiplyScalar(I).floor()),J.viewport(T.copy(O).multiplyScalar(I).floor()),Q=new Ho,K=new sl,$=new Ml(me,Y,J,K,Z,pe,Q),ee=new Oo(m),te=new Ao(me,Z),fe=new ko(me,Y,te,Z),ne=new Fo(0,te,Q,fe),re=new jo(0,ne,te,Q),ue=new Wo(me),le=new No(K),ie=new ol(m,ee,Y,Z,fe,le),ae=new Cl(K),oe=new hl(K),se=new gl(Y,Z),ce=new Io(m,ee,J,re,s),he=new Do(me,Y,Q,Z),de=new Uo(me,Y,Q,Z),Q.programs=ie.programs,m.capabilities=Z,m.extensions=Y,m.properties=K,m.renderLists=oe,m.state=J,m.info=Q}xe();var we=new Ll(m,me),be=(this.xr=we,new bl(m,re,Z.maxTextureSize));function _e(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function Me(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1,xe()}function Ee(e){(e=e.target).removeEventListener("dispose",Ee),Se(e=e),K.remove(e)}function Se(e){void 0!==(e=K.get(e).program)&&ie.releaseProgram(e)}this.shadowMap=be,this.getContext=function(){return me},this.getContextAttributes=function(){return me.getContextAttributes()},this.forceContextLoss=function(){var e=Y.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=Y.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(e){void 0!==e&&(I=e,this.setSize(P,R,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Hr),e.set(P,R)},this.setSize=function(e,n,r){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(P=e,R=n,t.width=Math.floor(e*I),t.height=Math.floor(n*I),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Hr),e.set(P*I,R*I).floor()},this.setDrawingBufferSize=function(e,n,r){P=e,R=n,I=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Xr),e.copy(T)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,r){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,r),J.viewport(T.copy(O).multiplyScalar(I).floor())},this.getScissor=function(e){return e.copy(B)},this.setScissor=function(e,t,n,r){e.isVector4?B.set(e.x,e.y,e.z,e.w):B.set(e,t,n,r),J.scissor(A.copy(B).multiplyScalar(I).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){J.setScissorTest(F=e)},this.setOpaqueSort=function(e){z=e},this.setTransparentSort=function(e){N=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new wa),e.copy(ce.getClearColor())},this.setClearColor=function(){ce.setClearColor.apply(ce,arguments)},this.getClearAlpha=function(){return ce.getClearAlpha()},this.setClearAlpha=function(){ce.setClearAlpha.apply(ce,arguments)},this.clear=function(e,t,n){var r=0;void 0!==e&&!e||(r|=16384),void 0!==t&&!t||(r|=256),void 0!==n&&!n||(r|=1024),me.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",_e,!1),t.removeEventListener("webglcontextrestored",Me,!1),oe.dispose(),se.dispose(),K.dispose(),ee.dispose(),re.dispose(),fe.dispose(),we.dispose(),Ae.stop()},this.renderBufferImmediate=function(e,t){fe.initAttributes();var n=K.get(e);e.hasPositions&&!n.position&&(n.position=me.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=me.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=me.createBuffer()),e.hasColors&&!n.color&&(n.color=me.createBuffer()),t=t.getAttributes();e.hasPositions&&(me.bindBuffer(34962,n.position),me.bufferData(34962,e.positionArray,35048),fe.enableAttribute(t.position),me.vertexAttribPointer(t.position,3,5126,!1,0,0)),e.hasNormals&&(me.bindBuffer(34962,n.normal),me.bufferData(34962,e.normalArray,35048),fe.enableAttribute(t.normal),me.vertexAttribPointer(t.normal,3,5126,!1,0,0)),e.hasUvs&&(me.bindBuffer(34962,n.uv),me.bufferData(34962,e.uvArray,35048),fe.enableAttribute(t.uv),me.vertexAttribPointer(t.uv,2,5126,!1,0,0)),e.hasColors&&(me.bindBuffer(34962,n.color),me.bufferData(34962,e.colorArray,35048),fe.enableAttribute(t.color),me.vertexAttribPointer(t.color,3,5126,!1,0,0)),fe.disableUnusedAttributes(),me.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=q);var o=i.isMesh&&i.matrixWorld.determinant()<0;e=De(e,t,r,i),J.setMaterial(r,o),t=n.index,o=n.attributes.position;if(null===t){if(void 0===o||0===o.count)return}else if(0===t.count)return;var s=1,l=(e=(!0===r.wireframe&&(t=ne.getWireframeAttribute(n),s=2),(r.morphTargets||r.morphNormals)&&ue.update(i,n,r,e),fe.setup(i,r,e,n,t),he),null!==t&&(l=te.get(t),(e=de).setIndex(l)),(null!==t?t:o).count),c=(t=n.drawRange.start*s,o=n.drawRange.count*s,null!==a?a.start*s:0);a=null!==a?a.count*s:1/0,s=Math.max(t,c),l=Math.min(l,t+o,c+a)-1;0!==(t=Math.max(0,l-s+1))&&(i.isMesh?!0===r.wireframe?(J.setLineWidth(r.wireframeLinewidth*X()),e.setMode(1)):e.setMode(4):i.isLine?(o=r.linewidth,J.setLineWidth((o=void 0===o?1:o)*X()),i.isLineSegments?e.setMode(1):i.isLineLoop?e.setMode(2):e.setMode(3)):i.isPoints?e.setMode(0):i.isSprite&&e.setMode(4),i.isInstancedMesh?e.renderInstances(s,t,i.count):n.isInstancedBufferGeometry?(c=Math.min(n.instanceCount,n._maxInstanceCount),e.renderInstances(s,t,c)):e.render(s,t))},this.compile=function(e,t){(d=se.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow)&&d.pushShadow(e)})),d.setupLights();var n=new k.a;e.traverse((function(t){var r=t.material;if(r)if(M()(r))for(var i=0;i<r.length;i++){var a=r[i];!1===n.has(a)&&(ke(a,e,t),n.set(a))}else!1===n.has(r)&&(ke(r,e,t),n.set(r))}))};var Te=null,Ae=new To;Ae.setAnimationLoop((function(e){we.isPresenting||Te&&Te(e)})),"undefined"!=typeof window&&Ae.setContext(window),this.setAnimationLoop=function(e){Te=e,we.setAnimationLoop(e),null===e?Ae.stop():Ae.start()};var Le=!(this.render=function(e,t){var n,r,i;void(Ce=0)!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),void 0!==t&&!0!==t.isCamera?console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."):!0!==v&&(fe.resetDefaultState(),E=-1,!(S=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(t=we.getCamera(t)),!0===e.isScene&&e.onBeforeRender(m,e,t,i||b),(d=se.get(e,f.length)).init(),f.push(d),W.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(W),G=this.localClippingEnabled,H=le.init(this.clippingPlanes,G,t),(h=oe.get(e,p.length)).init(),p.push(h),function e(t,n,r,i){if(!1!==t.visible){var a=t.layers.test(n.layers);if(a)if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(n);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){var o;t.frustumCulled&&!U.intersectsSprite(t)||(i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(W),a=re.update(t),(o=t.material).visible&&h.push(t,a,o,r,j.z,null))}else if(t.isImmediateRenderObject)i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(W),h.push(t,null,t.material,r,j.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==Q.render.frame&&(t.skeleton.update(),t.skeleton.frame=Q.render.frame),!t.frustumCulled||U.intersectsObject(t))){i&&j.setFromMatrixPosition(t.matrixWorld).applyMatrix4(W);var s=re.update(t),l=t.material;if(M()(l))for(var c=s.groups,u=0,p=c.length;u<p;u++){var f=c[u],m=l[f.materialIndex];m&&m.visible&&h.push(t,s,m,r,j.z,f)}else l.visible&&h.push(t,s,l,r,j.z,null)}for(var v=t.children,g=0,y=v.length;g<y;g++)e(v[g],n,r,i)}}(e,t,0,m.sortObjects),h.finish(),!0===m.sortObjects&&D()(h).call(h,z,N),!0===H&&le.beginShadows(),r=d.state.shadowsArray,be.render(r,e,t),d.setupLights(),d.setupLightsView(t),!0===H&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),ce.render(h,e,t,n),r=h.opaque,i=h.transparent,Le=!0,0<r.length&&Pe(r,e,t),0<i.length&&Pe(i,e,t),!0===e.isScene&&e.onAfterRender(m,e,t),null!==b&&($.updateRenderTargetMipmap(b),$.updateMultisampleRenderTarget(b)),J.buffers.depth.setTest(!0),J.buffers.depth.setMask(!0),J.buffers.color.setMask(!0),J.setPolygonOffset(!1),f.pop(),0<f.length&&(d=f[f.length-1]),p.pop(),h=0<p.length?p[p.length-1]:null)}),Ce=0;function Pe(e,t,n){var r=[];if(2e4<Ce+e.length){for(var i=0;i<e.length;i+=2e3)r.push(w()(e).call(e,i,i+2e3));if(0!==r.length){for(i=0;i<10;i++)i<r.length&&Re(r[i],t,n);Le=!1,function e(t,n,r,i){n<t.length&&(Le?console.log("",Le,t.length):V()((function(n){Re(t[n],r,i),e(t,++n,r,i)}),1,n))}(r,10,t,n)}}else Re(e,t,n)}function Re(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i];if(!(null!=o.group&&1==o.group.hide||null!=o.group&&0==o.group.visibility)){Ce++;var s=o.object,l=o.geometry,c=null===r?o.material:r,u=o.group;if(n.isArrayCamera)for(var h=n.cameras,p=0,f=h.length;p<f;p++){var m=h[p];s.layers.test(m.layers)&&(J.viewport(T.copy(m.viewport)),d.setupLightsView(m),Ie(s,t,m,l,c,u))}else Ie(s,t,n,l,c,u)}}}function Ie(e,t,n,r,i,a){var o,s;null!=e&&(e.onBeforeRender(m,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject?(o=De(n,t,i,e),J.setMaterial(i),fe.reset(),s=o,e.render((function(e){m.renderBufferImmediate(e,s)}))):m.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(m,t,n,r,i,a))}function ke(e,t,n){!0!==t.isScene&&(t=q);var r=K.get(e),i=d.state.lights,a=d.state.shadowsArray,o=i.state.version,s=(a=ie.getParameters(e,i.state,a,t,n),n=ie.getProgramCacheKey(a),r.program),l=!0;if(r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=ee.get(e.envMap||r.environment),void 0===s)e.addEventListener("dispose",Ee);else if(s.cacheKey!==n)Se(e);else{if(r.lightsStateVersion===o&&void 0!==a.shaderID)return;l=!1}l&&(a.uniforms=ie.getUniforms(e),e.onBeforeCompile(a,m),s=ie.acquireProgram(a,n),r.program=s,r.uniforms=a.uniforms,r.outputEncoding=a.outputEncoding),t=r.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=le.numPlanes,r.numIntersection=le.numIntersection,t.clippingPlanes=le.uniform),r.needsLights=(l=e).isMeshLambertMaterial||l.isMeshToonMaterial||l.isMeshPhongMaterial||l.isMeshStandardMaterial||l.isShadowMaterial||l.isShaderMaterial&&!0===l.lights,r.lightsStateVersion=o,r.needsLights&&(t.ambientLightColor.value=i.state.ambient,t.lightProbe.value=i.state.probe,t.directionalLights.value=i.state.directional,t.directionalLightShadows.value=i.state.directionalShadow,t.spotLights.value=i.state.spot,t.spotLightShadows.value=i.state.spotShadow,t.rectAreaLights.value=i.state.rectArea,t.ltc_1.value=i.state.rectAreaLTC1,t.ltc_2.value=i.state.rectAreaLTC2,t.pointLights.value=i.state.point,t.pointLightShadows.value=i.state.pointShadow,t.hemisphereLights.value=i.state.hemi,t.directionalShadowMap.value=i.state.directionalShadowMap,t.directionalShadowMatrix.value=i.state.directionalShadowMatrix,t.spotShadowMap.value=i.state.spotShadowMap,t.spotShadowMatrix.value=i.state.spotShadowMatrix,t.pointShadowMap.value=i.state.pointShadowMap,t.pointShadowMatrix.value=i.state.pointShadowMatrix),n=r.program.getUniforms(),s=Hs.seqWithValue(n.seq,t),r.uniformsList=s}function De(e,t,n,r){var i,a,o,s,l,c,u,h,p;if(null!=d)return!0!==t.isScene&&(t=q),$.resetTextureUnits(),i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,l=null===b?m.outputEncoding:b.texture.encoding,c=ee.get(n.envMap||o),a=K.get(n),s=d.state.lights,!0!==H||!0!==G&&e===S||(u=e===S&&n.id===E,le.setState(n,e,u)),n.version===a.__version?(n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version||void 0!==a.numClippingPlanes&&(a.numClippingPlanes!==le.numPlanes||a.numIntersection!==le.numIntersection)||a.outputEncoding!==l||a.envMap!==c)&&ke(n,t,r):(ke(n,t,r),a.__version=n.version),s=o=u=!1,c=(l=a.program).getUniforms(),t=a.uniforms,J.useProgram(l.program)&&(s=o=u=!0),n.id!==E&&(E=n.id,o=!0),(u||S!==e)&&(c.setValue(me,"projectionMatrix",e.projectionMatrix),Z.logarithmicDepthBuffer&&c.setValue(me,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),S!==e&&(S=e,s=o=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(u=L()(c).cameraPosition)&&u.setValue(me,j.setFromMatrixPosition(e.matrixWorld)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&c.setValue(me,"isOrthographic",!0===e.isOrthographicCamera),n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&c.setValue(me,"viewMatrix",e.matrixWorldInverse),n.skinning&&(c.setOptional(me,r,"bindMatrix"),c.setOptional(me,r,"bindMatrixInverse"),u=r.skeleton)&&(e=u.bones,Z.floatVertexTextures?(null===u.boneTexture&&(e=Math.sqrt(4*e.length),e=Ur.ceilPowerOfTwo(e),e=Math.max(e,4),(p=new Float32Array(e*e*4)).set(u.boneMatrices),h=new _o(p,e,e,Ot,Ct),u.boneMatrices=p,u.boneTexture=h,u.boneTextureSize=e),c.setValue(me,"boneTexture",u.boneTexture,$),c.setValue(me,"boneTextureSize",u.boneTextureSize)):c.setOptional(me,u,"boneMatrices")),!o&&a.receiveShadow===r.receiveShadow||(a.receiveShadow=r.receiveShadow,c.setValue(me,"receiveShadow",r.receiveShadow)),o&&(c.setValue(me,"toneMappingExposure",m.toneMappingExposure),a.needsLights&&(p=s,(h=t).ambientLightColor.needsUpdate=p,h.lightProbe.needsUpdate=p,h.directionalLights.needsUpdate=p,h.directionalLightShadows.needsUpdate=p,h.pointLights.needsUpdate=p,h.pointLightShadows.needsUpdate=p,h.spotLights.needsUpdate=p,h.spotLightShadows.needsUpdate=p,h.rectAreaLights.needsUpdate=p,h.hemisphereLights.needsUpdate=p),i&&n.fog&&ae.refreshFogUniforms(t,i),ae.refreshMaterialUniforms(t,n,I,R),Hs.upload(me,a.uniformsList,t,$)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Hs.upload(me,a.uniformsList,t,$),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&c.setValue(me,"center",r.center),c.setValue(me,"modelViewMatrix",r.modelViewMatrix),c.setValue(me,"normalMatrix",r.normalMatrix),c.setValue(me,"modelMatrix",r.matrixWorld),l}this.setFramebuffer=function(e){g!==e&&null===b&&me.bindFramebuffer(36160,e),g=e},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=(y=n,x=r,(b=e)&&void 0===K.get(e).__webglFramebuffer&&$.setupRenderTarget(e),g),a=!1,o=!1;C=e?(((t=e.texture).isDataTexture3D||t.isDataTexture2DArray)&&(o=!0),t=K.get(e).__webglFramebuffer,e.isWebGLCubeRenderTarget?(i=t[n],a=!0):i=e.isWebGLMultisampleRenderTarget?K.get(e).__webglMultisampledFramebuffer:t,T.copy(e.viewport),A.copy(e.scissor),e.scissorTest):(T.copy(O).multiplyScalar(I).floor(),A.copy(B).multiplyScalar(I).floor(),F),_!==i&&(me.bindFramebuffer(36160,i),_=i),J.viewport(T),J.scissor(A),J.setScissorTest(C),a?(t=K.get(e.texture),me.framebufferTexture2D(36160,36064,34069+n,t.__webglTexture,r)):o&&(i=K.get(e.texture),me.framebufferTextureLayer(36160,36064,i.__webglTexture,r||0,n||0))},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=K.get(e).__webglFramebuffer;if(s=e.isWebGLCubeRenderTarget&&void 0!==o?s[o]:s){o=!1,s!==_&&(me.bindFramebuffer(36160,s),o=!0);try{var l,c=e.texture,u=c.format,h=c.type;u!==Ot&&pe.convert(u)!==me.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):(l=h===Pt&&(Y.has("EXT_color_buffer_half_float")||Z.isWebGL2&&Y.has("EXT_color_buffer_float")),h===Mt||pe.convert(h)===me.getParameter(35738)||h===Ct&&(Z.isWebGL2||Y.has("OES_texture_float")||Y.has("WEBGL_color_buffer_float"))||l?36053===me.checkFramebufferStatus(36160)?0<=t&&t<=e.width-r&&0<=n&&n<=e.height-i&&me.readPixels(t,n,r,i,pe.convert(u),pe.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type."))}finally{o&&me.bindFramebuffer(36160,_)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=(r=Math.floor(t.image.height*r),pe.convert(t.format));$.setTexture2D(t,0),me.copyTexImage2D(3553,n,a,e.x,e.y,i,r,0),J.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=t.image.width,a=t.image.height,o=pe.convert(n.format),s=pe.convert(n.type);$.setTexture2D(n,0),me.pixelStorei(37440,n.flipY),me.pixelStorei(37441,n.premultiplyAlpha),me.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?me.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?me.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):me.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&me.generateMipmap(3553),J.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=(n=n.image).width,s=n.height,l=(n=n.data,pe.convert(r.format)),c=pe.convert(r.type);if(r.isDataTexture3D)$.setTexture3D(r,0),a=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");$.setTexture2DArray(r,0),a=35866}me.pixelStorei(37440,r.flipY),me.pixelStorei(37441,r.premultiplyAlpha),me.pixelStorei(3317,r.unpackAlignment);var u=me.getParameter(3314),h=me.getParameter(32878),d=me.getParameter(3316),p=me.getParameter(3315),f=me.getParameter(32877);me.pixelStorei(3314,o),me.pixelStorei(32878,s),me.pixelStorei(3316,e.min.x),me.pixelStorei(3315,e.min.y),me.pixelStorei(32877,e.min.z),me.texSubImage3D(a,i,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,l,c,n),me.pixelStorei(3314,u),me.pixelStorei(32878,h),me.pixelStorei(3316,d),me.pixelStorei(3315,p),me.pixelStorei(32877,f),0===i&&r.generateMipmaps&&me.generateMipmap(a),J.unbindTexture()}},this.initTexture=function(e){$.setTexture2D(e,0),J.unbindTexture()},this.resetState=function(){J.reset(),fe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Tl.prototype.isGroup=!0,g()(Al.prototype,{constructor:Al,getHandSpace:function(){return null===this._hand&&(this._hand=new Tl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Tl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Tl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(l&&e.hand){a=!0;var c,u=$(F()(m=e.hand).call(m));try{for(u.s();!(c=u.n()).done;){var h,d=c.value,p=t.getJointPose(d,n),f=(void 0===l.joints[d.jointName]&&((h=new Tl).matrixAutoUpdate=!1,h.visible=!1,l.joints[d.jointName]=h,l.add(h)),l.joints[d.jointName]);null!==p&&(f.matrix.fromArray(p.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.jointRadius=p.radius),f.visible=null!==p}}catch(e){u.e(e)}finally{u.f()}var m=l.joints["index-finger-tip"],v=l.joints["thumb-tip"];m=m.position.distanceTo(v.position);l.inputState.pinching&&.025<m?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&m<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}}),g()(Ll.prototype,zr.prototype);var Rl=function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Pl),Il=(Rl.prototype.isWebGL1Renderer=!0,function(){function e(t,n){f()(this,e),this.name="",this.color=new wa(t),this.density=void 0!==n?n:25e-5}return m()(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}()),kl=(Il.prototype.isFogExp2=!0,function(){function e(t,n,r){f()(this,e),this.name="",this.color=new wa(t),this.near=void 0!==n?n:1,this.far=void 0!==r?r:1e3}return m()(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}()),Dl=(kl.prototype.isFog=!0,function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:u()(e)})),e}return m()(n,[{key:"copy",value:function(e,t){return c()(p()(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=c()(p()(n.prototype),"toJSON",this).call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(Ji));function zl(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Er,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ur.generateUUID()}Dl.prototype.isScene=!0,b()(zl.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),g()(zl.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e){return this.array.set(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ur.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=w()(t=this.array).call(t,0).buffer);var t=new zl(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ur.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=w()(Array.prototype).call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Nl=new Qr;function Ol(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}S()(Ol.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),g()(Ol.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)Nl.x=this.getX(t),Nl.y=this.getY(t),Nl.z=this.getZ(t),Nl.applyMatrix4(e),this.setXYZ(t,Nl.x,Nl.y,Nl.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},clone:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ol(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return new Ea(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}});var Bl,Fl=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new wa(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=L()(e),this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(pa),Ul=(Fl.prototype.isSpriteMaterial=!0,new Qr),Hl=new Qr,Vl=new Qr,Gl=new Hr,Wl=new Hr,jl=new Si,ql=new Qr,Xl=new Qr,Yl=new Qr,Zl=new Hr,Jl=new Hr,Ql=new Hr,Kl=function(e){h()(n,e);var t=te(n);function n(e){var r,i;return f()(this,n),(r=t.call(this)).type="Sprite",void 0===Bl&&(Bl=new ja,i=new zl(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),Bl.setIndex([0,1,2,0,2,3]),Bl.setAttribute("position",new Ol(i,3,0,!1)),Bl.setAttribute("uv",new Ol(i,2,3,!1))),r.geometry=Bl,r.material=void 0!==e?e:new Fl,r.center=new Hr(.5,.5),r}return m()(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hl.setFromMatrixScale(this.matrixWorld),jl.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Vl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Hl.multiplyScalar(-Vl.z);var n,r,i=(0!==(i=this.material.rotation)&&(r=Math.cos(i),n=Math.sin(i)),this.center);$l(ql.set(-.5,-.5,0),Vl,i,Hl,n,r),$l(Xl.set(.5,-.5,0),Vl,i,Hl,n,r),$l(Yl.set(.5,.5,0),Vl,i,Hl,n,r),Zl.set(0,0),Jl.set(1,0),Ql.set(1,1),null===e.ray.intersectTriangle(ql,Xl,Yl,!1,Ul)&&($l(Xl.set(-.5,.5,0),Vl,i,Hl,n,r),Jl.set(0,1),null===e.ray.intersectTriangle(ql,Yl,Xl,!1,Ul))||(i=e.ray.origin.distanceTo(Ul))<e.near||i>e.far||t.push({distance:i,point:Ul.clone(),uv:ha.getUV(Ul,ql,Xl,Yl,Zl,Jl,Ql,new Hr),face:null,object:this})}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(Ji);function $l(e,t,n,r,i,a){Gl.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Wl.x=a*Gl.x-i*Gl.y,Wl.y=i*Gl.x+a*Gl.y):Wl.copy(Gl),e.copy(t),e.x+=Wl.x,e.y+=Wl.y,e.applyMatrix4(jl)}Kl.prototype.isSprite=!0;var ec=new Qr,tc=new Qr,nc=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",S()(u()(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return m()(n,[{key:"copy",value:function(e){c()(p()(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,i=t.length;r<i;r++){var a=t[r];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=(t=Math.abs(t),this.levels),r=0;r<n.length&&!(t<n[r].distance);r++);return x()(n).call(n,r,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(0<t.length){for(var n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){var n;0<this.levels.length&&(ec.setFromMatrixPosition(this.matrixWorld),n=e.ray.origin.distanceTo(ec),this.getObjectForDistance(n).raycast(e,t))}},{key:"update",value:function(e){var t=this.levels;if(1<t.length){ec.setFromMatrixPosition(e.matrixWorld),tc.setFromMatrixPosition(this.matrixWorld);var n,r,i=ec.distanceTo(tc)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){for(var t=c()(p()(n.prototype),"toJSON",this).call(this,e),r=(!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[],this.levels),i=0,a=r.length;i<a;i++){var o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(Ji),rc=new Qr,ic=new Xr,ac=new Xr,oc=new Qr,sc=new Si;function lc(e,t){co.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Si,this.bindMatrixInverse=new Si}function cc(){Ji.call(this),this.type="Bone"}lc.prototype=g()(T()(co.prototype),{constructor:lc,isSkinnedMesh:!0,copy:function(e){return co.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Xr,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!=1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){co.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;ic.fromBufferAttribute(r.attributes.skinIndex,e),ac.fromBufferAttribute(r.attributes.skinWeight,e),rc.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a,o=ac.getComponent(i);0!==o&&(a=ic.getComponent(i),sc.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(oc.copy(rc).applyMatrix4(sc),o))}return t.applyMatrix4(this.bindMatrixInverse)}}),cc.prototype=g()(T()(Ji.prototype),{constructor:cc,isBone:!0});var uc=new Si,hc=new Si,dc=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];f()(this,e),this.uuid=Ur.generateUUID(),this.bones=w()(t).call(t,0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return m()(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Si)}}},{key:"calculateInverses",value:function(){for(var e=this.boneInverses.length=0,t=this.bones.length;e<t;e++){var n=new Si;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:hc;uc.multiplyMatrices(o,t[i]),uc.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var i=e.bones[n],a=t[i];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),a=new cc),this.bones.push(a),this.boneInverses.push((new Si).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){for(var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]},t=(e.uuid=this.uuid,this.bones),n=this.boneInverses,r=0,i=t.length;r<i;r++){var a=t[r];a=(e.bones.push(a.uuid),n[r]);e.boneInverses.push(a.toArray())}return e}}]),e}(),pc=new Si,fc=new Si,mc=[],vc=new co;function gc(e,t,n){co.call(this,e,t),this.instanceMatrix=new Ea(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}gc.prototype=g()(T()(co.prototype),{constructor:gc,isInstancedMesh:!0,copy:function(e){return co.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(vc.geometry=this.geometry,vc.material=this.material,void 0!==vc.material)for(var i=0;i<r;i++){this.getMatrixAt(i,pc),fc.multiplyMatrices(n,pc),vc.matrixWorld=fc,vc.raycast(e,mc);for(var a=0,o=mc.length;a<o;a++){var s=mc[a];s.instanceId=i,s.object=this,t.push(s)}mc.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new Ea(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var yc=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new wa(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.morphTargets=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}]),n}(pa),xc=(yc.prototype.isLineBasicMaterial=!0,new Qr),wc=new Qr,bc=new Si,_c=new Ei,Mc=new vi;function Ec(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ja,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new yc;Ji.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}Ec.prototype=g()(T()(Ji.prototype),{constructor:Ec,isLine:!0,copy:function(e){return Ji.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)xc.fromBufferAttribute(t,r-1),wc.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=xc.distanceTo(wc);e.setAttribute("lineDistance",new ka(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Mc.copy(n.boundingSphere),Mc.applyMatrix4(r),Mc.radius+=i,!1!==e.ray.intersectsSphere(Mc)){bc.copy(r).invert(),_c.copy(e.ray).applyMatrix4(bc);var a=(r=i/((this.scale.x+this.scale.y+this.scale.z)/3))*r,o=new Qr,s=new Qr,l=new Qr,c=new Qr,u=this.isLineSegments?2:1;if(n.isBufferGeometry){i=n.index;var h=n.attributes.position;if(null!==i)for(var d=i.array,p=0,f=d.length-1;p<f;p+=u){var m=d[p],v=d[p+1];o.fromBufferAttribute(h,m),s.fromBufferAttribute(h,v),a<_c.distanceSqToSegment(o,s,c,l)||(c.applyMatrix4(this.matrixWorld),(m=e.ray.origin.distanceTo(c))<e.near)||m>e.far||t.push({distance:m,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}else for(var g,y=0,x=h.count-1;y<x;y+=u)o.fromBufferAttribute(h,y),s.fromBufferAttribute(h,y+1),a<_c.distanceSqToSegment(o,s,c,l)||(c.applyMatrix4(this.matrixWorld),(g=e.ray.origin.distanceTo(c))<e.near)||g>e.far||t.push({distance:g,point:l.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=R()(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Sc=new Qr,Tc=new Qr;function Ac(e,t){Ec.call(this,e,t),this.type="LineSegments"}Ac.prototype=g()(T()(Ec.prototype),{constructor:Ac,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Sc.fromBufferAttribute(t,r),Tc.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Sc.distanceTo(Tc);e.setAttribute("lineDistance",new ka(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var Lc=function(e){h()(n,e);var t=te(n);function n(e,r){return f()(this,n),(e=t.call(this,e,r)).type="LineLoop",e}return m()(n)}(Ec),Cc=(Lc.prototype.isLineLoop=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new wa(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.morphTargets=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=L()(e),this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}]),n}(pa)),Pc=(Cc.prototype.isPointsMaterial=!0,new Si),Rc=new Ei,Ic=new vi,kc=new Qr;function Dc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ja,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Cc;Ji.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function zc(e,t,n,r,i,a,o){var s=Rc.distanceSqToPoint(e);s<n&&(n=new Qr,Rc.closestPointToPoint(e,n),n.applyMatrix4(r),(e=i.ray.origin.distanceTo(n))<i.near||e>i.far||a.push({distance:e,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:o}))}Dc.prototype=g()(T()(Ji.prototype),{constructor:Dc,isPoints:!0,copy:function(e){return Ji.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ic.copy(n.boundingSphere),Ic.applyMatrix4(r),Ic.radius+=i,!1!==e.ray.intersectsSphere(Ic)){Pc.copy(r).invert(),Rc.copy(e.ray).applyMatrix4(Pc);var a=(i=i/((this.scale.x+this.scale.y+this.scale.z)/3))*i;if(n.isBufferGeometry){i=n.index;var o=n.attributes.position;if(null!==i)for(var s=i.array,l=0,c=s.length;l<c;l++){var u=s[l];kc.fromBufferAttribute(o,u),zc(kc,u,a,r,e,t,this)}else for(var h=0,d=o.count;h<d;h++)kc.fromBufferAttribute(o,h),zc(kc,h,a,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=R()(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Nc=function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,h){f()(this,n),(r=t.call(this,e,r,i,a,o,s,l,c,h)).format=void 0!==l?l:Nt,r.minFilter=void 0!==s?s:yt,r.magFilter=void 0!==o?o:yt,r.generateMipmaps=!1;var d=u()(r);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){d.needsUpdate=!0,e.requestVideoFrameCallback(t)})),r}return m()(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;0=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(jr),Oc=(Nc.prototype.isVideoTexture=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,u,h,d,p){return f()(this,n),(s=t.call(this,null,s,l,c,u,h,a,o,d,p)).image={width:r,height:i},s.mipmaps=e,s.flipY=!1,s.generateMipmaps=!1,s}return m()(n)}(jr)),Bc=(Oc.prototype.isCompressedTexture=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,u){return f()(this,n),(e=t.call(this,e,r,i,a,o,s,l,c,u)).needsUpdate=!0,e}return m()(n)}(jr)),Fc=(Bc.prototype.isCanvasTexture=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s,l,c,u,h){if(f()(this,n),(h=void 0!==h?h:Ht)!==Ht&&h!==Vt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return(a=t.call(this,null,a,o,s,l,c,h,i=void 0===(i=void 0===i&&h===Ht?Tt:i)&&h===Vt?Dt:i,u)).image={width:e,height:r},a.magFilter=void 0!==l?l:pt,a.minFilter=void 0!==c?c:pt,a.flipY=!1,a.generateMipmaps=!1,a}return m()(n)}(jr)),Uc=(Fc.prototype.isDepthTexture=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2*Math.PI,s=(f()(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:i,thetaStart:a,thetaLength:o},i=Math.max(3,i),[]),l=[],c=[],u=[],h=new Qr,d=new Hr;l.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(var p=0,m=3;p<=i;p++,m+=3){var v=a+p/i*o;h.x=r*Math.cos(v),h.y=r*Math.sin(v),l.push(h.x,h.y,h.z),c.push(0,0,1),d.x=(l[m]/r+1)/2,d.y=(l[m+1]/r+1)/2,u.push(d.x,d.y)}for(var g=1;g<=i;g++)s.push(g,g+1,0);return e.setIndex(s),e.setAttribute("position",new ka(l,3)),e.setAttribute("normal",new ka(c,3)),e.setAttribute("uv",new ka(u,2)),e}return m()(n)}(ja)),Hc=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,l=5<arguments.length&&void 0!==arguments[5]&&arguments[5],c=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:2*Math.PI,d=(f()(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:i,height:a,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:c,thetaLength:h},u()(e)),p=(o=Math.floor(o),s=Math.floor(s),[]),m=[],v=[],g=[],y=0,x=[],w=a/2,b=0,_=new Qr,M=new Qr,E=0,S=(i-r)/a,T=0;T<=s;T++){for(var A=[],L=T/s,C=L*(i-r)+r,P=0;P<=o;P++){var R=P/o,I=R*h+c,k=Math.sin(I);I=Math.cos(I);M.x=C*k,M.y=-L*a+w,M.z=C*I,m.push(M.x,M.y,M.z),_.set(k,S,I).normalize(),v.push(_.x,_.y,_.z),g.push(R,1-L),A.push(y++)}x.push(A)}for(var D=0;D<o;D++)for(var z=0;z<s;z++){var N=x[z][D],O=x[z+1][D],B=x[z+1][D+1],F=x[z][D+1];p.push(N,O,F),p.push(O,B,F),E+=6}function U(e){for(var t=y,n=new Hr,a=new Qr,s=0,l=!0===e?r:i,u=!0===e?1:-1,f=1;f<=o;f++)m.push(0,w*u,0),v.push(0,u,0),g.push(.5,.5),y++;for(var x=y,_=0;_<=o;_++){var M=_/o*h+c,E=Math.cos(M);M=Math.sin(M);a.x=l*M,a.y=w*u,a.z=l*E,m.push(a.x,a.y,a.z),v.push(0,u,0),n.x=.5*E+.5,n.y=.5*M*u+.5,g.push(n.x,n.y),y++}for(var S=0;S<o;S++){var T=t+S,A=x+S;!0===e?p.push(A,A+1,T):p.push(A+1,A,T),s+=3}d.addGroup(b,s,!0===e?1:2),b+=s}return d.addGroup(b,E,0),b+=E,!1===l&&(0<r&&U(!0),0<i)&&U(!1),e.setIndex(p),e.setAttribute("position",new ka(m,3)),e.setAttribute("normal",new ka(v,3)),e.setAttribute("uv",new ka(g,2)),e}return m()(n)}(ja),Vc=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,c=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return f()(this,n),(e=t.call(this,0,r,i,a,o,s,l,c)).type="ConeGeometry",e.parameters={radius:r,height:i,radialSegments:a,heightSegments:o,openEnded:s,thetaStart:l,thetaLength:c},e}return m()(n)}(Hc),Gc=function(e){h()(n,e);var t=te(n);function n(e,r){for(var i,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=(f()(this,n),(i=t.call(this)).type="PolyhedronGeometry",i.parameters={vertices:e,indices:r,radius:a,detail:o},[]),l=[],c=o,u=new Qr,h=new Qr,d=new Qr,p=0;p<r.length;p+=3){ee(r[p+0],u),ee(r[p+1],h),ee(r[p+2],d),C=L=A=T=S=E=M=_=b=x=y=g=v=m=void 0;for(var m=u,v=h,g=d,y=c,x=y+1,b=[],_=0;_<=x;_++){b[_]=[];for(var M=m.clone().lerp(g,_/x),E=v.clone().lerp(g,_/x),S=x-_,T=0;T<=S;T++)b[_][T]=0===T&&_===x?M:M.clone().lerp(E,T/S)}for(var A=0;A<x;A++)for(var L=0;L<2*(x-A)-1;L++){var C=Math.floor(L/2);L%2==0?($(b[A][C+1]),$(b[A+1][C]),$(b[A][C])):($(b[A][C+1]),$(b[A+1][C+1]),$(b[A+1][C]))}}for(var P=a,R=new Qr,I=0;I<s.length;I+=3)R.x=s[I+0],R.y=s[I+1],R.z=s[I+2],R.normalize().multiplyScalar(P),s[I+0]=R.x,s[I+1]=R.y,s[I+2]=R.z;for(var k=new Qr,D=0;D<s.length;D+=3){k.x=s[D+0],k.y=s[D+1],k.z=s[D+2];var z=ne(k)/2/Math.PI+.5,N=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(k)/Math.PI+.5;l.push(z,1-N)}for(var O=new Qr,B=new Qr,F=new Qr,U=new Qr,H=new Hr,V=new Hr,G=new Hr,W=0,j=0;W<s.length;W+=9,j+=6){O.set(s[W+0],s[W+1],s[W+2]),B.set(s[W+3],s[W+4],s[W+5]),F.set(s[W+6],s[W+7],s[W+8]),H.set(l[j+0],l[j+1]),V.set(l[j+2],l[j+3]),G.set(l[j+4],l[j+5]),U.copy(O).add(B).add(F).divideScalar(3);var q=ne(U);te(H,j+0,O,q),te(V,j+2,B,q),te(G,j+4,F,q)}for(var X=0;X<l.length;X+=6){var Y=l[X+0],Z=l[X+2],J=l[X+4],Q=Math.max(Y,Z,J),K=Math.min(Y,Z,J);.9<Q&&K<.1&&(Y<.2&&(l[X+0]+=1),Z<.2&&(l[X+2]+=1),J<.2)&&(l[X+4]+=1)}function $(e){s.push(e.x,e.y,e.z)}function ee(t,n){t*=3,n.x=e[0+t],n.y=e[1+t],n.z=e[2+t]}function te(e,t,n,r){r<0&&1===e.x&&(l[t]=e.x-1),0===n.x&&0===n.z&&(l[t]=r/2/Math.PI+.5)}function ne(e){return Math.atan2(e.z,-e.x)}return i.setAttribute("position",new ka(s,3)),i.setAttribute("normal",new ka(w()(s).call(s),3)),i.setAttribute("uv",new ka(l,2)),0===o?i.computeVertexNormals():i.normalizeNormals(),i}return m()(n)}(ja),Wc=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=1/(e=(f()(this,n),(1+Math.sqrt(5))/2));return(e=t.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-e,0,-a,e,0,a,-e,0,a,e,-a,-e,0,-a,e,0,a,-e,0,a,e,0,-e,0,-a,e,0,-a,-e,0,a,e,0,a],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],r,i)).type="DodecahedronGeometry",e.parameters={radius:r,detail:i},e}return m()(n)}(Gc),jc=new Qr,qc=new Qr,Xc=new Qr,Yc=new ha,Zc=function(e){h()(n,e);var t=te(n);function n(e,r){var i;if(f()(this,n),(i=t.call(this)).type="EdgesGeometry",i.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),d()(i);for(var a,o,s,l=Math.pow(10,4),c=Math.cos(Ur.DEG2RAD*r),u=e.getIndex(),h=e.getAttribute("position"),p=(u||h).count,m=[0,0,0],v=["a","b","c"],g=new Array(3),y={},x=[],w=0;w<p;w+=3){u?(m[0]=u.getX(w),m[1]=u.getX(w+1),m[2]=u.getX(w+2)):(m[0]=w,m[1]=w+1,m[2]=w+2);var b,_=Yc.a,M=Yc.b,E=Yc.c;if(_.fromBufferAttribute(h,m[0]),M.fromBufferAttribute(h,m[1]),E.fromBufferAttribute(h,m[2]),Yc.getNormal(Xc),g[0]=G()(b=G()(b="".concat(Math.round(_.x*l),",")).call(b,Math.round(_.y*l),",")).call(b,Math.round(_.z*l)),g[1]=G()(_=G()(b="".concat(Math.round(M.x*l),",")).call(b,Math.round(M.y*l),",")).call(_,Math.round(M.z*l)),g[2]=G()(_=G()(b="".concat(Math.round(E.x*l),",")).call(b,Math.round(E.y*l),",")).call(_,Math.round(E.z*l)),g[0]!==g[1]&&g[1]!==g[2]&&g[2]!==g[0])for(var S=0;S<3;S++){var T=(S+1)%3,A=g[S],L=g[T],C=Yc[v[S]],P=Yc[v[T]],R=G()(R="".concat(A,"_")).call(R,L);(L=G()(L="".concat(L,"_")).call(L,A))in y&&y[L]?(Xc.dot(y[L].normal)<=c&&(x.push(C.x,C.y,C.z),x.push(P.x,P.y,P.z)),y[L]=null):R in y||(y[R]={index0:m[S],index1:m[T],normal:Xc.clone()})}}for(a in y)y[a]&&(o=(s=y[a]).index0,s=s.index1,jc.fromBufferAttribute(h,o),qc.fromBufferAttribute(h,s),x.push(jc.x,jc.y,jc.z),x.push(qc.x,qc.y,qc.z));return i.setAttribute("position",new ka(x,3)),i}return m()(n)}(ja),Jc=function(e,t,n){n=n||2;var r,i,a,o,s,l=t&&t.length,c=l?t[0]*n:e.length,u=Qc(e,0,c,n,!0),h=[];if(u&&u.next!==u.prev){if(l&&(u=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Qc(e,o=t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(function(e){for(var t=e,n=e;(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),(t=t.next)!==e;);return n}(o));for(D()(s).call(s,$c),i=0;i<s.length;i++)!function(e,t){(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&o<s){if((o=s)===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}}while((r=r.next)!==t);if(!n)return null;if(i!==o){var l,c=n,u=n.x,h=n.y,d=1/0;for(r=n;i>=r.x&&r.x>=u&&i!==r.x&&tu(a<h?i:o,a,u,h,a<h?o:i,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(i-r.x),su(r,e))&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&function(e,t){return nu(e.prev,e,t.prev)<0&&nu(t.next,e,e.next)<0}(n,r)))&&(n=r,d=l),(r=r.next)!==c;);}return n}(e,t))&&(e=lu(t,e),Kc(t,t.next),Kc(e,e.next))}(s[i],n),n=Kc(n,n.next);return n}(e,t,u,n)),e.length>80*n){for(var d=r=e[0],p=i=e[1],f=n;f<c;f+=n)(a=e[f])<d&&(d=a),(o=e[f+1])<p&&(p=o),r<a&&(r=a),i<o&&(i=o);s=0!==(s=Math.max(r-d,i-p))?1/s:0}!function e(t,n,r,i,a,o,s){if(t){if(!s&&o){for(var l=t,c=i,u=a,h=o,d=l;null===d.z&&(d.z=eu(d.x,d.y,c,u,h)),d.prevZ=d.prev,d.nextZ=d.next,(d=d.next)!==l;);d.prevZ.nextZ=null,d.prevZ=null;var p,f,m,v,g,y,x,w,b=d,_=1;do{for(f=b,g=b=null,y=0;f;){for(y++,m=f,p=x=0;p<_&&(x++,m=m.nextZ);p++);for(w=_;0<x||0<w&&m;)0!==x&&(0===w||!m||f.z<=m.z)?(f=(v=f).nextZ,x--):(m=(v=m).nextZ,w--),g?g.nextZ=v:b=v,v.prevZ=g,g=v;f=m}}while(g.nextZ=null,_*=2,1<y)}for(var M,E,S=t;t.prev!==t.next;)if(M=t.prev,E=t.next,o?function(e,t,n,r){var i=e.prev,a=e,o=e.next;if(!(0<=nu(i,a,o))){for(var s=(i.x<a.x?i.x<o.x?i:o:a.x<o.x?a:o).x,l=(i.y<a.y?i.y<o.y?i:o:a.y<o.y?a:o).y,c=(i.x>a.x?i.x>o.x?i:o:a.x>o.x?a:o).x,u=(i.y>a.y?i.y>o.y?i:o:a.y>o.y?a:o).y,h=eu(s,l,t,n,r),d=eu(c,u,t,n,r),p=e.prevZ,f=e.nextZ;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&tu(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=nu(p.prev,p,p.next))return;if(p=p.prevZ,f!==e.prev&&f!==e.next&&tu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=nu(f.prev,f,f.next))return;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&tu(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=nu(p.prev,p,p.next))return;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&tu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=nu(f.prev,f,f.next))return;f=f.nextZ}return 1}}(t,i,a,o):function(e){var t=e.prev,n=e,r=e.next;if(!(0<=nu(t,n,r))){for(var i=e.next.next;i!==e.prev;){if(tu(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=nu(i.prev,i,i.next))return;i=i.next}return 1}}(t))n.push(M.i/r),n.push(t.i/r),n.push(E.i/r),uu(t),t=E.next,S=E.next;else if((t=E)===S){s?1===s?e(t=function(e,t,n){var r=e;do{var i=r.prev,a=r.next.next}while(!ru(i,a)&&iu(i,r,r.next,a)&&su(i,a)&&su(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),uu(r),uu(r.next),r=e=a),(r=r.next)!==e);return Kc(r)}(Kc(t),n,r),n,r,i,a,o,2):2===s&&function(t,n,r,i,a,o){var s=t;do{for(var l,c=s.next.next;c!==s.prev;){if(s.i!==c.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&iu(n,n.next,e,t))return 1}while((n=n.next)!==e)}(e,t)&&(su(e,t)&&su(t,e)&&function(e,t){for(var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),(n=n.next)!==e;);return r}(e,t)&&(nu(e.prev,e,t.prev)||nu(e,t.prev,t))||ru(e,t)&&0<nu(e.prev,e,e.next)&&0<nu(t.prev,t,t.next))}(s,c))return l=lu(s,c),s=Kc(s,s.next),l=Kc(l,l.next),e(s,n,r,i,a,o),e(l,n,r,i,a,o);c=c.next}}while((s=s.next)!==t)}(t,n,r,i,a,o):e(Kc(t),n,r,i,a,o,1);break}}}(u,h,n,d,p,s)}return h};function Qc(e,t,n,r,i){var a,o;if(i===0<function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r))for(a=t;a<n;a+=r)o=cu(a,e[a],e[a+1],o);else for(a=n-r;t<=a;a-=r)o=cu(a,e[a],e[a+1],o);return o&&ru(o,o.next)&&(uu(o),o=o.next),o}function Kc(e,t){if(!e)return e;t=t||e;var n,r=e;do{if(n=!1,r.steiner||!ru(r,r.next)&&0!==nu(r.prev,r,r.next))r=r.next;else{if(uu(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function $c(e,t){return e.x-t.x}function eu(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function tu(e,t,n,r,i,a,o,s){return 0<=(i-o)*(t-s)-(e-o)*(a-s)&&0<=(e-o)*(r-s)-(n-o)*(t-s)&&0<=(n-o)*(a-s)-(i-o)*(r-s)}function nu(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function ru(e,t){return e.x===t.x&&e.y===t.y}function iu(e,t,n,r){var i=ou(nu(e,t,n)),a=ou(nu(e,t,r)),o=ou(nu(n,r,e)),s=ou(nu(n,r,t));return i!==a&&o!==s||0===i&&au(e,n,t)||0===a&&au(e,r,t)||0===o&&au(n,e,r)||!(0!==s||!au(n,t,r))}function au(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function ou(e){return 0<e?1:e<0?-1:0}function su(e,t){return nu(e.prev,e,e.next)<0?0<=nu(e,t,e.next)&&0<=nu(e,e.prev,t):nu(e,t,e.prev)<0||nu(e,e.next,t)<0}function lu(e,t){var n=new hu(e.i,e.x,e.y),r=new hu(t.i,t.x,t.y),i=e.next,a=t.prev;return(e.next=t).prev=e,(n.next=i).prev=n,(r.next=n).prev=r,(a.next=r).prev=a,r}function cu(e,t,n,r){return e=new hu(e,t,n),r?(e.next=r.next,(e.prev=r).next.prev=e,r.next=e):(e.prev=e).next=e,e}function uu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function hu(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var du={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return du.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[],a=(pu(e),fu(n,e),e.length);H()(t).call(t,pu);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,fu(n,t[o]);for(var s=Jc(n,r),l=0;l<s.length;l+=3)i.push(w()(s).call(s,l,l+3));return i}};function pu(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function fu(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var mu=function(e){h()(n,e);var t=te(n);function n(e,r){f()(this,n),(i=t.call(this)).type="ExtrudeGeometry",i.parameters={shapes:e,options:r},e=M()(e)?e:[e];for(var i,a=u()(i),o=[],s=[],l=0,c=e.length;l<c;l++)!function(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,i=void 0!==r.steps?r.steps:1,l=void 0!==r.depth?r.depth:100,c=void 0===r.bevelEnabled||r.bevelEnabled,u=void 0!==r.bevelThickness?r.bevelThickness:6,h=void 0!==r.bevelSize?r.bevelSize:u-2,d=void 0!==r.bevelOffset?r.bevelOffset:0,p=void 0!==r.bevelSegments?r.bevelSegments:3,f=r.extrudePath,m=void 0!==r.UVGenerator?r.UVGenerator:vu;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=r.amount);var v,g,y,x,w,b=!1;f&&(v=f.getSpacedPoints(i),c=!(b=!0),g=f.computeFrenetFrames(i,!1),y=new Qr,x=new Qr,w=new Qr),c||(d=h=u=p=0);var _=(f=e.extractPoints(n)).shape,M=f.holes;if(!du.isClockWise(_)){_=W()(_).call(_);for(var S=0,T=M.length;S<T;S++){var A=M[S];du.isClockWise(A)&&(M[S]=W()(A).call(A))}}for(var L=du.triangulateShape(_,M),C=_,P=0,R=M.length;P<R;P++){var I=M[P];_=G()(_).call(_,I)}function k(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var D=_.length,z=L.length;function N(e,t,n){var r=e.x-t.x,i=e.y-t.y,a=n.x-e.x,o=n.y-e.y,s=r*r+i*i;if(Math.abs(r*o-i*a)>E.a){var l=Math.sqrt(s),c=Math.sqrt(a*a+o*o),u=t.x-i/l;t=t.y+r/l;if((n=(c=u+r*(l=((n.x-o/c-u)*o-(n.y+a/c-t)*a)/(r*o-i*a))-e.x)*c+(u=t+i*l-e.y)*u)<=2)return new Hr(c,u);l=Math.sqrt(n/2)}else t=!1,r>E.a?a>E.a&&(t=!0):r<-E.a?a<-E.a&&(t=!0):j()(i)===j()(o)&&(t=!0),l=t?(c=-i,u=r,Math.sqrt(s)):(c=r,u=i,Math.sqrt(s/2));return new Hr(c/l,u/l)}for(var O=[],B=0,F=C.length,U=F-1,H=B+1;B<F;B++,U++,H++)U===F&&(U=0),H===F&&(H=0),O[B]=N(C[B],C[U],C[H]);for(var V,q=[],X=G()(O).call(O),Y=0,Z=M.length;Y<Z;Y++){var J=M[Y];V=[];for(var Q=0,K=J.length,$=K-1,ee=Q+1;Q<K;Q++,$++,ee++)$===K&&($=0),ee===K&&(ee=0),V[Q]=N(J[Q],J[$],J[ee]);q.push(V),X=G()(X).call(X,V)}for(var te=0;te<p;te++){for(var ne=te/p,re=u*Math.cos(ne*Math.PI/2),ie=h*Math.sin(ne*Math.PI/2)+d,ae=0,oe=C.length;ae<oe;ae++){var se=k(C[ae],O[ae],ie);De(se.x,se.y,-re)}for(var le=0,ce=M.length;le<ce;le++){var ue=M[le];V=q[le];for(var he=0,de=ue.length;he<de;he++){var pe=k(ue[he],V[he],ie);De(pe.x,pe.y,-re)}}}for(var fe=h+d,me=0;me<D;me++){var ve=c?k(_[me],X[me],fe):_[me];b?(x.copy(g.normals[0]).multiplyScalar(ve.x),y.copy(g.binormals[0]).multiplyScalar(ve.y),w.copy(v[0]).add(x).add(y),De(w.x,w.y,w.z)):De(ve.x,ve.y,0)}for(var ge=1;ge<=i;ge++)for(var ye=0;ye<D;ye++){var xe=c?k(_[ye],X[ye],fe):_[ye];b?(x.copy(g.normals[ge]).multiplyScalar(xe.x),y.copy(g.binormals[ge]).multiplyScalar(xe.y),w.copy(v[ge]).add(x).add(y),De(w.x,w.y,w.z)):De(xe.x,xe.y,l/i*ge)}for(var we=p-1;0<=we;we--){for(var be=we/p,_e=u*Math.cos(be*Math.PI/2),Me=h*Math.sin(be*Math.PI/2)+d,Ee=0,Se=C.length;Ee<Se;Ee++){var Te=k(C[Ee],O[Ee],Me);De(Te.x,Te.y,l+_e)}for(var Ae=0,Le=M.length;Ae<Le;Ae++){var Ce=M[Ae];V=q[Ae];for(var Pe=0,Re=Ce.length;Pe<Re;Pe++){var Ie=k(Ce[Pe],V[Pe],Me);b?De(Ie.x,Ie.y+v[i-1].y,v[i-1].x+_e):De(Ie.x,Ie.y,l+_e)}}}function ke(e,t){for(var n=e.length;0<=--n;){var r=n,s=n-1;s<0&&(s=e.length-1);for(var l=0,c=i+2*p;l<c;l++){var u=D*l,h=D*(l+1),d=(f=d=void 0,t+r+u),f=t+s+u,v=t+s+h,g=t+r+h;Ne(d),Ne(f),Ne(g),Ne(f),Ne(v),Ne(g),d=o.length/3,Oe((f=m.generateSideWallUV(a,o,d-6,d-3,d-2,d-1))[0]),Oe(f[1]),Oe(f[3]),Oe(f[1]),Oe(f[2]),Oe(f[3])}}}function De(e,n,r){t.push(e),t.push(n),t.push(r)}function ze(e,t,n){Ne(e),Ne(t),Ne(n),e=o.length/3,Oe((t=m.generateTopUV(a,o,e-3,e-2,e-1))[0]),Oe(t[1]),Oe(t[2])}function Ne(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Oe(e){s.push(e.x),s.push(e.y)}(function(){var e=o.length/3;if(c){for(var t=0*D,n=0;n<z;n++){var r=L[n];ze(r[2]+t,r[1]+t,r[0]+t)}t=D*(i+2*p);for(var s=0;s<z;s++){var l=L[s];ze(l[0]+t,l[1]+t,l[2]+t)}}else{for(var u=0;u<z;u++){var h=L[u];ze(h[2],h[1],h[0])}for(var d=0;d<z;d++){var f=L[d];ze(f[0]+D*i,f[1]+D*i,f[2]+D*i)}}a.addGroup(e,o.length/3-e,0)})(),function(){var e=o.length/3,t=0;ke(C,t),t+=C.length;for(var n=0,r=M.length;n<r;n++){var i=M[n];ke(i,t),t+=i.length}a.addGroup(e,o.length/3-e,1)}()}(e[l]);return i.setAttribute("position",new ka(o,3)),i.setAttribute("uv",new ka(s,2)),i.computeVertexNormals(),i}return m()(n,[{key:"toJSON",value:function(){var e=ja.prototype.toJSON.call(this),t=n=this.parameters.shapes,n=this.parameters.options,r=e;if(r.shapes=[],M()(t))for(var i=0,a=t.length;i<a;i++){var o=t[i];r.shapes.push(o.uuid)}else r.shapes.push(t.uuid);return void 0!==n.extrudePath&&(r.options.extrudePath=n.extrudePath.toJSON()),r}}]),n}(ja),vu={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=(n=t[3*n+1],t[3*r]),s=(r=t[3*r+1],t[3*i]);t=t[3*i+1];return[new Hr(a,n),new Hr(o,r),new Hr(s,t)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=(n=t[3*n+2],t[3*r]),c=t[3*r+1],u=(r=t[3*r+2],t[3*i]),h=t[3*i+1],d=(i=t[3*i+2],t[3*a]),p=t[3*a+1];t=t[3*a+2];return Math.abs(s-c)<.01?[new Hr(o,1-n),new Hr(l,1-r),new Hr(u,1-i),new Hr(d,1-t)]:[new Hr(s,1-n),new Hr(c,1-r),new Hr(h,1-i),new Hr(p,1-t)]}},gu=function(e){h()(n,e);var t=te(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=(f()(this,n),(1+Math.sqrt(5))/2);return(i=t.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,r)).type="IcosahedronGeometry",i.parameters={radius:e,detail:r},i}return m()(n)}(Gc),yu=function(e){h()(n,e);var t=te(n);function n(e){for(var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:2*Math.PI,s=(f()(this,n),(r=t.call(this)).type="LatheGeometry",r.parameters={points:e,segments:i,phiStart:a,phiLength:o},i=Math.floor(i),o=Ur.clamp(o,0,2*Math.PI),[]),l=[],c=[],u=1/i,h=new Qr,d=new Hr,p=0;p<=i;p++)for(var m=a+p*u*o,v=Math.sin(m),g=Math.cos(m),y=0;y<=e.length-1;y++)h.x=e[y].x*v,h.y=e[y].y,h.z=e[y].x*g,l.push(h.x,h.y,h.z),d.x=p/i,d.y=y/(e.length-1),c.push(d.x,d.y);for(var x=0;x<i;x++)for(var w=0;w<e.length-1;w++){var b=w+x*e.length,_=b+e.length,M=b+e.length+1,E=b+1;s.push(b,_,E),s.push(_,M,E)}if(r.setIndex(s),r.setAttribute("position",new ka(l,3)),r.setAttribute("uv",new ka(c,2)),r.computeVertexNormals(),o===2*Math.PI)for(var S=r.attributes.normal.array,T=new Qr,A=new Qr,L=new Qr,C=i*e.length*3,P=0,R=0;P<e.length;P++,R+=3)T.x=S[R+0],T.y=S[R+1],T.z=S[R+2],A.x=S[C+R+0],A.y=S[C+R+1],A.z=S[C+R+2],L.addVectors(T,A).normalize(),S[R+0]=S[C+R+0]=L.x,S[R+1]=S[C+R+1]=L.y,S[R+2]=S[C+R+2]=L.z;return r}return m()(n)}(ja),xu=function(e){h()(n,e);var t=te(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=(f()(this,n),t.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,r));return i.type="OctahedronGeometry",i.parameters={radius:e,detail:r},i}return m()(n)}(Gc);function wu(e,t,n){ja.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};for(var r=[],i=[],a=[],o=[],s=new Qr,l=new Qr,c=new Qr,u=new Qr,h=new Qr,d=(e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter."),t+1),p=0;p<=n;p++)for(var f=p/n,m=0;m<=t;m++){var v=m/t;e(v,f,l),i.push(l.x,l.y,l.z),0<=v-1e-5?(e(v-1e-5,f,c),u.subVectors(l,c)):(e(1e-5+v,f,c),u.subVectors(c,l)),0<=f-1e-5?(e(v,f-1e-5,c),h.subVectors(l,c)):(e(v,1e-5+f,c),h.subVectors(c,l)),s.crossVectors(u,h).normalize(),a.push(s.x,s.y,s.z),o.push(v,f)}for(var g=0;g<n;g++)for(var y=0;y<t;y++){var x=g*d+y+1,w=(g+1)*d+y+1,b=(g+1)*d+y;r.push(g*d+y,x,b),r.push(x,w,b)}this.setIndex(r),this.setAttribute("position",new ka(i,3)),this.setAttribute("normal",new ka(a,3)),this.setAttribute("uv",new ka(o,2))}(wu.prototype=T()(ja.prototype)).constructor=wu;var bu=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2*Math.PI,c=(f()(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:i,thetaSegments:a,phiSegments:o,thetaStart:s,thetaLength:l},a=Math.max(3,a),[]),u=[],h=[],d=[],p=r,m=(i-r)/(o=Math.max(1,o)),v=new Qr,g=new Hr,y=0;y<=o;y++){for(var x=0;x<=a;x++){var w=s+x/a*l;v.x=p*Math.cos(w),v.y=p*Math.sin(w),u.push(v.x,v.y,v.z),h.push(0,0,1),g.x=(v.x/i+1)/2,g.y=(v.y/i+1)/2,d.push(g.x,g.y)}p+=m}for(var b=0;b<o;b++)for(var _=b*(a+1),M=0;M<a;M++){var E=M+_,S=E+a+1,T=E+a+2,A=E+1;c.push(E,S,A),c.push(S,T,A)}return e.setIndex(c),e.setAttribute("position",new ka(u,3)),e.setAttribute("normal",new ka(h,3)),e.setAttribute("uv",new ka(d,2)),e}return m()(n)}(ja),_u=function(e){h()(n,e);var t=te(n);function n(e){var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:12,a=(f()(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:i},[]),o=[],s=[],l=[],c=0,u=0;if(!1===M()(e))d(e);else for(var h=0;h<e.length;h++)d(e[h]),r.addGroup(c,u,h),c+=u,u=0;function d(e){var t=o.length/3,n=(e=e.extractPoints(i)).shape,r=e.holes;!1===du.isClockWise(n)&&(n=W()(n).call(n));for(var c=0,h=r.length;c<h;c++){var d=r[c];!0===du.isClockWise(d)&&(r[c]=W()(d).call(d))}for(var p=du.triangulateShape(n,r),f=0,m=r.length;f<m;f++){var v=r[f];n=G()(n).call(n,v)}for(var g=0,y=n.length;g<y;g++){var x=n[g];o.push(x.x,x.y,0),s.push(0,0,1),l.push(x.x,x.y)}for(var w=0,b=p.length;w<b;w++){var _=(E=p[w])[0]+t,M=E[1]+t,E=E[2]+t;a.push(_,M,E),u+=3}}return r.setIndex(a),r.setAttribute("position",new ka(o,3)),r.setAttribute("normal",new ka(s,3)),r.setAttribute("uv",new ka(l,2)),r}return m()(n,[{key:"toJSON",value:function(){var e=ja.prototype.toJSON.call(this),t=this.parameters.shapes,n=e;if(n.shapes=[],M()(t))for(var r=0,i=t.length;r<i;r++){var a=t[r];n.shapes.push(a.uuid)}else n.shapes.push(t.uuid);return n}}]),n}(ja),Mu=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:6,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,c=6<arguments.length&&void 0!==arguments[6]?arguments[6]:Math.PI,u=(f()(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:i,heightSegments:a,phiStart:o,phiLength:s,thetaStart:l,thetaLength:c},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a)),Math.min(l+c,Math.PI)),h=0,d=[],p=new Qr,m=new Qr,v=[],g=[],y=[],x=[],w=0;w<=a;w++){var b=[],_=w/a,M=0;0==w&&0==l?M=.5/i:w==a&&u==Math.PI&&(M=-.5/i);for(var E=0;E<=i;E++){var S=E/i;p.x=-r*Math.cos(o+S*s)*Math.sin(l+_*c),p.y=r*Math.cos(l+_*c),p.z=r*Math.sin(o+S*s)*Math.sin(l+_*c),g.push(p.x,p.y,p.z),m.copy(p).normalize(),y.push(m.x,m.y,m.z),x.push(S+M,1-_),b.push(h++)}d.push(b)}for(var T=0;T<a;T++)for(var A=0;A<i;A++){var L=d[T][A+1],C=d[T][A],P=d[T+1][A],R=d[T+1][A+1];(0!==T||0<l)&&v.push(L,C,R),(T!==a-1||u<Math.PI)&&v.push(C,P,R)}return e.setIndex(v),e.setAttribute("position",new ka(g,3)),e.setAttribute("normal",new ka(y,3)),e.setAttribute("uv",new ka(x,2)),e}return m()(n)}(ja),Eu=function(e){h()(n,e);var t=te(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=(f()(this,n),t.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,r));return i.type="TetrahedronGeometry",i.parameters={radius:e,detail:r},i}return m()(n)}(Gc),Su=function(e){h()(n,e);var t=te(n);function n(e){var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=(f()(this,n),i.font);return a&&a.isFont?(a=a.generateShapes(e,i.size),i.depth=void 0!==i.height?i.height:50,void 0===i.bevelThickness&&(i.bevelThickness=10),void 0===i.bevelSize&&(i.bevelSize=8),void 0===i.bevelEnabled&&(i.bevelEnabled=!1),(r=t.call(this,a,i)).type="TextGeometry",r):(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),d()(r,new ja))}return m()(n)}(mu),Tu=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.4,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:6,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2*Math.PI,l=(f()(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:i,radialSegments:a,tubularSegments:o,arc:s},a=Math.floor(a),o=Math.floor(o),[]),c=[],u=[],h=[],d=new Qr,p=new Qr,m=new Qr,v=0;v<=a;v++)for(var g=0;g<=o;g++){var y=g/o*s,x=v/a*Math.PI*2;p.x=(r+i*Math.cos(x))*Math.cos(y),p.y=(r+i*Math.cos(x))*Math.sin(y),p.z=i*Math.sin(x),c.push(p.x,p.y,p.z),d.x=r*Math.cos(y),d.y=r*Math.sin(y),m.subVectors(p,d).normalize(),u.push(m.x,m.y,m.z),h.push(g/o),h.push(v/a)}for(var w=1;w<=a;w++)for(var b=1;b<=o;b++){var _=(o+1)*(w-1)+b-1,M=(o+1)*(w-1)+b,E=(o+1)*w+b;l.push((o+1)*w+b-1,_,E),l.push(_,M,E)}return e.setIndex(l),e.setAttribute("position",new ka(c,3)),e.setAttribute("normal",new ka(u,3)),e.setAttribute("uv",new ka(h,2)),e}return m()(n)}(ja),Au=function(e){h()(n,e);var t=te(n);function n(){for(var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.4,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:64,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:2,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:3,c=(f()(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:i,tubularSegments:a,radialSegments:o,p:s,q:l},a=Math.floor(a),o=Math.floor(o),[]),u=[],h=[],d=[],p=new Qr,m=new Qr,v=new Qr,g=new Qr,y=new Qr,x=new Qr,w=new Qr,b=0;b<=a;++b){var _=b/a*s*Math.PI*2;R(_,s,l,r,v),R(.01+_,s,l,r,g),x.subVectors(g,v),w.addVectors(g,v),y.crossVectors(x,w),w.crossVectors(y,x),y.normalize(),w.normalize();for(var M=0;M<=o;++M){var E=M/o*Math.PI*2,S=-i*Math.cos(E);E=i*Math.sin(E);p.x=v.x+(S*w.x+E*y.x),p.y=v.y+(S*w.y+E*y.y),p.z=v.z+(S*w.z+E*y.z),u.push(p.x,p.y,p.z),m.subVectors(p,v).normalize(),h.push(m.x,m.y,m.z),d.push(b/a),d.push(M/o)}}for(var T=1;T<=a;T++)for(var A=1;A<=o;A++){var L=(o+1)*T+(A-1),C=(o+1)*T+A,P=(o+1)*(T-1)+A;c.push((o+1)*(T-1)+(A-1),L,P),c.push(L,C,P)}function R(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e);n=n/t*e,t=Math.cos(n);i.x=r*(2+t)*.5*a,i.y=r*(2+t)*o*.5,i.z=r*Math.sin(n)*.5}return e.setIndex(c),e.setAttribute("position",new ka(u,3)),e.setAttribute("normal",new ka(h,3)),e.setAttribute("uv",new ka(d,2)),e}return m()(n)}(ja),Lu=function(e){h()(n,e);var t=te(n);function n(e){for(var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:64,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8,s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],l=(f()(this,n),(r=t.call(this)).type="TubeGeometry",r.parameters={path:e,tubularSegments:i,radius:a,radialSegments:o,closed:s},e.computeFrenetFrames(i,s)),c=(r.tangents=l.tangents,r.normals=l.normals,r.binormals=l.binormals,new Qr),u=new Qr,h=new Hr,d=new Qr,p=[],m=[],v=[],g=[],y=0;y<i;y++)A(y);A(!1===s?i:0);for(var x=0;x<=i;x++)for(var w=0;w<=o;w++)h.x=x/i,h.y=w/o,v.push(h.x,h.y);for(var b=1;b<=i;b++)for(var _=1;_<=o;_++){var M=(o+1)*(b-1)+(_-1),E=(o+1)*b+(_-1),S=(o+1)*b+_,T=(o+1)*(b-1)+_;g.push(M,E,T),g.push(E,S,T)}function A(t){d=e.getPointAt(t/i,d);for(var n=l.normals[t],r=l.binormals[t],s=0;s<=o;s++){var h=s/o*Math.PI*2,f=Math.sin(h);h=-Math.cos(h);u.x=h*n.x+f*r.x,u.y=h*n.y+f*r.y,u.z=h*n.z+f*r.z,u.normalize(),m.push(u.x,u.y,u.z),c.x=d.x+a*u.x,c.y=d.y+a*u.y,c.z=d.z+a*u.z,p.push(c.x,c.y,c.z)}}return r.setIndex(g),r.setAttribute("position",new ka(p,3)),r.setAttribute("normal",new ka(m,3)),r.setAttribute("uv",new ka(v,2)),r}return m()(n,[{key:"toJSON",value:function(){var e=ja.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}]),n}(ja),Cu=function(e){h()(n,e);var t=te(n);function n(e){var r;if(f()(this,n),(r=t.call(this)).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),d()(r);var i=[],a=[0,0],o={},s=new Qr;if(null!==e.index){for(var l,c=e.attributes.position,u=e.index,h=e.groups,p=0,m=(h=0===h.length?[{start:0,count:u.count,materialIndex:0}]:h).length;p<m;++p)for(var v=h[p],g=v.start,y=g,x=g+v.count;y<x;y+=3)for(var w=0;w<3;w++){var b=u.getX(y+w),_=u.getX(y+(w+1)%3);void 0===o[b=(a[0]=Math.min(b,_),a[1]=Math.max(b,_),a[0]+","+a[1])]&&(o[b]={index1:a[0],index2:a[1]})}for(l in o){var M=o[l];s.fromBufferAttribute(c,M.index1),i.push(s.x,s.y,s.z),s.fromBufferAttribute(c,M.index2),i.push(s.x,s.y,s.z)}}else for(var E=e.attributes.position,S=0,T=E.count/3;S<T;S++)for(var A=0;A<3;A++){s.fromBufferAttribute(E,3*S+A),i.push(s.x,s.y,s.z);var L=3*S+(A+1)%3;s.fromBufferAttribute(E,L),i.push(s.x,s.y,s.z)}return r.setAttribute("position",new ka(i,3)),r}return m()(n)}(ja),Pu=t()({__proto__:null,BoxGeometry:ho,BoxBufferGeometry:ho,CircleGeometry:Uc,CircleBufferGeometry:Uc,ConeGeometry:Vc,ConeBufferGeometry:Vc,CylinderGeometry:Hc,CylinderBufferGeometry:Hc,DodecahedronGeometry:Wc,DodecahedronBufferGeometry:Wc,EdgesGeometry:Zc,ExtrudeGeometry:mu,ExtrudeBufferGeometry:mu,IcosahedronGeometry:gu,IcosahedronBufferGeometry:gu,LatheGeometry:yu,LatheBufferGeometry:yu,OctahedronGeometry:xu,OctahedronBufferGeometry:xu,ParametricGeometry:wu,ParametricBufferGeometry:wu,PlaneGeometry:Lo,PlaneBufferGeometry:Lo,PolyhedronGeometry:Gc,PolyhedronBufferGeometry:Gc,RingGeometry:bu,RingBufferGeometry:bu,ShapeGeometry:_u,ShapeBufferGeometry:_u,SphereGeometry:Mu,SphereBufferGeometry:Mu,TetrahedronGeometry:Eu,TetrahedronBufferGeometry:Eu,TextGeometry:Su,TextBufferGeometry:Su,TorusGeometry:Tu,TorusBufferGeometry:Tu,TorusKnotGeometry:Au,TorusKnotBufferGeometry:Au,TubeGeometry:Lu,TubeBufferGeometry:Lu,WireframeGeometry:Cu}),Ru=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new wa(0),r.transparent=!0,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(pa),Iu=(Ru.prototype.isShadowMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),(e=t.call(this,e)).type="RawShaderMaterial",e}return m()(n)}(vo));function ku(e){pa.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new wa(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wa(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=or,this.normalScale=new Hr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function Du(e){ku.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Hr(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,b()(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=Ur.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}Iu.prototype.isRawShaderMaterial=!0,((ku.prototype=T()(pa.prototype)).constructor=ku).prototype.isMeshStandardMaterial=!0,ku.prototype.copy=function(e){return pa.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=L()(e),this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this},((Du.prototype=T()(ku.prototype)).constructor=Du).prototype.isMeshPhysicalMaterial=!0,Du.prototype.copy=function(e){return ku.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new wa).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};var zu=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new wa(16777215),r.specular=new wa(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new wa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=or,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=Ye,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=L()(e),this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(pa),Nu=(zu.prototype.isMeshPhongMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new wa(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new wa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=or,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=L()(e),this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(pa)),Ou=(Nu.prototype.isMeshToonMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=or,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(pa)),Bu=(Ou.prototype.isMeshNormalMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new wa(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new wa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=Ye,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=L()(e),this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(pa)),Fu=(Bu.prototype.isMeshLambertMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new wa(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=or,r.normalScale=new Hr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=L()(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(pa)),Uu=(Fu.prototype.isMeshMatcapMaterial=!0,function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(yc)),Hu=(Uu.prototype.isLineDashedMaterial=!0,t()({__proto__:null,ShadowMaterial:Ru,SpriteMaterial:Fl,RawShaderMaterial:Iu,ShaderMaterial:vo,PointsMaterial:Cc,MeshPhysicalMaterial:Du,MeshStandardMaterial:ku,MeshPhongMaterial:zu,MeshToonMaterial:Nu,MeshNormalMaterial:Ou,MeshLambertMaterial:Bu,MeshDepthMaterial:yl,MeshDistanceMaterial:xl,MeshBasicMaterial:ba,MeshMatcapMaterial:Fu,LineDashedMaterial:Uu,LineBasicMaterial:yc,Material:pa})),Vu={arraySlice:function(e,t,n){return Vu.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):w()(e).call(e,t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):w()(Array.prototype).call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return D()(n).call(n,(function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(M()(o))for(;void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),void 0!==(a=e[i++]););else if(void 0!==o.toArray)for(;void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),void 0!==(a=e[i++]););else for(;void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),void 0!==(a=e[i++]););}},subclip:function(e,t,n,r){for(var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:30,a=e.clone(),o=(a.name=t,[]),s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],c=l.getValueSize(),u=[],h=[],d=0;d<l.times.length;++d){var p=l.times[d]*i;if(!(p<n||r<=p)){u.push(l.times[d]);for(var f=0;f<c;++f)h.push(F()(l)[d*c+f])}}0!==u.length&&(l.times=Vu.convertArray(u,l.times.constructor),l.values=Vu.convertArray(h,F()(l).constructor),o.push(l))}a.tracks=o;for(var m=1/0,v=0;v<a.tracks.length;++v)m>a.tracks[v].times[0]&&(m=a.tracks[v].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:30,i=n.tracks.length,a=t/(r=r<=0?30:r),o=0;o<i;++o)!function(){var t=n.tracks[o],r=t.ValueTypeName;if("bool"!==r&&"string"!==r){var i=X()(u=e.tracks).call(u,(function(e){return e.name===t.name&&e.ValueTypeName===r}));if(void 0!==i)for(var s,l,c,u=0,h=t.getValueSize(),d=(t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3),0),p=i.getValueSize(),f=(i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=p/3),t.times.length-1),m=(s=a<=t.times[0]?(l=h-(c=u),Vu.arraySlice(F()(t),c,l)):a>=t.times[f]?(l=(c=f*h+u)+h-u,Vu.arraySlice(F()(t),c,l)):(c=h-(f=u),(l=t.createInterpolant()).evaluate(a),Vu.arraySlice(l.resultBuffer,f,c)),"quaternion"===r&&(new Jr).fromArray(s).normalize().conjugate().toArray(s),i.times.length),v=0;v<m;++v){var g=v*p+d;if("quaternion"===r)Jr.multiplyQuaternionsFlat(F()(i),g,s,0,F()(i),g);else for(var y=p-2*d,x=0;x<y;++x)F()(i)[g+x]-=s[x]}}}();return e.blendMode=qn,e}};function Gu(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Wu(e,t,n,r){Gu.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ju(e,t,n,r){Gu.call(this,e,t,n,r)}function qu(e,t,n,r){Gu.call(this,e,t,n,r)}g()(Gu.prototype,{evaluate:function(e){var t,n=this.parameterPositions,r=this._cachedIndex,i=n[r],a=n[r-1];e:{t:{n:{r:if(!(e<i)){for(var o=r+2;;){if(void 0===i){if(e<a)break r;return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,e,a)}if(r===o)break;if(a=i,e<(i=n[++r]))break t}t=n.length;break n}if(a<=e)break e;var s=n[1];e<s&&(r=2,a=s);for(var l=r-2;;){if(void 0===a)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(r===l)break;if(i=a,(a=n[--r-1])<=e)break t}t=r,r=0}for(;r<t;){var c=r+t>>>1;e<n[c]?t=c:r=1+c}if(i=n[r],void 0===(a=n[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return r=n.length,this._cachedIndex=r,this.afterEnd_(r-1,a,e)}this._cachedIndex=r,this.intervalChanged_(r,a,i)}return this.interpolate_(r,a,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),g()(Gu.prototype,{beforeStart_:Gu.prototype.copySampleValue_,afterEnd_:Gu.prototype.copySampleValue_}),Wu.prototype=g()(T()(Gu.prototype),{constructor:Wu,DefaultSettings_:{endingStart:Vn,endingEnd:Vn},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Gn:i=e,o=2*t-n;break;case Wn:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Gn:a=e,s=2*n-t;break;case Wn:s=n+r[a=1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=(e=this._weightPrev,this._weightNext),d=-e*(t=(r=(n=(n-t)/(r-t))*n)*n)+2*e*r-e*n,p=(1+e)*t+(-1.5-2*e)*r+(-.5+e)*n+1,f=(-1-h)*t+(1.5+h)*r+.5*n,m=h*t-h*r,v=0;v!==o;++v)i[v]=d*a[c+v]+p*a[l+v]+f*a[s+v]+m*a[u+v];return i}}),ju.prototype=g()(T()(Gu.prototype),{constructor:ju,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(r-t),u=1-c,h=0;h!==o;++h)i[h]=a[l+h]*u+a[s+h]*c;return i}}),qu.prototype=g()(T()(Gu.prototype),{constructor:qu,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Xu=function(){function e(t,n,r,i){if(f()(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Vu.convertArray(n,this.TimeBufferType),this.values=Vu.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}return m()(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new qu(this.times,F()(this),this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new ju(this.times,F()(this),this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Wu(this.times,F()(this),this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case Fn:t=this.InterpolantFactoryMethodDiscrete;break;case Un:t=this.InterpolantFactoryMethodLinear;break;case Hn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}else this.createInterpolant=t;return this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fn;case this.InterpolantFactoryMethodLinear:return Un;case this.InterpolantFactoryMethodSmooth:return Hn}}},{key:"getValueSize",value:function(){return F()(this).length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n,r=this.times,i=r.length,a=0,o=i-1;a!==i&&r[a]<e;)++a;for(;-1!==o&&r[o]>t;)--o;return++o,0===a&&o===i||(o<=a&&(a=(o=Math.max(o,1))-1),n=this.getValueSize(),this.times=Vu.arraySlice(r,a,o),this.values=Vu.arraySlice(F()(this),a*n,o*n)),this}},{key:"validate",value:function(){for(var e=!0,t=this.getValueSize(),n=(t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1),this.times),r=F()(this),i=n.length,a=(0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1),null),o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&s<a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Vu.isTypedArray(r))for(var l=0,c=r.length;l!==c;++l){var u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=Vu.arraySlice(this.times),t=Vu.arraySlice(F()(this)),n=this.getValueSize(),r=this.getInterpolation()===Hn,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)s=!0;else for(var c=o*n,u=c-n,h=c+n,d=0;d!==n;++d){var p=t[c+d];if(p!==t[u+d]||p!==t[h+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var f=o*n,m=a*n,v=0;v!==n;++v)t[m+v]=t[f+v]}++a}}if(0<i){e[a]=e[i];for(var g=i*n,y=a*n,x=0;x!==n;++x)t[y+x]=t[g+x];++a}return a!==e.length?(this.times=Vu.arraySlice(e,0,a),this.values=Vu.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=Vu.arraySlice(this.times,0),t=Vu.arraySlice(F()(this),0);return(e=new this.constructor(this.name,e,t)).createInterpolant=this.createInterpolant,e}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;return n.toJSON!==this.toJSON?t=n.toJSON(e):(t={name:e.name,times:Vu.convertArray(e.times,Array),values:Vu.convertArray(F()(e),Array)},(n=e.getInterpolation())!==e.DefaultInterpolation&&(t.interpolation=n)),t.type=e.ValueTypeName,t}}]),e}(),Yu=(Xu.prototype.TimeBufferType=Float32Array,Xu.prototype.ValueBufferType=Float32Array,Xu.prototype.DefaultInterpolation=Un,function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Xu)),Zu=(Yu.prototype.ValueTypeName="bool",Yu.prototype.ValueBufferType=Array,Yu.prototype.DefaultInterpolation=Fn,Yu.prototype.InterpolantFactoryMethodLinear=void 0,Yu.prototype.InterpolantFactoryMethodSmooth=void 0,function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Xu)),Ju=(Zu.prototype.ValueTypeName="color",function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Xu));function Qu(e,t,n,r){Gu.call(this,e,t,n,r)}Ju.prototype.ValueTypeName="number",Qu.prototype=g()(T()(Gu.prototype),{constructor:Qu,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,c=l+o;l!==c;l+=4)Jr.slerpFlat(i,0,a,l-o,a,l,s);return i}});var Ku=function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Qu(this.times,F()(this),this.getValueSize(),e)}}]),n}(Xu),$u=(Ku.prototype.ValueTypeName="quaternion",Ku.prototype.DefaultInterpolation=Un,Ku.prototype.InterpolantFactoryMethodSmooth=void 0,function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Xu)),eh=($u.prototype.ValueTypeName="string",$u.prototype.ValueBufferType=Array,$u.prototype.DefaultInterpolation=Fn,$u.prototype.InterpolantFactoryMethodLinear=void 0,$u.prototype.InterpolantFactoryMethodSmooth=void 0,function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.apply(this,arguments)}return m()(n)}(Xu)),th=(eh.prototype.ValueTypeName="vector",function(){function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,r=2<arguments.length?arguments[2]:void 0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:jn;f()(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=Ur.generateUUID(),this.duration<0&&this.resetDuration()}return m()(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e,t=0;t<this.tracks.length;t++)N()(e=this.tracks[t]).call(e,0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t,n,r=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ju;case"vector":case"vector2":case"vector3":case"vector4":return eh;case"color":return Zu;case"quaternion":return Ku;case"bool":case"boolean":return Yu;case"string":return $u}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);return void 0===e.times&&(t=[],n=[],Vu.flattenJSON(Y()(e),t,n,"value"),e.times=t,e.values=n),void 0!==r.parse?r.parse(e):new r(e.name,e.times,F()(e),e.interpolation)}(n[i]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r=(e={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},0),i=n.length;r!==i;++r)t.push(Xu.toJSON(n[r]));return e}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=((c=[]).push((o+i-1)%i,o,(o+1)%i),s.push(0,1,0),Vu.getKeyframeOrder(c)),c=Vu.sortedArray(c,1,l);s=Vu.sortedArray(s,1,l);r||0!==c[0]||(c.push(i),s.push(s[0])),a.push(new Ju(".morphTargetInfluences["+t[o].name+"]",c,s).scale(1/n))}return new this(e,-1,a)}},{key:"findByName",value:function(e,t){var n=e;M()(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s,l=e[a],c=l.name.match(i);c&&1<c.length&&((s=r[c=c[1]])||(r[c]=s=[]),s.push(l))}var u,h=[];for(u in r)h.push(this.CreateFromMorphTargetSequence(u,r[u],t,n));return h}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){var a;0!==n.length&&(Vu.flattenJSON(n,n=[],a=[],r),0!==n.length)&&i.push(new e(t,n,a))},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],c=0;c<l.length;c++){var u=Y()(l[c]);if(u&&0!==u.length)if(u[0].morphTargets){var h,d={},p=void 0;for(p=0;p<u.length;p++)if(u[p].morphTargets)for(var f=0;f<u[p].morphTargets.length;f++)d[u[p].morphTargets[f]]=-1;for(h in d){for(var m=[],v=[],g=0;g!==u[p].morphTargets.length;++g){var y=u[p];m.push(y.time),v.push(y.morphTarget===h?1:0)}r.push(new Ju(".morphTargetInfluence["+h+"]",m,v))}s=d.length*(a||1)}else{var x=".bones["+t[c].name+"]";n(eh,x+".position",u,"pos",r),n(Ku,x+".quaternion",u,"rot",r),n(eh,x+".scale",u,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}}]),e}()),nh={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function rh(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){return-1!==(e=y()(l).call(l,e))&&x()(l).call(l,e,2),this},this.getHandler=function(e){for(var t=0,n=l.length;t<n;t+=2){var r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}var ih=new rh;function ah(e){this.manager=void 0!==e?e:ih,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}g()(ah.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Z.a((function(r,i){n.load(e,r,t,i)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var oh={};function sh(e){ah.call(this,e)}sh.prototype=g()(T()(ah.prototype),{constructor:sh,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=nh.get(e);if(void 0!==a)return i.manager.itemStart(e),V()((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===oh[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var l=s[1],c=!!s[2],u=s[3];u=decodeURIComponent(u);c&&(u=atob(u));try{var h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),p=0;p<u.length;p++)d[p]=u.charCodeAt(p);f="blob"===h?new Blob([d.buffer],{type:l}):d.buffer;break;case"document":var f=(new DOMParser).parseFromString(u,l);break;case"json":f=JSON.parse(u);break;default:f=u}V()((function(){t&&t(f),i.manager.itemEnd(e)}),0)}catch(t){V()((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var m in oh[e]=[],oh[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=oh[e];if(delete oh[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),nh.add(e,n);for(var a=0,o=r.length;a<o;a++){var s=r[a];s.onLoad&&s.onLoad(n)}}else{for(var l=0,c=r.length;l<c;l++){var u=r[l];u.onError&&u.onError(t)}i.manager.itemError(e)}i.manager.itemEnd(e)}),!1),o.addEventListener("progress",(function(t){for(var n=oh[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=oh[e];delete oh[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=oh[e];delete oh[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(m,this.requestHeader[m]);o.send(null)}return i.manager.itemStart(e),o}oh[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});var lh=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new sh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(n){r?r(n):console.error(n),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=th.parse(e[n]);t.push(r)}return t}}]),n}(ah);function ch(e){ah.call(this,e)}ch.prototype=g()(T()(ah.prototype),{constructor:ch,load:function(e,t,n,r){var i=this,a=[],o=new Oc,s=new sh(this.manager),l=(s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials),0);if(M()(e))for(var c=0,u=e.length;c<u;++c)!function(c){s.load(e[c],(function(e){e=i.parse(e,!0),a[c]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(l+=1)&&(1===e.mipmapCount&&(o.minFilter=yt),o.image=a,o.format=e.format,o.needsUpdate=!0,t)&&t(o)}),n,r)}(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=yt),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}});var uh=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i,a=this,o=nh.get(e);return void 0!==o?(a.manager.itemStart(e),V()((function(){t&&t(o),a.manager.itemEnd(e)}),0),o):((i=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",s,!1),i.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin),a.manager.itemStart(e),i.src=e,i);function s(){i.removeEventListener("load",s,!1),i.removeEventListener("error",l,!1),nh.add(e,this),t&&t(this),a.manager.itemEnd(e)}function l(t){i.removeEventListener("load",s,!1),i.removeEventListener("error",l,!1),r&&r(t),a.manager.itemError(e),a.manager.itemEnd(e)}}}]),n}(ah),hh=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){for(var i=new wo,a=new uh(this.manager),o=(a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),0),s=0;s<e.length;++s)!function(n){a.load(e[n],(function(e){i.images[n]=e,6==++o&&(i.needsUpdate=!0,t)&&t(i)}),void 0,r)}(s);return i}}]),n}(ah);function dh(e){ah.call(this,e)}function ph(e){ah.call(this,e)}function fh(){this.type="Curve",this.arcLengthDivisions=200}dh.prototype=g()(T()(ah.prototype),{constructor:dh,load:function(e,t,n,r){var i=this,a=new _o,o=new sh(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){(e=i.parse(e))&&(void 0!==e.image?a.image=e.image:void 0!==e.data&&(a.image.width=e.width,a.image.height=e.height,a.image.data=e.data),a.wrapS=void 0!==e.wrapS?e.wrapS:ht,a.wrapT=void 0!==e.wrapT?e.wrapT:ht,a.magFilter=void 0!==e.magFilter?e.magFilter:yt,a.minFilter=void 0!==e.minFilter?e.minFilter:yt,a.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.encoding&&(a.encoding=e.encoding),void 0!==e.flipY&&(a.flipY=e.flipY),void 0!==e.format&&(a.format=e.format),void 0!==e.type&&(a.type=e.type),void 0!==e.mipmaps&&(a.mipmaps=e.mipmaps,a.minFilter=bt),1===e.mipmapCount&&(a.minFilter=yt),a.needsUpdate=!0,t)&&t(a,e)}),n,r),a}}),ph.prototype=g()(T()(ah.prototype),{constructor:ph,load:function(e,t,n,r){var i=new jr,a=new uh(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n,n=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/),i.format=n?Nt:Ot,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),g()(fh.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){for(var n,r=this.getLengths(),i=0,a=r.length,o=t||e*r[a-1],s=0,l=a-1;s<=l;)if((n=r[i=Math.floor(s+(l-s)/2)]-o)<0)s=i+1;else{if(!(0<n)){l=i;break}l=i-1}return r[i=l]===o?i/(a-1):(i+(o-(t=r[i]))/(r[i+1]-t))/(a-1)},getTangent:function(e,t){var n=e-1e-4;1<(e=e+1e-4)&&(e=1),n=this.getPoint(n=n<0?0:n),e=this.getPoint(e);return(t=t||new(n.isVector2?Hr:Qr)).copy(e).sub(n).normalize(),t},getTangentAt:function(e,t){return e=this.getUtoTmapping(e),this.getTangent(e,t)},computeFrenetFrames:function(e,t){for(var n=new Qr,r=[],i=[],a=[],o=new Qr,s=new Si,l=0;l<=e;l++)r[l]=this.getTangentAt(l/e,new Qr),r[l].normalize();i[0]=new Qr,a[0]=new Qr;var c=Number.MAX_VALUE,u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),d<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var p,f=1;f<=e;f++)i[f]=i[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>E.a&&(o.normalize(),p=Math.acos(Ur.clamp(r[f-1].dot(r[f]),-1,1)),i[f].applyMatrix4(s.makeRotationAxis(o,p))),a[f].crossVectors(r[f],i[f]);if(!0===t){var m=Math.acos(Ur.clamp(i[0].dot(i[e]),-1,1));m/=e,0<r[0].dot(o.crossVectors(i[0],i[e]))&&(m=-m);for(var v=1;v<=e;v++)i[v].applyMatrix4(s.makeRotationAxis(r[v],m*v)),a[v].crossVectors(r[v],i[v])}return{tangents:r,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});var mh=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2*Math.PI,c=6<arguments.length&&void 0!==arguments[6]&&arguments[6],u=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0;return f()(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=i,e.xRadius=a,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=l,e.aClockwise=c,e.aRotation=u,e}return m()(n,[{key:"getPoint",value:function(e,t){t=t||new Hr;for(var n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,i=Math.abs(r)<E.a;r<0;)r+=n;for(;n<r;)r-=n;r<E.a&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);var a,o,s,l;i=this.aStartAngle+e*r,e=this.aX+this.xRadius*Math.cos(i),i=this.aY+this.yRadius*Math.sin(i);return 0!==this.aRotation&&(a=Math.cos(this.aRotation),o=Math.sin(this.aRotation),e=(s=e-this.aX)*a-(l=i-this.aY)*o+this.aX,i=s*o+l*a+this.aY),t.set(e,i)}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(fh),vh=(mh.prototype.isEllipseCurve=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i,a,o,s){return f()(this,n),(e=t.call(this,e,r,i,i,a,o,s)).type="ArcCurve",e}return m()(n)}(mh));function gh(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){n=-3*(e=i)+3*a-2*(t=o)-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){e=(t-e)/a-(n-e)/(a+o)+(n-t)/o,a=(n-t)/o-(r-t)/(o+s)+(r-n)/s,i(t,n,e*=o,a*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}vh.prototype.isArcCurve=!0;var yh=new Qr,xh=new gh,wh=new gh,bh=new gh,_h=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"centripetal",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5;return f()(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=i,e.curveType=a,e.tension=o,e}return m()(n,[{key:"getPoint",value:function(e){var t,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,i=this.points,a=i.length,o=(e=(e=(a-(this.closed?0:1))*e)-(l=Math.floor(e)),this.closed?l+=0<l?0:(Math.floor(Math.abs(l)/a)+1)*a:0===e&&l===a-1&&(l=a-2,e=1),t=this.closed||0<l?i[(l-1)%a]:(yh.subVectors(i[0],i[1]).add(i[0]),yh),i[l%a]),s=i[(l+1)%a],l=this.closed||l+2<a?i[(l+2)%a]:(yh.subVectors(i[a-1],i[a-2]).add(i[a-1]),yh);return"centripetal"===this.curveType||"chordal"===this.curveType?(i="chordal"===this.curveType?.5:.25,a=Math.pow(t.distanceToSquared(o),i),(n=Math.pow(o.distanceToSquared(s),i))<1e-4&&(n=1),a<1e-4&&(a=n),(i=Math.pow(s.distanceToSquared(l),i))<1e-4&&(i=n),xh.initNonuniformCatmullRom(t.x,o.x,s.x,l.x,a,n,i),wh.initNonuniformCatmullRom(t.y,o.y,s.y,l.y,a,n,i),bh.initNonuniformCatmullRom(t.z,o.z,s.z,l.z,a,n,i)):"catmullrom"===this.curveType&&(xh.initCatmullRom(t.x,o.x,s.x,l.x,this.tension),wh.initCatmullRom(t.y,o.y,s.y,l.y,this.tension),bh.initCatmullRom(t.z,o.z,s.z,l.z,this.tension)),r.set(xh.calc(e),wh.calc(e),bh.calc(e)),r}},{key:"copy",value:function(e){c()(p()(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){c()(p()(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Qr).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(fh);function Mh(e,t,n,r,i){var a=e*e;return(2*n-2*r+(t=.5*(r-t))+(i=.5*(i-n)))*(e*a)+(-3*n+3*r-2*t-i)*a+t*e+n}function Eh(e,t,n,r){return(i=1-(i=e))*i*t+2*(1-e)*e*n+e*e*r;var i}function Sh(e,t,n,r,i){return(a=1-(a=e))*a*a*t+3*(a=1-e)*a*e*n+3*(1-e)*e*e*r+e*e*e*i;var a}_h.prototype.isCatmullRomCurve3=!0;var Th=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Hr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Hr,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Hr;return f()(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(Sh(e,n.x,r.x,i.x,a.x),Sh(e,n.y,r.y,i.y,a.y)),t}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(fh),Ah=(Th.prototype.isCubicBezierCurve=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Qr,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Qr;return f()(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e.v3=o,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(Sh(e,n.x,r.x,i.x,a.x),Sh(e,n.y,r.y,i.y,a.y),Sh(e,n.z,r.z,i.z,a.z)),t}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(fh)),Lh=(Ah.prototype.isCubicBezierCurve3=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Hr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr;return f()(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=i,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){return(t=t||new Hr).copy(this.v2).sub(this.v1).normalize(),t}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(fh)),Ch=(Lh.prototype.isLineCurve=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr;return f()(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=i,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(fh)),Ph=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Hr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Hr;return f()(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=i,e.v2=a,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr,n=this.v0,r=this.v1,i=this.v2;return t.set(Eh(e,n.x,r.x,i.x),Eh(e,n.y,r.y,i.y)),t}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(fh),Rh=(Ph.prototype.isQuadraticBezierCurve=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Qr;return f()(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=i,e.v2=a,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr,n=this.v0,r=this.v1,i=this.v2;return t.set(Eh(e,n.x,r.x,i.x),Eh(e,n.y,r.y,i.y),Eh(e,n.z,r.z,i.z)),t}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(fh)),Ih=(Rh.prototype.isQuadraticBezierCurve3=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return f()(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return m()(n,[{key:"getPoint",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr,n=(e=((o=this.points).length-1)*e,Math.floor(e)),r=(e=e-n,o[0===n?n:n-1]),i=o[n],a=o[n>o.length-2?o.length-1:n+1],o=o[n>o.length-3?o.length-1:n+2];return t.set(Mh(e,r.x,i.x,a.x,o.x),Mh(e,r.y,i.y,a.y,o.y)),t}},{key:"copy",value:function(e){c()(p()(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var i=this.points[t];e.points.push(i.toArray())}return e}},{key:"fromJSON",value:function(e){c()(p()(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var i=e.points[t];this.points.push((new Hr).fromArray(i))}return this}}]),n}(fh)),kh=(Ih.prototype.isSplineCurve=!0,t()({__proto__:null,ArcCurve:vh,CatmullRomCurve3:_h,CubicBezierCurve:Th,CubicBezierCurve3:Ah,EllipseCurve:mh,LineCurve:Lh,LineCurve3:Ch,QuadraticBezierCurve:Ph,QuadraticBezierCurve3:Rh,SplineCurve:Ih})),Dh=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return m()(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Lh(t,e))}},{key:"getPoint",value:function(e){for(var t,n,r,i=e*this.getLength(),a=this.getCurveLengths(),o=0;o<a.length;){if(a[o]>=i)return t=a[o]-i,r=(n=this.curves[o]).getLength(),n.getPointAt(0===r?0:1-t/r);o++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e}},{key:"getSpacedPoints",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),l=0;l<s.length;l++){var c=s[l];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){c()(p()(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){c()(p()(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var i=e.curves[t];this.curves.push((new kh[i.type]).fromJSON(i))}return this}}]),n}(fh),zh=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="Path",r.currentPoint=new Hr,e&&r.setFromPoints(e),r}return m()(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new Lh(this.currentPoint.clone(),new Hr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return e=new Ph(this.currentPoint.clone(),new Hr(e,t),new Hr(n,r)),this.curves.push(e),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return e=new Th(this.currentPoint.clone(),new Hr(e,t),new Hr(n,r),new Hr(i,a)),this.curves.push(e),this.currentPoint.set(i,a),this}},{key:"splineThru",value:function(e){var t=G()(t=[this.currentPoint.clone()]).call(t,e);t=new Ih(t);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}},{key:"absarc",value:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}},{key:"ellipse",value:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,a,o,s),this}},{key:"absellipse",value:function(e,t,n,r,i,a,o,s){return e=new mh(e,t,n,r,i,a,o,s),0<this.curves.length&&((t=e.getPoint(0)).equals(this.currentPoint)||this.lineTo(t.x,t.y)),this.curves.push(e),n=e.getPoint(1),this.currentPoint.copy(n),this}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return c()(p()(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(Dh),Nh=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),(e=t.call(this,e)).uuid=Ur.generateUUID(),e.type="Shape",e.holes=[],e}return m()(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){c()(p()(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push(i.clone())}return this}},{key:"toJSON",value:function(){var e=c()(p()(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e}},{key:"fromJSON",value:function(e){c()(p()(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var i=e.holes[t];this.holes.push((new zh).fromJSON(i))}return this}}]),n}(zh),Oh=function(e){h()(n,e);var t=te(n);function n(e){var r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return f()(this,n),(r=t.call(this)).type="Light",r.color=new wa(e),r.intensity=i,r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){return(e=c()(p()(n.prototype),"toJSON",this).call(this,e)).object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}]),n}(Ji),Bh=(Oh.prototype.isLight=!0,function(e){h()(n,e);var t=te(n);function n(e,r,i){return f()(this,n),(e=t.call(this,e,i)).type="HemisphereLight",e.position.copy(Ji.DefaultUp),e.updateMatrix(),e.groundColor=new wa(r),e}return m()(n,[{key:"copy",value:function(e){return Oh.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(Oh)),Fh=(Bh.prototype.isHemisphereLight=!0,new Si),Uh=new Qr,Hh=new Qr,Vh=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this,new yo(50,1,.5,500))).focus=1,e}return m()(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*Ur.RAD2DEG*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;r===t.fov&&i===t.aspect&&a===t.far||(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),c()(p()(n.prototype),"updateMatrices",this).call(this,e)}}]),n}(n=function(){function e(t){f()(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Hr(512,512),this.map=null,this.mapPass=null,this.matrix=new Si,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new So,this._frameExtents=new Hr(1,1),this._viewportCount=1,this._viewports=[new Xr(0,0,1,1)]}return m()(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Uh.setFromMatrixPosition(e.matrixWorld),t.position.copy(Uh),Hh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Hh),t.updateMatrixWorld(),Fh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Fh),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}()),Gh=(Vh.prototype.isSpotLightShadow=!0,function(e){h()(n,e);var t=te(n);function n(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Math.PI/3,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1;return f()(this,n),(e=t.call(this,e,r)).type="SpotLight",e.position.copy(Ji.DefaultUp),e.updateMatrix(),e.target=new Ji,e.distance=i,e.angle=a,e.penumbra=o,e.decay=s,e.shadow=new Vh,e}return m()(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Oh)),Wh=(Gh.prototype.isSpotLight=!0,new Si),jh=new Qr,qh=new Qr,Xh=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this,new yo(90,1,.5,500)))._frameExtents=new Hr(4,2),e._viewportCount=6,e._viewports=[new Xr(2,1,1,1),new Xr(0,1,1,1),new Xr(3,1,1,1),new Xr(1,1,1,1),new Xr(3,0,1,1),new Xr(1,0,1,1)],e._cubeDirections=[new Qr(1,0,0),new Qr(-1,0,0),new Qr(0,0,1),new Qr(0,0,-1),new Qr(0,1,0),new Qr(0,-1,0)],e._cubeUps=[new Qr(0,1,0),new Qr(0,1,0),new Qr(0,1,0),new Qr(0,1,0),new Qr(0,0,1),new Qr(0,0,-1)],e}return m()(n,[{key:"updateMatrices",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix;jh.setFromMatrixPosition(e.matrixWorld),n.position.copy(jh),qh.copy(n.position),qh.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(qh),n.updateMatrixWorld(),r.makeTranslation(-jh.x,-jh.y,-jh.z),Wh.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Wh)}}]),n}(n),Yh=(Xh.prototype.isPointLightShadow=!0,function(e){h()(n,e);var t=te(n);function n(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;return f()(this,n),(e=t.call(this,e,r)).type="PointLight",e.distance=i,e.decay=a,e.shadow=new Xh,e}return m()(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(Oh)),Zh=(Yh.prototype.isPointLight=!0,function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-1,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:.1,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2e3;return f()(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=i,e.top=a,e.bottom=o,e.near=s,e.far=l,e.updateProjectionMatrix(),e}return m()(n,[{key:"copy",value:function(e,t){return c()(p()(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:g()({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e,t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(i=(this.right+this.left)/2)-t,i=i+t,a=(t=(a=(this.top+this.bottom)/2)+n,a-n);null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,i=(r+=n*this.view.offsetX)+n*this.view.width,a=(t-=e*this.view.offsetY)-e*this.view.height),this.projectionMatrix.makeOrthographic(r,i,t,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){return(e=Ji.prototype.toJSON.call(this,e)).object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=g()({},this.view)),e}}]),n}(go)),Jh=(Zh.prototype.isOrthographicCamera=!0,function(e){h()(n,e);var t=te(n);function n(){return f()(this,n),t.call(this,new Zh(-5,5,5,-5,.5,500))}return m()(n)}(n)),Qh=(Jh.prototype.isDirectionalLightShadow=!0,function(e){h()(n,e);var t=te(n);function n(e,r){return f()(this,n),(e=t.call(this,e,r)).type="DirectionalLight",e.position.copy(Ji.DefaultUp),e.updateMatrix(),e.target=new Ji,e.shadow=new Jh,e}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Oh)),Kh=(Qh.prototype.isDirectionalLight=!0,function(e){h()(n,e);var t=te(n);function n(e,r){return f()(this,n),(e=t.call(this,e,r)).type="AmbientLight",e}return m()(n)}(Oh)),$h=(Kh.prototype.isAmbientLight=!0,function(e){h()(n,e);var t=te(n);function n(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;return f()(this,n),(e=t.call(this,e,r)).type="RectAreaLight",e.width=i,e.height=a,e}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){return(e=c()(p()(n.prototype),"toJSON",this).call(this,e)).object.width=this.width,e.object.height=this.height,e}}]),n}(Oh)),ed=($h.prototype.isRectAreaLight=!0,function(){function e(){f()(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Qr)}return m()(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,i=(e=e.z,this.coefficients);return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*r),t.addScaledVector(i[2],.488603*e),t.addScaledVector(i[3],.488603*n),t.addScaledVector(i[4],n*r*1.092548),t.addScaledVector(i[5],r*e*1.092548),t.addScaledVector(i[6],.315392*(3*e*e-1)),t.addScaledVector(i[7],n*e*1.092548),t.addScaledVector(i[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,i=(e=e.z,this.coefficients);return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*r),t.addScaledVector(i[2],1.023328*e),t.addScaledVector(i[3],1.023328*n),t.addScaledVector(i[4],.858086*n*r),t.addScaledVector(i[5],.858086*r*e),t.addScaledVector(i[6],.743125*e*e-.247708),t.addScaledVector(i[7],.858086*n*e),t.addScaledVector(i[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y;e=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*e,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*n*e,t[8]=.546274*(n*n-r*r)}}]),e}()),td=(ed.prototype.isSphericalHarmonics3=!0,function(e){h()(n,e);var t=te(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ed,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return f()(this,n),(r=t.call(this,void 0,r)).sh=e,r}return m()(n,[{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){return(e=c()(p()(n.prototype),"toJSON",this).call(this,e)).object.sh=this.sh.toArray(),e}}]),n}(Oh)),nd=(td.prototype.isLightProbe=!0,function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),(e=t.call(this,e)).textures={},e}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new sh(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(n){r?r(n):console.error(n),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r,i=new Hu[e.type];if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=(new wa).setHex(e.sheen)),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(i.skinning=e.skinning),void 0!==e.morphTargets&&(i.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(i.morphNormals=e.morphNormals),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.vertexTangents&&(i.vertexTangents=e.vertexTangents),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=0<e.vertexColors:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var a in e.uniforms){var o=e.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=n(o.value);break;case"c":i.uniforms[a].value=(new wa).setHex(o.value);break;case"v2":i.uniforms[a].value=(new Hr).fromArray(o.value);break;case"v3":i.uniforms[a].value=(new Qr).fromArray(o.value);break;case"v4":i.uniforms[a].value=(new Xr).fromArray(o.value);break;case"m3":i.uniforms[a].value=(new Vr).fromArray(o.value);break;case"m4":i.uniforms[a].value=(new Si).fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var s in e.extensions)i.extensions[s]=e.extensions[s];return void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==L()(e)&&(i.map=n(L()(e))),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale&&(r=e.normalScale,!1===M()(r)&&(r=[r,r]),i.normalScale=(new Hr).fromArray(r)),void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Hr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),i}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(ah)),rd={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=J()(e).call(e,"/");return-1===t?"./":e.substr(0,t+1)}};function id(){ja.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function ad(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ea.call(this,e,t,n),this.meshPerAttribute=r||1}id.prototype=g()(T()(ja.prototype),{constructor:id,isInstancedBufferGeometry:!0,copy:function(e){return ja.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=ja.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),ad.prototype=g()(T()(Ea.prototype),{constructor:ad,isInstancedBufferAttribute:!0,copy:function(e){return Ea.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Ea.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});var od=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new sh(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(n){r?r(n):console.error(n),i.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){var i,a;return void 0!==t[r]?t[r]:(i=e.interleavedBuffers[r],e=e,a=i.buffer,a=void 0!==n[a]?n[a]:(e=e.arrayBuffers[a],e=new Uint32Array(e).buffer,n[a]=e),(e=new zl(Oa(i.type,a),i.stride)).uuid=i.uuid,t[r]=e)}var i,a=new(e.isInstancedBufferGeometry?id:ja),o=(void 0!==(x=e.data.index)&&(x=Oa(x.type,x.array),a.setIndex(new Ea(x,1))),e.data.attributes);for(i in o){var s,l=o[i],c=void 0;c=l.isInterleavedBufferAttribute?new Ol(r(e.data,l.data),l.itemSize,l.offset,l.normalized):(s=Oa(l.type,l.array),new(l.isInstancedBufferAttribute?ad:Ea)(s,l.itemSize,l.normalized)),void 0!==l.name&&(c.name=l.name),a.setAttribute(i,c)}var u=e.data.morphAttributes;if(u)for(var h in u){for(var d=u[h],p=[],f=0,m=d.length;f<m;f++){var v=d[f],g=void 0;g=v.isInterleavedBufferAttribute?new Ol(r(e.data,v.data),v.itemSize,v.offset,v.normalized):new Ea(Oa(v.type,v.array),v.itemSize,v.normalized),void 0!==v.name&&(g.name=v.name),p.push(g)}a.morphAttributes[h]=p}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);var y,x,w=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==w)for(var b=0,_=w.length;b!==_;++b){var M=w[b];a.addGroup(M.start,M.count,M.materialIndex)}return void 0!==(x=e.data.boundingSphere)&&(y=new Qr,void 0!==x.center&&y.fromArray(x.center),a.boundingSphere=new vi(y,x.radius)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}]),n}(ah),sd=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=""===this.path?rd.extractUrlBase(e):this.path;(a=(this.resourcePath=this.resourcePath||a,new sh(this.manager))).setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(n){return void 0!==r&&r(n),void console.error("THREE:ObjectLoader: Can't parse "+e+".",n.message)}void 0===(n=a.metadata)||void 0===n.type||"geometry"===n.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+e):i.parse(a,t)}),n,r)}},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=(r=this.parseGeometries(e.geometries,r),this.parseImages(e.images,(function(){void 0!==t&&t(o)}))),a=this.parseTextures(e.textures,i),o=(a=this.parseMaterials(e.materials,a),this.parseObject(e.object,r,a,n));r=this.parseSkeletons(e.skeletons,o);if(this.bindSkeletons(o,r),void 0!==t){var s,l=!1;for(s in i)if(i[s]instanceof HTMLImageElement){l=!0;break}!1===l&&t(o)}return o}},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Nh).fromJSON(e[n]);t[i.uuid]=i}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=(new dc).fromJSON(e[i],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n={};if(void 0!==e)for(var r=new od,i=0,a=e.length;i<a;i++){var o=void 0,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Pu[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":o=new Pu[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Pu[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Pu[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Pu[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Pu[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Pu[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Pu[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Pu[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Pu[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Pu[s.type]((new kh[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Pu[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Pu[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,u=s.shapes.length;c<u;c++){var h=t[s.shapes[c]];l.push(h)}o=new Pu[s.type](l,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":l=[];for(var d=0,p=s.shapes.length;d<p;d++){var f=t[s.shapes[d]];l.push(f)}var m=s.options.extrudePath;void 0!==m&&(s.options.extrudePath=(new kh[m.type]).fromJSON(m)),o=new Pu[s.type](l,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var i=new nd;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var l=[],c=0;c<s.materials.length;c++){var u=s.materials[c];void 0===n[u.uuid]&&(n[u.uuid]=i.parse(u)),l.push(n[u.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n];t[(r=th.parse(r)).uuid]=r}return t}},{key:"parseImages",value:function(e,t){var n=this,r={};function i(e){var t,r;return"string"==typeof e?(t=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t=e)?t:n.resourcePath+t,r=t,n.manager.itemStart(r),a.load(r,(function(){n.manager.itemEnd(r)}),void 0,(function(){n.manager.itemError(r),n.manager.itemEnd(r)}))):e.data?{data:Oa(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&0<e.length){var a;t=new rh(t);(a=new uh(t)).setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var l=e[o],c=l.url;if(M()(c)){r[l.uuid]=[];for(var u=0,h=c.length;u<h;u++){var d=i(c[u]);null!==d&&(d instanceof HTMLImageElement?r[l.uuid].push(d):r[l.uuid].push(new _o(d.data,d.width,d.height)))}}else{var p=i(l.url);null!==p&&(r[l.uuid]=p)}}}return r}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i],s=(void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void(void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image))),l=t[o.image];M()(l)?(s=new wo(l),6===l.length&&(s.needsUpdate=!0)):(s=l&&l.data?new _o(l.data,l.width,l.height):new jr(l),l&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,ld)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==_()(o)&&_()(s).fromArray(_()(o)),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],cd),s.wrapT=n(o.wrap[1],cd)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,ud)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,ud)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r){function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(M()(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":o=new Dl,void 0!==e.background&&I()(e.background)&&(o.background=new wa(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new kl(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new Il(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new yo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=g()({},e.view));break;case"OrthographicCamera":o=new Zh(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=g()({},e.view));break;case"AmbientLight":o=new Kh(e.color,e.intensity);break;case"DirectionalLight":o=new Qh(e.color,e.intensity);break;case"PointLight":o=new Yh(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new $h(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Gh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Bh(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new td).fromJSON(e);break;case"SkinnedMesh":o=new lc(s=i(e.geometry),l=a(e.material)),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":o=new co(s=i(e.geometry),l=a(e.material));break;case"InstancedMesh":var o,s=i(e.geometry),l=a(e.material),c=e.count,u=e.instanceMatrix;(o=new gc(s,l,c)).instanceMatrix=new Ea(new Float32Array(u.array),16);break;case"LOD":o=new nc;break;case"Line":o=new Ec(i(e.geometry),a(e.material));break;case"LineLoop":o=new Lc(i(e.geometry),a(e.material));break;case"LineSegments":o=new Ac(i(e.geometry),a(e.material));break;case"PointCloud":case"Points":o=new Dc(i(e.geometry),a(e.material));break;case"Sprite":o=new Kl(a(e.material));break;case"Group":o=new Tl;break;case"Bone":o=new cc;break;default:o=new Ji}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera)&&(o.shadow.camera=this.parseObject(e.shadow.camera)),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children)for(var h=e.children,d=0;d<h.length;d++)o.add(this.parseObject(h[d],t,n,r));if(void 0!==e.animations)for(var p=e.animations,f=0;f<p.length;f++){var m=p[f];o.animations.push(r[m])}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);for(var v=e.levels,y=0;y<v.length;y++){var x=v[y],w=o.getObjectByProperty("uuid",x.object);void 0!==w&&o.addLevel(w,x.distance)}}return o}},{key:"bindSkeletons",value:function(e,t){0!==R()(t).length&&e.traverse((function(e){var n;!0===e.isSkinnedMesh&&void 0!==e.skeleton&&(void 0===(n=t[e.skeleton])?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):Q()(e).call(e,n,e.bindMatrix))}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),n}(ah),ld={UVMapping:rt,CubeReflectionMapping:it,CubeRefractionMapping:at,EquirectangularReflectionMapping:ot,EquirectangularRefractionMapping:st,CubeUVReflectionMapping:lt,CubeUVRefractionMapping:ct},cd={RepeatWrapping:ut,ClampToEdgeWrapping:ht,MirroredRepeatWrapping:dt},ud={NearestFilter:pt,NearestMipmapNearestFilter:ft,NearestMipmapLinearFilter:vt,LinearFilter:yt,LinearMipmapNearestFilter:xt,LinearMipmapLinearFilter:bt};function hd(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ah.call(this,e),this.options={premultiplyAlpha:"none"}}hd.prototype=g()(T()(ah.prototype),{constructor:hd,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=nh.get(e);if(void 0!==a)return i.manager.itemStart(e),V()((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,g()(i.options,{colorSpaceConversion:"none"}))})).then((function(n){nh.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}});var dd=function(){function e(){f()(this,e),this.type="ShapePath",this.color=new wa,this.subPaths=[],this.currentPath=null}return m()(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new zh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Nh;a.curves=i.curves,t.push(a)}return t}var r,i,a,o=du.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===t)return n(s);var l=[];if(1===s.length)i=s[0],(a=new Nh).curves=i.curves,l.push(a);else{var c,u=!o(s[0].getPoints()),h=(u=e?!u:u,[]),d=[],p=[],f=0;d[f]=void 0,p[f]=[];for(var m=0,v=s.length;m<v;m++)r=o(c=(i=s[m]).getPoints()),(e?!r:r)?(!u&&d[f]&&f++,d[f]={s:new Nh,p:c},d[f].s.curves=i.curves,u&&f++,p[f]=[]):p[f].push({h:i,p:c[0]});if(!d[0])return n(s);if(1<d.length){for(var g=!1,y=[],x=0,w=d.length;x<w;x++)h[x]=[];for(var b=0,_=d.length;b<_;b++)for(var M=p[b],S=0;S<M.length;S++){for(var T=M[S],A=!0,L=0;L<d.length;L++)!function(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>E.a){if(c<0&&(o=t[a],l=-l,s=t[i],c=-c),!(e.y<o.y||e.y>s.y))if(e.y===o.y){if(e.x===o.x)return 1}else{if(0==(c=c*(e.x-o.x)-l*(e.y-o.y)))return 1;c<0||(r=!r)}}else if(e.y===o.y&&(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x))return 1}return r}(T.p,d[L].p)||(b!==L&&y.push({froms:b,tos:L,hole:S}),A?(A=!1,h[L].push(T)):g=!0);A&&h[b].push(T)}0<y.length&&(g||(p=h))}for(var C=0,P=d.length;C<P;C++){a=d[C].s,l.push(a);for(var R,I=0,k=(R=p[C]).length;I<k;I++)a.holes.push(R[I].h)}}return l}}]),e}(),pd=function(){function e(t){f()(this,e),this.type="Font",this.data=t}return m()(e,[{key:"generateShapes",value:function(e){for(var t=[],n=function(e,t,n){for(var r=K()(e),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,l=0,c=0;c<r.length;c++){var u=r[c];"\n"===u?(s=0,l-=a):(u=function(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,l,c,u,h,d,p,f=new dd;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,g=m.length;v<g;)switch(m[v++]){case"m":o=m[v++]*t+n,s=m[v++]*t+r,f.moveTo(o,s);break;case"l":o=m[v++]*t+n,s=m[v++]*t+r,f.lineTo(o,s);break;case"q":l=m[v++]*t+n,c=m[v++]*t+r,u=m[v++]*t+n,h=m[v++]*t+r,f.quadraticCurveTo(u,h,l,c);break;case"b":l=m[v++]*t+n,c=m[v++]*t+r,u=m[v++]*t+n,h=m[v++]*t+r,d=m[v++]*t+n,p=m[v++]*t+r,f.bezierCurveTo(u,h,d,p,l,c)}return{offsetX:a.ha*t,path:f}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}(u,i,s,l,n),s+=u.offsetX,o.push(u.path))}return o}(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,this.data),r=0,i=n.length;r<i;r++)Array.prototype.push.apply(t,n[r].toShapes());return t}}]),e}();pd.prototype.isFont=!0;var fd,md=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new sh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}e=i.parse(n),t&&t(e)}),n,r)}},{key:"parse",value:function(e){return new pd(e)}}]),n}(ah),vd={getContext:function(){return fd=void 0===fd?new(window.AudioContext||window.webkitAudioContext):fd},setContext:function(e){fd=e}},gd=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),t.call(this,e)}return m()(n,[{key:"load",value:function(e,t,n,r){var i=this,a=new sh(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{var a=w()(n).call(n,0);vd.getContext().decodeAudioData(a,(function(e){t(e)}))}catch(n){r?r(n):console.error(n),i.manager.itemError(e)}}),n,r)}}]),n}(ah),yd=function(e){h()(n,e);var t=te(n);function n(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=(e=(f()(this,n),i=t.call(this,void 0,i),(new wa).set(e)),r=(new wa).set(r),e=new Qr(e.r,e.g,e.b),r=new Qr(r.r,r.g,r.b),Math.sqrt(Math.PI)),o=a*Math.sqrt(.75);return i.sh.coefficients[0].copy(e).add(r).multiplyScalar(a),i.sh.coefficients[1].copy(e).sub(r).multiplyScalar(o),i}return m()(n)}(td),xd=(yd.prototype.isHemisphereLightProbe=!0,function(e){h()(n,e);var t=te(n);function n(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;f()(this,n),r=t.call(this,void 0,r),e=(new wa).set(e);return r.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return m()(n)}(td)),wd=(xd.prototype.isAmbientLightProbe=!0,new Si),bd=new Si,_d=function(){function e(){f()(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new yo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new yo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return m()(e,[{key:"update",value:function(e){var t,n,r,i,a,o=this._cache;o.focus===e.focus&&o.fov===e.fov&&o.aspect===e.aspect*this.aspect&&o.near===e.near&&o.far===e.far&&o.zoom===e.zoom&&o.eyeSep===this.eyeSep||(o.focus=e.focus,o.fov=e.fov,o.aspect=e.aspect*this.aspect,o.near=e.near,o.far=e.far,o.zoom=e.zoom,o.eyeSep=this.eyeSep,t=e.projectionMatrix.clone(),n=(i=o.eyeSep/2)*o.near/o.focus,r=o.near*Math.tan(Ur.DEG2RAD*o.fov*.5)/o.zoom,bd.elements[12]=-i,wd.elements[12]=i,i=-r*o.aspect+n,a=r*o.aspect+n,t.elements[0]=2*o.near/(a-i),t.elements[8]=(a+i)/(a-i),this.cameraL.projectionMatrix.copy(t),i=-r*o.aspect-n,a=r*o.aspect-n,t.elements[0]=2*o.near/(a-i),t.elements[8]=(a+i)/(a-i),this.cameraR.projectionMatrix.copy(t)),this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(bd),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(wd)}}]),e}(),Md=function(){function e(t){f()(this,e),this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return m()(e,[{key:"start",value:function(){this.startTime=Ed(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e,t=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(t=((e=Ed())-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t),t)}}]),e}();function Ed(){return("undefined"==typeof performance?Date:performance).now()}var Sd=new Qr,Td=new Jr,Ad=new Qr,Ld=new Qr,Cd=function(e){h()(n,e);var t=te(n);function n(){var e;return f()(this,n),(e=t.call(this)).type="AudioListener",e.context=vd.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new Md,e}return m()(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==O()(this)&&(this.gain.disconnect(O()(this)),O()(this).disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return O()(this)}},{key:"setFilter",value:function(e){return(null!==O()(this)?(this.gain.disconnect(O()(this)),O()(this)):this.gain).disconnect(this.context.destination),this.filter=e,this.gain.connect(O()(this)),O()(this).connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){c()(p()(n.prototype),"updateMatrixWorld",this).call(this,e);e=this.context.listener;var t,r=this.up;this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sd,Td,Ad),Ld.set(0,0,-1).applyQuaternion(Td),e.positionX?(t=this.context.currentTime+this.timeDelta,e.positionX.linearRampToValueAtTime(Sd.x,t),e.positionY.linearRampToValueAtTime(Sd.y,t),e.positionZ.linearRampToValueAtTime(Sd.z,t),e.forwardX.linearRampToValueAtTime(Ld.x,t),e.forwardY.linearRampToValueAtTime(Ld.y,t),e.forwardZ.linearRampToValueAtTime(Ld.z,t),e.upX.linearRampToValueAtTime(r.x,t),e.upY.linearRampToValueAtTime(r.y,t),e.upZ.linearRampToValueAtTime(r.z,t)):(e.setPosition(Sd.x,Sd.y,Sd.z),e.setOrientation(Ld.x,Ld.y,Ld.z,r.x,r.y,r.z))}}]),n}(Ji),Pd=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return m()(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+t,(t=this.context.createBufferSource()).buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=Q()(e=this.onEnded).call(e,this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e=e||[],!0===this._connected?(this.disconnect(),this.filters=w()(e).call(e),this.connect()):this.filters=w()(e).call(e),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(Ji),Rd=new Qr,Id=new Jr,kd=new Qr,Dd=new Qr,zd=function(e){h()(n,e);var t=te(n);function n(e){return f()(this,n),(e=t.call(this,e)).panner=e.context.createPanner(),e.panner.panningModel="HRTF",e.panner.connect(e.gain),e}return m()(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){var t;c()(p()(n.prototype),"updateMatrixWorld",this).call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying||(this.matrixWorld.decompose(Rd,Id,kd),Dd.set(0,0,1).applyQuaternion(Id),(e=this.panner).positionX?(t=this.context.currentTime+this.listener.timeDelta,e.positionX.linearRampToValueAtTime(Rd.x,t),e.positionY.linearRampToValueAtTime(Rd.y,t),e.positionZ.linearRampToValueAtTime(Rd.z,t),e.orientationX.linearRampToValueAtTime(Dd.x,t),e.orientationY.linearRampToValueAtTime(Dd.y,t),e.orientationZ.linearRampToValueAtTime(Dd.z,t)):(e.setPosition(Rd.x,Rd.y,Rd.z),e.setOrientation(Dd.x,Dd.y,Dd.z)))}}]),n}(Pd),Nd=function(){function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2048;f()(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return m()(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Od=function(){function e(t,n,r){var i,a,o;switch(f()(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return m()(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r;if(0===(e=this.cumulativeWeight)){for(var a=0;a!==r;++a)n[i+a]=n[a];e=t}else this._mixBufferRegion(n,i,0,t/(e+=t),r);this.cumulativeWeight=e}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t,n=this.valueSize,r=this.buffer,i=e*n+n,a=(e=this.cumulativeWeight,this.cumulativeWeightAdditive),o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,e<1&&(t=n*this._origIndex,this._mixBufferRegion(r,i,t,1-e,n)),0<a&&this._mixBufferRegionAdditive(r,i,this._addIndex*n,1,n);for(var s=n,l=n+n;s!==l;++s)if(r[s]!==r[s+n]){o.setValue(r,i);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,i){if(.5<=r)for(var a=0;a!==i;++a)e[t+a]=e[n+a]}},{key:"_slerp",value:function(e,t,n,r){Jr.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,i){i=this._workIndex*i,Jr.multiplyQuaternionsFlat(e,i,e,t,e,n),Jr.slerpFlat(e,t,e,t,e,i,r)}},{key:"_lerp",value:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}}]),e}(),Bd=(q="\\[\\]\\.:\\/",new RegExp("["+q+"]","g")),Fd=(t="[^"+q+"]",n="[^"+q.replace("\\.","")+"]",q=/((?:WC+[\/:])*)/.source.replace("WC",t),n=/(WCOD+)?/.source.replace("WCOD",n),/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t)),Ud=(t=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),new RegExp("^"+q+n+Fd+t+"$")),Hd=["material","materials","bones"];function Vd(e,t,n){n=n||Gd.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Gd(e,t,n){this.path=t,this.parsedPath=n||Gd.parseTrackName(t),this.node=Gd.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}g()(Vd.prototype,{getValue:function(e,t){Q()(this).call(this);var n=this._targetGroup.nCachedObjects_;void 0!==(n=this._bindings[n])&&n.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e,t=this._bindings,n=this._targetGroup.nCachedObjects_,r=t.length;n!==r;++n)Q()(e=t[n]).call(e)},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),g()(Gd,{Composite:Vd,create:function(e,t,n){return new(e&&e.isAnimationObjectGroup?Gd.Composite:Gd)(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Bd,"")},parseTrackName:function(e){if(!(n=Ud.exec(e)))throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t,n,r=(n={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]}).nodeName&&J()(r=n.nodeName).call(r,".");if(void 0!==r&&-1!==r&&(t=n.nodeName.substring(r+1),-1!==y()(Hd).call(Hd,t))&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t),null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}return e.children&&(n=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;if(i=e(i.children))return i}return null}(e.children))?n:null}}),g()(Gd.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){Q()(this).call(this),this.getValue(e,t)},setValue:function(e,t){Q()(this).call(this),this.setValue(e,t)},bind:function(){var e=this.node,t=(s=this.parsedPath).objectName,n=s.propertyName,r=s.propertyIndex;if(e||(e=Gd.findNode(this.rootNode,s.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(t){var i=s.objectIndex;switch(t){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===i){i=a;break}break;default:if(void 0===e[t])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[t]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}var o=e[n];if(void 0===o)s=s.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+s+"."+n+" but it wasn't found.",e);else{var s=this.Versioning.None,l=(void 0!==(this.targetObject=e).needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate),this.BindingType.Direct);if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else void 0!==o.fromArray&&void 0!==o.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):M()(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),g()(Gd.prototype,{_getValue_unbound:Gd.prototype.getValue,_setValue_unbound:Gd.prototype.setValue});var Wd=function(){function e(){f()(this,e),this.uuid=Ur.generateUUID(),this._objects=w()(Array.prototype).call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}return m()(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,l=this.nCachedObjects_,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],d=h.uuid,p=t[d];if(void 0===p){p=s++,t[d]=p,e.push(h);for(var f=0,m=a;f!==m;++f)i[f].push(new Gd(h,n[f],r[f]))}else if(p<l){o=e[p];var v=--l,g=e[v];e[t[g.uuid]=p]=g,e[t[d]=v]=h;for(var y=0,x=a;y!==x;++y){var w=i[y],b=w[v],_=w[p];w[p]=b,void 0===_&&(_=new Gd(h,n[y],r[y])),w[v]=_}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,c=t[l];if(void 0!==c&&i<=c){var u=i++,h=e[u];e[t[h.uuid]=c]=h,e[t[l]=u]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[u],v=f[c];f[c]=m,f[u]=v}}}this.nCachedObjects_=i}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=t[u=arguments[o].uuid];if(void 0!==l)if(delete t[u],l<i){var c=--i,u=e[c],h=--a,d=e[h];e[t[u.uuid]=l]=u,e[t[d.uuid]=c]=d,e.pop();for(var p=0,f=r;p!==f;++p){var m=n[p],v=m[c],g=m[h];m[l]=v,m[c]=g,m.pop()}}else{var y=--a;u=e[y];0<y&&(t[u.uuid]=l),e[l]=u,e.pop();for(var x=0,w=r;x!==w;++x){var b=n[x];b[l]=b[y],b.pop()}}}this.nCachedObjects_=i}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);r=i.length;n[e]=r,a.push(e),o.push(t),i.push(u);for(var h=c,d=s.length;h!==d;++h){var p=s[h];u[h]=new Gd(p,e,t)}return u}},{key:"unsubscribe_",value:function(e){var t,n,r,i,a,o=this._bindingsIndicesByPath,s=o[e];void 0!==s&&(t=this._paths,n=this._parsedPaths,a=(r=this._bindings)[i=r.length-1],r[o[e[i]]=s]=a,r.pop(),n[s]=n[i],n.pop(),t[s]=t[i],t.pop())}}]),e}(),jd=(Wd.prototype.isAnimationObjectGroup=!0,function(){function e(t,n){for(var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n.blendMode,a=(f()(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=i,n.tracks),o=a.length,s=new Array(o),l={endingStart:Vn,endingEnd:Vn},c=0;c!==o;++c){var u=a[c].createInterpolant(null);(s[c]=u).settings=l}this._interpolantSettings=l,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=On,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return m()(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){var r,i;return e.fadeOut(t),this.fadeIn(t),n&&(i=(n=this._clip.duration)/(r=e._clip.duration),e.warp(1,r/n,t),this.warp(i,1,t)),this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=(a=this._mixer).time,i=this.timeScale,a=(null===(o=this._timeScaleInterpolant)&&(o=a._lendControlInterpolant(),this._timeScaleInterpolant=o),o.parameterPositions),o=o.sampleValues;return a[0]=r,a[1]=r+n,o[0]=e/i,o[1]=t/i,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){if((i=(e-i)*n)<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var a=this._updateTime(t),o=this._updateWeight(e);if(0<o){var s=this._interpolants,l=this._propertyBindings;if(this.blendMode===qn)for(var c=0,u=s.length;c!==u;++c)s[c].evaluate(a),l[c].accumulateAdditive(o);else for(var h=0,d=s.length;h!==d;++h)s[h].evaluate(a),l[h].accumulate(r,o)}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t,n,r=0;return this.enabled&&(r=this.weight,null!==(t=this._weightInterpolant))&&(r*=n=t.evaluate(e)[0],e>t.parameterPositions[1])&&(this.stopFading(),0===n)&&(this.enabled=!1),this._effectiveWeight=r}},{key:"_updateTimeScale",value:function(e){var t,n=0;return this.paused||(n=this.timeScale,null!==(t=this._timeScaleInterpolant)&&(n*=t.evaluate(e)[0],e>t.parameterPositions[1])&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n)),this._effectiveTimeScale=n}},{key:"_updateTime",value:function(e){var t,n=this._clip.duration,r=this.loop,i=this.time+e,a=this._loopCount,o=r===Bn;if(0===e)return-1!==a&&o&&1==(1&a)?n-i:i;if(r===Nn){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=i)i=n;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else if(-1===a&&(0<=e?this._setEndings(!(a=0),0===this.repetitions,o):this._setEndings(0===this.repetitions,!0,o)),n<=i||i<0?(i-=n*(r=Math.floor(i/n)),a+=Math.abs(r),(t=this.repetitions-a)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(1==t?this._setEndings(t=e<0,!t,o):this._setEndings(!1,!1,o),this._loopCount=a,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r}))):this.time=i,o&&1==(1&a))return n-i;return i}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=Gn,r.endingEnd=Gn):(r.endingStart=e?this.zeroSlopeAtStart?Gn:Vn:Wn,r.endingEnd=t?this.zeroSlopeAtEnd?Gn:Vn:Wn)}},{key:"_scheduleFading",value:function(e,t,n){var r=(i=this._mixer).time,i=(null===(a=this._weightInterpolant)&&(a=i._lendControlInterpolant(),this._weightInterpolant=a),a.parameterPositions),a=a.sampleValues;return i[0]=r,a[0]=t,i[1]=r+e,a[1]=n,this}}]),e}()),qd=function(e){h()(n,e);var t=te(n);function n(e){var r;return f()(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return m()(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=(e=this._bindingsByRootAndName)[s];void 0===l&&(e[s]=l={});for(var c=0;c!==i;++c){var u=r[c],h=u.name,d=l[h];if(void 0===d){if(void 0!==(d=a[c])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,h));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(d=new Od(Gd.create(n,h,p),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(d,s,h)}a[c]=d,o[c].resultBuffer=d.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){null===e._cacheIndex&&(t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n],this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t));for(var t,n,r,i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){return null!==(e=e._cacheIndex)&&e<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];void 0===a?(a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a):(i=a.knownActions,e._byClipCacheIndex=i.length,i.push(e)),e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t,n=(t=this._actions)[t.length-1],r=e._cacheIndex,i=(r=(t[n._cacheIndex=r]=n,t.pop(),e._cacheIndex=null,e._clip.uuid),(t=(n=this._actionsByClip)[r]).knownActions),a=i[i.length-1],o=e._byClipCacheIndex;i[a._byClipCacheIndex=o]=a,i.pop(),e._byClipCacheIndex=null,delete t.actionByRoot[(e._localRoot||this._root).uuid],0===i.length&&delete n[r],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(r[t]=a={}),(a[n]=e)._cacheIndex=i.length,i.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=(r=e.binding).rootNode.uuid,r=r.path,i=this._bindingsByRootAndName,a=i[n],o=t[t.length-1];e=e._cacheIndex;t[o._cacheIndex=e]=o,t.pop(),delete a[r],0===R()(a).length&&delete i[n]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(e[(n=new ju(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];t[e.__cacheIndex=r]=e,t[i.__cacheIndex=n]=i}},{key:"clipAction",value:function(e,t,n){var r,i=(r=t||this._root).uuid,a=(e=null!==(r="string"==typeof e?th.findByName(r,e):e)?r.uuid:e,this._actionsByClip[e]),o=null;if(void 0===n&&(n=null!==r?r.blendMode:jn),void 0!==a){var s=a.actionByRoot[i];if(void 0!==s&&s.blendMode===n)return s;o=a.knownActions[0],null===r&&(r=o._clip)}return null===r?null:(s=new jd(this,r,t,n),this._bindAction(s,o),this._addInactiveAction(s,e,i),s)}},{key:"existingAction",value:function(e,t){var n=(t=t||this._root).uuid;t=(t="string"==typeof e?th.findByName(t,e):e)?t.uuid:e;return void 0!==(e=this._actionsByClip[t])&&e.actionByRoot[n]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;0<=t;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=j()(e),a=this._accuIndex^=1,o=0;o!==n;++o)t[o]._update(r,e,i,a);for(var s=this._bindings,l=this._nActiveBindings,c=0;c!==l;++c)s[c].apply(a);return this}},{key:"setTime",value:function(e){for(var t=this.time=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=(e=e.uuid,this._actionsByClip),r=n[e];if(void 0!==r){for(var i=r.knownActions,a=0,o=i.length;a!==o;++a){var s=i[a],l=(this._deactivateAction(s),s._cacheIndex),c=t[t.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,t[c._cacheIndex=l]=c,t.pop(),this._removeInactiveBindingsForAction(s)}delete n[e]}}},{key:"uncacheRoot",value:function(e){var t,n=e.uuid,r=this._actionsByClip;for(t in r){var i=r[t].actionByRoot[n];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[n];if(void 0!==a)for(var o in a)(o=a[o]).restoreOriginalState(),this._removeInactiveBinding(o)}},{key:"uncacheAction",value:function(e,t){null!==(e=this.existingAction(e,t))&&(this._deactivateAction(e),this._removeInactiveAction(e))}}]),n}(zr),Xd=(qd.prototype._controlInterpolantsResultBuffer=new Float32Array(1),function(){function e(t){f()(this,e),"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return m()(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}());function Yd(e,t,n){zl.call(this,e,t),this.meshPerAttribute=n||1}function Zd(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function Jd(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Ei(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Ni,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},S()(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Qd(e,t){return e.distance-t.distance}function Kd(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)Kd(i[a],t,n,!0)}Yd.prototype=g()(T()(zl.prototype),{constructor:Yd,isInstancedInterleavedBuffer:!0,copy:function(e){return zl.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){return(e=zl.prototype.clone.call(this,e)).meshPerAttribute=this.meshPerAttribute,e},toJSON:function(e){return(e=zl.prototype.toJSON.call(this,e)).isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),b()(Zd.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),g()(Zd.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),g()(Jd.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return Kd(e,this,n,t),D()(n).call(n,Qd),n},intersectObjects:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=0,i=e.length;r<i;r++)Kd(e[r],this,n,t);return D()(n).call(n,Qd),n}});var $d=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return f()(this,e),this.radius=t,this.phi=n,this.theta=r,this}return m()(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ur.clamp(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),ep=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return f()(this,e),this.radius=t,this.theta=n,this.y=r,this}return m()(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),tp=new Hr,np=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Hr(1/0,1/0),n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Hr(-1/0,-1/0);f()(this,e),this.min=t,this.max=n}return m()(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){return t=tp.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Hr),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Hr),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Hr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Hr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return tp.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}(),rp=(np.prototype.isBox2=!0,new Qr),ip=new Qr,ap=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr;f()(this,e),this.start=t,this.end=n}return m()(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Qr),e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Qr),e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Qr),this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){return rp.subVectors(e,this.start),ip.subVectors(this.end,this.start),e=ip.dot(ip),e=ip.dot(rp)/e,t?Ur.clamp(e,0,1):e}},{key:"closestPointToPoint",value:function(e,t,n){return e=this.closestPointToPointParameter(e,t),void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Qr),this.delta(n).multiplyScalar(e).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function op(e){Ji.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}((op.prototype=T()(Ji.prototype)).constructor=op).prototype.isImmediateRenderObject=!0;var sp=new Qr,lp=function(e){h()(n,e);var t=te(n);function n(e,r){f()(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;e=new ja;for(var i,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],o=0,s=1;o<32;o++,s++){var l=o/32*Math.PI*2,c=s/32*Math.PI*2;a.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}return e.setAttribute("position",new ka(a,3)),r=new yc({fog:!1,toneMapped:!1}),i.cone=new Ac(e,r),i.add(i.cone),i.update(),i}return m()(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance||1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),sp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(sp),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(Ji),cp=new Qr,up=new Si,hp=new Si,dp=function(e){h()(n,e);var t=te(n);function n(e){f()(this,n);for(var r=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),i=new ja,a=[],o=[],s=new wa(0,0,1),l=new wa(0,1,0),c=0;c<r.length;c++){var u=r[c];u.parent&&u.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),o.push(s.r,s.g,s.b),o.push(l.r,l.g,l.b))}i.setAttribute("position",new ka(a,3)),i.setAttribute("color",new ka(o,3));var h=new yc({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(i=t.call(this,i,h)).type="SkeletonHelper",i.isSkeletonHelper=!0,i.root=e,i.bones=r,i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i}return m()(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,i=r.getAttribute("position");hp.copy(this.root.matrixWorld).invert();for(var a=0,o=0;a<t.length;a++){var s=t[a];s.parent&&s.parent.isBone&&(up.multiplyMatrices(hp,s.matrixWorld),cp.setFromMatrixPosition(up),i.setXYZ(o,cp.x,cp.y,cp.z),up.multiplyMatrices(hp,s.parent.matrixWorld),cp.setFromMatrixPosition(up),i.setXYZ(o+1,cp.x,cp.y,cp.z),o+=2)}r.getAttribute("position").needsUpdate=!0,c()(p()(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Ac),pp=function(e){h()(n,e);var t=te(n);function n(e,r,i){f()(this,n);r=new Mu(r,4,2);var a=new ba({wireframe:!0,fog:!1,toneMapped:!1});return(r=t.call(this,r,a)).light=e,r.light.updateMatrixWorld(),r.color=i,r.type="PointLightHelper",r.matrix=r.light.matrixWorld,r.matrixAutoUpdate=!1,r.update(),r}return m()(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(co),fp=new Qr,mp=new wa,vp=new wa,gp=function(e){h()(n,e);var t=te(n);function n(e,r,i){f()(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i;var a;(e=new xu(r)).rotateY(.5*Math.PI),a.material=new ba({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0),i=e.getAttribute("position"),r=new Float32Array(3*i.count);return e.setAttribute("color",new Ea(r,3)),a.add(new co(e,a.material)),a.update(),a}return m()(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");mp.copy(this.light.color),vp.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?mp:vp;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(fp.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(Ji),yp=function(e){h()(n,e);var t=te(n);function n(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4473924,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:8947848,o=(f()(this,n),i=new wa(i),a=new wa(a),r/2),s=e/r,l=e/2,c=[],u=[],h=0,d=0,p=-l;h<=r;h++,p+=s){c.push(-l,0,p,l,0,p),c.push(p,0,-l,p,0,l);var m=h===o?i:a;m.toArray(u,d),d+=3,m.toArray(u,d),d+=3,m.toArray(u,d),d+=3,m.toArray(u,d),d+=3}var v=((e=new ja).setAttribute("position",new ka(c,3)),e.setAttribute("color",new ka(u,3)),new yc({vertexColors:!0,toneMapped:!1}));return(e=t.call(this,e,v)).type="GridHelper",e}return m()(n)}(Ac),xp=function(e){h()(n,e);var t=te(n);function n(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:8,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:64,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4473924,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:8947848,l=(f()(this,n),o=new wa(o),s=new wa(s),[]),c=[],u=0;u<=r;u++){var h=u/r*(2*Math.PI),d=Math.sin(h)*e;h=Math.cos(h)*e,d=(l.push(0,0,0),l.push(d,0,h),1&u?o:s);c.push(d.r,d.g,d.b),c.push(d.r,d.g,d.b)}for(var p=0;p<=i;p++)for(var m=1&p?o:s,v=e-e/i*p,g=0;g<a;g++){var y=g/a*(2*Math.PI),x=Math.sin(y)*v,w=Math.cos(y)*v;l.push(x,0,w),c.push(m.r,m.g,m.b),y=(g+1)/a*(2*Math.PI),x=Math.sin(y)*v,w=Math.cos(y)*v,l.push(x,0,w),c.push(m.r,m.g,m.b)}var b=new ja,_=(b.setAttribute("position",new ka(l,3)),b.setAttribute("color",new ka(c,3)),new yc({vertexColors:!0,toneMapped:!1}));return(b=t.call(this,b,_)).type="PolarGridHelper",b}return m()(n)}(Ac),wp=new Qr,bp=new Qr,_p=new Qr,Mp=function(e){h()(n,e);var t=te(n);function n(e,r,i){f()(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=i,void 0===r&&(r=1);var a;(e=new ja).setAttribute("position",new ka([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3)),i=new yc({fog:!1,toneMapped:!1});return a.lightPlane=new Ec(e,i),a.add(a.lightPlane),(e=new ja).setAttribute("position",new ka([0,0,0,0,0,1],3)),a.targetLine=new Ec(e,i),a.add(a.targetLine),a.update(),a}return m()(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){wp.setFromMatrixPosition(this.light.matrixWorld),bp.setFromMatrixPosition(this.light.target.matrixWorld),_p.subVectors(bp,wp),this.lightPlane.lookAt(bp),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bp),this.targetLine.scale.z=_p.length()}}]),n}(Ji),Ep=new Qr,Sp=new go,Tp=function(e){h()(n,e);var t=te(n);function n(e){f()(this,n);var r=new ja,i=new yc({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],s={},l=new wa(16755200),c=new wa(16711680),u=new wa(43775),h=new wa(16777215),d=new wa(3355443);function p(e,t,n){m(e,n),m(t,n)}function m(e,t){a.push(0,0,0),o.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(a.length/3-1)}return p("n1","n2",l),p("n2","n4",l),p("n4","n3",l),p("n3","n1",l),p("f1","f2",l),p("f2","f4",l),p("f4","f3",l),p("f3","f1",l),p("n1","f1",l),p("n2","f2",l),p("n3","f3",l),p("n4","f4",l),p("p","n1",c),p("p","n2",c),p("p","n3",c),p("p","n4",c),p("u1","u2",u),p("u2","u3",u),p("u3","u1",u),p("c","t",h),p("p","c",d),p("cn1","cn2",d),p("cn3","cn4",d),p("cf1","cf2",d),p("cf3","cf4",d),r.setAttribute("position",new ka(a,3)),r.setAttribute("color",new ka(o,3)),(l=t.call(this,r,i)).type="CameraHelper",l.camera=e,l.camera.updateProjectionMatrix&&l.camera.updateProjectionMatrix(),l.matrix=e.matrixWorld,l.matrixAutoUpdate=!1,l.pointMap=s,l.update(),l}return m()(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;Sp.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ap("c",t,e,Sp,0,0,-1),Ap("t",t,e,Sp,0,0,1),Ap("n1",t,e,Sp,-1,-1,-1),Ap("n2",t,e,Sp,1,-1,-1),Ap("n3",t,e,Sp,-1,1,-1),Ap("n4",t,e,Sp,1,1,-1),Ap("f1",t,e,Sp,-1,-1,1),Ap("f2",t,e,Sp,1,-1,1),Ap("f3",t,e,Sp,-1,1,1),Ap("f4",t,e,Sp,1,1,1),Ap("u1",t,e,Sp,.7,1.1,-1),Ap("u2",t,e,Sp,-.7,1.1,-1),Ap("u3",t,e,Sp,0,2,-1),Ap("cf1",t,e,Sp,-1,0,1),Ap("cf2",t,e,Sp,1,0,1),Ap("cf3",t,e,Sp,0,-1,1),Ap("cf4",t,e,Sp,0,1,1),Ap("cn1",t,e,Sp,-1,0,-1),Ap("cn2",t,e,Sp,1,0,-1),Ap("cn3",t,e,Sp,0,-1,-1),Ap("cn4",t,e,Sp,0,1,-1),e.getAttribute("position").needsUpdate=!0}}]),n}(Ac);function Ap(e,t,n,r,i,a,o){Ep.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),c=0,u=s.length;c<u;c++)l.setXYZ(s[c],Ep.x,Ep.y,Ep.z)}var Lp,Cp,Pp=new ei,Rp=function(e){h()(n,e);var t=te(n);function n(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16776960,i=(f()(this,n),new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7])),a=new Float32Array(24),o=new ja;return o.setIndex(new Ea(i,1)),o.setAttribute("position",new Ea(a,3)),(i=t.call(this,o,new yc({color:r,toneMapped:!1}))).object=e,i.type="BoxHelper",i.matrixAutoUpdate=!1,i.update(),i}return m()(n,[{key:"update",value:function(e){var t,n,r;void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Pp.setFromObject(this.object),Pp.isEmpty()||(e=Pp.min,t=Pp.max,(r=(n=this.geometry.attributes.position).array)[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere())}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return Ac.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(Ac),Ip=function(e){h()(n,e);var t=te(n);function n(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:16776960,i=(f()(this,n),new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7])),a=new ja;return a.setIndex(new Ea(i,1)),a.setAttribute("position",new ka([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(i=t.call(this,a,new yc({color:r,toneMapped:!1}))).box=e,i.type="Box3Helper",i.geometry.computeBoundingSphere(),i}return m()(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),c()(p()(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(Ac),kp=function(e){h()(n,e);var t=te(n);function n(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:16776960,a=(f()(this,n),new ja);return(e=(a.setAttribute("position",new ka([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),(a=t.call(this,a,new yc({color:i,toneMapped:!1}))).type="PlaneHelper",a.plane=e,a.size=r,new ja)).setAttribute("position",new ka([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),e.computeBoundingSphere(),a.add(new co(e,new ba({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),a}return m()(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?fe:pe,this.lookAt(this.plane.normal),c()(p()(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(Ec),Dp=new Qr,zp=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Qr(0,0,1),i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Qr(0,0,0),a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:16776960,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:.2*a,l=5<arguments.length&&void 0!==arguments[5]?arguments[5]:.2*s;return f()(this,n),(e=t.call(this)).type="ArrowHelper",void 0===Lp&&((Lp=new ja).setAttribute("position",new ka([0,0,0,0,1,0],3)),(Cp=new Hc(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(i),e.line=new Ec(Lp,new yc({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new co(Cp,new ba({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(a,s,l),e}return m()(n,[{key:"setDirection",value:function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Dp.set(e.z,0,-e.x).normalize(),e=Math.acos(e.y),this.quaternion.setFromAxisAngle(Dp,e))}},{key:"setLength",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.2*e,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return c()(p()(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(Ji),Np=function(e){h()(n,e);var t=te(n);function n(){var e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;f()(this,n),r=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],(e=new ja).setAttribute("position",new ka(r,3)),e.setAttribute("color",new ka([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),r=new yc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,e,r)).type="AxesHelper",e}return m()(n)}(Ac),Op=new Float32Array(1),Bp=new Int32Array(Op.buffer),Fp={toHalfFloat:function(e){Op[0]=e;var t=(e=Bp[0])>>16&32768,n=e>>12&2047,r=e>>23&255;if(!(r<103)){if(142<r)return 31744|t|((255==r?0:1)&&8388607&e);if(r<113)return t|((n|=2048)>>114-r)+(n>>113-r&1);t=(t|r-112<<10|n>>1)+(1&n)}return t}},Up=Math.pow(2,8),Hp=[.125,.215,.35,.446,.526,.582],Vp=5+Hp.length,Gp=(q={},s()(q,Jn,0),s()(q,Qn,1),s()(q,$n,2),s()(q,tr,3),s()(q,nr,4),s()(q,rr,5),s()(q,Kn,6),q),Wp=new ba({side:fe,depthWrite:!1,depthTest:!1}),jp=new co(new ho,Wp),qp=new Zh,Xp=(n=function(){for(var e=[],t=[],n=[],r=8,i=0;i<Vp;i++){for(var a=Math.pow(2,r),o=(t.push(a),1/a),s=(o=(4<i?o=Hp[i-8+4-1]:0==i&&(o=0),n.push(o),1/(a-1)),[a=-o/2,a,o=1+o/2,a,o,o,a,a,o,o,a,o]),l=new Float32Array(108),c=new Float32Array(72),u=new Float32Array(36),h=0;h<6;h++){var d=h%3*2/3-1,p=2<h?0:-1;l.set([d,p,0,d+2/3,p,0,d+2/3,1+p,0,d,p,0,d+2/3,1+p,0,d,1+p,0],18*h),c.set(s,12*h),u.set([h,h,h,h,h,h],6*h)}(a=new ja).setAttribute("position",new Ea(l,3)),a.setAttribute("uv",new Ea(c,2)),a.setAttribute("faceIndex",new Ea(u,1)),e.push(a),4<r&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}())._lodPlanes,Yp=n._sizeLods,Zp=n._sigmas,Jp=new wa,Qp=null,Kp=(t=1/(Fd=(1+Math.sqrt(5))/2),[new Qr(1,1,1),new Qr(-1,1,1),new Qr(1,1,-1),new Qr(-1,1,-1),new Qr(0,Fd,t),new Qr(0,Fd,-t),new Qr(t,0,Fd),new Qr(-t,0,Fd),new Qr(Fd,t,0),new Qr(-Fd,t,0)]);function $p(e){var t=Math.max(e.r,e.g,e.b);t=Math.min(Math.max(Math.ceil(B()(t)),-128),127);return e.multiplyScalar(Math.pow(2,-t)),(t+128)/255}var ef=function(){function e(t){var n,r;f()(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(t=20,n=new Float32Array(t),r=new Qr(0,1,0),new Iu({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:Gp[Jn]},outputEncoding:{value:Gp[Jn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:ye,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return m()(e,[{key:"fromScene",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100,i=(Qp=this._renderer.getRenderTarget(),this._allocateTargets());return this._sceneToCubeUV(e,n,r,i),0<t&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=af(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=rf(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Xp.length;e++)Xp[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Qp),e.scissorTest=!1,nf(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){Qp=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:pt,minFilter:pt,generateMipmaps:!1,type:Mt,format:Ut,encoding:void 0===(t=e)||t.type!==Mt||t.encoding!==Jn&&t.encoding!==Qn&&t.encoding!==Kn?$n:e.encoding,depthBuffer:!1},n=tf(t);return n.depthBuffer=!e,this._pingPongRenderTarget=tf(t),n}},{key:"_compileMaterial",value:function(e){e=new co(Xp[0],e),this._renderer.compile(e,qp)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var i=new yo(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=(t=s.autoClear,n=s.outputEncoding,s.toneMapping),c=(s.getClearColor(Jp),s.toneMapping=Qe,s.outputEncoding=Jn,s.autoClear=!1),u=e.background;u?u.isColor&&(Wp.color.copy(u).convertSRGBToLinear(),e.background=null,u=$p(Wp.color),Wp.opacity=u,c=!0):(Wp.color.copy(Jp).convertSRGBToLinear(),u=$p(Wp.color),Wp.opacity=u,c=!0);for(var h=0;h<6;h++){var d=h%3;0==d?(i.up.set(0,a[h],0),i.lookAt(o[h],0,0)):1==d?(i.up.set(0,0,a[h]),i.lookAt(0,o[h],0)):(i.up.set(0,a[h],0),i.lookAt(0,0,o[h])),nf(r,d*Up,2<h?Up:0,Up,Up),s.setRenderTarget(r),c&&s.render(jp,i),s.render(e,i)}s.toneMapping=l,s.outputEncoding=n,s.autoClear=t}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=(e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=af()):null==this._equirectShader&&(this._equirectShader=rf()),e.isCubeTexture?this._cubemapShader:this._equirectShader),i=new co(Xp[0],r);((r=r.uniforms).envMap.value=e).isCubeTexture||r.texelSize.value.set(1/e.image.width,1/e.image.height),r.inputEncoding.value=Gp[e.encoding],r.outputEncoding.value=Gp[t.texture.encoding],nf(t,0,0,3*Up,2*Up),n.setRenderTarget(t),n.render(i,qp)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Vp;r++){var i=Math.sqrt(Zp[r]*Zp[r]-Zp[r-1]*Zp[r-1]);this._blur(e,r-1,r,i,Kp[(r-1)%Kp.length])}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}},{key:"_halfBlur",value:function(e,t,n,r,i,a,o){for(var s=this._renderer,l=this._blurMaterial,c=("latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!"),new co(Xp[r],l)),u=(l=l.uniforms,Yp[n]-1),h=i/(u=isFinite(i)?Math.PI/(2*u):2*Math.PI/39),d=isFinite(i)?1+Math.floor(3*h):20,p=(20<d&&console.warn(G()(i=G()(i="sigmaRadians, ".concat(i,", is too large and will clip, as it requested ")).call(i,d," samples when the maximum is set to ")).call(i,20)),[]),f=0,m=0;m<20;++m){var v=m/h;v=Math.exp(-v*v/2);p.push(v),0==m?f+=v:m<d&&(f+=2*v)}for(var g=0;g<p.length;g++)p[g]=p[g]/f;l.envMap.value=e.texture,l.samples.value=d,l.weights.value=p,l.latitudinal.value="latitudinal"===a,o&&(l.poleAxis.value=o),l.dTheta.value=u,l.mipInt.value=8-n,l.inputEncoding.value=Gp[e.texture.encoding],l.outputEncoding.value=Gp[e.texture.encoding],i=Yp[r],nf(t,3*Math.max(0,Up-2*i),(0===r?0:2*Up)+2*i*(4<r?r-8+4:0),3*i,2*i),s.setRenderTarget(t),s.render(c,qp)}}]),e}();function tf(e){return(e=new Yr(3*Up,3*Up,e)).texture.mapping=lt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function nf(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function rf(){var e=new Hr(1,1);return new Iu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Gp[Jn]},outputEncoding:{value:Gp[Jn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:ye,depthTest:!1,depthWrite:!1})}function af(){return new Iu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Gp[Jn]},outputEncoding:{value:Gp[Jn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:ye,depthTest:!1,depthWrite:!1})}var of=0,sf=1,lf=0,cf=1,uf=2;function hf(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function df(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,(e.materials=e).clone=function(){return w()(e).call(e)},e}function pf(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Dc(e,t)}function ff(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Kl(e)}function mf(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Dc(e,t)}function vf(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Cc(e)}function gf(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Cc(e)}function yf(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Cc(e)}function xf(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Qr(e,t,n)}function wf(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Ea(e,t).setUsage(Sr)}function bf(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Sa(e,t)}function _f(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ta(e,t)}function Mf(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Aa(e,t)}function Ef(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new La(e,t)}function Sf(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ca(e,t)}function Tf(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Pa(e,t)}function Af(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ra(e,t)}function Lf(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ka(e,t)}function Cf(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Da(e,t)}function Pf(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Np(e)}function Rf(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Rp(e,t)}function If(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ac(new Zc(e.geometry),new yc({color:void 0!==t?t:16777215}))}function kf(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ac(new Cu(e.geometry),new yc({color:void 0!==t?t:16777215}))}function Df(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new sh(e)}function zf(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new dh(e)}function Nf(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new bo(e,n)}function Of(){console.error("THREE.CanvasRenderer has been removed")}function Bf(){console.error("THREE.JSONLoader has been removed.")}fh.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=T()(fh.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},zh.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},yp.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},dp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ah.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),rd.extractUrlBase(e)},ah.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},np.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},np.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},np.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},np.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},ei.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ei.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ei.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ei.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},ei.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},vi.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},So.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},ap.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ur.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},Ur.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ur.floorPowerOfTwo(e)},Ur.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ur.ceilPowerOfTwo(e)},Vr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Vr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Vr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Vr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Vr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Vr.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Si.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Si.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Si.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Qr).setFromMatrixColumn(this,3)},Si.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Si.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Si.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Si.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Si.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Si.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Si.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Si.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Si.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Si.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Si.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Si.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Si.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Si.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Si.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)},Si.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ea.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Jr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Jr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ei.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ei.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},Ei.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},ha.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ha.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},ha.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},ha.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},ha.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},ha.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ha.getBarycoord(e,t,n,r,i)},ha.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ha.getNormal(e,t,n,r)},Nh.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Nh.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new mu(this,e)},Nh.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new _u(this,e)},Hr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Hr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Hr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Qr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Qr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Qr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Qr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Qr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Qr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Qr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Qr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Qr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Xr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Xr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ji.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Ji.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ji.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Ji.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ji.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},S()(Ji.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),co.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},S()(co.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xn},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),S()(nc.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),b()(dc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),lc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},b()(fh.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),yo.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},S()(Oh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),S()(Ea.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Sr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Sr)}}}),Ea.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Sr:Er),this},Ea.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ea.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ja.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},ja.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Ea(t,arguments[2])))},ja.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},ja.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ja.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ja.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},ja.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},S()(ja.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),S()(id.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),S()(Jd.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),S()(zl.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Sr},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),zl.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Sr:Er),this},zl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},mu.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},mu.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},mu.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Dl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},S()(Xd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),S()(pa.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new wa}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===ve}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),S()(zu.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),S()(Du.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),S()(vo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Pl.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},Pl.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},Pl.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Pl.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Pl.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Pl.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Pl.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Pl.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Pl.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Pl.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Pl.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Pl.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Pl.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Pl.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Pl.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},Pl.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Pl.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Pl.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Pl.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Pl.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Pl.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Pl.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Pl.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Pl.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Pl.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},S()(Pl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Qn:Jn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),S()(bl.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),S()(Yr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),_()(this.texture)},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),S()(Pd.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new gd).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Nd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},xo.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},xo.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},Gr.crossOrigin=void 0,Gr.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=((i=new ph).setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},Gr.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=((i=new hh).setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},Gr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Ff={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Uf(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ne}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ne)},function(e,t,n){"use strict";(function(e){var r,i=n(138);const a=Object.prototype.toString,o=Object.getPrototypeOf,s=(r=Object.create(null),e=>(e=a.call(e),r[e]||(r[e]=e.slice(8,-1).toLowerCase())));var l=e=>(e=e.toLowerCase(),t=>s(t)===e),c=e=>t=>typeof t===e;const u=Array.isArray,h=c("undefined"),d=l("ArrayBuffer");var p=c("string");const f=c("function"),m=c("number"),v=e=>null!==e&&"object"==typeof e,g=e=>{var t;return"object"===s(e)&&!(null!==(t=o(e))&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)};c=l("Date");var y=l("File"),x=l("Blob"),w=l("FileList"),b=l("URLSearchParams");function _(e,t,{allOwnKeys:n=!1}={}){if(null!=e){let s;var r;if("object"!=typeof e&&(e=[e]),u(e))for(s=0,r=e.length;s<r;s++)t.call(null,e[s],s,e);else{var i,a=n?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;for(s=0;s<o;s++)i=a[s],t.call(null,e[i],i,e)}}}function M(e,t){t=t.toLowerCase();var n,r=Object.keys(e);let i=r.length;for(;0<i--;)if(t===(n=r[i]).toLowerCase())return n;return null}const E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e,S=e=>!h(e)&&e!==E;T="undefined"!=typeof Uint8Array&&o(Uint8Array);e=e=>T&&e instanceof T;var T,A,L=l("HTMLFormElement"),C=(A=Object.prototype.hasOwnProperty,(e,t)=>A.call(e,t)),P=l("RegExp");const R=(e,t)=>{var n=Object.getOwnPropertyDescriptors(e);const r={};_(n,(n,i)=>{!1!==t(n,i,e)&&(r[i]=n)}),Object.defineProperties(e,r)};var I="abcdefghijklmnopqrstuvwxyz",k="0123456789";const D={DIGIT:k,ALPHA:I,ALPHA_DIGIT:I+I.toUpperCase()+k};t.a={isArray:u,isArrayBuffer:d,isBuffer:function(e){return null!==e&&!h(e)&&null!==e.constructor&&!h(e.constructor)&&f(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||a.call(e)===t||f(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&d(e.buffer)},isString:p,isNumber:m,isBoolean:e=>!0===e||!1===e,isObject:v,isPlainObject:g,isUndefined:h,isDate:c,isFile:y,isBlob:x,isRegExp:P,isFunction:f,isStream:e=>v(e)&&f(e.pipe),isURLSearchParams:b,isTypedArray:e,isFileList:w,forEach:_,merge:function e(){const t=(S(this)&&this||{}).caseless,n={};var r=(r,i)=>{i=t&&M(n,i)||i,g(n[i])&&g(r)?n[i]=e(n[i],r):g(r)?n[i]=e({},r):u(r)?n[i]=r.slice():n[i]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&_(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(_(t,(t,r)=>{n&&f(t)?e[r]=Object(i.a)(t,n):e[r]=t},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>65279===e.charCodeAt(0)?e.slice(1):e,inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{var i,a;let s;var l={};if(t=t||{},null!=e)do{for(s=(i=Object.getOwnPropertyNames(e)).length;0<s--;)a=i[s],r&&!r(a,e,t)||l[a]||(t[a]=e[a],l[a]=!0)}while((e=!1!==n&&o(e))&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:s,kindOfTest:l,endsWith:(e,t,n)=>(e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length,-1!==(e=e.indexOf(t,n))&&e===n),toArray:e=>{if(!e)return null;if(u(e))return e;let t=e.length;if(!m(t))return null;for(var n=new Array(t);0<t--;)n[t]=e[t];return n},forEachEntry:(e,t)=>{for(var n=(e&&e[Symbol.iterator]).call(e);(r=n.next())&&!r.done;){var r=r.value;t.call(e,r[0],r[1])}},matchAll:(e,t)=>{for(var n,r=[];null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:L,hasOwnProperty:C,hasOwnProp:C,reduceDescriptors:R,freezeMethods:e=>{R(e,(t,n)=>{if(f(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;var r=e[n];f(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={};var r=e=>{e.forEach(e=>{n[e]=!0})};return u(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>(e=+e,Number.isFinite(e)?e:t),findKey:M,global:E,isContextDefined:S,ALPHABET:D,generateString:(e=16,t=D.ALPHA_DIGIT)=>{let n="";for(var r=t.length;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&f(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(v(e)){if(0<=t.indexOf(e))return;if(!("toJSON"in e)){t[r]=e;const i=u(e)?[]:{};return _(e,(e,t)=>{e=n(e,r+1),h(e)||(i[t]=e)}),t[r]=void 0,i}}return e};return n(e,0)}}}).call(this,n(84))},function(e,t,n){var r=n(224),i=n(131),a=n(419);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=r(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i(e,"prototype",{writable:!1}),t&&a(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(250)},function(e,t,n){e.exports=n(217)},function(e,t,n){e.exports=n(257)},function(e,t,n){e.exports=n(214)},function(e,t,n){e.exports=n(525)},function(e,t,n){var r=n(158),i=n(157),a=n(223);function o(t){var n;return e.exports=o=r?i(n=a).call(n):function(e){return e.__proto__||a(e)},e.exports.__esModule=!0,e.exports.default=e.exports,o(t)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(219)},function(e,t,n){var r=n(380),i=n(157),a=n(394),o=n(401);function s(){var t;return"undefined"!=typeof Reflect&&r?e.exports=s=i(t=r).call(t):e.exports=s=function(e,t,n){var r=o(e,t);if(r)return(r=a(r,t)).get?r.get.call(arguments.length<3?e:n):r.value},e.exports.__esModule=!0,e.exports.default=e.exports,s.apply(this,arguments)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(436)},function(e,t,n){"use strict";function r(e){function t(n,r,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,i)}return a(e,this,arguments)}return t.prototype=e.prototype,t}var i=n(28),a=n(81),o=n(142),s=n(34),l=n(85).f,c=n(172),u=n(24),h=n(64),d=n(65),p=n(35);e.exports=function(e,t){var n,a,f,m,v,g,y=e.target,x=e.global,w=e.stat,b=e.proto,_=x?i:w?i[y]:(i[y]||{}).prototype,M=x?u:u[y]||d(u,y,{})[y],E=M.prototype;for(a in t)v=!(n=c(x?a:y+(w?".":"#")+a,e.forced))&&_&&p(_,a),m=M[a],v&&(g=e.dontCallGetSet?(g=l(_,a))&&g.value:_[a]),f=v&&g?g:t[a],v&&typeof m==typeof f||(v=e.bind&&v?h(f,i):e.wrap&&v?r(f):b&&s(f)?o(f):f,(e.sham||f&&f.sham||m&&m.sham)&&d(v,"sham",!0),d(M,a,v),b&&(p(u,m=y+"Prototype")||d(u,m,{}),d(u[m],a,f),e.real)&&E&&(n||!E[a])&&d(E,a,f))}},function(e,t,n){e.exports=n(225)},function(e,t,n){e.exports=n(296)},function(e,t,n){e.exports=n(183)},function(e,t,n){e.exports=n(261)},function(e,t,n){e.exports=n(266)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r=n(3);function i(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}r.a.inherits(i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:r.a.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const a=i.prototype,o={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{o[e]={value:e}}),Object.defineProperties(i,o),Object.defineProperty(a,"isAxiosError",{value:!0}),i.from=(e,t,n,o,s,l)=>{var c=Object.create(a);return r.a.toFlatObject(e,c,(function(e){return e!==Error.prototype}),e=>"isAxiosError"!==e),i.call(c,e.message,t,n,o,s),c.cause=e,c.name=e.name,l&&Object.assign(c,l),c},t.a=i},function(e,t,n){e.exports=n(478)},function(e,t,n){n=n(99);var r=(i=Function.prototype).call,i=n&&i.bind.bind(r,r);e.exports=n?i:function(e){return function(){return r.apply(e,arguments)}}},function(e,t){e.exports={}},function(e,t,n){e.exports=n(439)},function(e,t,n){var r=n(131),i=n(212);e.exports=function(e,t,n){return(t=i(t))in e?r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(454)},function(e,t,n){(function(t){function n(e){return e&&e.Math==Math&&e}e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(84))},function(e,t,n){e.exports=n(443)},function(e,t,n){var r=n(34),i=(n=n(169)).all;e.exports=n.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},function(e,t,n){n=n(23),e.exports=n({}.isPrototypeOf)},function(e,t,n){var r=n(28),i=n(101),a=n(35),o=n(121),s=n(88),l=n(170),c=i("wks"),u=r.Symbol,h=u&&u.for,d=l?u:u&&u.withoutSetter||o;e.exports=function(e){var t;return a(c,e)&&(s||"string"==typeof c[e])||(t="Symbol."+e,s&&a(u,e)?c[e]=u[e]:c[e]=(l&&h?h:d)(t)),c[e]}},function(e,t,n){e.exports=n(451)},function(e,t,n){var r=(n=n(169)).all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===r}:function(e){return"function"==typeof e}},function(e,t,n){var r=n(23),i=n(54),a=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(i(e),t)}},function(e,t,n){var r=n(24),i=n(35),a=n(128),o=n(50).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||o(t,e,{value:a.f(e)})}},function(e,t,n){e.exports=n(242)},function(e,t,n){var r=n(24);e.exports=function(e){return r[e+"Prototype"]}},function(e,t,n){e.exports=n(533)},function(e,t,n){n=n(20),e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t,n){n=n(99);var r=Function.prototype.call;e.exports=n?r.bind(r):function(){return r.apply(r,arguments)}},function(e,t,n){e.exports=n(460)},function(e,t,n){e.exports=n(496)},function(e,t,n){e.exports=n(222)},function(e,t,n){e.exports=n(448)},function(e,t,n){var r=n(30),i=String,a=TypeError;e.exports=function(e){if(r(e))return e;throw a(i(e)+" is not an object")}},function(e,t,n){e.exports=n(211)},function(e,t,n){function r(e){return o(e)?e:void 0}var i=n(24),a=n(28),o=n(34);e.exports=function(e,t){return arguments.length<2?r(i[e])||r(a[e]):i[e]&&i[e][t]||a[e]&&a[e][t]}},function(e,t,n){e.exports=n(471)},function(e,t,n){var r=n(40),i=n(171),a=n(173),o=n(46),s=n(119),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",p="writable";t.f=r?a?function(e,t,n){var r;return o(e),t=s(t),o(n),"function"==typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]&&(r=u(e,t))&&r[p]&&(e[t]=n.value,n={configurable:(d in n?n:r)[d],enumerable:(h in n?n:r)[h],writable:!1}),c(e,t,n)}:c:function(e,t,n){if(o(e),t=s(t),o(n),i)try{return c(e,t,n)}catch(e){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(67),i=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},function(e,t,n){e.exports=n(226)},function(e,t,n){e.exports=n(464)},function(e,t,n){var r=n(86),i=Object;e.exports=function(e){return i(r(e))}},function(e,t,n){var r=n(522),i=n(523),a=n(215),o=n(524);e.exports=function(e){return r(e)||i(e)||a(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(34),i=n(89),a=TypeError;e.exports=function(e){if(r(e))return e;throw a(i(e)+" is not a function")}},function(e,t){e.exports=!0},function(e,t,n){var r=n(254);e.exports=function(e){return r(e.length)}},function(e,t,n){var r=n(144),i=n(86);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(65);e.exports=function(e,t,n,i){return i&&i.enumerable?e[t]=n:r(e,t,n),e}},function(e,t,n){var r,i,a,o,s=n(186),l=n(28),c=n(30),u=n(65),h=n(35),d=n(146),p=n(125),f=(n=n(106),"Object already initialized"),m=l.TypeError,v=(l=l.WeakMap,s||d.state?((a=d.state||(d.state=new l)).get=a.get,a.has=a.has,a.set=a.set,r=function(e,t){if(a.has(e))throw m(f);return t.facade=e,a.set(e,t),t},i=function(e){return a.get(e)||{}},function(e){return a.has(e)}):(n[o=p("state")]=!0,r=function(e,t){if(h(e,o))throw m(f);return t.facade=e,u(e,o,t),t},i=function(e){return h(e,o)?e[o]:{}},function(e){return h(e,o)}));e.exports={set:r,get:i,has:v,enforce:function(e){return v(e)?i(e):r(e,{})},getterFor:function(e){return function(t){if(c(t)&&(t=i(t)).type===e)return t;throw m("Incompatible receiver, "+e+" required")}}}},function(e,t,n){n(63);var r,i=n(295),a=n(28),o=n(67),s=n(65),l=n(91),c=n(32)("toStringTag");for(r in i){var u;(u=(u=a[r])&&u.prototype)&&o(u)!==c&&s(u,c,r),l[r]=l.Array}},function(e,t,n){"use strict";var r=n(59),i=n(107),a=n(91),o=n(61),s=n(50).f,l=n(154),c=n(155),u=n(57),h=(n=n(40),"Array Iterator"),d=o.set,p=o.getterFor(h);e.exports=l(Array,"Array",(function(e,t){d(this,{type:h,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,c(void 0,!0)):c("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1)}),"values"),o=a.Arguments=a.Array;if(i("keys"),i("values"),i("entries"),!u&&n&&"values"!==o.name)try{s(o,"name",{value:"values"})}catch(e){}},function(e,t,n){var r=n(142),i=n(56),a=n(99),o=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:a?o(e,t):function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(40),i=n(50),a=n(71);e.exports=r?function(e,t,n){return i.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){function r(e){var t=1==e,n=2==e,r=3==e,a=4==e,h=6==e,d=7==e,p=5==e||h;return function(f,m,v,g){for(var y,x,w=s(f),b=o(w),_=i(m,v),M=l(b),E=0,S=(m=g||c,t?m(f,M):n||d?m(f,0):void 0);E<M;E++)if((p||E in b)&&(x=_(y=b[E],E,w),e))if(t)S[E]=x;else if(x)switch(e){case 3:return!0;case 5:return y;case 6:return E;case 2:u(S,y)}else switch(e){case 4:return!1;case 7:u(S,y)}return h?-1:r||a?a:S}}var i=n(64),a=n(23),o=n(144),s=n(54),l=n(58),c=n(148),u=a([].push);e.exports={forEach:r(0),map:r(1),filter:r(2),some:r(3),every:r(4),find:r(5),findIndex:r(6),filterReject:r(7)}},function(e,t,n){var r=n(149),i=n(34),a=n(70),o=n(32)("toStringTag"),s=Object,l="Arguments"==a(function(){return arguments}());e.exports=r?a:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=s(e),o))?t:l?a(e):"Object"==(t=a(e))&&i(e.callee)?"Arguments":t}},function(e,t,n){var r=n(149),i=n(50).f,a=n(65),o=n(35),s=n(275),l=n(32)("toStringTag");e.exports=function(e,t,n,c){e&&(n=n?e:e.prototype,o(n,l)||i(n,l,{configurable:!0,value:t}),c)&&!r&&a(n,"toString",s)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=(n=n(23))({}.toString),i=n("".slice);e.exports=function(e){return i(r(e),8,-1)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){n=n(48),e.exports=n("navigator","userAgent")||""},function(e,t,n){function r(){}var i,a=n(46),o=n(150),s=n(152),l=n(106),c=n(182),u=n(147),h=(n=n(125),"prototype"),d="script",p=n("IE_PROTO"),f=function(e){return"<script>"+e+"</"+d+">"},m=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}m="undefined"==typeof document||document.domain&&i?function(e){e.write(f("")),e.close();var t=e.parentWindow.Object;return e=null,t}(i):(t="javascript:",(e=u("iframe")).style.display="none",c.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var e,t,n=s.length;n--;)delete m[h][s[n]];return m()};l[p]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(r[h]=a(e),n=new r,r[h]=null,n[p]=e):n=m(),void 0===t?n:o.f(n,t)}},function(e,t){},function(e,t,n){function r(e,t){this.stopped=e,this.result=t}var i=n(64),a=n(41),o=n(46),s=n(89),l=n(199),c=n(58),u=n(31),h=n(156),d=n(109),p=n(200),f=TypeError,m=r.prototype;e.exports=function(e,t,n){function v(e){return y&&p(y,"normal",e),new r(!0,e)}function g(e){return S?(o(e),L?C(e[0],e[1],v):C(e[0],e[1])):L?C(e,v):C(e)}var y,x,w,b,_,M,E=n&&n.that,S=!(!n||!n.AS_ENTRIES),T=!(!n||!n.IS_RECORD),A=!(!n||!n.IS_ITERATOR),L=!(!n||!n.INTERRUPTED),C=i(t,E);if(T)y=e.iterator;else if(A)y=e;else{if(!(n=d(e)))throw f(s(e)+" is not iterable");if(l(n)){for(x=0,w=c(e);x<w;x++)if((b=g(e[x]))&&u(m,b))return b;return new r(!1)}y=h(e,n)}for(_=(T?e:y).next;!(M=a(_,y)).done;){try{b=g(M.value)}catch(e){p(y,"throw",e)}if("object"==typeof b&&b&&u(m,b))return b}return new r(!1)}},function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw a("Bad Promise constructor");t=e,n=r})),this.resolve=i(t),this.reject=i(n)}var i=n(56),a=TypeError;e.exports.f=function(e){return new r(e)}},function(e,t,n){"use strict";(function(e){var r=n(3),i=n(21),a=n(139);function o(e){return r.a.isPlainObject(e)||r.a.isArray(e)}function s(e){return r.a.endsWith(e,"[]")?e.slice(0,-2):e}function l(e,t,n){return e?e.concat(t).map((function(e,t){return e=s(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const c=r.a.toFlatObject(r.a,{},null,(function(e){return/^is[A-Z]/.test(e)}));t.a=function(t,n,u){if(!r.a.isObject(t))throw new TypeError("target must be an object");n=n||new(a.a||FormData);const h=(u=r.a.toFlatObject(u,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!r.a.isUndefined(t[e])}))).metaTokens,d=u.visitor||g,p=u.dots,f=u.indexes,m=(u.Blob||"undefined"!=typeof Blob&&Blob)&&r.a.isSpecCompliantForm(n);if(!r.a.isFunction(d))throw new TypeError("visitor must be a function");function v(t){if(null===t)return"";if(r.a.isDate(t))return t.toISOString();if(!m&&r.a.isBlob(t))throw new i.a("Blob is not supported. Use a Buffer instead.");return r.a.isArrayBuffer(t)||r.a.isTypedArray(t)?m&&"function"==typeof Blob?new Blob([t]):e.from(t):t}function g(e,t,i){let a=e;if(e&&!i&&"object"==typeof e)if(r.a.endsWith(t,"{}"))t=h?t:t.slice(0,-2),e=JSON.stringify(e);else if(r.a.isArray(e)&&(c=e,r.a.isArray(c))&&!c.some(o)||(r.a.isFileList(e)||r.a.endsWith(t,"[]"))&&(a=r.a.toArray(e)))return t=s(t),a.forEach((function(e,i){r.a.isUndefined(e)||null===e||n.append(!0===f?l([t],i,p):null===f?t:t+"[]",v(e))})),!1;var c;return!!o(e)||(n.append(l(i,t,p),v(e)),!1)}const y=[],x=Object.assign(c,{defaultVisitor:g,convertValue:v,isVisitable:o});if(r.a.isObject(t))return function e(t,i){if(!r.a.isUndefined(t)){if(-1!==y.indexOf(t))throw Error("Circular reference detected in "+i.join("."));y.push(t),r.a.forEach(t,(function(t,a){!0===(!(r.a.isUndefined(t)||null===t)&&d.call(n,t,r.a.isString(a)?a.trim():a,i,x))&&e(t,i?i.concat(a):[a])})),y.pop()}}(t),n;throw new TypeError("data must be an object")}}).call(this,n(231).Buffer)},function(e,t,n){n=n(420)(),e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(e,t,n){e.exports=n(456)},function(e,t,n){e.exports=n(514)},function(e,t,n){n=n(99);var r=Function.prototype,i=r.apply,a=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(i):function(){return a.apply(i,arguments)})},function(e,t,n){var r=n(70);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r=n(195).charAt,i=n(51),a=n(61),o=n(154),s=n(155),l="String Iterator",c=a.set,u=a.getterFor(l);o(String,"String",(function(e){c(this,{type:l,string:i(e),index:0})}),(function(){var e=u(this),t=e.string,n=e.index;return n>=t.length?s(void 0,!0):(t=r(t,n),e.index+=t.length,s(t,!1))}))},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(40),i=n(41),a=n(143),o=n(71),s=n(59),l=n(119),c=n(35),u=n(171),h=Object.getOwnPropertyDescriptor;t.f=r?h:function(e,t){if(e=s(e),t=l(t),u)try{return h(e,t)}catch(e){}if(c(e,t))return o(!i(a.f,e,t),e[t])}},function(e,t,n){var r=n(87),i=TypeError;e.exports=function(e){if(r(e))throw i("Can't call method on "+e);return e}},function(e,t){e.exports=function(e){return null==e}},function(e,t,n){var r=n(100);n=n(20);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t){var n=String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},function(e,t,n){var r=n(255);e.exports=function(e){return(e=+e)!=e||0==e?0:r(e)}},function(e,t){e.exports={}},function(e,t,n){var r=n(31),i=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw i("Incorrect invocation")}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t,n){n=n(28),e.exports=n.Promise},function(e,t,n){e.exports=n(197)},function(e,t,n){e.exports=n(572)},function(e,t,n){var r=n(132).default,i=n(69);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(488)},function(e,t,n){n=n(20),e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,t,n){var r,i,a=n(28),o=(n=n(72),a.process);a=a.Deno;!(i=(a=(o=o&&o.versions||a&&a.version)&&o.v8)?0<(r=a.split("."))[0]&&r[0]<4?1:+(r[0]+r[1]):i)&&n&&(!(r=n.match(/Edge\/(\d+)/))||74<=r[1])&&(r=n.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},function(e,t,n){var r=n(57),i=n(146);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.27.1",mode:r?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,n){n=n(23),e.exports=n([].slice)},function(e,t,n){var r=n(20),i=n(32),a=n(100),o=i("species");e.exports=function(e){return 51<=a||!r((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var r=n(90),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):a(e,t)}},function(e,t,n){"use strict";var r=n(119),i=n(50),a=n(71);e.exports=function(e,t,n){(t=r(t))in e?i.f(e,t,a(0,n)):e[t]=n}},function(e,t){e.exports={}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(35),i=n(34),a=n(54),o=n(125),s=(n=n(194),o("IE_PROTO")),l=Object,c=l.prototype;e.exports=n?l.getPrototypeOf:function(e){var t;e=a(e);return r(e,s)?e[s]:(t=e.constructor,i(t)&&e instanceof t?t.prototype:e instanceof l?c:null)}},function(e,t,n){var r=n(67),i=n(145),a=n(87),o=n(91),s=n(32)("iterator");e.exports=function(e){if(!a(e))return i(e,s)||i(e,"@@iterator")||o[r(e)]}},function(e,t,n){var r=n(28),i=n(94),a=n(34),o=n(172),s=n(175),l=n(32),c=n(319),u=n(205),h=n(57),d=n(100),p=i&&i.prototype,f=l("species"),m=!1,v=a(r.PromiseRejectionEvent);n=o("Promise",(function(){var e=s(i),t=e!==String(i);if(!t&&66===d)return!0;if(h&&(!p.catch||!p.finally))return!0;if(!d||d<51||!/native code/.test(e)){function n(e){e((function(){}),(function(){}))}if(((e=new i((function(e){e(1)}))).constructor={})[f]=n,!(m=e.then((function(){}))instanceof n))return!0}return!t&&(c||u)&&!v}));e.exports={CONSTRUCTOR:n,REJECTION_EVENT:v,SUBCLASSING:m}},function(e,t,n){"use strict";var r=n(20);e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){return 1},1)}))}},function(e,t,n){function r(e){c(e,v,{value:{objectID:"O"+g++,weakData:{}}})}var i=n(14),a=n(23),o=n(106),s=n(30),l=n(35),c=n(50).f,u=n(126),h=n(184),d=n(475),p=n(121),f=n(160),m=!1,v=p("meta"),g=0,y=e.exports={enable:function(){y.enable=function(){},m=!0;var e=u.f,t=a([].splice),n={};n[v]=1,e(n).length&&(u.f=function(n){for(var r=e(n),i=0,a=r.length;i<a;i++)if(r[i]===v){t(r,i,1);break}return r},i({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:h.f}))},fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!l(e,v)){if(!d(e))return"F";if(!t)return"E";r(e)}return e[v].objectID},getWeakData:function(e,t){if(!l(e,v)){if(!d(e))return!0;if(!t)return!1;r(e)}return e[v].weakData},onFreeze:function(e){return f&&m&&d(e)&&!l(e,v)&&r(e),e}};o[v]=!0},function(e,t,n){var r=n(196);function i(e,t,n,i,a,o,s){try{var l=e[o](s),c=l.value}catch(e){return void n(e)}l.done?t(c):r.resolve(c).then(i,a)}e.exports=function(e){return function(){var t=this,n=arguments;return new r((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,l,"next",e)}function l(e){i(o,r,a,s,l,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(517)},function(e,t,n){e.exports=n(529)},function(e,t,n){e.exports=n(269)},function(e,t,n){e.exports=n(227)},,function(e,t,n){var r=n(245),i=n(120);e.exports=function(e){return e=r(e,"string"),i(e)?e:e+""}},function(e,t,n){var r=n(48),i=n(34),a=n(31),o=(n=n(170),Object);e.exports=n?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&a(t.prototype,o(e))}},function(e,t,n){n=n(23);var r=0,i=Math.random(),a=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++r+i,36)}},function(e,t){var n=TypeError;e.exports=function(e,t){if(e<t)throw n("Not enough arguments");return e}},function(e,t,n){function r(){}function i(e){if(!l(e))return!1;try{return p(r,d,e),!0}catch(e){return!1}}function a(e){if(!l(e))return!1;switch(c(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return v||!!m(f,h(e))}catch(e){return!0}}var o=n(23),s=n(20),l=n(34),c=n(67),u=n(48),h=n(175),d=[],p=u("Reflect","construct"),f=/^\s*(?:class|function)\b/,m=o(f.exec),v=!f.exec(r);a.sham=!0,e.exports=!p||s((function(){var e;return i(i.call)||!i(Object)||!i((function(){e=!0}))||e}))?a:i},function(e,t,n){var r=n(181),i=n(152);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(101),i=n(121),a=r("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},function(e,t,n){var r=n(181),i=n(152).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){n=n(32),t.f=n},function(e,t,n){var r=n(23),i=n(46),a=n(294);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(n){}return function(n,r){return i(n),a(r),t?e(n,r):n.__proto__=r,n}}():void 0)},function(e,t,n){var r=n(70);n=n(28);e.exports="process"==r(n.process)},function(e,t,n){e.exports=n(330)},function(e,t,n){var r=n(133),i=n(346);function a(t){return e.exports=a="function"==typeof r&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(335)},function(e,t){e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(e,t,n){var r=n(60);e.exports=function(e,t,n){for(var i in t)n&&n.unsafe&&e[i]?e[i]=t[i]:r(e,i,t[i],n);return e}},function(e,t,n){e.exports=n(548)},function(e,t,n){(function(t,n,r,i){e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}l=n[o]={exports:{}},t[o][0].call(l.exports,(function(e){return i(t[o][1][e]||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var a=!1,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,o,s,l,c=[],u=0,h=e.length,d="string"!==r.getTypeOf(e);u<e.length;)l=h-u,i=d?(t=e[u++],n=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),n=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),o=(3&t)<<4|n>>4,s=1<l?(15&n)<<2|i>>6:64,l=2<l?63&i:64,c.push(a.charAt(t>>2)+a.charAt(o)+a.charAt(s)+a.charAt(l));return c.join("")},n.decode=function(e){var t,n,r,o,s,l=0,c=0;if("data:"===e.substr(0,"data:".length))throw new Error("Invalid base64 input, it looks like a data url.");var u,h=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&h--,e.charAt(e.length-2)===a.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=new(i.uint8array?Uint8Array:Array)(0|h);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(o=a.indexOf(e.charAt(l++)))>>4,n=(15&o)<<4|(o=a.indexOf(e.charAt(l++)))>>2,r=(3&o)<<6|(s=a.indexOf(e.charAt(l++))),u[c++]=t,64!==o&&(u[c++]=n),64!==s&&(u[c++]=r);return u}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e=[],t=0;t<256;t++){for(var n=t,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}();t.exports=function(e,t){return void 0!==e&&e.length?("string"!==r.getTypeOf(e)?function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}:function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e})(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";e="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:e}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){for(var n="",r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function i(e,t,n,i,o,u){var h=e.file,d=e.compression,p=u!==s.utf8encode,f=a.transformTo("string",u(h.name)),m=a.transformTo("string",s.utf8encode(h.name)),v=h.comment,g=(u=a.transformTo("string",u(v)),a.transformTo("string",s.utf8encode(v))),y=m.length!==h.name.length,x=(v=g.length!==v.length,""),w=h.dir,b=h.date,_={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(_.crc32=e.crc32,_.compressedSize=e.compressedSize,_.uncompressedSize=e.uncompressedSize),n=0,t&&(n|=8),p||!y&&!v||(n|=2048),e=0,t=0,w&&(e|=16),"UNIX"===o?(t=798,e|=(65535&((p=h.unixPermissions)?p:w?16893:33204))<<16):(t=20,e|=63&(h.dosPermissions||0)),o=b.getUTCHours(),o=(o=((o<<=6)|b.getUTCMinutes())<<5)|b.getUTCSeconds()/2,p=b.getUTCFullYear()-1980,p=(p=((p<<=4)|b.getUTCMonth()+1)<<5)|b.getUTCDate(),y&&(w=r(1,1)+r(l(f),4)+m,x+="up"+r(w.length,2)+w),v&&(h=r(1,1)+r(l(u),4)+g,x+="uc"+r(h.length,2)+h),b="",b=(b=(b=(b=(b=(b=(b=(b=(b=(b+="\n\0")+r(n,2))+d.magic)+r(o,2))+r(p,2))+r(_.crc32,4))+r(_.compressedSize,4))+r(_.uncompressedSize,4))+r(f.length,2))+r(x.length,2);return{fileRecord:c.LOCAL_FILE_HEADER+b+f+x,dirRecord:c.CENTRAL_FILE_HEADER+r(t,2)+b+r(u.length,2)+"\0\0\0\0"+r(e,4)+r(i,4)+f+x+u}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,n,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;t?(e=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:e.fileRecord,meta:{percent:0}})):this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:(t=e,c.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e;n=function(e,t,n,i,o){return o=a.transformTo("string",o(i)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(o.length,2)+o}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,n){o++;var i=function(e,t){if(t=r[e=e||t])return t;throw new Error(e+" is not a valid compression method !")}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)})),a.entriesCount=o}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e,t=new r;for(e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var n=new o(t);return n.load(e),n})).then((function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(function(e){return new i.Promise((function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",(function(e){n(e)})).on("end",(function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}(r[a]));return i.Promise.all(n)})).then((function(e){for(var i=(e=e.shift()).files,a=0;a<i.length;a++){var o=i[a],s=o.fileNameStr,l=r.resolve(o.fileNameStr);n.file(l,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(n.file(l).unsafeOriginalName=s)}return e.zipComment.length&&(n.comment=e.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),n&&n(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,n,r){"use strict";n.exports={isNode:void 0!==t,newBufferFrom:function(e,n){if(t.from&&t.from!==Uint8Array.from)return t.from(e,n);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new t(e,n)},allocBuffer:function(e){return t.alloc?t.alloc(e):((e=new t(e)).fill(0),e)},isBuffer:function(e){return t.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r=o.getTypeOf(t),a=o.extend(n||{},c),l=(a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=m(e)),a.createFolders&&(l=function(e){var t=(e="/"===e.slice(-1)?e.substring(0,e.length-1):e).lastIndexOf("/");return 0<t?e.substring(0,t):""}(e))&&i.call(this,l,!0),"string"===r&&!1===a.binary&&!1===a.base64);n&&void 0!==n.binary||(a.binary=!l),(t instanceof u&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE"),r=t instanceof u||t instanceof s?t:p.isNode&&p.isStream(t)?new f(e,t):o.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64),n=new h(e,r,a);this.files[e]=n}function i(e,t){return t=void 0!==t?t:c.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]}var a=e("./utf8"),o=e("./utils"),s=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),c=e("./defaults"),u=e("./compressedObject"),h=e("./zipObject"),d=e("./generate"),p=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}t.exports={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach((function(n,r){e(n,r)&&t.push(r)})),t},file:function(e,t,n){var i;return 1!==arguments.length?(e=this.root+e,r.call(this,e,t,n),this):v(e)?(i=e,this.filter((function(e,t){return!t.dir&&i.test(e)}))):(t=this.files[this.root+e])&&!t.dir?t:null},folder:function(e){var t,n;return e?v(e)?this.filter((function(t,n){return n.dir&&e.test(t)})):(t=this.root+e,t=i.call(this,t),(n=this.clone()).root=t.name,n):this},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter((function(t,n){return n.name.slice(0,e.length)===e})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t={};try{if((t=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),"binarystring"===t.type&&(t.type="string"),!t.type)throw new Error("No output type specified.");o.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var n=t.comment||this.comment||"",r=d.generateWorker(this,t,n)}catch(e){(r=new s("error")).error(e)}return new l(r,t.type||"string",t.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=(e=e.charCodeAt(3),this.readData(4));return t===i[0]&&n===i[1]&&r===i[2]&&e===i[3]},i.prototype.readData=function(e){var t;return this.checkOffset(e),0===e?[]:(t=this.data.slice(this.zero+this.index,this.zero+this.index+e),this.index+=e,t)},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){var t;return this.checkOffset(e),0===e?new Uint8Array(0):(t=this.data.subarray(this.zero+this.index,this.zero+this.index+e),this.index+=e,t)},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){var t;e&&(t=this.streamInfo[this.propName]||0,this.streamInfo[this.propName]=t+e.data.length),i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}r.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished)||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0)},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){var e;return!(!this.isPaused||this.isFinished||(e=this.isPaused=!1,this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),e))},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,n,r){"use strict";var i=e("../utils"),a=e("./ConvertWorker"),o=e("./GenericWorker"),s=e("../base64"),l=e("../support"),c=e("../external"),u=null;if(l.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function h(e,t,n){var r=t;switch(t){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string"}try{this._internalType=r,this._outputType=t,this._mimeType=n,i.checkSupport(r),this._worker=e.pipe(new a(r)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}h.prototype={accumulate:function(e){return n=this,r=e,new c.Promise((function(e,a){var o=[],l=n._internalType,c=n._outputType,u=n._mimeType;n.on("data",(function(e,t){o.push(e),r&&r(t)})).on("error",(function(e){o=[],a(e)})).on("end",(function(){try{var n=function(e,t,n){switch(e){case"blob":return i.newBlob(i.transformTo("arraybuffer",t),n);case"base64":return s.encode(t);default:return i.transformTo(e,t)}}(c,function(e,n){for(var r=0,i=null,a=0,o=0;o<n.length;o++)a+=n[o].length;switch(e){case"string":return n.join("");case"array":return Array.prototype.concat.apply([],n);case"uint8array":for(i=new Uint8Array(a),o=0;o<n.length;o++)i.set(n[o],r),r+=n[o].length;return i;case"nodebuffer":return t.concat(n);default:throw new Error("concat : unsupported type '"+e+"'")}}(l,o),u);e(n)}catch(n){a(n)}o=[]})).resume()}));var n,r},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,(function(e){t.call(n,e.data,e.meta)})):this._worker.on(e,(function(){i.delay(t,arguments,n)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer=void 0!==t,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var i=new ArrayBuffer(0);try{r.blob=0===new Blob([i],{type:"application/zip"}).size}catch(e){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),r.blob=0===a.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){if(i.nodebuffer)return a.newBufferFrom(e,"utf-8");for(var t,n,r,o,s=e,l=s.length,c=0,u=0;u<l;u++)55296==(64512&(n=s.charCodeAt(u)))&&u+1<l&&56320==(64512&(r=s.charCodeAt(u+1)))&&(n=65536+(n-55296<<10)+(r-56320),u++),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new(i.uint8array?Uint8Array:Array)(c),u=o=0;o<c;u++)55296==(64512&(n=s.charCodeAt(u)))&&u+1<l&&56320==(64512&(r=s.charCodeAt(u+1)))&&(n=65536+(n-55296<<10)+(r-56320),u++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.utf8decode=function(e){if(i.nodebuffer)return r.transformTo("nodebuffer",e).toString("utf-8");for(var t,n,a,o=e=r.transformTo(i.uint8array?"uint8array":"array",e),l=o.length,c=new Array(2*l),u=t=0;u<l;)if((n=o[u++])<128)c[t++]=n;else if(4<(a=s[n]))c[t++]=65533,u+=a-1;else{for(n&=2===a?31:3===a?15:7;1<a&&u<l;)n=n<<6|63&o[u++],a--;1<a?c[t++]=65533:n<65536?c[t++]=n:(n-=65536,c[t++]=55296|n>>10&1023,c[t++]=56320|1023&n)}return c.length!==t&&(c.subarray?c=c.subarray(0,t):c.length=t),r.applyFromCharCode(c)},r.inherits(c,o),c.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data),a=(this.leftOver&&this.leftOver.length&&(i.uint8array?(a=t,(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)):t=this.leftOver.concat(t),this.leftOver=null),function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+s[e[n]]>t?n:t}(t)),o=t;a!==t.length&&(i.uint8array?(o=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(o=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:n.utf8decode(o),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var i=e("./support"),a=e("./base64"),o=e("./nodejsUtils"),s=e("./external");function l(e){return e}function c(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)r.push("array"===t||"nodebuffer"===t?String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a))):String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function h(e){var t=65536,n=r.getTypeOf(e),i=!0;if("uint8array"===n?i=u.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,n,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}r.applyFromCharCode=h;var p={};p.string={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,o.allocBuffer(e.length))}},p.array={string:h,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},p.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return o.newBufferFrom(e)}},p.nodebuffer={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:l},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return p[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":i.nodebuffer&&o.isBuffer(e)?"nodebuffer":i.uint8array&&e instanceof Uint8Array?"uint8array":i.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!i[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){for(var t,n="",r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){n((function(){e.apply(r||null,t||[])}))},r.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},r.extend=function(){for(var e,t={},n=0;n<arguments.length;n++)for(e in arguments[n])Object.prototype.hasOwnProperty.call(arguments[n],e)&&void 0===t[e]&&(t[e]=arguments[n][e]);return t},r.prepareContent=function(e,t,n,o,l){return s.Promise.resolve(t).then((function(e){return i.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new s.Promise((function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)})):e})).then((function(t){var u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(l?t=a.decode(t):n&&!0!==o&&(t=c(u=t,new(i.uint8array?Uint8Array:Array)(u.length)))),t):s.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){var t;if(!this.reader.readAndCheckSignature(e))throw this.reader.index-=4,t=this.reader.readString(4),new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e),e=this.reader.readString(4)===t;return this.reader.setIndex(n),e},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array";t=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){for(var e,t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}if(e=this.centralDirOffset+this.centralDirSize,0<(e=t-(e=this.zip64?e+20+(12+this.zip64EndOfCentralSize):e)))this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=e);else if(e<0)throw new Error("Corrupted zip: missing "+Math.abs(e)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){var e;this.extraFields[1]&&(e=r(this.extraFields[1].value),this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS)&&(this.diskNumberStart=e.readInt(4))},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e,t=c.uint8array?"uint8array":"array";this.useUTF8()?(this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment)):(null!==(e=this.findExtraFieldUnicodePath())?this.fileNameStr=e:(e=i.transformTo(t,this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(e)),null!==(e=this.findExtraFieldUnicodeComment())?this.fileCommentStr=e:(e=i.transformTo(t,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(e)))},findExtraFieldUnicodePath:function(){var e,t=this.extraFields[28789];return t&&1===(e=r(t.value)).readInt(1)&&o(this.fileName)===e.readInt(4)?s.utf8decode(e.readData(t.length-5)):null},findExtraFieldUnicodeComment:function(){var e,t=this.extraFields[25461];return t&&1===(e=r(t.value)).readInt(1)&&o(this.fileComment)===e.readInt(4)?s.utf8decode(e.readData(t.length-5)):null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n,a=("binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker(),!this._dataBinary);a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){var n;return this._data instanceof s&&this._data.compression.magic===e.magic?this._data.getCompressedWorker():(n=this._decompressWorker(),this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t))},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)r.prototype[c[h]]=u;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){"use strict";var n,r,i,a,o=e.MutationObserver||e.WebKitMutationObserver,s=o?(r=0,o=new o(c),i=e.document.createTextNode(""),o.observe(i,{characterData:!0}),function(){i.data=r=++r%2}):e.setImmediate||void 0===e.MessageChannel?"document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)}:((a=new e.MessageChannel).port1.onmessage=c,function(){a.port2.postMessage(0)}),l=[];function c(){var e,t;n=!0;for(var r=l.length;r;){for(t=l,l=[],e=-1;++e<r;)t[e]();r=l.length}n=!1}t.exports=function(e){1!==l.push(e)||n||s()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(e,t,n){r((function(){var r;try{r=t(n)}catch(r){return a.reject(e,r)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}var o=f((function(){t(i,r)}));"error"===o.status&&r(o.value)}function f(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=c).prototype.finally=function(e){var t;return"function"!=typeof e?this:(t=this.constructor,this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))})))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){var n;return"function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o?this:(n=new this.constructor(i),this.state!==l?h(n,this.state===s?e:t,this.outcome):this.queue.push(new u(n,e,t)),n)},u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=f(d,t);if("error"===n.status)return a.reject(e,n.value);if(n=n.value)p(e,n);else{e.state=s,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return a.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,l=-1,c=new this(i);++l<n;)!function(e,i){t.resolve(e).then((function(e){o[i]=e,++s!==n||r||(r=!0,a.resolve(c,o))}),(function(e){r||(r=!0,a.reject(c,e))}))}(e[l],l);return c},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return this.resolve([]);for(var r,o=-1,s=new this(i);++o<t;)r=e[o],this.resolve(r).then((function(e){n||(n=!0,a.resolve(s,e))}),(function(e){n||(n=!0,a.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=((e=this.options).raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0,r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy));if(0!==t)throw new Error(o[t]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){if(e="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(t=r.deflateSetDictionary(this.strm,e)))throw new Error(o[t]);this._dict_set=!0}}function u(e,t){if((t=new c(t)).push(e,!0),t.err)throw t.msg||o[t.err];return t.result}c.prototype.push=function(e,t){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&0!==n)return this.onEnd(n),!(this.ended=!0)}while(0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out))),(0<s.avail_in||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==o||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=c,n.deflate=u,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if((e=(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0,r.inflateInit2(this.strm,t.windowBits)))!==o.Z_OK)throw new Error(s[e]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function d(e,t){if((t=new h(t)).push(e,!0),t.err)throw t.msg||s[t.err];return t.result}h.prototype.push=function(e,t){var n,s,l,c,h,d=this.strm,p=this.options.chunkSize,f=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?d.input=a.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?d.input=new Uint8Array(e):d.input=e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(p),d.next_out=0,d.avail_out=p),(n=r.inflate(d,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&f&&(h="string"==typeof f?a.string2buf(f):"[object ArrayBuffer]"===u.call(f)?new Uint8Array(f):f,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===m&&(n=o.Z_OK,m=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0)}while(!d.next_out||0!==d.avail_out&&n!==o.Z_STREAM_END&&(0!==d.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(h=a.utf8border(d.output,d.next_out),l=d.next_out-h,c=a.buf2string(d.output,h),d.next_out=l,d.avail_out=p-l,l&&i.arraySet(d.output,d.output,h,l,0),this.onData(c)):this.onData(i.shrinkBuf(d.output,d.next_out))),0===d.avail_in&&0===d.avail_out&&(m=!0),(0<d.avail_in||0===d.avail_out)&&n!==o.Z_STREAM_END);return(s=n===o.Z_STREAM_END?o.Z_FINISH:s)===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(d.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=d,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},n.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array,i=(n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)},{arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){for(var t,n,r,i,a=t=0,o=e.length;a<o;a++)t+=e[a].length;for(i=new Uint8Array(t),a=n=0,o=e.length;a<o;a++)r=e[a],i.set(r,n),n+=r.length;return i}}),a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){for(var t,n,i,a,o=e.length,s=0,l=0;l<o;l++)55296==(64512&(n=e.charCodeAt(l)))&&l+1<o&&56320==(64512&(i=e.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(i-56320),l++),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(s),l=a=0;a<s;l++)55296==(64512&(n=e.charCodeAt(l)))&&l+1<o&&56320==(64512&(i=e.charCodeAt(l+1)))&&(n=65536+(n-55296<<10)+(i-56320),l++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){for(var n,r,i,a=t||e.length,s=new Array(2*a),c=n=0;c<a;)if((r=e[c++])<128)s[n++]=r;else if(4<(i=o[r]))s[n++]=65533,c+=i-1;else{for(r&=2===i?31:3===i?15:7;1<i&&c<a;)r=r<<6|63&e[c++],i--;1<i?s[n++]=65533:r<65536?s[n++]=r:(r-=65536,s[n++]=55296|r>>10&1023,s[n++]=56320|1023&r)}return l(s,n)},n.utf8border=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;a=a+(i=i+t[r++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16|0}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e=[],t=0;t<256;t++){for(var n=t,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=-2,u=258,h=262,d=113;function p(e,t){return e.msg=l[t],t}function f(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function v(e){var t=e.state,n=t.pending;0!==(n=n>e.avail_out?e.avail_out:n)&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending)&&(t.pending_out=0)}function g(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,v(e.strm)}function y(e,t){e.pending_buf[e.pending++]=t}function x(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,p=e.prev,f=e.strstart+u,m=c[a+o-1],v=c[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+o]===v&&c[n+o-1]===m&&c[n]===c[a]&&c[++n]===c[a+1]){for(a+=2,n++;c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<f;);if(r=u-(f-a),a=f-u,o<r){if(e.match_start=t,s<=(o=r))break;m=c[a+o-1],v=c[a+o]}}}while((t=p[t&d])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function b(e){var t,n,r,a,l,c,u,d,p,f=e.w_size;do{if(d=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-h)){for(i.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=n=e.hash_size;r=e.head[--t],e.head[t]=f<=r?r-f:0,--n;);for(t=n=f;r=e.prev[--t],e.prev[t]=f<=r?r-f:0,--n;);d+=f}if(0===e.strm.avail_in)break;if(l=e.strm,c=e.window,u=e.strstart+e.lookahead,p=void 0,n=0===(p=(d=d)<(p=l.avail_in)?d:p)?0:(l.avail_in-=p,i.arraySet(c,l.input,l.next_in,p,u),1===l.state.wrap?l.adler=o(l.adler,c,p,u):2===l.state.wrap&&(l.adler=s(l.adler,c,p,u)),l.next_in+=p,l.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+3-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function _(e,t){for(var n,r;;){if(e.lookahead<h){if(b(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-h&&(e.match_length=w(e,n)),e.match_length>=3)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function M(e,t){for(var n,r,i;;){if(e.lookahead<h){if(b(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-h&&(e.match_length=w(e,n),e.match_length<=5)&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function E(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function S(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function T(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):p(e,c)}function A(e){var t=T(e);return 0===t&&((e=e.state).window_size=2*e.w_size,m(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),t}function L(e,t,n,r,a,o){if(!e)return c;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||9<a||8!==n||r<8||15<r||t<0||9<t||o<0||4<o)return p(e,c);8===r&&(r=9);var l=new S;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=+l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,A(e)}r=[new E(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(b(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,g(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)})),new E(4,4,8,4,_),new E(4,5,16,8,_),new E(4,6,32,32,_),new E(4,4,16,16,M),new E(8,16,32,32,M),new E(8,16,128,128,M),new E(8,32,128,256,M),new E(32,128,258,1024,M),new E(32,258,258,4096,M)],n.deflateInit=function(e,t){return L(e,t,8,15,8,0)},n.deflateInit2=L,n.deflateReset=A,n.deflateResetKeep=T,n.deflateSetHeader=function(e,t){return e&&e.state&&2===e.state.wrap?(e.state.gzhead=t,0):c},n.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||5<t||t<0)return e?p(e,c):c;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return p(e,0===e.avail_out?-5:c);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status&&(2===i.wrap?(e.adler=0,y(i,31),y(i,139),y(i,8),i.gzhead?(y(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),y(i,255&i.gzhead.time),y(i,i.gzhead.time>>8&255),y(i,i.gzhead.time>>16&255),y(i,i.gzhead.time>>24&255),y(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),y(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(y(i,255&i.gzhead.extra.length),y(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(y(i,0),y(i,0),y(i,0),y(i,0),y(i,0),y(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),y(i,3),i.status=d)):(h=8+(i.w_bits-8<<4)<<8,h|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(h|=32),h+=31-h%31,i.status=d,x(i,h),0!==i.strstart&&(x(i,e.adler>>>16),x(i,65535&e.adler)),e.adler=1)),69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),v(e),o=i.pending,i.pending!==i.pending_buf_size));)y(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),v(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}}while(l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,y(i,l),0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),v(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}}while(l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,y(i,l),0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&v(e),i.pending+2<=i.pending_buf_size&&(y(i,255&e.adler),y(i,e.adler>>8&255),e.adler=0,i.status=d)):i.status=d),0!==i.pending){if(v(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&f(t)<=f(n)&&4!==t)return p(e,-5);if(666===i.status&&0!==e.avail_in)return p(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var h=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(b(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=u){if(b(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){for(o=e.strstart+u;r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o;);e.match_length=u-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==h&&4!==h||(i.status=666),1===h||3===h)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===h&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t)&&(m(i.head),0===i.lookahead)&&(i.strstart=0,i.block_start=0,i.insert=0),v(e),0===e.avail_out))return i.last_flush=-1,0}return 4===t&&(i.wrap<=0||(2===i.wrap?(y(i,255&e.adler),y(i,e.adler>>8&255),y(i,e.adler>>16&255),y(i,e.adler>>24&255),y(i,255&e.total_in),y(i,e.total_in>>8&255),y(i,e.total_in>>16&255),y(i,e.total_in>>24&255)):(x(i,e.adler>>>16),x(i,65535&e.adler)),v(e),0<i.wrap&&(i.wrap=-i.wrap),0===i.pending))?1:0},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==d&&666!==t?p(e,c):(e.state=null,t===d?p(e,-3):0):c},n.deflateSetDictionary=function(e,t){var n,r,a,s,l,u,h,d=t.length;if(!e||!e.state)return c;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return c;for(1===s&&(e.adler=o(e.adler,t,d,0)),n.wrap=0,d>=n.w_size&&(0===s&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,d-n.w_size,n.w_size,0),t=h,d=n.w_size),h=e.avail_in,l=e.next_in,u=e.input,e.avail_in=d,e.next_in=0,e.input=t,b(n);n.lookahead>=3;){for(r=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=2,b(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=l,e.input=u,e.avail_in=h,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,a,o,s,l=e.state,c=e.next_in,u=e.input,h=c+(e.avail_in-5),d=e.next_out,p=e.output,f=d-(t-e.avail_out),m=d+(e.avail_out-257),v=l.dmax,g=l.wsize,y=l.whave,x=l.wnext,w=l.window,b=l.hold,_=l.bits,M=l.lencode,E=l.distcode,S=(1<<l.lenbits)-1,T=(1<<l.distbits)-1;e:do{for(_<15&&(b+=u[c++]<<_,_+=8,b+=u[c++]<<_,_+=8),n=M[b&S];;){if(b>>>=r=n>>>24,_-=r,0==(r=n>>>16&255))p[d++]=65535&n;else{if(!(16&r)){if(0==(64&r)){n=M[(65535&n)+(b&(1<<r)-1)];continue}if(32&r){l.mode=12;break e}e.msg="invalid literal/length code",l.mode=30;break e}for(i=65535&n,(r&=15)&&(_<r&&(b+=u[c++]<<_,_+=8),i+=b&(1<<r)-1,b>>>=r,_-=r),_<15&&(b+=u[c++]<<_,_+=8,b+=u[c++]<<_,_+=8),n=E[b&T];;){if(b>>>=r=n>>>24,_-=r,!(16&(r=n>>>16&255))){if(0==(64&r)){n=E[(65535&n)+(b&(1<<r)-1)];continue}e.msg="invalid distance code",l.mode=30;break e}if(a=65535&n,_<(r&=15)&&(b+=u[c++]<<_,(_+=8)<r)&&(b+=u[c++]<<_,_+=8),v<(a+=b&(1<<r)-1)){e.msg="invalid distance too far back",l.mode=30;break e}if(b>>>=r,_-=r,(r=d-f)<a){if(y<(r=a-r)&&l.sane){e.msg="invalid distance too far back",l.mode=30;break e}if(s=w,(o=0)===x){if(o+=g-r,r<i){for(i-=r;p[d++]=w[o++],--r;);o=d-a,s=p}}else if(x<r){if(o+=g+x-r,(r-=x)<i){for(i-=r;p[d++]=w[o++],--r;);if(o=0,x<i){for(i-=r=x;p[d++]=w[o++],--r;);o=d-a,s=p}}}else if(o+=x-r,r<i){for(i-=r;p[d++]=w[o++],--r;);o=d-a,s=p}for(;2<i;)p[d++]=s[o++],p[d++]=s[o++],p[d++]=s[o++],i-=3;i&&(p[d++]=s[o++],1<i)&&(p[d++]=s[o++])}else{for(o=d-a;p[d++]=p[o++],p[d++]=p[o++],p[d++]=p[o++],2<(i-=3););i&&(p[d++]=p[o++],1<i)&&(p[d++]=p[o++])}break}}break}}while(c<h&&d<m);c-=i=_>>3,b&=(1<<(_-=i<<3))-1,e.next_in=c,e.next_out=d,e.avail_in=c<h?h-c+5:5-(c-h),e.avail_out=d<m?m-d+257:257-(d-m),l.hold=b,l.bits=_}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):l}function p(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,d(e))}function f(e,t){var n;return e?(n=new u,(e.state=n).window=null,0!==(n=p(e,t))&&(e.state=null),n):l}var m,v,g=!0;function y(e,t,n,i){var a;return null===(e=e.state).window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new r.Buf8(e.wsize)),i>=e.wsize?(r.arraySet(e.window,t,n-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):(i<(a=e.wsize-e.wnext)&&(a=i),r.arraySet(e.window,t,n-i,a,e.wnext),(i-=a)?(r.arraySet(e.window,t,n-i,i,0),e.wnext=i,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a))),0}n.inflateReset=d,n.inflateReset2=p,n.inflateResetKeep=h,n.inflateInit=function(e){return f(e,15)},n.inflateInit2=f,n.inflate=function(e,t){var n,u,h,d,p,f,x,w,b,_,M,E,S,T,A,L,C,P,R,I,k,D,z,N,O=0,B=new r.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(n=e.state).mode&&(n.mode=13),p=e.next_out,h=e.output,x=e.avail_out,d=e.next_in,u=e.input,f=e.avail_in,w=n.hold,b=n.bits,_=f,M=x,D=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap)n.mode=13;else{for(;b<16;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(2&n.wrap&&35615===w)B[n.check=0]=255&w,B[1]=w>>>8&255,n.check=a(n.check,B,2,0),b=w=0,n.mode=2;else if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&w)<<8)+(w>>8))%31)e.msg="incorrect header check",n.mode=30;else if(8!=(15&w))e.msg="unknown compression method",n.mode=30;else{if(b-=4,k=8+(15&(w>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<k,e.adler=n.check=1,n.mode=512&w?10:12,b=w=0}}break;case 2:for(;b<16;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(n.flags=w,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=w>>8&1),512&n.flags&&(B[0]=255&w,B[1]=w>>>8&255,n.check=a(n.check,B,2,0)),b=w=0,n.mode=3;case 3:for(;b<32;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.head&&(n.head.time=w),512&n.flags&&(B[0]=255&w,B[1]=w>>>8&255,B[2]=w>>>16&255,B[3]=w>>>24&255,n.check=a(n.check,B,4,0)),b=w=0,n.mode=4;case 4:for(;b<16;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.head&&(n.head.xflags=255&w,n.head.os=w>>8),512&n.flags&&(B[0]=255&w,B[1]=w>>>8&255,n.check=a(n.check,B,2,0)),b=w=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.length=w,n.head&&(n.head.extra_len=w),512&n.flags&&(B[0]=255&w,B[1]=w>>>8&255,n.check=a(n.check,B,2,0)),b=w=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((E=f<(E=n.length)?f:E)&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,u,d,E,k)),512&n.flags&&(n.check=a(n.check,u,E,d)),f-=E,d+=E,n.length-=E),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===f)break e;for(E=0;k=u[d+E++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k)),k&&E<f;);if(512&n.flags&&(n.check=a(n.check,u,E,d)),f-=E,d+=E,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===f)break e;for(E=0;k=u[d+E++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k)),k&&E<f;);if(512&n.flags&&(n.check=a(n.check,u,E,d)),f-=E,d+=E,k)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(w!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}b=w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}e.adler=n.check=c(w),b=w=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=p,e.avail_out=x,e.next_in=d,e.avail_in=f,n.hold=w,n.bits=b,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last)w>>>=7&b,b-=7&b,n.mode=27;else{for(;b<3;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}switch(n.last=1&w,--b,3&(w>>>=1)){case 0:n.mode=14;break;case 1:U=H=void 0;var U,H=n;if(g){for(m=new r.Buf32(512),v=new r.Buf32(32),U=0;U<144;)H.lens[U++]=8;for(;U<256;)H.lens[U++]=9;for(;U<280;)H.lens[U++]=7;for(;U<288;)H.lens[U++]=8;for(s(1,H.lens,0,288,m,0,H.work,{bits:9}),U=0;U<32;)H.lens[U++]=5;s(2,H.lens,0,32,v,0,H.work,{bits:5}),g=!1}if(H.lencode=m,H.lenbits=9,H.distcode=v,H.distbits=5,n.mode=20,6!==t)break;w>>>=2,b-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}w>>>=2,b-=2}break;case 14:for(w>>>=7&b,b-=7&b;b<32;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if((65535&w)!=(w>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&w,b=w=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(E=n.length){if(0===(E=x<(E=f<E?f:E)?x:E))break e;r.arraySet(h,u,d,E,p),f-=E,d+=E,x-=E,p+=E,n.length-=E}else n.mode=12;break;case 17:for(;b<14;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(n.nlen=257+(31&w),w>>>=5,b-=5,n.ndist=1+(31&w),w>>>=5,b-=5,n.ncode=4+(15&w),w>>>=4,b-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.lens[F[n.have++]]=7&w,w>>>=3,b-=3}for(;n.have<19;)n.lens[F[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},D=s(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,D){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;L=(O=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,C=65535&O,!((A=O>>>24)<=b);){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(C<16)w>>>=A,b-=A,n.lens[n.have++]=C;else{if(16===C){for(N=A+2;b<N;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(w>>>=A,b-=A,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}k=n.lens[n.have-1],E=3+(3&w),w>>>=2,b-=2}else if(17===C){for(N=A+3;b<N;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}k=0,E=3+(7&(w>>>=A)),w>>>=3,b=b-A-3}else{for(N=A+7;b<N;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}k=0,E=11+(127&(w>>>=A)),w>>>=7,b=b-A-7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=k}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,z={bits:n.lenbits},D=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,D){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},D=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,D){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=f&&258<=x){e.next_out=p,e.avail_out=x,e.next_in=d,e.avail_in=f,n.hold=w,n.bits=b,o(e,M),p=e.next_out,h=e.output,x=e.avail_out,d=e.next_in,u=e.input,f=e.avail_in,w=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;L=(O=n.lencode[w&(1<<n.lenbits)-1])>>>16&255,C=65535&O,!((A=O>>>24)<=b);){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(L&&0==(240&L)){for(P=A,R=L,I=C;L=(O=n.lencode[I+((w&(1<<P+R)-1)>>P)])>>>16&255,C=65535&O,!(P+(A=O>>>24)<=b);){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}w>>>=P,b-=P,n.back+=P}if(w>>>=A,b-=A,n.back+=A,n.length=C,0===L){n.mode=26;break}if(32&L){n.back=-1,n.mode=12;break}if(64&L){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&L,n.mode=22;case 22:if(n.extra){for(N=n.extra;b<N;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.length+=w&(1<<n.extra)-1,w>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;L=(O=n.distcode[w&(1<<n.distbits)-1])>>>16&255,C=65535&O,!((A=O>>>24)<=b);){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(0==(240&L)){for(P=A,R=L,I=C;L=(O=n.distcode[I+((w&(1<<P+R)-1)>>P)])>>>16&255,C=65535&O,!(P+(A=O>>>24)<=b);){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}w>>>=P,b-=P,n.back+=P}if(w>>>=A,b-=A,n.back+=A,64&L){e.msg="invalid distance code",n.mode=30;break}n.offset=C,n.extra=15&L,n.mode=24;case 24:if(n.extra){for(N=n.extra;b<N;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}n.offset+=w&(1<<n.extra)-1,w>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===x)break e;if(n.offset>(E=M-x)){if((E=n.offset-E)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}S=E>n.wnext?(E-=n.wnext,n.wsize-E):n.wnext-E,E>n.length&&(E=n.length),T=n.window}else T=h,S=p-n.offset,E=n.length;for(x-=E=x<E?x:E,n.length-=E;h[p++]=T[S++],--E;);0===n.length&&(n.mode=21);break;case 26:if(0===x)break e;h[p++]=n.length,x--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===f)break e;f--,w|=u[d++]<<b,b+=8}if(M-=x,e.total_out+=M,n.total+=M,M&&(e.adler=n.check=(n.flags?a:i)(n.check,h,M,p-M)),M=x,(n.flags?w:c(w))!==n.check){e.msg="incorrect data check",n.mode=30;break}b=w=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===f)break e;f--,w+=u[d++]<<b,b+=8}if(w!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}b=w=0}n.mode=29;case 29:D=1;break e;case 30:D=-3;break e;case 31:return-4;default:return l}return e.next_out=p,e.avail_out=x,e.next_in=d,e.avail_in=f,n.hold=w,n.bits=b,(n.wsize||M!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&y(e,e.output,e.next_out,M-e.avail_out)?(n.mode=31,-4):(_-=e.avail_in,M-=e.avail_out,e.total_in+=_,e.total_out+=M,n.total+=M,n.wrap&&M&&(e.adler=n.check=(n.flags?a:i)(n.check,h,M,e.next_out-M)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),D=(0==_&&0===M||4===t)&&0===D?-5:D)},n.inflateEnd=function(e){var t;return e&&e.state?((t=e.state).window&&(t.window=null),e.state=null,0):l},n.inflateGetHeader=function(e,t){return e&&e.state&&0!=(2&(e=e.state).wrap)?((e.head=t).done=!1,0):l},n.inflateSetDictionary=function(e,t){var n,r=t.length;return!e||!e.state||0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,t,r,0)!==n.check?-3:y(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0)},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,u,h,d){var p,f,m,v,g,y,x,w,b,_=d.bits,M=0,E=0,S=0,T=0,A=0,L=0,C=0,P=0,R=0,I=0,k=null,D=0,z=new r.Buf16(16),N=new r.Buf16(16),O=null,B=0;for(M=0;M<=15;M++)z[M]=0;for(E=0;E<l;E++)z[t[n+E]]++;for(A=_,T=15;1<=T&&0===z[T];T--);if(T<A&&(A=T),0===T)c[u++]=20971520,c[u++]=20971520,d.bits=1;else{for(S=1;S<T&&0===z[S];S++);for(A<S&&(A=S),M=P=1;M<=15;M++)if((P=(P<<1)-z[M])<0)return-1;if(0<P&&(0===e||1!==T))return-1;for(N[1]=0,M=1;M<15;M++)N[M+1]=N[M]+z[M];for(E=0;E<l;E++)0!==t[n+E]&&(h[N[t[n+E]]++]=E);if(y=0===e?(k=O=h,19):1===e?(k=i,D-=257,O=a,B-=257,256):(k=o,O=s,-1),M=S,g=u,C=E=I=0,m=-1,v=(R=1<<(L=A))-1,1===e&&852<R||2===e&&592<R)return 1;for(;;){for(b=h[E]<y?(w=0,h[E]):h[E]>y?(w=O[B+h[E]],k[D+h[E]]):(w=96,0),p=1<<(x=M-C),S=f=1<<L;c[g+(I>>C)+(f-=p)]=x<<24|w<<16|b|0,0!==f;);for(p=1<<M-1;I&p;)p>>=1;if(I=0!==p?(I&p-1)+p:0,E++,0==--z[M]){if(M===T)break;M=t[n+h[E]]}if(A<M&&(I&v)!==m){for(g+=S,P=1<<(L=M-(C=0===C?A:C));L+C<T&&!((P-=z[L+C])<=0);)L++,P<<=1;if(R+=1<<L,1===e&&852<R||2===e&&592<R)return 1;c[m=I&v]=A<<24|L<<16|g-u|0}}0!==I&&(c[g+I]=M-C<<24|64<<16|0),d.bits=A}return 0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576),u=(i(c),new Array(60)),h=(i(u),new Array(512)),d=(i(h),new Array(256)),p=(i(d),new Array(29));i(p);var f,m,v,g=new Array(30);function y(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function x(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function w(e){return e<256?h[e]:h[256+(e>>>7)]}function b(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function _(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,b(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function M(e,t,n){_(e,n[2*t],n[2*t+1])}function E(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function S(e,t,n){for(var r,i=new Array(16),a=0,o=1;o<=15;o++)i[o]=a=a+n[o-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=E(i[s]++,s))}}function T(e){for(var t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){8<e.bi_valid?b(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function L(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function C(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&L(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!L(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function P(e,t,n){var r,i,s,l,c=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],i=e.pending_buf[e.l_buf+c],c++,0==r?M(e,i,t):(M(e,(s=d[i])+256+1,t),0!==(l=a[s])&&_(e,i-=p[s],l),M(e,s=w(--r),n),0!==(l=o[s])&&_(e,r-=g[s],l)),c<e.last_lit;);M(e,256,t)}function R(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)C(e,a,n);for(i=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],C(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,C(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1];for(var u,h,d,p,f,m=e,v=t.dyn_tree,g=t.max_code,y=t.stat_desc.static_tree,x=t.stat_desc.has_stree,w=t.stat_desc.extra_bits,b=t.stat_desc.extra_base,_=t.stat_desc.max_length,M=0,E=0;E<=15;E++)m.bl_count[E]=0;for(v[2*m.heap[m.heap_max]+1]=0,u=m.heap_max+1;u<573;u++)_<(E=v[2*v[2*(h=m.heap[u])+1]+1]+1)&&(E=_,M++),v[2*h+1]=E,g<h||(m.bl_count[E]++,p=0,b<=h&&(p=w[h-b]),f=v[2*h],m.opt_len+=f*(E+p),x&&(m.static_len+=f*(y[2*h+1]+p)));if(0!==M){do{for(E=_-1;0===m.bl_count[E];)E--}while(m.bl_count[E]--,m.bl_count[E+1]+=2,m.bl_count[_]--,0<(M-=2));for(E=_;0!==E;E--)for(h=m.bl_count[E];0!==h;)g<(d=m.heap[--u])||(v[2*d+1]!==E&&(m.opt_len+=(E-v[2*d+1])*v[2*d],v[2*d+1]=E),h--)}S(a,c,e.bl_count)}function I(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<l&&i===o||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4))}function k(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<l&&i===o)){if(s<c)for(;M(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(M(e,i,e.bl_tree),s--),M(e,16,e.bl_tree),_(e,s-3,2)):s<=10?(M(e,17,e.bl_tree),_(e,s-3,3)):(M(e,18,e.bl_tree),_(e,s-11,7));a=i,c=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4)}}i(g);var D=!1;function z(e,t,n,i){_(e,0+(i?1:0),3),i=t,t=n,A(n=e),b(n,t),b(n,~t),r.arraySet(n.pending_buf,n.window,i,t,n.pending),n.pending+=t}n._tr_init=function(e){if(!D){for(var t,n,r,i,l=new Array(16),w=r=0;w<28;w++)for(p[w]=r,t=0;t<1<<a[w];t++)d[r++]=w;for(d[r-1]=w,w=i=0;w<16;w++)for(g[w]=i,t=0;t<1<<o[w];t++)h[i++]=w;for(i>>=7;w<30;w++)for(g[w]=i<<7,t=0;t<1<<o[w]-7;t++)h[256+i++]=w;for(n=0;n<=15;n++)l[n]=0;for(t=0;t<=143;)c[2*t+1]=8,t++,l[8]++;for(;t<=255;)c[2*t+1]=9,t++,l[9]++;for(;t<=279;)c[2*t+1]=7,t++,l[7]++;for(;t<=287;)c[2*t+1]=8,t++,l[8]++;for(S(c,287,l),t=0;t<30;t++)u[2*t+1]=5,u[2*t]=E(t,5);f=new y(c,a,257,286,15),m=new y(u,o,0,30,15),v=new y(new Array(0),s,0,19,7),D=!0}e.l_desc=new x(e.dyn_ltree,f),e.d_desc=new x(e.dyn_dtree,m),e.bl_desc=new x(e.bl_tree,v),e.bi_buf=0,e.bi_valid=0,T(e)},n._tr_stored_block=z,n._tr_flush_block=function(e,t,n,r){var i,a,o,s=0;if(0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){for(var t=4093624447,n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==e.dyn_ltree[2*n])return 1;return 0}(e)),R(e,e.l_desc),R(e,e.d_desc),s=function(e){var t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),R(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==t)z(e,t,n,r);else if(4===e.strategy||a===i)_(e,2+(r?1:0),3),P(e,c,u);else{_(e,4+(r?1:0),3);var h=e,d=(t=e.l_desc.max_code+1,n=e.d_desc.max_code+1,s+1);for(_(h,t-257,5),_(h,n-1,5),_(h,d-4,4),o=0;o<d;o++)_(h,h.bl_tree[2*l[o]+1],3);k(h,h.dyn_ltree,t-1),k(h,h.dyn_dtree,n-1),P(e,e.dyn_ltree,e.dyn_dtree)}T(e),r&&A(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(d[n]+256+1)]++,e.dyn_dtree[2*w(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){_(e,2,3),M(e,256,c),16===(e=e).bi_valid?(b(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e,t){"use strict";var n,r,a,o,s,l,c,u,h;function d(e){delete s[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=s[e];if(t){l=!0;try{var n=t.callback,r=t.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(void 0,r)}}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))}e.setImmediate||(o=1,l=!(s={}),c=e.document,u=(u=Object.getPrototypeOf&&Object.getPrototypeOf(e))&&u.setTimeout?u:e,h="[object process]"==={}.toString.call(e.process)?function(e){i.nextTick((function(){p(e)}))}:function(){var t,n;if(e.postMessage&&!e.importScripts)return t=!0,n=e.onmessage,e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}()?(a="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){r.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(p,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];return s[o]={callback:e,args:t},h(o),o++},u.clearImmediate=d)}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}).call(this,n(231).Buffer,n(557).setImmediate,n(84),n(162))},function(e,t,n){"use strict";function r(e,t){return function(){return e.apply(t,arguments)}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";t.a=null},function(e,t,n){e.exports=n(503)},function(e,t,n){e.exports=n(507)},function(e,t,n){var r=n(70),i=n(23);e.exports=function(e){if("Function"===r(e))return i(e)}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,a=i&&!r.call({1:2},1);t.f=a?function(e){return!!(e=i(this,e))&&e.enumerable}:r},function(e,t,n){var r=n(23),i=n(20),a=n(70),o=Object,s=r("".split);e.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?s(e,""):o(e)}:o},function(e,t,n){var r=n(56),i=n(87);e.exports=function(e,t){return e=e[t],i(e)?void 0:r(e)}},function(e,t,n){var r=n(28),i=(n=n(247),"__core-js_shared__");r=r[i]||n(i,{});e.exports=r},function(e,t,n){var r=n(28),i=(n=n(30),r.document),a=n(i)&&n(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var r=n(256);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},function(e,t,n){var r={};r[n(32)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){var r=n(40),i=n(173),a=n(50),o=n(46),s=n(59),l=n(124);t.f=r&&!i?Object.defineProperties:function(e,t){o(e);for(var n,r=s(t),i=l(t),c=i.length,u=0;u<c;)a.f(e,n=i[u++],r[n]);return e}},function(e,t,n){function r(e){return function(t,n,r){var s,l=i(t),c=o(l),u=a(r,c);if(e&&n!=n){for(;u<c;)if((s=l[u++])!=s)return!0}else for(;u<c;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}var i=n(59),a=n(104),o=n(58);e.exports={includes:r(!0),indexOf:r(!1)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var r=n(104),i=n(58),a=n(105),o=Array,s=Math.max;e.exports=function(e,t,n){for(var l=i(e),c=r(t,l),u=r(void 0===n?l:n,l),h=o(s(u-c,0)),d=0;c<u;c++,d++)a(h,d,e[c]);return h.length=d,h}},function(e,t,n){"use strict";function r(){return this}var i=n(14),a=n(41),o=n(57),s=n(191),l=n(34),c=n(192),u=n(108),h=n(129),d=n(68),p=n(65),f=n(60),m=n(32),v=n(91),g=(n=n(193),s.PROPER),y=s.CONFIGURABLE,x=n.IteratorPrototype,w=n.BUGGY_SAFARI_ITERATORS,b=m("iterator"),_="values";e.exports=function(e,t,n,s,m,M,E){function S(e){if(e===m&&R)return R;if(!w&&e in C)return C[e];switch(e){case"keys":case _:case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}}c(n,t,s);s=t+" Iterator";var T,A,L=!1,C=e.prototype,P=C[b]||C["@@iterator"]||m&&C[m],R=!w&&P||S(m),I="Array"==t&&C.entries||P;if(I&&(I=u(I.call(new e)))!==Object.prototype&&I.next&&(o||u(I)===x||(h?h(I,x):l(I[b])||f(I,b,r)),d(I,s,!0,!0),o)&&(v[s]=r),g&&m==_&&P&&P.name!==_&&(!o&&y?p(C,"name",_):(L=!0,R=function(){return a(P,this)})),m)if(T={values:S(_),keys:M?R:S("keys"),entries:S("entries")},E)for(A in T)!w&&!L&&A in C||f(C,A,T[A]);else i({target:t,proto:!0,forced:w||L},T);return o&&!E||C[b]===R||f(C,b,R,{name:m}),v[t]=R,T}},function(e,t){e.exports=function(e,t){return{value:e,done:t}}},function(e,t,n){var r=n(41),i=n(56),a=n(46),o=n(89),s=n(109),l=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(i(n))return a(r(n,e));throw l(o(e)+" is not iterable")}},function(e,t,n){e.exports=n(388)},function(e,t,n){e.exports=n(402)},function(e,t,n){function r(e){return function(t){return t=o(a(t)),1&e&&(t=s(t,l,"")),2&e?s(t,c,""):t}}var i=n(23),a=n(86),o=n(51),s=(n=n(134),i("".replace)),l=(i="["+n+"]",RegExp("^"+i+i+"*")),c=RegExp(i+i+"*$");e.exports={start:r(1),end:r(2),trim:r(3)}},function(e,t,n){n=n(20),e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){"use strict";var r=n(14),i=n(28),a=n(112),o=n(20),s=n(65),l=n(75),c=n(92),u=n(34),h=n(30),d=n(68),p=n(50).f,f=n(66).forEach,m=n(40),v=(n=n(61)).set,g=n.getterFor;e.exports=function(e,t,n){var y,x,w,b=-1!==e.indexOf("Map"),_=-1!==e.indexOf("Weak"),M=b?"set":"add",E=i[e],S=E&&E.prototype,T={};return m&&u(E)&&(_||S.forEach&&!o((function(){(new E).entries().next()})))?(x=(y=t((function(t,n){v(c(t,x),{type:e,collection:new E}),null!=n&&l(n,t[M],{that:t,AS_ENTRIES:b})}))).prototype,w=g(e),f(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"==e||"set"==e;e in S&&(!_||"clear"!=e)&&s(x,e,(function(n,r){var i=w(this).collection;return t||!_||h(n)?(i=i[e](0===n?0:n,r),t?this:i):"get"==e&&void 0}))})),_||p(x,"size",{configurable:!0,get:function(){return w(this).collection.size}})):(y=n.getConstructor(t,e,b,M),a.enable()),d(y,e,!1,!0),T[e]=y,r({global:!0,forced:!0},T),_||n.setStrong(y,e,b),y}},function(e,t){var n,r;e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var s,l=[],c=!1,u=-1;function h(){c&&s&&(c=!1,s.length?l=s.concat(l):u=-1,l.length)&&d()}function d(){if(!c){for(var e=o(h),t=(c=!0,l.length);t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return(r=clearTimeout)(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=f,e.addListener=f,e.once=f,e.off=f,e.removeListener=f,e.removeAllListeners=f,e.emit=f,e.prependListener=f,e.prependOnceListener=f,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t,n){var r={"./MobileStyle/measuresStyle.scss":615,"./PCStyle/measuresStyle.scss":617};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=163},function(e,t,n){var r={"./MobileStyle/d3measure.scss":627,"./PCStyle/d3measure.scss":629};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=164},function(e,t,n){e.exports=n(467)},function(e,t,n){e.exports=n(485)},function(e,t,n){e.exports=n(493)},function(e,t,n){"use strict";(function(e){var n={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((1+t)*e-t)*.5:.5*((e-=2)*e*((1+t)*e+t)+2)}},Bounce:{In:function(e){return 1-n.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*n.Bounce.In(2*e):.5*n.Bounce.Out(2*e-1)+.5}}},r=i="undefined"==typeof self&&void 0!==e&&e.hrtime?function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},i=(a.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},a.prototype.removeAll=function(){this._tweens={}},a.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},a.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},a.prototype.update=function(e,t){void 0===e&&(e=r()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;0<n.length;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var a=this._tweens[n[i]];a&&!1===a.update(e,!t)&&!t&&delete this._tweens[n[i]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},a);function a(){this._tweens={},this._tweensAddedDuringUpdate={}}var o,s={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=s.Utils.Linear;return t<0?a(e[0],e[1],r):1<t?a(e[n],e[n-1],n-r):a(e[i],e[n<i+1?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,a=s.Utils.Bernstein,o=0;o<=r;o++)n+=i(1-t,r-o)*i(t,o)*e[o]*a(r,o);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),a=s.Utils.CatmullRom;return e[0]===e[n]?a(e[((i=t<0?Math.floor(r=n*(1+t)):i)-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-r)-e[0]):1<t?e[n]-(a(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):a(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=s.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(o=[1],function(e){var t=1;if(o[e])return o[e];for(var n=e;1<n;n--)t*=n;return o[e]=t}),CatmullRom:function(e,t,n,r,i){var a=i*i;return(2*t-2*n+(e=.5*(n-e))+(r=.5*(r-t)))*(i*a)+(-3*t+3*n-2*e-r)*a+e*i+t}}},l=(c.nextId=function(){return c._nextId++},c._nextId=0,c);function c(){}var u=new i,h=(d.prototype.getId=function(){return this._id},d.prototype.isPlaying=function(){return this._isPlaying},d.prototype.isPaused=function(){return this._isPaused},d.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},d.prototype.duration=function(e){return this._duration=e,this},d.prototype.start=function(e){if(!this._isPlaying){if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?r()+parseFloat(e):e:r(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat)}return this},d.prototype._setupProperties=function(e,t,n,r){for(var i in n){var a=e[i],o=Array.isArray(a),s=o?"array":typeof a,l=!o&&Array.isArray(n[i]);if("undefined"!=s&&"function"!=s){if(l){var c=n[i];if(0===c.length)continue;c=c.map(this._handleRelativeValue.bind(this,a)),n[i]=[a].concat(c)}if("object"!=s&&!o||!a||l)void 0===t[i]&&(t[i]=a),o||(t[i]*=1),r[i]=l?n[i].slice().reverse():t[i]||0;else{for(var u in t[i]=o?[]:{},a)t[i][u]=a[u];r[i]=o?[]:{},this._setupProperties(a,t[i],n[i],r[i])}}}},d.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying&&(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback)&&this._onStopCallback(this._object),this},d.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},d.prototype.pause=function(e){return void 0===e&&(e=r()),!this._isPaused&&this._isPlaying&&(this._isPaused=!0,this._pauseStart=e,this._group)&&this._group.remove(this),this},d.prototype.resume=function(e){return void 0===e&&(e=r()),this._isPaused&&this._isPlaying&&(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group)&&this._group.add(this),this},d.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},d.prototype.group=function(e){return this._group=e,this},d.prototype.delay=function(e){return this._delayTime=e,this},d.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},d.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},d.prototype.yoyo=function(e){return this._yoyo=e,this},d.prototype.easing=function(e){return this._easingFunction=e,this},d.prototype.interpolation=function(e){return this._interpolationFunction=e,this},d.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},d.prototype.onStart=function(e){return this._onStartCallback=e,this},d.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},d.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},d.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},d.prototype.onStop=function(e){return this._onStopCallback=e,this},d.prototype.update=function(e,t){if(void 0===e&&(e=r()),void 0===t&&(t=!0),this._isPaused)return!0;var n,i=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(i<e)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;if(!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(e-this._startTime)/this._duration,i=0===this._duration||1<i?1:i,t=this._easingFunction(i),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1!=i)return!0;if(0<this._repeat){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,o=this._chainedTweens.length;a<o;a++)this._chainedTweens[a].start(this._startTime+this._duration);return this._isPlaying=!1},d.prototype._updateProperties=function(e,t,n,r){for(var i in n){var a,o,s,l;void 0!==t[i]&&(a=t[i]||0,o=n[i],s=Array.isArray(e[i]),l=Array.isArray(o),!s&&l?e[i]=this._interpolationFunction(o,r):"object"==typeof o&&o?this._updateProperties(e[i],a,o,r):"number"==typeof(o=this._handleRelativeValue(a,o))&&(e[i]=a+(o-a)*r))}},d.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},d.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},d);function d(e,t){void 0===t&&(t=u),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=n.Linear.None,this._interpolationFunction=s.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=l.nextId(),this._isChainStopped=!1,this._goToEnd=!1}var p=l.nextId,f=(y=u).getAll.bind(y),m=y.removeAll.bind(y),v=y.add.bind(y),g=y.remove.bind(y),y=y.update.bind(y);t.a={Easing:n,Group:i,Interpolation:s,now:r,Sequence:l,nextId:p,Tween:h,VERSION:"18.6.4",getAll:f,removeAll:m,add:v,remove:g,update:y}}).call(this,n(162))},function(e,t){var n="object"==typeof document&&document.all;e.exports={all:n,IS_HTMLDDA:void 0===n&&void 0!==n}},function(e,t,n){n=n(88),e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(40),i=n(20),a=n(147);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){function r(e,t){return(e=l[s(e)])==u||e!=c&&(a(t)?i(t):!!t)}var i=n(20),a=n(34),o=/#|\.prototype\./,s=r.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=r.data={},c=r.NATIVE="N",u=r.POLYFILL="P";e.exports=r},function(e,t,n){var r=n(40);n=n(20);e.exports=r&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,t,n){"use strict";var r=n(28),i=n(81),a=n(34),o=n(248),s=n(72),l=n(102),c=n(122),u=r.Function,h=/MSIE .\./.test(s)||o&&((n=r.Bun.version.split(".")).length<3||0==n[0]&&(n[1]<3||3==n[1]&&0==n[2]));e.exports=function(e,t){var n=t?2:1;return h?function(r,o){var s=c(arguments.length,1)>n,h=a(r)?r:u(r),d=s?l(arguments,n):[];r=s?function(){i(h,this,d)}:h;return t?e(r,o):e(r)}:e}},function(e,t,n){var r=n(23),i=n(34),a=(n=n(146),r(Function.toString));i(n.inspectSource)||(n.inspectSource=function(e){return a(e)}),e.exports=n.inspectSource},function(e,t){var n=TypeError;e.exports=function(e){if(9007199254740991<e)throw n("Maximum allowed index exceeded");return e}},function(e,t,n){"use strict";var r=n(89),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw i("Cannot delete property "+r(t)+" of "+r(e))}},function(e,t,n){"use strict";var r=n(14),i=n(20),a=n(82),o=n(30),s=n(54),l=n(58),c=n(176),u=n(105),h=n(148),d=n(103),p=n(32),f=(n=n(100),p("isConcatSpreadable"));p=51<=n||!i((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),n=d("concat");r({target:"Array",proto:!0,arity:1,forced:!p||!n},{concat:function(e){for(var t,n,r,i,d,p=s(this),m=h(p,0),v=0,g=-1,y=arguments.length;g<y;g++)if(d=void 0,o(i=r=-1===g?p:arguments[g])&&(void 0!==(d=i[f])?d:a(i)))for(n=l(r),c(v+n),t=0;t<n;t++,v++)t in r&&u(m,v,r[t]);else c(v+1),u(m,v++,r);return m.length=v,m}})},function(e,t,n){"use strict";var r=n(23),i=n(56),a=n(30),o=n(35),s=n(102),l=(n=n(99),Function),c=r([].concat),u=r([].join),h={};e.exports=n?l.bind:function(e){var t=i(this),n=t.prototype,r=s(arguments,1),d=function(){var n=c(r,s(arguments));if(this instanceof d){var i=t,a=n.length,p=n;if(!o(h,a)){for(var f=[],m=0;m<a;m++)f[m]="a["+m+"]";h[a]=l("C,a","return new C("+u(f,",")+")")}return h[a](i,p)}return t.apply(e,n)};return a(n)&&(d.prototype=n),d}},function(e,t,n){var r=n(123),i=n(89),a=TypeError;e.exports=function(e){if(r(e))return e;throw a(i(e)+" is not a constructor")}},function(e,t,n){var r=n(23),i=n(35),a=n(59),o=n(151).indexOf,s=n(106),l=r([].push);e.exports=function(e,t){var n,r=a(e),c=0,u=[];for(n in r)!i(s,n)&&i(r,n)&&l(u,n);for(;t.length>c;)!i(r,n=t[c++])||~o(u,n)||l(u,n);return u}},function(e,t,n){n=n(48),e.exports=n("document","documentElement")},function(e,t,n){var r=n(272);n(62),e.exports=r},function(e,t,n){var r=n(70),i=n(59),a=n(126).f,o=n(153),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){if(!s||"Window"!=r(e))return a(i(e));try{return a(e)}catch(e){return o(s)}}},function(e,t,n){var r=n(41),i=n(48),a=n(32),o=n(60);e.exports=function(){var e,t=(e=(e=i("Symbol"))&&e.prototype)&&e.valueOf,n=a("toPrimitive");e&&!e[n]&&o(e,n,(function(e){return r(t,this)}),{arity:1})}},function(e,t,n){var r=n(28);n=n(34),r=r.WeakMap;e.exports=n(r)&&/native code/.test(String(r))},function(e,t,n){n=n(88),e.exports=n&&!!Symbol.for&&!!Symbol.keyFor},function(e,t,n){function r(e,t){var n=m(arguments),r=t;if((p(t)||void 0!==e)&&!f(e))return h(t)||(t=function(e,t){if(d(r)&&(t=l(r,this,e,t)),!f(t))return t}),n[1]=t,s(v,null,n)}function i(e,t,n){var r=y(n,t-1);n=y(n,t+1);return g(M,e)&&!g(E,n)||g(E,e)&&!g(M,r)?"\\u"+b(x(e,0),16):e}var a=n(14),o=n(48),s=n(81),l=n(41),c=n(23),u=n(20),h=n(82),d=n(34),p=n(30),f=n(120),m=n(102),v=(n=n(88),o("JSON","stringify")),g=c(/./.exec),y=c("".charAt),x=c("".charCodeAt),w=c("".replace),b=c(1..toString),_=/[\uD800-\uDFFF]/g,M=/^[\uD800-\uDBFF]$/,E=/^[\uDC00-\uDFFF]$/,S=!n||u((function(){var e=o("Symbol")();return"[null]"!=v([e])||"{}"!=v({a:e})||"{}"!=v(Object(e))})),T=u((function(){return'"\\udf06\\ud834"'!==v("\udf06\ud834")||'"\\udead"'!==v("\udead")}));v&&a({target:"JSON",stat:!0,arity:3,forced:S||T},{stringify:function(e,t,n){var a=m(arguments);a=s(S?r:v,null,a);return T&&"string"==typeof a?w(a,_,i):a}})},function(e,t,n){n(36)("iterator")},function(e,t,n){var r=n(36);n=n(185);r("toPrimitive"),n()},function(e,t,n){var r=n(40),i=(n=n(35),Function.prototype),a=r&&Object.getOwnPropertyDescriptor,o=(n=n(i,"name"))&&"something"===function(){}.name;r=n&&(!r||a(i,"name").configurable);e.exports={EXISTS:n,PROPER:o,CONFIGURABLE:r}},function(e,t,n){"use strict";function r(){return this}var i=n(193).IteratorPrototype,a=n(73),o=n(71),s=n(68),l=n(91);e.exports=function(e,t,n,c){return t+=" Iterator",e.prototype=a(i,{next:o(+!c,n)}),s(e,t,!1,!0),l[t]=r,e}},function(e,t,n){"use strict";var r,i,a=n(20),o=n(34),s=n(30),l=n(73),c=n(108),u=n(60),h=n(32),d=(n=n(57),h("iterator"));h=!1;[].keys&&("next"in(i=[].keys())?(c=c(c(i)))!==Object.prototype&&(r=c):h=!0),!s(r)||a((function(){var e={};return r[d].call(e)!==e}))?r={}:n&&(r=l(r)),o(r[d])||u(r,d,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},function(e,t,n){n=n(20),e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){function r(e){return function(t,n){t=o(s(t)),n=a(n);var r,i=t.length;return n<0||i<=n?e?"":void 0:(r=c(t,n))<55296||56319<r||n+1===i||(i=c(t,n+1))<56320||57343<i?e?l(t,n):r:e?u(t,n,n+2):i-56320+(r-55296<<10)+65536}}var i=n(23),a=n(90),o=n(51),s=n(86),l=i("".charAt),c=i("".charCodeAt),u=i("".slice);e.exports={codeAt:r(!1),charAt:r(!0)}},function(e,t,n){e.exports=n(301)},function(e,t,n){var r=n(304);n(62),e.exports=r},function(e,t,n){n(305)},function(e,t,n){var r=n(32),i=n(91),a=r("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[a]===e)}},function(e,t,n){var r=n(41),i=n(46),a=n(145);e.exports=function(e,t,n){var o,s;i(e);try{if(!(o=a(e,"return"))){if("throw"===t)throw n;return n}o=r(o,e)}catch(e){s=!0,o=e}if("throw"===t)throw n;if(s)throw o;return i(o),n}},function(e,t,n){"use strict";var r=n(48),i=n(50),a=n(32),o=n(40),s=a("species");e.exports=function(e){e=r(e);var t=i.f;o&&e&&!e[s]&&t(e,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(46),i=n(180),a=n(87),o=n(32)("species");e.exports=function(e,t){return void 0===(e=r(e).constructor)||a(e=r(e)[o])?t:i(e)}},function(e,t,n){var r,i,a=n(28),o=n(81),s=n(64),l=n(34),c=n(35),u=n(20),h=n(182),d=n(102),p=n(147),f=n(122),m=n(204),v=(n=n(130),a.setImmediate),g=a.clearImmediate,y=a.process,x=a.Dispatch,w=a.Function,b=a.MessageChannel,_=a.String,M=0,E={},S="onreadystatechange";try{r=a.location}catch(e){}function T(e){return function(){C(e)}}function A(e){C(e.data)}function L(e){a.postMessage(_(e),r.protocol+"//"+r.host)}var C=function(e){var t;c(E,e)&&(t=E[e],delete E[e],t())};v&&g||(v=function(e){f(arguments.length,1);var t=l(e)?e:w(e),n=d(arguments,1);return E[++M]=function(){o(t,void 0,n)},i(M),M},g=function(e){delete E[e]},n?i=function(e){y.nextTick(T(e))}:x&&x.now?i=function(e){x.now(T(e))}:b&&!m?(m=(n=new b).port2,n.port1.onmessage=A,i=s(m.postMessage,m)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!u(L)?(i=L,a.addEventListener("message",A,!1)):i=S in p("script")?function(e){h.appendChild(p("script"))[S]=function(){h.removeChild(this),C(e)}}:function(e){setTimeout(T(e),0)}),e.exports={set:v,clear:g}},function(e,t,n){n=n(72),e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},function(e,t){e.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(e,t,n){var r=n(94),i=n(207);n=n(110).CONSTRUCTOR;e.exports=n||!i((function(e){r.all(e).then(void 0,(function(){}))}))},function(e,t,n){var r=n(32)("iterator"),i=!1;try{var a=0,o={next:function(){return{done:!!a++}},return:function(){i=!0}};o[r]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var a={};a[r]=function(){return{next:function(){return{done:n=!0}}}},e(a)}catch(e){}return n}},function(e,t,n){var r=n(46),i=n(30),a=n(76);e.exports=function(e,t){return r(e),i(t)&&t.constructor===e?t:((0,(e=a.f(e)).resolve)(t),e.promise)}},function(e,t,n){"use strict";var r=n(14),i=n(41),a=n(56),o=n(76),s=n(93),l=n(75);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=o.f(t),r=n.resolve,c=n.reject,u=s((function(){var n=a(t.resolve),o=[],s=0,c=1;l(e,(function(e){var a=s++,l=!1;c++,i(n,t,e).then((function(e){l||(l=!0,o[a]={status:"fulfilled",value:e},--c)||r(o)}),(function(e){l||(l=!0,o[a]={status:"rejected",reason:e},--c)||r(o)}))})),--c||r(o)}));return u.error&&c(u.value),n.promise}})},function(e,t,n){"use strict";var r=n(14),i=n(41),a=n(56),o=n(48),s=n(76),l=n(93),c=n(75),u="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=o("AggregateError"),r=s.f(t),h=r.resolve,d=r.reject,p=l((function(){var r=a(t.resolve),o=[],s=0,l=1,p=!1;c(e,(function(e){var a=s++,c=!1;l++,i(r,t,e).then((function(e){c||p||(p=!0,h(e))}),(function(e){c||p||(c=!0,o[a]=e,--l)||d(new n(o,u))}))})),--l||d(new n(o,u))}));return p.error&&d(p.value),r.promise}})},function(e,t,n){n=n(333),e.exports=n},function(e,t,n){var r=n(132).default,i=n(352);e.exports=function(e){return e=i(e,"string"),"symbol"===r(e)?e:String(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(361)},function(e,t,n){n=n(364),e.exports=n},function(e,t,n){var r=n(216),i=n(218),a=n(221);e.exports=function(e,t){var n;if(e)return"string"==typeof e?a(e,t):"Map"===(n="Object"===(n=r(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?i(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(367)},function(e,t,n){n=n(370),e.exports=n},function(e,t,n){e.exports=n(373)},function(e,t,n){n=n(376),e.exports=n},function(e,t,n){"use strict";var r=n(64),i=n(41),a=n(54),o=n(378),s=n(199),l=n(123),c=n(58),u=n(105),h=n(156),d=n(109),p=Array;e.exports=function(e){var t,n,f,m,v,g,y,x=a(e),w=(e=l(this),1<(y=arguments.length)?arguments[1]:void 0),b=void 0!==w,_=0;if(!(y=(b&&(w=r(w,2<y?arguments[2]:void 0)),d(x)))||this===p&&s(y))for(t=c(x),n=e?new this(t):p(t);_<t;_++)g=b?w(x[_],_):x[_],u(n,_,g);else for(v=(m=h(x,y)).next,n=e?new this:[];!(f=i(v,m)).done;_++)g=b?o(m,w,[f.value,_],!0):f.value,u(n,_,g);return n.length=_,n}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n=n(391),e.exports=n},function(e,t,n){e.exports=n(408)},function(e,t,n){e.exports=n(414)},function(e,t,n){n=n(417),e.exports=n},function(e,t,n){n(62);var r=n(67),i=n(35),a=n(31),o=n(425),s=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.forEach;return e===s||a(s,e)&&t===s.forEach||i(l,r(e))?o:t}},function(e,t,n){n=n(433),e.exports=n},function(e,t,n){"use strict";var r=n(40),i=n(23),a=n(41),o=n(20),s=n(124),l=n(127),c=n(143),u=n(54),h=n(144),d=Object.assign,p=Object.defineProperty,f=i([].concat);e.exports=!d||o((function(){var e,t,n,i;return!(!r||1===d({b:1},d(p({},"a",{enumerable:!0,get:function(){p(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)||(t={},i="abcdefghijklmnopqrst",(e={})[n=Symbol()]=7,i.split("").forEach((function(e){t[e]=e})),7!=d({},e)[n])||s(d({},t)).join("")!=i}))?function(e,t){for(var n=u(e),i=arguments.length,o=1,d=l.f,p=c.f;o<i;)for(var m,v=h(arguments[o++]),g=d?f(s(v),d(v)):s(v),y=g.length,x=0;x<y;)m=g[x++],r&&!a(p,v,m)||(n[m]=v[m]);return n}:d},function(e,t,n){var r=n(153),i=Math.floor;e.exports=function e(t,n){var a=t.length,o=i(a/2);if(a<8){for(var s,l,c=t,u=n,h=c.length,d=1;d<h;){for(s=c[l=d];l&&0<u(c[l-1],s);)c[l]=c[--l];l!==d++&&(c[l]=s)}return c}for(var p=t,f=e(r(t,0,o),n),m=e(r(t,o),n),v=n,g=f.length,y=m.length,x=0,w=0;x<g||w<y;)p[x+w]=x<g&&w<y?v(f[x],m[w])<=0?f[x++]:m[w++]:x<g?f[x++]:m[w++];return p}},function(e,t,n){"use strict";var r=n(50).f,i=n(73),a=n(135),o=n(64),s=n(92),l=n(87),c=n(75),u=n(154),h=n(155),d=n(201),p=n(40),f=n(112).fastKey,m=(n=n(61)).set,v=n.getterFor;e.exports={getConstructor:function(e,t,n,u){function h(e,t,n){var r,i=y(e),a=d(e,t);return a?a.value=n:(i.last=a={index:r=f(t,!0),key:t,value:n,previous:t=i.last,next:void 0,removed:!1},i.first||(i.first=a),t&&(t.next=a),p?i.size++:e.size++,"F"!==r&&(i.index[r]=a)),e}function d(e,t){e=y(e);var n,r=f(t);if("F"!==r)return e.index[r];for(n=e.first;n;n=n.next)if(n.key==t)return n}var g=(e=e((function(e,r){s(e,g),m(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),p||(e.size=0),l(r)||c(r,e[u],{that:e,AS_ENTRIES:n})}))).prototype,y=v(t);return a(g,{clear:function(){for(var e=y(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,p?e.size=0:this.size=0},delete:function(e){var t,n,r=y(this);return(e=d(this,e))&&(t=e.next,n=e.previous,delete r.index[e.index],e.removed=!0,n&&(n.next=t),t&&(t.previous=n),r.first==e&&(r.first=t),r.last==e&&(r.last=n),p?r.size--:this.size--),!!e},forEach:function(e){for(var t,n=y(this),r=o(e,1<arguments.length?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!d(this,e)}}),a(g,n?{get:function(e){return(e=d(this,e))&&e.value},set:function(e,t){return h(this,0===e?0:e,t)}}:{add:function(e){return h(this,e=0===e?0:e,e)}}),p&&r(g,"size",{get:function(){return y(this).size}}),e},setStrong:function(e,t,n){var r=t+" Iterator",i=v(t),a=v(r);u(e,t,(function(e,t){m(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?h("keys"==t?n.key:"values"==t?n.value:[n.key,n.value],!1):(e.target=void 0,h(void 0,!0))}),n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(554),i=n(555),a=n(556);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(e=null===e?new l(t):e).length=t,e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"!=typeof e)return c(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer){var i=e,o=t,c=n;if(o.byteLength,c<0||o.byteLength<c)throw new RangeError("'offset' is out of bounds");if(o.byteLength<c+(r||0))throw new RangeError("'length' is out of bounds");return o=void 0===c&&void 0===r?new Uint8Array(o):void 0===r?new Uint8Array(o,c):new Uint8Array(o,c,r),l.TYPED_ARRAY_SUPPORT?(i=o).__proto__=l.prototype:i=d(i,o),i}if("string"!=typeof t){if(c=e,r=t,l.isBuffer(r))return 0!==(c=s(c,o=0|p(r.length))).length&&r.copy(c,0,0,o),c;if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||function(e){return e!=e}(r.length)?s(c,0):d(c,r);if("Buffer"===r.type&&a(r.data))return d(c,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}if(i=e,r=t,e=n,l.isEncoding(e="string"==typeof e&&""!==e?e:"utf8"))return(r=(i=s(i,t=0|f(r,e))).write(r,e))!==t?i.slice(0,r):i;throw new TypeError('"encoding" must be a valid string encoding')}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;var n=(e="string"!=typeof e?""+e:e).length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return R(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(r)return R(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var i,a=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var o=t,s=n,l=this.length;(!s||s<0||l<s)&&(s=l);for(var c="",u=o=!o||o<0?0:o;u<s;++u)c+=function(e){return e<16?"0"+e.toString(16):e.toString(16)}(this[u]);return c;case"utf8":case"utf-8":return b(this,t,n);case"ascii":l=t;var h=n,d="";h=Math.min(this.length,h);for(var p=l;p<h;++p)d+=String.fromCharCode(127&this[p]);return d;case"latin1":case"binary":o=t;var f=n,m="";f=Math.min(this.length,f);for(var v=o;v<f;++v)m+=String.fromCharCode(this[v]);return m;case"base64":return g=this,i=n,0===(y=t)&&i===g.length?r.fromByteArray(g):r.fromByteArray(g.slice(y,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var g=t,y=n,x=this.slice(g,y),w="",_=0;_<x.length;_+=2)w+=String.fromCharCode(x[_]+256*x[_+1]);return w;default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?i?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(i?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a=1,o=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o/=a=2,s/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i)for(var c=-1,u=n;u<o;u++)if(l(e,u)===l(t,-1===c?0:u-c)){if(u-(c=-1===c?u:c)+1===s)return c*a}else-1!==c&&(u-=u-c),c=-1;else for(u=n=o<n+s?o-s:n;0<=u;u--){for(var h=!0,d=0;d<s;d++)if(l(e,u+d)!==l(t,d)){h=!1;break}if(h)return u}return-1}function x(e,t,n,r){return k(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return k(function(e,t){for(var n,r,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i.push(n%256),i.push(r);return i}(t,e.length-n),e,n,r)}function b(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,l,c=e[i],u=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(a=e[i+1]))&&127<(l=(31&c)<<6|63&a)&&(u=l);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&2047<(l=(15&c)<<12|(63&a)<<6|63&o)&&(l<55296||57343<l)&&(u=l);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(l=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)&&l<1114112&&(u=l)}null===u?(u=65533,h=1):65535<u&&(r.push((u-=65536)>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}var d=r,p=d.length;if(p<=_)return String.fromCharCode.apply(String,d);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,d.slice(m,m+=_));return f}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0}),l.alloc=function(e,t,n){return r=null,t=t,n=n,u(e=e),e<=0||void 0===t?s(r,e):"string"==typeof n?s(r,e).fill(t,n):s(r,e).fill(t);var r},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;for(var n=l.allocUnsafe(t),r=0,i=0;i<e.length;++i){var o=e[i];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?b(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(l.isBuffer(e))return this===e||0===l.compare(this,e);throw new TypeError("Argument must be a Buffer")},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n)&&(e+=" ... "),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),(t=void 0===t?0:t)<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),c=this.slice(r,i),u=e.slice(t,n),h=0;h<s;++h)if(c[h]!==u[h]){a=c[h],o=u[h];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var a,o,s,l=!1;;)switch(r){case"hex":var c=e,u=t,h=n,d=(u=Number(u)||0,this.length-u);if((!h||d<(h=Number(h)))&&(h=d),(d=c.length)%2!=0)throw new TypeError("Invalid hex string");d/2<h&&(h=d/2);for(var p=0;p<h;++p){var f=parseInt(c.substr(2*p,2),16);if(isNaN(f))return p;this[u+p]=f}return p;case"utf8":case"utf-8":return d=t,s=n,k(R(e,(o=this).length-d),o,d,s);case"ascii":return x(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return o=this,s=t,a=n,k(I(e),o,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(l)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),l=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function E(e,t,n,r,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function S(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function T(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function A(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,a){return a||A(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function C(e,t,n,r,a){return a||A(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=l.prototype;else for(var r=t-e,i=new l(r,void 0),a=0;a<r;++a)i[a]=this[a+e];return i},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,i=1,a=this[e+--r];0<r&&(i*=256);)a+=this[e+--r]*i;return(i*=128)<=a&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){return t||M(e,2,this.length),32768&(t=this[e]|this[e+1]<<8)?4294901760|t:t},l.prototype.readInt16BE=function(e,t){return t||M(e,2,this.length),32768&(t=this[e+1]|this[e]<<8)?4294901760|t:t},l.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||E(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||E(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):S(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):S(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):T(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){e=+e,t|=0,r||E(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=0,a=1,o=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){e=+e,t|=0,r||E(this,e,t,n,(r=Math.pow(2,8*n-1))-1,-r);var i=n-1,a=1,o=0;for(this[t+i]=255&e;0<=--i&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&(e=e<0?255+e+1:e),t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):S(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):S(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):T(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||E(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):T(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return C(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return C(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),(r=0<r&&r<n?n:r)===n)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length);var i,a=(r=e.length-t<r-n?e.length-t+n:r)-n;if(this===e&&n<t&&t<r)for(i=a-1;0<=i;--i)e[i+t]=this[i+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){var i;if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length&&(i=e.charCodeAt(0))<256&&(e=i),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(!(n<=t))if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(s=t;s<n;++s)this[s]=e;else for(var a=l.isBuffer(e)?e:R(new l(e,r).toString()),o=a.length,s=0;s<n-t;++s)this[s+t]=a[s%o];return this};var P=/[^+\/0-9A-Za-z-_]/g;function R(e,t){t=t||1/0;for(var n,r=e.length,i=null,a=[],o=0;o<r;++o){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===r){-1<(t-=3)&&a.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,n<128){if(--t<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function I(e){return r.toByteArray(function(e){var t;if((e=((t=e).trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function k(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(84))},function(e,t,n){var r={"./MobileStyle/FormStyle.scss":607,"./PCStyle/FormStyle.scss":609};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=232},function(e,t,n){var r=n(20),i=n(32),a=n(57),o=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),a&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(e,t,n){"use strict";function r(e){var t;return g?(t=W(f,e))&&t.value:f[e]}function i(e){try{return Q(e)}catch(t){return e}}function a(e){var t,n=ne(e,se," "),r=4;try{return Q(n)}catch(e){for(;r;)n=ne(n,(t=r--,le[t-1]||(le[t-1]=Z("((?:%[\\da-f]{2}){"+t+"})","gi"))),i);return n}}function o(e){return ue[e]}function s(e){return ne(K(e),ce,o)}function l(e){this.entries=[],this.url=null,void 0!==e&&(P(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===$(e,0)?oe(e,1):e:R(e)))}function c(){E(this,de),H(this,new l(0<arguments.length?arguments[0]:void 0))}n(63);var u,h,d,p=n(14),f=n(28),m=n(41),v=n(23),g=n(40),y=n(233),x=n(60),w=n(135),b=n(68),_=n(192),M=n(61),E=n(92),S=n(34),T=n(35),A=n(64),L=n(67),C=n(46),P=n(30),R=n(51),I=n(73),k=n(71),D=n(156),z=n(109),N=n(122),O=n(32),B=n(229),F=(n=O("iterator"),"URLSearchParams"),U=F+"Iterator",H=M.set,V=M.getterFor(F),G=M.getterFor(U),W=Object.getOwnPropertyDescriptor,j=r("fetch"),q=r("Request"),X=r("Headers"),Y=q&&q.prototype,Z=(O=X&&X.prototype,f.RegExp),J=f.TypeError,Q=f.decodeURIComponent,K=f.encodeURIComponent,$=v("".charAt),ee=v([].join),te=v([].push),ne=v("".replace),re=v([].shift),ie=v([].splice),ae=v("".split),oe=v("".slice),se=/\+/g,le=Array(4),ce=/[!'()~]|%20/g,ue={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},he=_((function(e,t){H(this,{type:U,iterator:D(V(e).entries),kind:t})}),"Iterator",(function(){var e,t=(e=G(this)).kind,n=(e=e.iterator.next()).value;return e.done||(e.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),e}),!0),de=(l.prototype={type:F,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,a,o,s=z(e);if(s)for(n=(t=D(e,s)).next;!(r=m(n,t)).done;){if(i=(r=D(C(r.value))).next,(a=m(i,r)).done||(o=m(i,r)).done||!m(i,r).done)throw J("Expected sequence with length 2");te(this.entries,{key:R(a.value),value:R(o.value)})}else for(var l in e)T(e,l)&&te(this.entries,{key:l,value:R(e[l])})},parseQuery:function(e){if(e)for(var t,n=ae(e,"&"),r=0;r<n.length;)(t=n[r++]).length&&(t=ae(t,"="),te(this.entries,{key:a(re(t)),value:a(ee(t,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],te(n,s(e.key)+"="+s(e.value));return ee(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}},c.prototype);w(de,{append:function(e,t){N(arguments.length,2);var n=V(this);te(n.entries,{key:R(e),value:R(t)}),n.updateURL()},delete:function(e){N(arguments.length,1);for(var t=V(this),n=t.entries,r=R(e),i=0;i<n.length;)n[i].key===r?ie(n,i,1):i++;t.updateURL()},get:function(e){N(arguments.length,1);for(var t=V(this).entries,n=R(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){N(arguments.length,1);for(var t=V(this).entries,n=R(e),r=[],i=0;i<t.length;i++)t[i].key===n&&te(r,t[i].value);return r},has:function(e){N(arguments.length,1);for(var t=V(this).entries,n=R(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){N(arguments.length,1);for(var n,r=V(this),i=r.entries,a=!1,o=R(e),s=R(t),l=0;l<i.length;l++)(n=i[l]).key===o&&(a?ie(i,l--,1):(a=!0,n.value=s));a||te(i,{key:o,value:s}),r.updateURL()},sort:function(){var e=V(this);B(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=V(this).entries,r=A(e,1<arguments.length?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new he(this,"keys")},values:function(){return new he(this,"values")},entries:function(){return new he(this,"entries")}},{enumerable:!0}),x(de,n,de.entries,{name:"entries"}),x(de,"toString",(function(){return V(this).serialize()}),{enumerable:!0}),b(c,F),p({global:!0,constructor:!0,forced:!y},{URLSearchParams:c}),!y&&S(X)&&(u=v(O.has),h=v(O.set),d=function(e){if(P(e)){var t,n=e.body;if(L(n)===F)return t=e.headers?new X(e.headers):new X,u(t,"content-type")||h(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),I(e,{body:k(0,R(n)),headers:k(0,t)})}return e},S(j)&&p({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return j(e,1<arguments.length?d(arguments[1]):{})}}),S(q))&&((Y.constructor=M=function(e){return E(this,Y),new q(e,1<arguments.length?d(arguments[1]):{})}).prototype=Y,p({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:M})),e.exports={URLSearchParams:c,getState:V}},function(e,t,n){var r=n(360),i=n(366),a=n(215),o=n(379);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(499)},function(e,t,n){e.exports=n(510)},function(e,t,n){e.exports=n(544)},function(e,t,n){e.exports=n(559)},function(e,t,n){e.exports=n(580)},,function(e,t,n){n(243),n=n(24),e.exports=n.setTimeout},function(e,t,n){n(244),n(249)},function(e,t,n){var r=n(14),i=n(28);n=n(174)(i.setInterval,!0);r({global:!0,bind:!0,forced:i.setInterval!==n},{setInterval:n})},function(e,t,n){var r=n(41),i=n(30),a=n(120),o=n(145),s=n(246),l=(n=n(32),TypeError),c=n("toPrimitive");e.exports=function(e,t){if(!i(e)||a(e))return e;var n=o(e,c);if(n){if(n=r(n,e,t=void 0===t?"default":t),!i(n)||a(n))return n;throw l("Can't convert object to primitive value")}return s(e,t=void 0===t?"number":t)}},function(e,t,n){var r=n(41),i=n(34),a=n(30),o=TypeError;e.exports=function(e,t){var n,s;if("string"===t&&i(n=e.toString)&&!a(s=r(n,e)))return s;if(i(n=e.valueOf)&&!a(s=r(n,e)))return s;if("string"!==t&&i(n=e.toString)&&!a(s=r(n,e)))return s;throw o("Can't convert object to primitive value")}},function(e,t,n){var r=n(28),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},function(e,t){e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(e,t,n){var r=n(14),i=n(28);n=n(174)(i.setTimeout,!0);r({global:!0,bind:!0,forced:i.setTimeout!==n},{setTimeout:n})},function(e,t,n){n=n(251),e.exports=n},function(e,t,n){var r=n(31),i=n(252),a=Array.prototype;e.exports=function(e){var t=e.filter;return e===a||r(a,e)&&t===a.filter?i:t}},function(e,t,n){n(253),n=n(38),e.exports=n("Array").filter},function(e,t,n){"use strict";var r=n(14),i=n(66).filter;r({target:"Array",proto:!0,forced:!n(103)("filter")},{filter:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},function(e,t,n){var r=n(90),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){return(0<(e=+e)?r:n)(e)}},function(e,t,n){var r=n(82),i=n(123),a=n(30),o=n(32)("species"),s=Array;e.exports=function(e){var t;return void 0===(t=r(e)&&(t=e.constructor,i(t)&&(t===s||r(t.prototype))||a(t)&&null===(t=t[o]))?void 0:t)?s:t}},function(e,t,n){n=n(258),e.exports=n},function(e,t,n){var r=n(31),i=n(259),a=Array.prototype;e.exports=function(e){var t=e.map;return e===a||r(a,e)&&t===a.map?i:t}},function(e,t,n){n(260),n=n(38),e.exports=n("Array").map},function(e,t,n){"use strict";var r=n(14),i=n(66).map;r({target:"Array",proto:!0,forced:!n(103)("map")},{map:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},function(e,t,n){n=n(262),e.exports=n},function(e,t,n){var r=n(31),i=n(263),a=Array.prototype;e.exports=function(e){var t=e.splice;return e===a||r(a,e)&&t===a.splice?i:t}},function(e,t,n){n(264),n=n(38),e.exports=n("Array").splice},function(e,t,n){"use strict";var r=n(14),i=n(54),a=n(104),o=n(90),s=n(58),l=n(265),c=n(176),u=n(148),h=n(105),d=n(177),p=(n=n(103)("splice"),Math.max),f=Math.min;r({target:"Array",proto:!0,forced:!n},{splice:function(e,t){var n,r,m,v,g,y,x=i(this),w=s(x),b=a(e,w);for(0===(e=arguments.length)?n=r=0:r=1===e?(n=0,w-b):(n=e-2,f(p(o(t),0),w-b)),c(w+n-r),m=u(x,r),v=0;v<r;v++)(g=b+v)in x&&h(m,v,x[g]);if(n<(m.length=r)){for(v=b;v<w-r;v++)y=v+n,(g=v+r)in x?x[y]=x[g]:d(x,y);for(v=w;w-r+n<v;v--)d(x,v-1)}else if(r<n)for(v=w-r;b<v;v--)y=v+n-1,(g=v+r-1)in x?x[y]=x[g]:d(x,y);for(v=0;v<n;v++)x[v+b]=arguments[v+2];return l(x,w-r+n),m}})},function(e,t,n){"use strict";var r=n(40),i=n(82),a=TypeError,o=Object.getOwnPropertyDescriptor;n=r&&!function(){if(void 0!==this)return 1;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=n?function(e,t){if(i(e)&&!o(e,"length").writable)throw a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},function(e,t,n){n=n(267),e.exports=n},function(e,t,n){var r=n(31),i=n(268),a=Array.prototype;e.exports=function(e){var t=e.concat;return e===a||r(a,e)&&t===a.concat?i:t}},function(e,t,n){n(178),n=n(38),e.exports=n("Array").concat},function(e,t,n){n=n(270),e.exports=n},function(e,t,n){n(271),n=n(24),e.exports=n.Reflect.construct},function(e,t,n){var r=n(14),i=n(48),a=n(81),o=n(179),s=n(180),l=n(46),c=n(30),u=n(73),h=(n=n(20),i("Reflect","construct")),d=Object.prototype,p=[].push,f=n((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),m=!n((function(){h((function(){}))}));r({target:"Reflect",stat:!0,forced:i=f||m,sham:i},{construct:function(e,t){s(e),l(t);var n=arguments.length<3?e:s(arguments[2]);if(m&&!f)return h(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return a(p,r,t),new(a(o,e,r))}return r=n.prototype,n=u(c(r)?r:d),r=a(e,n,t),c(r)?r:n}})},function(e,t,n){n(178),n(74),n(273),n(279),n(280),n(281),n(282),n(189),n(283),n(284),n(285),n(286),n(287),n(288),n(190),n(289),n(290),n(291),n(292),n(293),n=n(24),e.exports=n.Symbol},function(e,t,n){n(274),n(276),n(277),n(188),n(278)},function(e,t,n){"use strict";function r(e,t){var n=ie[e]=S(Q);return Y(n,{type:X,tag:e,description:t}),m||(n.description=t),n}function i(e,t,n){return e===J&&i(ae,t,n),w(e),t=_(t),w(n),(y(ie,t)?(n.enumerable?(y(e,q)&&e[q][t]&&(e[q][t]=!1),n=S(n,{enumerable:E(0,!1)})):(y(e,q)||ee(e,q,E(1,{})),e[q][t]=!0),se):ee)(e,t,n)}function a(e,t){w(e);var n=b(t);t=T(n).concat(c(n));return j(t,(function(t){m&&!d(o,n,t)||i(e,t,n[t])})),e}function o(e){e=_(e);var t=d(ne,this,e);return!(this===J&&y(ie,e)&&!y(ae,e))&&(!(t||!y(this,e)||!y(ie,e)||y(this,q)&&this[q][e])||t)}function s(e,t){var n;e=b(e),t=_(t);if(e!==J||!y(ie,t)||y(ae,t))return!(n=$(e,t))||!y(ie,t)||y(e,q)&&e[q][t]||(n.enumerable=!0),n}function l(e){e=te(b(e));var t=[];return j(e,(function(e){y(ie,e)||y(O,e)||re(t,e)})),t}function c(e){var t=e===J,n=(e=te(t?ae:b(e)),[]);return j(e,(function(e){!y(ie,e)||t&&!y(J,e)||re(n,ie[e])})),n}var u=n(14),h=n(28),d=n(41),p=n(23),f=n(57),m=n(40),v=n(88),g=n(20),y=n(35),x=n(31),w=n(46),b=n(59),_=n(119),M=n(51),E=n(71),S=n(73),T=n(124),A=n(126),L=n(184),C=n(127),P=n(85),R=n(50),I=n(150),k=n(143),D=n(60),z=n(101),N=n(125),O=n(106),B=n(121),F=n(32),U=n(128),H=n(36),V=n(185),G=n(68),W=n(61),j=n(66).forEach,q=N("hidden"),X="Symbol",Y=(n="prototype",W.set),Z=W.getterFor(X),J=Object[n],Q=(N=h.Symbol)&&N[n],K=h.TypeError,$=(W=h.QObject,P.f),ee=R.f,te=L.f,ne=k.f,re=p([].push),ie=z("symbols"),ae=z("op-symbols"),oe=(h=z("wks"),!W||!W[n]||!W[n].findChild),se=m&&g((function(){return 7!=S(ee({},"a",{get:function(){return ee(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=$(J,t);r&&delete J[t],ee(e,t,n),r&&e!==J&&ee(J,t,r)}:ee;v||(D(Q=(N=function(){if(x(Q,this))throw K("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?M(arguments[0]):void 0,t=B(e),n=function(e){this===J&&d(n,ae,e),y(this,q)&&y(this[q],t)&&(this[q][t]=!1),se(this,t,E(1,e))};return m&&oe&&se(J,t,{configurable:!0,set:n}),r(t,e)})[n],"toString",(function(){return Z(this).tag})),D(N,"withoutSetter",(function(e){return r(B(e),e)})),k.f=o,R.f=i,I.f=a,P.f=s,A.f=L.f=l,C.f=c,U.f=function(e){return r(F(e),e)},m&&(ee(Q,"description",{configurable:!0,get:function(){return Z(this).description}}),f||D(J,"propertyIsEnumerable",o,{unsafe:!0}))),u({global:!0,constructor:!0,wrap:!0,forced:!v,sham:!v},{Symbol:N}),j(T(h),(function(e){H(e)})),u({target:X,stat:!0,forced:!v},{useSetter:function(){oe=!0},useSimple:function(){oe=!1}}),u({target:"Object",stat:!0,forced:!v,sham:!m},{create:function(e,t){return void 0===t?S(e):a(S(e),t)},defineProperty:i,defineProperties:a,getOwnPropertyDescriptor:s}),u({target:"Object",stat:!0,forced:!v},{getOwnPropertyNames:l}),V(),G(N,X),O[q]=!0},function(e,t,n){"use strict";var r=n(149),i=n(67);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){var r=n(14),i=n(48),a=n(35),o=n(51),s=n(101),l=(n=n(187),s("string-to-symbol-registry")),c=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!n},{for:function(e){var t;e=o(e);return a(l,e)?l[e]:(t=i("Symbol")(e),l[e]=t,c[t]=e,t)}})},function(e,t,n){var r=n(14),i=n(35),a=n(120),o=n(89),s=n(101),l=(n=n(187),s("symbol-to-string-registry"));r({target:"Symbol",stat:!0,forced:!n},{keyFor:function(e){if(!a(e))throw TypeError(o(e)+" is not a symbol");if(i(l,e))return l[e]}})},function(e,t,n){var r=n(14),i=n(88),a=n(20),o=n(127),s=n(54);r({target:"Object",stat:!0,forced:!i||a((function(){o.f(1)}))},{getOwnPropertySymbols:function(e){var t=o.f;return t?t(s(e)):[]}})},function(e,t,n){n(36)("asyncIterator")},function(e,t){},function(e,t,n){n(36)("hasInstance")},function(e,t,n){n(36)("isConcatSpreadable")},function(e,t,n){n(36)("match")},function(e,t,n){n(36)("matchAll")},function(e,t,n){n(36)("replace")},function(e,t,n){n(36)("search")},function(e,t,n){n(36)("species")},function(e,t,n){n(36)("split")},function(e,t,n){var r=n(48),i=n(36);n=n(68);i("toStringTag"),n(r("Symbol"),"Symbol")},function(e,t,n){n(36)("unscopables")},function(e,t,n){var r=n(28);n(68)(r.JSON,"JSON",!0)},function(e,t){},function(e,t){},function(e,t,n){var r=n(34),i=String,a=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw a("Can't set "+i(e)+" as a prototype")}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){e.exports=n(297)},function(e,t,n){n=n(298),e.exports=n},function(e,t,n){n=n(299),e.exports=n},function(e,t,n){var r=n(300);n(62),e.exports=r},function(e,t,n){n(63),n(83),n=n(109),e.exports=n},function(e,t,n){e.exports=n(302)},function(e,t,n){var r=n(303);n(326),n(327),n(328),n(329),e.exports=r},function(e,t,n){n=n(197),e.exports=n},function(e,t,n){n(198),n(63),n(74),n(312),n(209),n(210),n(325),n(83),n=n(24),e.exports=n.Promise},function(e,t,n){"use strict";function r(e,t){var n,r=2<arguments.length?arguments[2]:void 0,i=a(b,this);return s?n=s(x(),i?o(this):b):(n=i?this:c(b),u(n,y,"Error")),void 0!==t&&u(n,"message",m(t)),g&&u(n,"stack",d(n.stack,1)),p(n,r),f(e,w,{that:i=[]}),u(n,"errors",i),n}var i=n(14),a=n(31),o=n(108),s=n(129),l=n(306),c=n(73),u=n(65),h=n(71),d=n(308),p=n(309),f=n(75),m=n(310),v=n(32),g=n(311),y=v("toStringTag"),x=Error,w=[].push,b=(s?s(r,x):l(r,x,{name:!0}),r.prototype=c(x.prototype,{constructor:h(1,r),message:h(1,""),name:h(1,"AggregateError")}));i({global:!0,constructor:!0,arity:2},{AggregateError:r})},function(e,t,n){var r=n(35),i=n(307),a=n(85),o=n(50);e.exports=function(e,t,n){for(var s=i(t),l=o.f,c=a.f,u=0;u<s.length;u++){var h=s[u];r(e,h)||n&&r(n,h)||l(e,h,c(t,h))}}},function(e,t,n){var r=n(48),i=n(23),a=n(126),o=n(127),s=n(46),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=a.f(s(e)),n=o.f;return n?l(t,n(e)):t}},function(e,t,n){n=n(23);var r=Error,i=n("".replace),a=(n=String(r("zxcasd").stack),/\n\s*at [^:]*:[^\n]*/),o=a.test(n);e.exports=function(e,t){if(o&&"string"==typeof e&&!r.prepareStackTrace)for(;t--;)e=i(e,a,"");return e}},function(e,t,n){var r=n(30),i=n(65);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},function(e,t,n){var r=n(51);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},function(e,t,n){var r=n(20),i=n(71);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},function(e,t,n){n(313),n(320),n(321),n(322),n(323),n(324)},function(e,t,n){"use strict";function r(e,t){var n,r,i,a,o=t.value,s=t.state==W,l=s?e.ok:e.fail,d=e.resolve,p=e.reject,f=e.domain;try{l?(s||(t.rejection===q&&(a=t,h(b,u,(function(){var e=a.facade;c?B.emit("rejectionHandled",e):Z(G,e,a.value)}))),t.rejection=j),!0===l?n=o:(f&&f.enter(),n=l(o),f&&(f.exit(),i=!0)),n===e.promise?p(N("Promise-chain cycle")):(r=X(n))?h(r,n,d,p):d(n)):p(o)}catch(e){f&&!i&&f.exit(),p(e)}}var i,a,o,s=n(14),l=n(57),c=n(130),u=n(28),h=n(41),d=n(60),p=n(129),f=n(68),m=n(201),v=n(56),g=n(34),y=n(30),x=n(92),w=n(202),b=n(203).set,_=n(314),M=n(317),E=n(93),S=n(318),T=n(61),A=n(94),L=n(110),C=(n=n(76),"Promise"),P=L.CONSTRUCTOR,R=L.REJECTION_EVENT,I=(L=L.SUBCLASSING,T.getterFor(C)),k=T.set,D=(T=A&&A.prototype,A),z=T,N=u.TypeError,O=u.document,B=u.process,F=n.f,U=F,H=!!(O&&O.createEvent&&u.dispatchEvent),V="unhandledrejection",G="rejectionhandled",W=1,j=1,q=2,X=function(e){var t;return!(!y(e)||!g(t=e.then))&&t},Y=function(e,t){e.notified||(e.notified=!0,_((function(){for(var n,i,a=e.reactions;n=a.get();)r(n,e);e.notified=!1,t&&!e.rejection&&(i=e,h(b,u,(function(){var e=i.facade,t=i.value,n=J(i);if(n&&(n=E((function(){c?B.emit("unhandledRejection",t,e):Z(V,e,t)})),i.rejection=c||J(i)?q:j,n.error))throw n.value})))})))},Z=function(e,t,n){var r;H?((r=O.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!R&&(t=u["on"+e])?t(r):e===V&&M("Unhandled promise rejection",n)},J=function(e){return e.rejection!==j&&!e.parent},Q=function(e,t,n){return function(r){e(t,r,n)}},K=function(e,t,n){e.done||(e.done=!0,(e=n||e).value=t,e.state=2,Y(e,!0))},$=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw N("Promise can't be resolved itself");var r=X(t);r?_((function(){var n={done:!1};try{h(r,t,Q($,n,e),Q(K,n,e))}catch(t){K(n,t,e)}})):(e.value=t,e.state=W,Y(e,!1))}catch(t){K({done:!1},t,e)}}};if(P&&(z=(D=function(e){x(this,z),v(e),h(i,this);var t=I(this);try{e(Q($,t),Q(K,t))}catch(e){K(t,e)}}).prototype,(i=function(e){k(this,{type:C,done:!1,notified:!1,parent:!1,reactions:new S,rejection:!1,state:0,value:void 0})}).prototype=d(z,"then",(function(e,t){var n=I(this),i=F(w(this,D));return n.parent=!0,i.ok=!g(e)||e,i.fail=g(t)&&t,i.domain=c?B.domain:void 0,0==n.state?n.reactions.add(i):_((function(){r(i,n)})),i.promise})),a=function(){var e=new i,t=I(e);this.promise=e,this.resolve=Q($,t),this.reject=Q(K,t)},n.f=F=function(e){return e===D||void 0===e?new a:U(e)},!l)&&g(A)&&T!==Object.prototype){o=T.then,L||d(T,"then",(function(e,t){var n=this;return new D((function(e,t){h(o,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete T.constructor}catch(n){}p&&p(T,z)}s({global:!0,constructor:!0,wrap:!0,forced:P},{Promise:D}),f(D,C,!1,!0),m(C)},function(e,t,n){var r,i,a,o,s,l,c,u=n(28),h=n(64),d=n(85).f,p=n(203).set,f=n(204),m=n(315),v=n(316),g=n(130),y=(n=u.MutationObserver||u.WebKitMutationObserver,u.document),x=u.process,w=u.Promise;(d=(d=d(u,"queueMicrotask"))&&d.value)||(r=function(){var e,t;for(g&&(e=x.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?o():a=void 0,e}}a=void 0,e&&e.enter()},o=f||g||v||!n||!y?!m&&w&&w.resolve?((f=w.resolve(void 0)).constructor=w,c=h(f.then,f),function(){c(r)}):g?function(){x.nextTick(r)}:(p=h(p,u),function(){p(r)}):(s=!0,l=y.createTextNode(""),new n(r).observe(l,{characterData:!0}),function(){l.data=s=!s})),e.exports=d||function(e){e={fn:e,next:void 0},a&&(a.next=e),i||(i=e,o()),a=e}},function(e,t,n){var r=n(72);n=n(28);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==n.Pebble},function(e,t,n){n=n(72),e.exports=/web0s(?!.*chrome)/i.test(n)},function(e,t,n){var r=n(28);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},function(e,t){function n(){this.head=null,this.tail=null}n.prototype={add:function(e){e={item:e,next:null},this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=n},function(e,t,n){var r=n(205);n=n(130);e.exports=!r&&!n&&"object"==typeof window&&"object"==typeof document},function(e,t,n){"use strict";var r=n(14),i=n(41),a=n(56),o=n(76),s=n(93),l=n(75);r({target:"Promise",stat:!0,forced:n(206)},{all:function(e){var t=this,n=o.f(t),r=n.resolve,c=n.reject,u=s((function(){var n=a(t.resolve),o=[],s=0,u=1;l(e,(function(e){var a=s++,l=!1;u++,i(n,t,e).then((function(e){l||(l=!0,o[a]=e,--u)||r(o)}),c)})),--u||r(o)}));return u.error&&c(u.value),n.promise}})},function(e,t,n){"use strict";var r=n(14),i=n(57),a=n(110).CONSTRUCTOR,o=n(94),s=n(48),l=n(34),c=(n=n(60),o&&o.prototype);r({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(e){return this.then(void 0,e)}}),!i&&l(o)&&(r=s("Promise").prototype.catch,c.catch!==r)&&n(c,"catch",r,{unsafe:!0})},function(e,t,n){"use strict";var r=n(14),i=n(41),a=n(56),o=n(76),s=n(93),l=n(75);r({target:"Promise",stat:!0,forced:n(206)},{race:function(e){var t=this,n=o.f(t),r=n.reject,c=s((function(){var o=a(t.resolve);l(e,(function(e){i(o,t,e).then(n.resolve,r)}))}));return c.error&&r(c.value),n.promise}})},function(e,t,n){"use strict";var r=n(14),i=n(41),a=n(76);r({target:"Promise",stat:!0,forced:n(110).CONSTRUCTOR},{reject:function(e){var t=a.f(this);return i(t.reject,void 0,e),t.promise}})},function(e,t,n){"use strict";var r=n(14),i=n(48),a=n(57),o=n(94),s=n(110).CONSTRUCTOR,l=n(208),c=i("Promise"),u=a&&!s;r({target:"Promise",stat:!0,forced:a||s},{resolve:function(e){return l(u&&this===c?o:this,e)}})},function(e,t,n){"use strict";var r=n(14),i=n(57),a=n(94),o=n(20),s=n(48),l=n(34),c=n(202),u=n(208),h=(n=n(60),a&&a.prototype);r({target:"Promise",proto:!0,real:!0,forced:!!a&&o((function(){h.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=c(this,s("Promise")),n=l(e);return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!i&&l(a)&&(r=s("Promise").prototype.finally,h.finally!==r)&&n(h,"finally",r,{unsafe:!0})},function(e,t,n){n(198)},function(e,t,n){n(209)},function(e,t,n){"use strict";var r=n(14),i=n(76),a=n(93);r({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=i.f(this);return((e=a(e)).error?t.reject:t.resolve)(e.value),t.promise}})},function(e,t,n){n(210)},function(e,t,n){e.exports=n(331)},function(e,t,n){n=n(332),e.exports=n},function(e,t,n){n=n(211),e.exports=n},function(e,t,n){n(334);var r=n(24).Object;n=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(n.sham=!0)},function(e,t,n){var r=n(14),i=n(40);n=n(50).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==n,sham:!i},{defineProperty:n})},function(e,t,n){e.exports=n(336)},function(e,t,n){var r=n(337);n(339),n(340),n(341),n(342),n(343),n(344),n(345),e.exports=r},function(e,t,n){var r=n(183);n(338),e.exports=r},function(e,t,n){n(36)("dispose")},function(e,t,n){n(36)("asyncDispose")},function(e,t,n){n(36)("matcher")},function(e,t,n){n(36)("metadataKey")},function(e,t,n){n(36)("observable")},function(e,t,n){n(36)("metadata")},function(e,t,n){n(36)("patternMatch")},function(e,t,n){n(36)("replaceAll")},function(e,t,n){e.exports=n(347)},function(e,t,n){e.exports=n(348)},function(e,t,n){n=n(349),e.exports=n},function(e,t,n){n=n(350),e.exports=n},function(e,t,n){var r=n(351);n(62),e.exports=r},function(e,t,n){n(63),n(74),n(83),n(189),n=n(128),e.exports=n.f("iterator")},function(e,t,n){var r=n(353),i=n(132).default;e.exports=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[r];if(void 0===n)return("string"===t?String:Number)(e);if(n=n.call(e,t||"default"),"object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(354)},function(e,t,n){e.exports=n(355)},function(e,t,n){n=n(356),e.exports=n},function(e,t,n){n=n(357),e.exports=n},function(e,t,n){n=n(358),e.exports=n},function(e,t,n){n(359),n(190),n=n(128),e.exports=n.f("toPrimitive")},function(e,t){},function(e,t,n){var r=n(213);e.exports=function(e){if(r(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(362)},function(e,t,n){n=n(363),e.exports=n},function(e,t,n){n=n(214),e.exports=n},function(e,t,n){n(365),n=n(24),e.exports=n.Array.isArray},function(e,t,n){n(14)({target:"Array",stat:!0},{isArray:n(82)})},function(e,t,n){var r=n(133),i=n(16);e.exports=function(e,t){var n=null==e?null:void 0!==r&&i(e)||e["@@iterator"];if(null!=n){var a,o,s,l,c=[],u=!0,h=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(a=s.call(n)).done)&&(c.push(a.value),c.length!==t);u=!0);}catch(e){h=!0,o=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(h)throw o}}return c}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(368)},function(e,t,n){n=n(369),e.exports=n},function(e,t,n){n=n(217),e.exports=n},function(e,t,n){var r=n(31),i=n(371),a=Array.prototype;e.exports=function(e){var t=e.slice;return e===a||r(a,e)&&t===a.slice?i:t}},function(e,t,n){n(372),n=n(38),e.exports=n("Array").slice},function(e,t,n){"use strict";var r=n(14),i=n(82),a=n(123),o=n(30),s=n(104),l=n(58),c=n(59),u=n(105),h=n(32),d=n(103),p=n(102),f=(n=d("slice"),h("species")),m=Array,v=Math.max;r({target:"Array",proto:!0,forced:!n},{slice:function(e,t){var n,r,h,d=c(this),g=l(d),y=s(e,g),x=s(void 0===t?g:t,g);if(i(d)&&(n=d.constructor,(n=a(n)&&(n===m||i(n.prototype))||o(n)&&null===(n=n[f])?void 0:n)===m||void 0===n))return p(d,y,x);for(r=new(void 0===n?m:n)(v(x-y,0)),h=0;y<x;y++,h++)y in d&&u(r,h,d[y]);return r.length=h,r}})},function(e,t,n){e.exports=n(374)},function(e,t,n){n=n(375),e.exports=n},function(e,t,n){n=n(219),e.exports=n},function(e,t,n){n(83),n(377),n=n(24),e.exports=n.Array.from},function(e,t,n){var r=n(14),i=n(220);r({target:"Array",stat:!0,forced:!n(207)((function(e){Array.from(e)}))},{from:i})},function(e,t,n){var r=n(46),i=n(200);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(381)},function(e,t,n){e.exports=n(382)},function(e,t,n){n=n(383),e.exports=n},function(e,t,n){n=n(384),e.exports=n},function(e,t,n){n=n(385),e.exports=n},function(e,t,n){n(386),n=n(24),e.exports=n.Reflect.get},function(e,t,n){var r=n(14),i=n(41),a=n(30),o=n(46),s=n(387),l=n(85),c=n(108);r({target:"Reflect",stat:!0},{get:function e(t,n){var r,u=arguments.length<3?t:arguments[2];return o(t)===u?t[n]:(r=l.f(t,n))?s(r)?r.value:void 0===r.get?void 0:i(r.get,u):a(r=c(t))?e(r,n,u):void 0}})},function(e,t,n){var r=n(35);e.exports=function(e){return void 0!==e&&(r(e,"value")||r(e,"writable"))}},function(e,t,n){e.exports=n(389)},function(e,t,n){n=n(390),e.exports=n},function(e,t,n){n=n(222),e.exports=n},function(e,t,n){var r=n(31),i=n(392),a=Function.prototype;e.exports=function(e){var t=e.bind;return e===a||r(a,e)&&t===a.bind?i:t}},function(e,t,n){n(393),n=n(38),e.exports=n("Function").bind},function(e,t,n){var r=n(14);n=n(179);r({target:"Function",proto:!0,forced:Function.bind!==n},{bind:n})},function(e,t,n){e.exports=n(395)},function(e,t,n){e.exports=n(396)},function(e,t,n){n=n(397),e.exports=n},function(e,t,n){n=n(398),e.exports=n},function(e,t,n){n=n(399),e.exports=n},function(e,t,n){n(400);var r=n(24).Object;n=e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)};r.getOwnPropertyDescriptor.sham&&(n.sham=!0)},function(e,t,n){var r=n(14),i=n(20),a=n(59),o=n(85).f;n=n(40),i=i((function(){o(1)}));r({target:"Object",stat:!0,forced:!n||i,sham:!n},{getOwnPropertyDescriptor:function(e,t){return o(a(e),t)}})},function(e,t,n){var r=n(10);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(403)},function(e,t,n){n=n(404),e.exports=n},function(e,t,n){n=n(405),e.exports=n},function(e,t,n){n=n(406),e.exports=n},function(e,t,n){n(407),n=n(24),e.exports=n.Object.setPrototypeOf},function(e,t,n){n(14)({target:"Object",stat:!0},{setPrototypeOf:n(129)})},function(e,t,n){e.exports=n(409)},function(e,t,n){n=n(410),e.exports=n},function(e,t,n){n=n(411),e.exports=n},function(e,t,n){n=n(412),e.exports=n},function(e,t,n){n(413),n=n(24),e.exports=n.Object.getPrototypeOf},function(e,t,n){var r=n(14),i=n(20),a=n(54),o=n(108);n=n(194);r({target:"Object",stat:!0,forced:i((function(){o(1)})),sham:!n},{getPrototypeOf:function(e){return o(a(e))}})},function(e,t,n){e.exports=n(415)},function(e,t,n){n=n(416),e.exports=n},function(e,t,n){n=n(225),e.exports=n},function(e,t,n){n(418);var r=n(24).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){n(14)({target:"Object",stat:!0,sham:!n(40)},{create:n(73)})},function(e,t,n){var r=n(158),i=n(157);function a(t,n){var o;return e.exports=a=r?i(o=r).call(o):function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,a(t,n)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(132).default,i=n(131),a=n(133),o=n(224),s=n(223),l=n(421),c=n(158),u=n(196),h=n(429),d=n(216);e.exports=function(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,p=n.hasOwnProperty,f=i||function(e,t,n){e[t]=n.value},m="function"==typeof a?a:{},v=m.iterator||"@@iterator",g=m.asyncIterator||"@@asyncIterator",y=m.toStringTag||"@@toStringTag";function x(e,t,n){return i(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{x({},"")}catch(n){x=function(e,t,n){return e[t]=n}}function w(e,t,n,r){var i,a,s,l;t=t&&t.prototype instanceof M?t:M,t=o(t.prototype),r=new I(r||[]);return f(t,"_invoke",{value:(i=e,a=n,s=r,l="suspendedStart",function(e,t){if("executing"===l)throw new Error("Generator is already running");if("completed"===l){if("throw"===e)throw t;return{value:void 0,done:!0}}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n&&(n=function e(t,n){var r=n.method,i=t.iterator[r];return void 0===i?(n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),_):"throw"===(r=b(i,t.iterator,n.arg)).type?(n.method="throw",n.arg=r.arg,n.delegate=null,_):(i=r.arg)?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,_):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}(n,s))){if(n===_)continue;return n}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===l)throw l="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);if(l="executing","normal"===(n=b(i,a,s)).type){if(l=s.done?"completed":"suspendedYield",n.arg===_)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(l="completed",s.method="throw",s.arg=n.arg)}})}),t}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=w;var _={};function M(){}function E(){}function S(){}x(m={},v,(function(){return this}));var T=s&&s(s(k([]))),A=(T&&T!==n&&p.call(T,v)&&(m=T),S.prototype=M.prototype=o(m));function L(e){var t;l(t=["next","throw","return"]).call(t,(function(t){x(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){var n;f(this,"_invoke",{value:function(i,a){function o(){return new t((function(n,o){!function n(i,a,o,s){var l;if("throw"!==(i=b(e[i],e,a)).type)return(a=(l=i.arg).value)&&"object"==r(a)&&p.call(a,"__await")?t.resolve(a.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(a).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}));s(i.arg)}(i,a,n,o)}))}return n=n?n.then(o,o):o()}})}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],l(e).call(e,P,this),this.reset(!0)}function k(e){if(e){var t,n=e[v];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return t=-1,(n=function n(){for(;++t<e.length;)if(p.call(e,t))return n.value=e[t],n.done=!1,n;return n.value=void 0,n.done=!0,n}).next=n}return{next:D}}function D(){return{value:void 0,done:!0}}return f(A,"constructor",{value:E.prototype=S,configurable:!0}),f(S,"constructor",{value:E,configurable:!0}),E.displayName=x(S,y,"GeneratorFunction"),t.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(e){return c?c(e,S):(e.__proto__=S,x(e,y,"GeneratorFunction")),e.prototype=o(A),e},t.awrap=function(e){return{__await:e}},L(C.prototype),x(C.prototype,g,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,i,a){void 0===a&&(a=u);var o=new C(w(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},L(A),x(A,y,"Generator"),x(A,v,(function(){return this})),x(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t,n=Object(e),r=[];for(t in n)r.push(t);return h(r).call(r),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},t.values=k,I.prototype={constructor:I,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,l(t=this.tryEntries).call(t,R),!e)for(var n in this)"t"===n.charAt(0)&&p.call(this,n)&&!isNaN(+d(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var o=p.call(i,"catchLoc"),s=p.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&p.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var a=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,_):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(n=i.completion).type&&(r=n.arg,R(i)),r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),_}},t},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){e.exports=n(422)},function(e,t,n){e.exports=n(423)},function(e,t,n){n=n(424),e.exports=n},function(e,t,n){n=n(226),e.exports=n},function(e,t,n){n=n(426),e.exports=n},function(e,t,n){n(427),n=n(38),e.exports=n("Array").forEach},function(e,t,n){"use strict";var r=n(14);n=n(428);r({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},function(e,t,n){"use strict";var r=n(66).forEach;n=n(111)("forEach");e.exports=n?[].forEach:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}},function(e,t,n){e.exports=n(430)},function(e,t,n){e.exports=n(431)},function(e,t,n){n=n(432),e.exports=n},function(e,t,n){n=n(227),e.exports=n},function(e,t,n){var r=n(31),i=n(434),a=Array.prototype;e.exports=function(e){var t=e.reverse;return e===a||r(a,e)&&t===a.reverse?i:t}},function(e,t,n){n(435),n=n(38),e.exports=n("Array").reverse},function(e,t,n){"use strict";var r=n(14),i=n(23),a=n(82),o=i([].reverse);n=[1,2];r({target:"Array",proto:!0,forced:String(n)===String(n.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),o(this)}})},function(e,t,n){n=n(437),e.exports=n},function(e,t,n){n(438),n=n(24),e.exports=n.Object.assign},function(e,t,n){var r=n(14);n=n(228);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==n},{assign:n})},function(e,t,n){n=n(440),e.exports=n},function(e,t,n){var r=n(31),i=n(441),a=Array.prototype;e.exports=function(e){var t=e.indexOf;return e===a||r(a,e)&&t===a.indexOf?i:t}},function(e,t,n){n(442),n=n(38),e.exports=n("Array").indexOf},function(e,t,n){"use strict";var r=n(14),i=n(142),a=n(151).indexOf,o=(n=n(111),i([].indexOf)),s=!!o&&1/o([1],1,-0)<0;i=n("indexOf");r({target:"Array",proto:!0,forced:s||!i},{indexOf:function(e){var t=1<arguments.length?arguments[1]:void 0;return s?o(this,e,t)||0:a(this,e,t)}})},function(e,t,n){n=n(444),e.exports=n},function(e,t,n){var r=n(31),i=n(445),a=String.prototype;e.exports=function(e){var t=e.repeat;return"string"==typeof e||e===a||r(a,e)&&t===a.repeat?i:t}},function(e,t,n){n(446),n=n(38),e.exports=n("String").repeat},function(e,t,n){n(14)({target:"String",proto:!0},{repeat:n(447)})},function(e,t,n){"use strict";var r=n(90),i=n(51),a=n(86),o=RangeError;e.exports=function(e){var t=i(a(this)),n="",s=r(e);if(s<0||s==1/0)throw o("Wrong number of repetitions");for(;0<s;(s>>>=1)&&(t+=t))1&s&&(n+=t);return n}},function(e,t,n){n=n(449),e.exports=n},function(e,t,n){n(450),e.exports=Math.pow(2,-52)},function(e,t,n){n(14)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{EPSILON:Math.pow(2,-52)})},function(e,t,n){n=n(452),e.exports=n},function(e,t,n){n(453);var r=n(24).Object;n=e.exports=function(e,t){return r.defineProperties(e,t)};r.defineProperties.sham&&(n.sham=!0)},function(e,t,n){var r=n(14),i=n(40);n=n(150).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==n,sham:!i},{defineProperties:n})},function(e,t,n){n=n(455),e.exports=n},function(e,t,n){n(188);var r=n(24),i=n(81);r.JSON||(r.JSON={stringify:JSON.stringify}),e.exports=function(e,t,n){return i(r.JSON.stringify,null,arguments)}},function(e,t,n){n=n(457),e.exports=n},function(e,t,n){n(458),n=n(24),e.exports=n.parseFloat},function(e,t,n){var r=n(14);n=n(459);r({global:!0,forced:parseFloat!=n},{parseFloat:n})},function(e,t,n){var r=n(28),i=n(20),a=n(23),o=n(51),s=n(159).trim,l=(n=n(134),a("".charAt)),c=r.parseFloat,u=(a=r.Symbol)&&a.iterator;r=1/c(n+"-0")!=-1/0||u&&!i((function(){c(Object(u))}));e.exports=r?function(e){e=s(o(e));var t=c(e);return 0===t&&"-"==l(e,0)?-0:t}:c},function(e,t,n){n=n(461),e.exports=n},function(e,t,n){n(462),n=n(24),e.exports=n.parseInt},function(e,t,n){var r=n(14);n=n(463);r({global:!0,forced:parseInt!=n},{parseInt:n})},function(e,t,n){var r=n(28),i=n(20),a=n(23),o=n(51),s=n(159).trim,l=(n=n(134),r.parseInt),c=(r=r.Symbol)&&r.iterator,u=/^[+-]?0x/i,h=a(u.exec);r=8!==l(n+"08")||22!==l(n+"0x16")||c&&!i((function(){l(Object(c))}));e.exports=r?function(e,t){return e=s(o(e)),l(e,t>>>0||(h(u,e)?16:10))}:l},function(e,t,n){n=n(465),e.exports=n},function(e,t,n){n(466),n=n(24),e.exports=n.Object.keys},function(e,t,n){var r=n(14),i=n(54),a=n(124);r({target:"Object",stat:!0,forced:n(20)((function(){a(1)}))},{keys:function(e){return a(i(e))}})},function(e,t,n){n=n(468),e.exports=n},function(e,t,n){n(469),n=n(24),e.exports=n.Number.isInteger},function(e,t,n){n(14)({target:"Number",stat:!0},{isInteger:n(470)})},function(e,t,n){var r=n(30),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){var r=n(472);n(62),e.exports=r},function(e,t,n){n(63),n(74),n(473),n=n(24),e.exports=n.WeakMap},function(e,t,n){n(474)},function(e,t,n){"use strict";function r(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}var i,a,o,s,l=n(160),c=n(28),u=n(23),h=n(135),d=n(112),p=n(161),f=n(477),m=n(30),v=n(61).enforce,g=n(20),y=(n=n(186),Object),x=Array.isArray,w=y.isExtensible,b=y.isFrozen,_=y.isSealed,M=y.freeze,E=y.seal,S={},T={},A=(y=!c.ActiveXObject&&"ActiveXObject"in c,p("WeakMap",r,f)),L=u((c=A.prototype).set);n&&(y?(i=f.getConstructor(r,"WeakMap",!0),d.enable(),a=u(c.delete),o=u(c.has),s=u(c.get),h(c,{delete:function(e){var t;return m(e)&&!w(e)?((t=v(this)).frozen||(t.frozen=new i),a(this,e)||t.frozen.delete(e)):a(this,e)},has:function(e){var t;return m(e)&&!w(e)?((t=v(this)).frozen||(t.frozen=new i),o(this,e)||t.frozen.has(e)):o(this,e)},get:function(e){var t;return!m(e)||w(e)||((t=v(this)).frozen||(t.frozen=new i),o(this,e))?s(this,e):t.frozen.get(e)},set:function(e,t){var n;return!m(e)||w(e)||((n=v(this)).frozen||(n.frozen=new i),o(this,e))?L(this,e,t):n.frozen.set(e,t),this}})):l&&g((function(){var e=M([]);return L(new A,e,1),!b(e)}))&&h(c,{set:function(e,t){var n;return x(e)&&(b(e)?n=S:_(e)&&(n=T)),L(this,e,t),n==S&&M(e),n==T&&E(e),this}}))},function(e,t,n){var r=n(20),i=n(30),a=n(70),o=n(476),s=Object.isExtensible;n=r((function(){s(1)}));e.exports=n||o?function(e){return!(!i(e)||o&&"ArrayBuffer"==a(e))&&(!s||s(e))}:s},function(e,t,n){n=n(20),e.exports=n((function(){var e;"function"==typeof ArrayBuffer&&(e=new ArrayBuffer(8),Object.isExtensible(e))&&Object.defineProperty(e,"a",{value:8})}))},function(e,t,n){"use strict";function r(e){return e.frozen||(e.frozen=new i)}function i(){this.entries=[]}function a(e,t){return y(e.entries,(function(e){return e[0]===t}))}var o=n(23),s=n(135),l=n(112).getWeakData,c=n(92),u=n(46),h=n(87),d=n(30),p=n(75),f=n(66),m=n(35),v=(n=n(61)).set,g=n.getterFor,y=f.find,x=f.findIndex,w=o([].splice),b=0;i.prototype={get:function(e){if(e=a(this,e))return e[1]},has:function(e){return!!a(this,e)},set:function(e,t){var n=a(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=x(this.entries,(function(t){return t[0]===e}));return~t&&w(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,i){function a(e,t,n){var i=f(e),a=l(u(t),!0);return!0===a?r(i).set(t,n):a[i.id]=n,e}var o=(e=e((function(e,r){c(e,o),v(e,{type:t,id:b++,frozen:void 0}),h(r)||p(r,e[i],{that:e,AS_ENTRIES:n})}))).prototype,f=g(t);return s(o,{delete:function(e){var t,n=f(this);return!!d(e)&&(!0===(t=l(e))?r(n).delete(e):t&&m(t,n.id)&&delete t[n.id])},has:function(e){var t,n=f(this);return!!d(e)&&(!0===(t=l(e))?r(n).has(e):t&&m(t,n.id))}}),s(o,n?{get:function(e){var t,n=f(this);if(d(e))return!0===(t=l(e))?r(n).get(e):t?t[n.id]:void 0},set:function(e,t){return a(this,e,t)}}:{add:function(e){return a(this,e,!0)}}),e}}},function(e,t,n){n=n(479),e.exports=n},function(e,t,n){var r=n(31),i=n(480),a=Array.prototype;e.exports=function(e){var t=e.sort;return e===a||r(a,e)&&t===a.sort?i:t}},function(e,t,n){n(481),n=n(38),e.exports=n("Array").sort},function(e,t,n){"use strict";var r=n(14),i=n(23),a=n(56),o=n(54),s=n(58),l=n(177),c=n(51),u=n(20),h=n(229),d=n(111),p=n(482),f=n(483),m=n(100),v=n(484),g=[],y=i(g.sort),x=i(g.push),w=(n=u((function(){g.sort(void 0)})),i=u((function(){g.sort(null)})),d=d("sort"),!u((function(){if(m)return m<70;if(!(p&&3<p)){if(f)return!0;if(v)return v<603;for(var e,t,n,r="",i=65;i<76;i++){switch(e=String.fromCharCode(i),i){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(n=0;n<47;n++)g.push({k:e+n,v:t})}for(g.sort((function(e,t){return t.v-e.v})),n=0;n<g.length;n++)e=g[n].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}})));r({target:"Array",proto:!0,forced:n||!i||!d||!w},{sort:function(e){void 0!==e&&a(e);var t=o(this);if(w)return void 0===e?y(t):y(t,e);for(var n,r,i=[],u=s(t),d=0;d<u;d++)d in t&&x(i,t[d]);for(h(i,(r=e,function(e,t){return void 0===t?-1:void 0===e?1:void 0!==r?+r(e,t)||0:c(e)>c(t)?1:-1})),n=s(i),d=0;d<n;)t[d]=i[d++];for(;d<u;)l(t,d++);return t}})},function(e,t,n){n=n(72).match(/firefox\/(\d+)/i),e.exports=!!n&&+n[1]},function(e,t,n){n=n(72),e.exports=/MSIE|Trident/.test(n)},function(e,t,n){n=n(72).match(/AppleWebKit\/(\d+)\./),e.exports=!!n&&+n[1]},function(e,t,n){n=n(486),e.exports=n},function(e,t,n){n(487),e.exports=9007199254740991},function(e,t,n){n(14)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){n=n(489),e.exports=n},function(e,t,n){var r=n(31),i=n(490),a=String.prototype;e.exports=function(e){var t=e.trim;return"string"==typeof e||e===a||r(a,e)&&t===a.trim?i:t}},function(e,t,n){n(491),n=n(38),e.exports=n("String").trim},function(e,t,n){"use strict";var r=n(14),i=n(159).trim;r({target:"String",proto:!0,forced:n(492)("trim")},{trim:function(){return i(this)}})},function(e,t,n){var r=n(191).PROPER,i=n(20),a=n(134);e.exports=function(e){return i((function(){return!!a[e]()||""!==""[e]()||r&&a[e].name!==e}))}},function(e,t,n){n=n(494),e.exports=n},function(e,t,n){n(495),n=n(24),e.exports=n.Math.log2},function(e,t,n){n=n(14);var r=Math.log,i=Math.LN2;n({target:"Math",stat:!0},{log2:function(e){return r(e)/i}})},function(e,t,n){n(62);var r=n(67),i=n(35),a=n(31),o=n(497),s=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.values;return e===s||a(s,e)&&t===s.values||i(l,r(e))?o:t}},function(e,t,n){n=n(498),e.exports=n},function(e,t,n){n(63),n(74),n=n(38),e.exports=n("Array").values},function(e,t,n){var r=n(500);n(62),e.exports=r},function(e,t,n){n(63),n(501),n(74),n(83),n=n(24),e.exports=n.Map},function(e,t,n){n(502)},function(e,t,n){"use strict";n(161)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(230))},function(e,t,n){n=n(504),e.exports=n},function(e,t,n){n(505),n=n(24),e.exports=n.Math.sign},function(e,t,n){n(14)({target:"Math",stat:!0},{sign:n(506)})},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,n){n=n(508),e.exports=n},function(e,t,n){n(509),n=n(24),e.exports=n.Object.freeze},function(e,t,n){var r=n(14),i=n(160),a=n(20),o=n(30),s=n(112).onFreeze,l=Object.freeze;r({target:"Object",stat:!0,forced:a((function(){l(1)})),sham:!i},{freeze:function(e){return l&&o(e)?l(s(e)):e}})},function(e,t,n){n=n(511),e.exports=n},function(e,t,n){var r=n(31),i=n(512),a=Array.prototype;e.exports=function(e){var t=e.find;return e===a||r(a,e)&&t===a.find?i:t}},function(e,t,n){n(513),n=n(38),e.exports=n("Array").find},function(e,t,n){"use strict";var r=n(14),i=n(66).find,a=(n=n(107),!0);"find"in[]&&Array(1).find((function(){a=!1})),r({target:"Array",proto:!0,forced:a},{find:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),n("find")},function(e,t,n){n(62);var r=n(67),i=n(35),a=n(31),o=n(515),s=Array.prototype,l={DOMTokenList:!0,NodeList:!0};e.exports=function(e){var t=e.keys;return e===s||a(s,e)&&t===s.keys||i(l,r(e))?o:t}},function(e,t,n){n=n(516),e.exports=n},function(e,t,n){n(63),n(74),n=n(38),e.exports=n("Array").keys},function(e,t,n){n=n(518),e.exports=n},function(e,t,n){var r=n(31),i=n(519),a=Array.prototype;e.exports=function(e){var t=e.lastIndexOf;return e===a||r(a,e)&&t===a.lastIndexOf?i:t}},function(e,t,n){n(520),n=n(38),e.exports=n("Array").lastIndexOf},function(e,t,n){n(14)({target:"Array",proto:!0,forced:(n=n(521))!==[].lastIndexOf},{lastIndexOf:n})},function(e,t,n){"use strict";var r=n(81),i=n(59),a=n(90),o=n(58),s=(n=n(111),Math.min),l=[].lastIndexOf,c=!!l&&1/[1].lastIndexOf(1,-0)<0;n=n("lastIndexOf");e.exports=c||!n?function(e){if(c)return r(l,this,arguments)||0;var t=i(this),n=o(t),u=n-1;for((u=1<arguments.length?s(u,a(arguments[1])):u)<0&&(u=n+u);0<=u;u--)if(u in t&&t[u]===e)return u||0;return-1}:l},function(e,t,n){var r=n(213),i=n(221);e.exports=function(e){if(r(e))return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(133),i=n(16),a=n(218);e.exports=function(e){if(void 0!==r&&null!=i(e)||null!=e["@@iterator"])return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){n=n(526),e.exports=n},function(e,t,n){var r=n(31),i=n(527),a=Array.prototype;e.exports=function(e){var t=e.findIndex;return e===a||r(a,e)&&t===a.findIndex?i:t}},function(e,t,n){n(528),n=n(38),e.exports=n("Array").findIndex},function(e,t,n){"use strict";var r=n(14),i=n(66).findIndex,a=(n=n(107),"findIndex"),o=!0;a in[]&&Array(1)[a]((function(){o=!1})),r({target:"Array",proto:!0,forced:o},{findIndex:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),n(a)},function(e,t,n){var r=n(530);n(62),e.exports=r},function(e,t,n){n(63),n(74),n(531),n(83),n=n(24),e.exports=n.Set},function(e,t,n){n(532)},function(e,t,n){"use strict";n(161)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(230))},function(e,t,n){n=n(534),e.exports=n},function(e,t,n){var r=n(31),i=n(535),a=n(537),o=Array.prototype,s=String.prototype;e.exports=function(e){var t=e.includes;return e===o||r(o,e)&&t===o.includes?i:"string"==typeof e||e===s||r(s,e)&&t===s.includes?a:t}},function(e,t,n){n(536),n=n(38),e.exports=n("Array").includes},function(e,t,n){"use strict";var r=n(14),i=n(151).includes,a=n(20);n=n(107);r({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),n("includes")},function(e,t,n){n(538),n=n(38),e.exports=n("String").includes},function(e,t,n){"use strict";var r=n(14),i=n(23),a=n(539),o=n(86),s=n(51),l=(n=n(541),i("".indexOf));r({target:"String",proto:!0,forced:!n("includes")},{includes:function(e){return!!~l(s(o(this)),s(a(e)),1<arguments.length?arguments[1]:void 0)}})},function(e,t,n){var r=n(540),i=TypeError;e.exports=function(e){if(r(e))throw i("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(30),i=n(70),a=n(32)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(32)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){var r={"./MobileStyle/SvgIcon.scss":589,"./PCStyle/SvgIcon.scss":593};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=542},function(e,t,n){var r=n(2);r.AnaglyphEffect=function(e,t,n){this.colorMatrixLeft=(new r.Matrix3).fromArray([.4561,-.0400822,-.0152161,.500484,-.0378246,-.0205971,.176381,-.0157589,-.00546856]),this.colorMatrixRight=(new r.Matrix3).fromArray([-.0434706,.378476,-.0721527,-.0879388,.73364,-.112961,-.00155529,-.0184503,1.2264]);var i=new r.OrthographicCamera(-1,1,1,-1,0,1),a=new r.Scene,o=new r.StereoCamera,s={minFilter:r.LinearFilter,magFilter:r.NearestFilter,format:r.RGBAFormat},l=new r.WebGLRenderTarget(t=void 0===t?512:t,n=void 0===n?512:n,s),c=new r.WebGLRenderTarget(t,n,s),u=new r.ShaderMaterial({uniforms:{mapLeft:{value:l.texture},mapRight:{value:c.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),h=new r.Mesh(new r.PlaneGeometry(2,2),u);a.add(h),this.setSize=function(t,n){e.setSize(t,n);var r=e.getPixelRatio();l.setSize(t*r,n*r),c.setSize(t*r,n*r)},this.render=function(t,n){var r=e.getRenderTarget();t.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),o.update(n),e.setRenderTarget(l),e.clear(),e.render(t,o.cameraL),e.setRenderTarget(c),e.clear(),e.render(t,o.cameraR),e.setRenderTarget(null),e.render(a,i),e.setRenderTarget(r)},this.dispose=function(){l&&l.dispose(),c&&c.dispose(),h&&h.geometry.dispose(),u&&u.dispose()}}},function(e,t,n){n=n(545),e.exports=n},function(e,t,n){var r=n(31),i=n(546),a=Array.prototype;e.exports=function(e){var t=e.some;return e===a||r(a,e)&&t===a.some?i:t}},function(e,t,n){n(547),n=n(38),e.exports=n("Array").some},function(e,t,n){"use strict";var r=n(14),i=n(66).some;r({target:"Array",proto:!0,forced:!n(111)("some")},{some:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}})},function(e,t,n){n=n(549),e.exports=n},function(e,t,n){var r=n(31),i=n(550),a=Array.prototype;e.exports=function(e){var t=e.fill;return e===a||r(a,e)&&t===a.fill?i:t}},function(e,t,n){n(551),n=n(38),e.exports=n("Array").fill},function(e,t,n){var r=n(14),i=n(552);n=n(107);r({target:"Array",proto:!0},{fill:i}),n("fill")},function(e,t,n){"use strict";var r=n(54),i=n(104),a=n(58);e.exports=function(e){for(var t,n=r(this),o=a(n),s=i(1<(t=arguments.length)?arguments[1]:void 0,o),l=void 0===(t=2<t?arguments[2]:void 0)?o:i(t,o);s<l;)n[s++]=e;return n}},function(e,t,n){var r={"./MobileStyle/RightClickMenu.scss":595,"./PCStyle/RightClickMenu.scss":597};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=553},function(e,t,n){"use strict";t.byteLength=function(e){return 3*((e=c(e))[0]+(e=e[1]))/4-e},t.toByteArray=function(e){var t,n,r=(o=c(e))[0],o=o[1],s=new a(function(e,t){return 3*(e+t)/4-t}(r,o)),l=0,u=0<o?r-4:r;for(n=0;n<u;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;return 2===o&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,s[l++]=255&t),1===o&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t),s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(function(e,t,n){for(var i,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(function(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}(i));return a.join("")}(e,o,s<o+16383?s:o+16383));return 1==i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2==i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return t=(e=-1===(e=e.indexOf("="))?t:e)===t?0:4-e%4,[e,t]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1;i=e[t+h];for(h+=d,a=i&(1<<-u)-1,i>>=-u,u+=s;0<u;a=256*a+e[t+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=r;0<u;o=256*o+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(i?-1:1);o+=Math.pow(2,r),a-=c}return(i?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,l=8*a-i-1,c=(1<<l)-1,u=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1;a=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(r=Math.pow(2,-o))<1&&(o--,r*=2),2<=(t+=1<=o+u?h/r:h*Math.pow(2,1-u))*r&&(o++,r/=2),c<=o+u?(s=0,o=c):1<=o+u?(s=(t*r-1)*Math.pow(2,i),o+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,i),o=0));8<=i;e[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;0<l;e[n+d]=255&o,d+=p,o/=256,l-=8);e[n+d-p]|=128*a}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(558),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(84))},function(e,t,n){(function(e,t){!function(e,n){"use strict";var r,i,a,o,s,l,c,u;function h(e){delete i[e]}function d(e){if(a)setTimeout(d,0,e);else{var t=i[e];if(t){a=!0;try{var n=t,r=n.callback,o=n.args;switch(o.length){case 0:r();break;case 1:r(o[0]);break;case 2:r(o[0],o[1]);break;case 3:r(o[0],o[1],o[2]);break;default:r.apply(void 0,o)}}finally{h(e),a=!1}}}}e.setImmediate||(r=1,a=!(i={}),o=e.document,u=(u=Object.getPrototypeOf&&Object.getPrototypeOf(e))&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?s=function(e){t.nextTick((function(){d(e)}))}:function(){var t,n;if(e.postMessage&&!e.importScripts)return t=!0,n=e.onmessage,e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}()?function(){function t(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&d(+t.data.slice(n.length))}var n="setImmediate$"+Math.random()+"$";e.addEventListener?e.addEventListener("message",t,!1):e.attachEvent("onmessage",t),s=function(t){e.postMessage(n+t,"*")}}():s=e.MessageChannel?((c=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){c.port2.postMessage(e)}):o&&"onreadystatechange"in o.createElement("script")?(l=o.documentElement,function(e){var t=o.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,l.removeChild(t),t=null},l.appendChild(t)}):function(e){setTimeout(d,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];return i[r]={callback:e,args:t},s(r),r++},u.clearImmediate=h)}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(84),n(162))},function(e,t,n){n=n(560),e.exports=n},function(e,t,n){n(561),n=n(24),e.exports=n.Math.log10},function(e,t,n){n(14)({target:"Math",stat:!0},{log10:n(562)})},function(e,t){var n=Math.log,r=Math.LOG10E;e.exports=Math.log10||function(e){return n(e)*r}},function(e,t,n){var r={"./MobileStyle/selectBox.scss":599,"./PCStyle/selectBox.scss":601};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=563},function(e,t,n){var r={"./MobileStyle/RenderSetDialog.scss":603,"./PCStyle/RenderSetDialog.scss":605};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=564},function(e,t,n){var r={"./MobileStyle/mainstyle.scss":611,"./PCStyle/mainstyle.scss":613};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=565},function(e,t,n){e.exports=n.p+"image/b26896ddb3fc8e9b610af082e95c0409.png"},function(e,t,n){e.exports=n.p+"image/c06a03d63efdb83115eb4ca2b0dea743.png"},function(e,t,n){e.exports=n.p+"image/41e746f17516af2b9892597f022beb54.png"},function(e,t,n){e.exports=n.p+"image/77803e5afb68120abb1f50e3de1a696e.png"},function(e,t,n){e.exports=n.p+"image/e451dde70d67865276872615151fabd6.png"},function(e,t,n){e.exports=n.p+"image/519ebe579825ec22be4b13ffaaa75679.png"},function(e,t,n){n=n(573),e.exports=n},function(e,t,n){n(574),n=n(24),e.exports=n.Date.now},function(e,t,n){var r=n(14),i=(n=n(23),Date),a=n(i.prototype.getTime);r({target:"Date",stat:!0},{now:function(){return a(new i)}})},function(e,t,n){var r={"./MobileStyle/multiview.scss":619,"./PCStyle/multiview.scss":621};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=575},function(e,t,n){var r={"./MobileStyle/minMap.scss":623,"./PCStyle/minMap.scss":625};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=576},function(e,t,n){var r={"./MobileStyle/FirstPersonRoaming.scss":631,"./PCStyle/FirstPersonRoaming.scss":633};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=577},function(e,t,n){var r={"./MobileStyle/TopMenu.scss":635,"./PCStyle/TopMenu.scss":637};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=578},function(e,t,n){var r={"./MobileStyle/CaptureMark.scss":639,"./PCStyle/CaptureMark.scss":641};function i(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}i.keys=function(){return Object.keys(r)},i.resolve=a,(e.exports=i).id=579},function(e,t,n){n=n(581),e.exports=n},function(e,t,n){n(582),n(586),n(587),n=n(24),e.exports=n.URL},function(e,t,n){n(583)},function(e,t,n){"use strict";function r(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)Y(t,e%256),e=z(e/256);return F(t,".")}if("object"!=typeof e)return e;for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,a=0;a<8;a++)0!==e[a]?(n<i&&(t=r,n=i),r=null,i=0):(null===r&&(r=a),++i);return n<i&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i=i&&!1,r===n?(t+=n?":":"::",i=!0):(t+=U(e[n],16),n<7&&(t+=":")));return"["+t+"]"}function i(e,t){var n=M(e,0);return 32<n&&n<127&&!x(t,e)?e:encodeURIComponent(e)}function a(e,t){return 2==e.length&&B(K,O(e,0))&&(":"==(e=O(e,1))||!t&&"|"==e)}function o(e){return 1<e.length&&a(q(e,0,2))&&(2==e.length||"/"===(e=O(e,2))||"\\"===e||"?"===e||"#"===e)}function s(e,t,n){var r,i;e=S(e);if(t){if(i=this.parse(e))throw k(i);this.searchParams=null}else{if(void 0!==n&&(r=new s(n,!0)),i=this.parse(e,null,r))throw k(i);(t=I(new R)).bindURL(this),this.searchParams=t}}function l(e,t){return{get:function(){return P(this)[e]()},set:t&&function(e){return P(this)[t](e)},configurable:!0,enumerable:!0}}n(83);var c,u=n(14),h=n(40),d=n(233),p=n(28),f=n(64),m=n(23),v=n(60),g=n(584),y=n(92),x=n(35),w=n(228),b=n(220),_=n(153),M=n(195).codeAt,E=n(585),S=n(51),T=n(68),A=n(122),L=n(234),C=(n=n(61)).set,P=n.getterFor("URL"),R=L.URLSearchParams,I=L.getState,k=(n=p.URL,p.TypeError),D=p.parseInt,z=Math.floor,N=Math.pow,O=m("".charAt),B=m(/./.exec),F=m([].join),U=m(1..toString),H=m([].pop),V=m([].push),G=m("".replace),W=m([].shift),j=m("".split),q=m("".slice),X=m("".toLowerCase),Y=m([].unshift),Z="Invalid scheme",J="Invalid host",Q="Invalid port",K=/[a-z]/i,$=/[\d+-.a-z]/i,ee=/\d/,te=/^0x/i,ne=/^[0-7]+$/,re=/^\d+$/,ie=/^[\da-f]+$/i,ae=/[\0\t\n\r #%/:<>?@[\\\]^|]/,oe=/[\0\t\n\r #/:<>?@[\\\]^|]/,se=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,le=/[\t\n\r]/g,ce={},ue=w({},ce,{" ":1,'"':1,"<":1,">":1,"`":1}),he=w({},ue,{"#":1,"?":1,"{":1,"}":1}),de=w({},he,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),pe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},fe={},me={},ve={},ge={},ye={},xe={},we={},be={},_e={},Me={},Ee={},Se={},Te={},Ae={},Le={},Ce={},Pe={},Re={},Ie={},ke={},De={},ze=(s.prototype={type:"URL",parse:function(e,t,n){var r,s,l,u,h=this,d=t||fe,p=0,f="",m=!1,v=!1,g=!1;for(e=S(e),t||(h.scheme="",h.username="",h.password="",h.host=null,h.port=null,h.path=[],h.query=null,h.fragment=null,h.cannotBeABaseURL=!1,e=G(e,se,"")),e=G(e,le,""),r=b(e);p<=r.length;){switch(s=r[p],d){case fe:if(!s||!B(K,s)){if(t)return Z;d=ve;continue}f+=X(s),d=me;break;case me:if(s&&(B($,s)||"+"==s||"-"==s||"."==s))f+=X(s);else{if(":"!=s){if(t)return Z;f="",d=ve,p=0;continue}if(t&&(h.isSpecial()!=x(pe,f)||"file"==f&&(h.includesCredentials()||null!==h.port)||"file"==h.scheme&&!h.host))return;if(h.scheme=f,t)return void(h.isSpecial()&&pe[h.scheme]==h.port&&(h.port=null));f="","file"==h.scheme?d=Ae:h.isSpecial()&&n&&n.scheme==h.scheme?d=ge:h.isSpecial()?d=be:"/"==r[p+1]?(d=ye,p++):(h.cannotBeABaseURL=!0,V(h.path,""),d=Ie)}break;case ve:if(!n||n.cannotBeABaseURL&&"#"!=s)return Z;if(n.cannotBeABaseURL&&"#"==s){h.scheme=n.scheme,h.path=_(n.path),h.query=n.query,h.fragment="",h.cannotBeABaseURL=!0,d=De;break}d="file"==n.scheme?Ae:xe;continue;case ge:if("/"!=s||"/"!=r[p+1]){d=xe;continue}d=_e,p++;break;case ye:if("/"==s){d=Me;break}d=Re;continue;case xe:if(h.scheme=n.scheme,s==c)h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=_(n.path),h.query=n.query;else if("/"==s||"\\"==s&&h.isSpecial())d=we;else if("?"==s)h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=_(n.path),h.query="",d=ke;else{if("#"!=s){h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=_(n.path),h.path.length--,d=Re;continue}h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,h.path=_(n.path),h.query=n.query,h.fragment="",d=De}break;case we:if(!h.isSpecial()||"/"!=s&&"\\"!=s){if("/"!=s){h.username=n.username,h.password=n.password,h.host=n.host,h.port=n.port,d=Re;continue}d=Me}else d=_e;break;case be:if(d=_e,"/"!=s||"/"!=O(f,p+1))continue;p++;break;case _e:if("/"==s||"\\"==s)break;d=Me;continue;case Me:if("@"==s){m&&(f="%40"+f);m=!0;for(var y=b(f),w=0;w<y.length;w++){var M=y[w];":"!=M||g?(M=i(M,de),g?h.password+=M:h.username+=M):g=!0}f=""}else if(s==c||"/"==s||"?"==s||"#"==s||"\\"==s&&h.isSpecial()){if(m&&""==f)return"Invalid authority";p-=b(f).length+1,f="",d=Ee}else f+=s;break;case Ee:case Se:if(t&&"file"==h.scheme){d=Ce;continue}if(":"!=s||v){if(s==c||"/"==s||"?"==s||"#"==s||"\\"==s&&h.isSpecial()){if(h.isSpecial()&&""==f)return J;if(t&&""==f&&(h.includesCredentials()||null!==h.port))return;if(l=h.parseHost(f))return l;if(f="",d=Pe,t)return;continue}"["==s?v=!0:"]"==s&&(v=!1),f+=s}else{if(""==f)return J;if(l=h.parseHost(f))return l;if(f="",d=Te,t==Se)return}break;case Te:if(!B(ee,s)){if(s==c||"/"==s||"?"==s||"#"==s||"\\"==s&&h.isSpecial()||t){if(""!=f){var E=D(f,10);if(65535<E)return Q;h.port=h.isSpecial()&&E===pe[h.scheme]?null:E,f=""}if(t)return;d=Pe;continue}return Q}f+=s;break;case Ae:if(h.scheme="file","/"==s||"\\"==s)d=Le;else{if(!n||"file"!=n.scheme){d=Re;continue}if(s==c)h.host=n.host,h.path=_(n.path),h.query=n.query;else if("?"==s)h.host=n.host,h.path=_(n.path),h.query="",d=ke;else{if("#"!=s){o(F(_(r,p),""))||(h.host=n.host,h.path=_(n.path),h.shortenPath()),d=Re;continue}h.host=n.host,h.path=_(n.path),h.query=n.query,h.fragment="",d=De}}break;case Le:if("/"==s||"\\"==s){d=Ce;break}n&&"file"==n.scheme&&!o(F(_(r,p),""))&&(a(n.path[0],!0)?V(h.path,n.path[0]):h.host=n.host),d=Re;continue;case Ce:if(s==c||"/"==s||"\\"==s||"?"==s||"#"==s){if(!t&&a(f))d=Re;else{if(""==f){if(h.host="",t)return}else{if(l=h.parseHost(f))return l;if("localhost"==h.host&&(h.host=""),t)return;f=""}d=Pe}continue}f+=s;break;case Pe:if(h.isSpecial()){if(d=Re,"/"!=s&&"\\"!=s)continue}else if(t||"?"!=s)if(t||"#"!=s){if(s!=c&&(d=Re,"/"!=s))continue}else h.fragment="",d=De;else h.query="",d=ke;break;case Re:if(s==c||"/"==s||"\\"==s&&h.isSpecial()||!t&&("?"==s||"#"==s)){if(".."===(E=X(E=f))||"%2e."===E||".%2e"===E||"%2e%2e"===E?(h.shortenPath(),"/"==s||"\\"==s&&h.isSpecial()||V(h.path,"")):"."===(u=f)||"%2e"===X(u)?"/"==s||"\\"==s&&h.isSpecial()||V(h.path,""):("file"==h.scheme&&!h.path.length&&a(f)&&(h.host&&(h.host=""),f=O(f,0)+":"),V(h.path,f)),f="","file"==h.scheme&&(s==c||"?"==s||"#"==s))for(;1<h.path.length&&""===h.path[0];)W(h.path);"?"==s?(h.query="",d=ke):"#"==s&&(h.fragment="",d=De)}else f+=i(s,he);break;case Ie:"?"==s?(h.query="",d=ke):"#"==s?(h.fragment="",d=De):s!=c&&(h.path[0]+=i(s,ce));break;case ke:t||"#"!=s?s!=c&&("'"==s&&h.isSpecial()?h.query+="%27":h.query+="#"==s?"%23":i(s,ce)):(h.fragment="",d=De);break;case De:s!=c&&(h.fragment+=i(s,ue))}p++}},parseHost:function(e){var t,n,r;if("["==O(e,0))return"]"==O(e,e.length-1)&&(t=function(e){function t(){return O(e,d)}var n,r,i,a,o,s,l,c=[0,0,0,0,0,0,0,0],u=0,h=null,d=0;if(":"==t()){if(":"!=O(e,1))return;d+=2,h=++u}for(;t();){if(8==u)return;if(":"==t()){if(null!==h)return;d++,h=++u}else{for(n=r=0;r<4&&B(ie,t());)n=16*n+D(t(),16),d++,r++;if("."==t()){if(0==r)return;if(d-=r,6<u)return;for(i=0;t();){if(a=null,0<i){if(!("."==t()&&i<4))return;d++}if(!B(ee,t()))return;for(;B(ee,t());){if(o=D(t(),10),null===a)a=o;else{if(0==a)return;a=10*a+o}if(255<a)return;d++}c[u]=256*c[u]+a,2!=++i&&4!=i||u++}if(4!=i)return;break}if(":"==t()){if(d++,!t())return}else if(t())return;c[u++]=n}}if(null!==h)for(s=u-h,u=7;0!=u&&0<s;)l=c[u],c[u--]=c[h+s-1],c[h+--s]=l;else if(8!=u)return;return c}(q(e,1,-1)))?void(this.host=t):J;if(this.isSpecial())return e=E(e),B(ae,e)||null===(t=function(e){var t,n,r,i,a,o,s,l=j(e,".");if(l.length&&""==l[l.length-1]&&l.length--,4<(t=l.length))return e;for(n=[],r=0;r<t;r++){if(""==(i=l[r]))return e;if(a=10,1<i.length&&"0"==O(i,0)&&(a=B(te,i)?16:8,i=q(i,8==a?1:2)),""===i)o=0;else{if(!B(10==a?re:8==a?ne:ie,i))return e;o=D(i,a)}V(n,o)}for(r=0;r<t;r++)if(o=n[r],r==t-1){if(o>=N(256,5-t))return null}else if(255<o)return null;for(s=H(n),r=0;r<n.length;r++)s+=n[r]*N(256,3-r);return s}(e))?J:void(this.host=t);if(B(oe,e))return J;for(t="",n=b(e),r=0;r<n.length;r++)t+=i(n[r],ce);this.host=t},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return x(pe,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&a(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,i=e.password,a=e.host,o=e.port,s=e.path,l=e.query,c=e.fragment,u=t+":";return null!==a?(u+="//",e.includesCredentials()&&(u+=n+(i?":"+i:"")+"@"),u+=r(a),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+F(s,"/"):"",null!==l&&(u+="?"+l),null!==c&&(u+="#"+c),u},setHref:function(e){if(e=this.parse(e))throw k(e);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new ze(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+r(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(S(e)+":",fe)},getUsername:function(){return this.username},setUsername:function(e){var t=b(S(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=i(t[n],de)}},getPassword:function(){return this.password},setPassword:function(e){var t=b(S(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=i(t[n],de)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?r(e):r(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Ee)},getHostname:function(){var e=this.host;return null===e?"":r(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Se)},getPort:function(){var e=this.port;return null===e?"":S(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=S(e))?this.port=null:this.parse(e,Te))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+F(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Pe))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=S(e))?this.query=null:("?"==O(e,0)&&(e=q(e,1)),this.query="",this.parse(e,ke)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""==(e=S(e))?this.fragment=null:("#"==O(e,0)&&(e=q(e,1)),this.fragment="",this.parse(e,De))},update:function(){this.query=this.searchParams.serialize()||null}},function(e){var t=y(this,Ne),n=1<A(arguments.length,1)?arguments[1]:void 0;e=C(t,new s(e,!1,n));h||(t.href=e.serialize(),t.origin=e.getOrigin(),t.protocol=e.getProtocol(),t.username=e.getUsername(),t.password=e.getPassword(),t.host=e.getHost(),t.hostname=e.getHostname(),t.port=e.getPort(),t.pathname=e.getPathname(),t.search=e.getSearch(),t.searchParams=e.getSearchParams(),t.hash=e.getHash())}),Ne=ze.prototype;h&&(g(Ne,"href",l("serialize","setHref")),g(Ne,"origin",l("getOrigin")),g(Ne,"protocol",l("getProtocol","setProtocol")),g(Ne,"username",l("getUsername","setUsername")),g(Ne,"password",l("getPassword","setPassword")),g(Ne,"host",l("getHost","setHost")),g(Ne,"hostname",l("getHostname","setHostname")),g(Ne,"port",l("getPort","setPort")),g(Ne,"pathname",l("getPathname","setPathname")),g(Ne,"search",l("getSearch","setSearch")),g(Ne,"searchParams",l("getSearchParams")),g(Ne,"hash",l("getHash","setHash"))),v(Ne,"toJSON",(function(){return P(this).serialize()}),{enumerable:!0}),v(Ne,"toString",(function(){return P(this).serialize()}),{enumerable:!0}),n&&(L=n.createObjectURL,p=n.revokeObjectURL,L&&v(ze,"createObjectURL",f(L,n)),p)&&v(ze,"revokeObjectURL",f(p,n)),T(ze,"URL"),u({global:!0,constructor:!0,forced:!d,sham:!h},{URL:ze})},function(e,t,n){var r=n(50);e.exports=function(e,t,n){return r.f(e,t,n)}},function(e,t,n){"use strict";function r(e){return e+22+75*(e<26)}function i(e){var t,n=[],i=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i,a=y(e,n++);55296<=a&&a<=56319&&n<r?56320==(64512&(i=y(e,n++)))?w(t,((1023&a)<<10)+(1023&i)+65536):(w(t,a),n--):w(t,a)}return t}(e)).length,u=128,h=0,m=72;for(E=0;E<e.length;E++)(t=e[E])<128&&w(n,g(t));var b=n.length,_=b;for(b&&w(n,"-");_<i;){for(var M=a,E=0;E<e.length;E++)u<=(t=e[E])&&t<M&&(M=t);var S=_+1;if(M-u>v((a-h)/S))throw f(d);for(h+=(M-u)*S,u=M,E=0;E<e.length;E++){if((t=e[E])<u&&++h>a)throw f(d);if(t==u){for(var T=h,A=o;;){var L=A<=m?1:m+s<=A?s:A-m;if(T<L)break;var C=T-L,P=o-L;w(n,g(r(L+C%P))),T=v(C/P),A+=o}w(n,g(r(T))),m=function(e,t,n){var r=0;for(e=n?v(e/c):e>>1,e+=v(e/t);p*s>>1<e;)e=v(e/p),r+=o;return v(r+(p+1)*e/(e+l))}(h,S,_==b),h=0,_++}}h++,u++}return x(n,"")}n=n(23);var a=2147483647,o=36,s=26,l=38,c=700,u=/[^\0-\u007E]/,h=/[.\u3002\uFF0E\uFF61]/g,d="Overflow: input needs wider integers to process",p=o-1,f=RangeError,m=n(h.exec),v=Math.floor,g=String.fromCharCode,y=n("".charCodeAt),x=n([].join),w=n([].push),b=n("".replace),_=n("".split),M=n("".toLowerCase);e.exports=function(e){for(var t,n=[],r=_(b(M(e),h,"."),"."),a=0;a<r.length;a++)t=r[a],w(n,m(u,t)?"xn--"+i(t):t);return x(n,".")}},function(e,t){},function(e,t,n){n(234)},function(e,t,n){"use strict";n.r(t);var r=n(37),a=n.n(r),o=(r=n(5),n.n(r)),s=(r=n(7),n.n(r)),l=(r=n(18),n.n(r)),c=(r=n(19),n.n(r)),u=(r=n(13),n.n(r)),h=(r=n(15),r=n.n(r),n(25)),d=n.n(h),p=(h=n(6),n.n(h)),f=(h=n(79),n.n(h)),m=(h=n(42),n.n(h)),v=n(2),g=function(e){v.DataTextureLoader.call(this,e),this.type=v.UnsignedByteType},y=(g.prototype=u()(r()(v.DataTextureLoader.prototype),{constructor:g,parse:function(e){var t,n,r,i,a,o,s,l,c,u,h=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},g=function(e,t,n){t=t||1024;for(var r=e.pos,i=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));(i=d()(s).call(s,"\n"))<0&&a<t&&r<e.byteLength;)o+=s,a+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(r,r+128)));return-1<i&&(!1!==n&&(e.pos+=a+i+1),o+p()(s).call(s,0,i))},y=((e=new Uint8Array(e)).pos=0,function(e){var t,n,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,s={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(t=g(e)))return h(1,"no header found");if(!(n=t.match(/^#\?(\S+)/)))return h(3,"bad initial token");for(s.valid|=1,s.programtype=n[1],s.string+=t+"\n";!1!==(t=g(e));)if(s.string+=t+"\n","#"===t.charAt(0))s.comments+=t+"\n";else if((n=t.match(r))&&(s.gamma=f()(n[1],10)),(n=t.match(i))&&(s.exposure=f()(n[1],10)),(n=t.match(a))&&(s.valid|=2,s.format=n[1]),(n=t.match(o))&&(s.valid|=4,s.height=m()(n[1],10),s.width=m()(n[2],10)),2&s.valid&&4&s.valid)break;return 2&s.valid?4&s.valid?s:h(3,"missing image size specifier"):h(3,"missing format specifier")}(e));if(-1!==y){var x=y.width,w=y.height,b=function(e,t,n){var r,i,a,o,s,l,c,u,d,p,f,m,v,g=t,y=n;if(g<8||32767<g||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(g!==(e[2]<<8|e[3]))return h(3,"wrong scanline width");if(!(r=new Uint8Array(4*t*n)).length)return h(4,"unable to allocate buffer space");for(a=i=0,u=4*g,v=new Uint8Array(4),l=new Uint8Array(u);0<y&&a<e.byteLength;){if(a+4>e.byteLength)return h(1);if(v[0]=e[a++],v[1]=e[a++],v[2]=e[a++],v[3]=e[a++],2!=v[0]||2!=v[1]||(v[2]<<8|v[3])!=g)return h(3,"bad rgbe scanline format");for(c=0;c<u&&a<e.byteLength;){if((m=128<(o=e[a++]))&&(o-=128),0===o||u<c+o)return h(3,"bad scanline data");if(m)for(s=e[a++],d=0;d<o;d++)l[c++]=s;else l.set(e.subarray(a,a+o),c),c+=o,a+=o}for(p=g,d=0;d<p;d++)r[i]=l[d+(f=0)],f+=g,r[i+1]=l[d+f],f+=g,r[i+2]=l[d+f],f+=g,r[i+3]=l[d+f],i+=4;y--}return r}(e.subarray(e.pos),x,w);if(-1!==b){switch(this.type){case v.UnsignedByteType:var _=b,M=v.RGBEFormat,E=v.UnsignedByteType;break;case v.FloatType:for(var S=b.length/4*3,T=new Float32Array(S),A=0;A<S;A++)l=T,c=3*A,u=void 0,u=(o=b)[3+(s=4*A)],u=Math.pow(2,u-128)/255,l[c+0]=o[s+0]*u,l[c+1]=o[s+1]*u,l[c+2]=o[s+2]*u;_=T,M=v.RGBFormat,E=v.FloatType;break;case v.HalfFloatType:S=b.length/4*3;var L=new Uint16Array(S);for(A=0;A<S;A++)r=L,i=3*A,a=void 0,a=(t=b)[3+(n=4*A)],a=Math.pow(2,a-128)/255,r[i+0]=v.DataUtils.toHalfFloat(t[n+0]*a),r[i+1]=v.DataUtils.toHalfFloat(t[n+1]*a),r[i+2]=v.DataUtils.toHalfFloat(t[n+2]*a);_=L,M=v.RGBFormat,E=v.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:x,height:w,data:_,header:y.string,gamma:y.gamma,exposure:y.exposure,format:M,type:E}}}return null},setDataType:function(e){return this.type=e,this},load:function(e,t,n,r){return v.DataTextureLoader.prototype.load.call(this,e,(function(e,n){switch(e.type){case v.UnsignedByteType:e.encoding=v.RGBEEncoding,e.minFilter=v.NearestFilter,e.magFilter=v.NearestFilter,e.generateMipmaps=!1,e.flipY=!0;break;case v.FloatType:case v.HalfFloatType:e.encoding=v.LinearEncoding,e.minFilter=v.LinearFilter,e.magFilter=v.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,n)}),n,r)}}),n(2));function x(){return new y.Scene}function w(e,t){document.getElementById(e).appendChild(t.domElement)}h=n(55);var b=n.n(h),_=(h=n(27),n.n(h)),M=(h=n(9),n.n(h)),E=(h=n(115),n.n(h)),S=(h=n(22),n.n(h)),T=(h=n(11),n.n(h)),A=(h=n(17),n.n(h)),L=(h=n(16),n.n(h)),C=(h=n(8),n.n(h)),P=(h=n(80),n.n(h));function R(e){return e.split("][")[1].split("]")[0]}n(114);h=n(39);var I,k,D,z,N,O=n.n(h);function B(){var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];t=o()(t).call(t,(function(t){return O()(e).call(e,t)})).length?"Mobile":"PC";return 1024<=window.screen.width?"PC":t}function F(){return"Mobile"===B()?"MobileStyle":"PCStyle"}window._iconfont_svg_string_3854110='<svg><symbol id="icon-lock-screen" viewBox="0 0 1024 1024"><path d="M812.8 396.8h-80c0-128-99.2-227.2-224-227.2s-224 99.2-224 227.2h-80c0-153.6 137.6-307.2 304-307.2s304 150.4 304 307.2zM915.2 528c0-44.8-35.2-80-80-80H192c-44.8 0-80 35.2-80 80v380.8c0 44.8 35.2 80 80 80h643.2c44.8 0 80-35.2 80-80V528zM576 825.6c0 32-25.6 60.8-60.8 60.8h-9.6c-32 0-60.8-25.6-60.8-60.8V662.4c0-32 25.6-60.8 60.8-60.8h9.6c32 0 60.8 25.6 60.8 60.8v163.2z"  ></path></symbol><symbol id="icon-close-btn" viewBox="0 0 1024 1024"><path d="M514.133333 85.333333c-238.933333 0-426.666667 187.733333-426.666666 426.666667C87.466667 746.666667 277.333333 938.666667 512 938.666667c234.666667 0 426.666667-192 426.666667-426.666667 0-236.8-192-426.666667-424.533334-426.666667z m162.133334 558.933334c8.533333 8.533333 8.533333 21.333333 0 29.866666-4.266667 4.266667-10.666667 6.4-14.933334 6.4-6.4 0-10.666667-2.133333-14.933333-6.4L512 539.733333l-136.533333 134.4c-4.266667 4.266667-10.666667 6.4-14.933334 6.4-6.4 0-10.666667-2.133333-14.933333-6.4-8.533333-8.533333-8.533333-21.333333 0-29.866666l134.4-134.4-134.4-134.4c-8.533333-8.533333-8.533333-21.333333 0-29.866667 8.533333-8.533333 21.333333-8.533333 29.866667 0l134.4 134.4 134.4-134.4c8.533333-8.533333 21.333333-8.533333 29.866666 0 8.533333 8.533333 8.533333 21.333333 0 29.866667l-134.4 134.4 136.533334 134.4z" fill="" ></path></symbol><symbol id="icon-biaogao" viewBox="0 0 1024 1024"><path d="M938.666667 565.333333a32 32 0 0 1 32 32v256a32 32 0 0 1-32 32H85.333333A32 32 0 0 1 53.333333 853.333333V597.333333A32 32 0 0 1 85.333333 565.333333z m-32 64h-789.333334v192h789.333334v-192z m32-448a32 32 0 0 1 3.072 63.850667L938.666667 245.333333H567.893333L342.613333 470.613333a32 32 0 0 1-45.226666 0l-234.666667-234.666666-0.512-0.512a32.213333 32.213333 0 0 1-0.917333-1.002667l1.408 1.536a34.176 34.176 0 0 1-2.645334-2.986667L59.733333 232.533333a31.274667 31.274667 0 0 1-5.205333-27.925333l0.085333-0.256 0.426667-1.365333 0.341333-0.938667 0.576-1.450667 0.533334-1.130666a31.381333 31.381333 0 0 1 25.557333-17.984h0.213333A31.36 31.36 0 0 1 85.333333 181.333333h853.333334z m-461.248 64H162.56L320 402.752l157.418667-157.418667z" fill="" ></path></symbol><symbol id="icon-baxin" viewBox="0 0 1024 1024"><path d="M512 802.1C352 802.1 221.9 672 221.9 512S352 221.9 512 221.9 802.1 352 802.1 512 672 802.1 512 802.1z m0-486.3c-108.2 0-196.2 88-196.2 196.2s88 196.2 196.2 196.2 196.2-88 196.2-196.2S620.2 315.8 512 315.8z" fill="#dbdbdb" ></path><path d="M512 609.4c-53.7 0-97.4-43.7-97.4-97.4S458.3 414.6 512 414.6s97.4 43.7 97.4 97.4-43.7 97.4-97.4 97.4z m0-100.9c-1.9 0-3.5 1.5-3.5 3.5 0 1.9 1.5 3.4 3.5 3.4s3.5-1.5 3.5-3.4-1.6-3.5-3.5-3.5z" fill="#409EFF" ></path><path d="M512 315.8c-25.9 0-47-21-47-47v-112.2c0-25.9 21-47 47-47s47 21 47 47v112.2c0 26-21.1 47-47 47z" fill="#dbdbdb" ></path><path d="M512 914.3c-25.9 0-47-21-47-47V755.2c0-25.9 21-47 47-47s47 21 47 47v112.1c0 25.9-21.1 47-47 47z" fill="#dbdbdb" ></path><path d="M867.3 559H755.1c-25.9 0-47-21-47-47s21-47 47-47h112.2c25.9 0 47 21 47 47s-21 47-47 47z" fill="#dbdbdb" ></path><path d="M268.9 559H156.7c-25.9 0-47-21-47-47s21-47 47-47h112.2c25.9 0 47 21 47 47s-21.1 47-47 47z" fill="#dbdbdb" ></path></symbol><symbol id="icon-View-East" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M972.730135 91.952556l1.934712 638.616143-217.440117 217.063924V307.565446z" fill="" opacity=".7" ></path></symbol><symbol id="icon-View-North" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M322.451979 51.968511h650.278156v650.815576H322.451979z" fill="" opacity=".7" ></path></symbol><symbol id="icon-View-West" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M269.46237 716.380812V76.259893L53.741996 290.797943v641.142017z" fill="" opacity=".7" ></path></symbol><symbol id="icon-View-South" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M53.741996 323.365593h649.472027V970.043036H53.741996z" fill="" opacity=".7" ></path></symbol><symbol id="icon-View-Bottom" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M308.962737 752.38795l641.625696 1.934712-215.559148 215.559148H92.32875z" fill="" opacity=".7" ></path></symbol><symbol id="icon-View-All" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path></symbol><symbol id="icon-View-Top" viewBox="0 0 1026 1024"><path d="M690.154718 0H269.46237L0 269.46237v754.53763h757.063504L1026.472132 754.483888V0h-336.317414zM269.46237 76.259893v193.202477H76.259893l193.202477-193.202477zM53.741996 323.365593h215.720374v393.015219L53.741996 931.93996zM703.160281 970.043036H91.952556l215.451664-215.61289h395.756061v215.61289z m0-269.462371H323.311851V323.365593h379.84843z m15.800147-431.118295H323.311851V53.741996h611.207725l-215.559148 215.720374z m38.103076 678.170253v-193.471187h193.094993l-193.094993 193.471187z m215.505405-247.213184h-215.612889v-392.853993L972.730135 91.952556v608.628109z" fill="" ></path><path d="M292.893881 51.968511l641.625695 1.773485-215.559148 215.720374H76.259893z" fill="" opacity=".7" ></path></symbol><symbol id="icon-roam-left" viewBox="0 0 1024 1024"><path d="M919.6 935.4c7.7-6.8 10.5-17.6 7-27.3L783.1 512l143-398.8c3.5-9.7 0.7-20.5-7.1-27.3-7.8-6.8-18.9-8.1-28-3.3l-781.4 407.6c-8.29999999 4.3-13.4 12.9-13.4 22.2 0 9.30000001 5.2 17.9 13.49999999 22.2l781.80000001 404.2c9.3 4.7 20.4 3.4 28.1-3.4z" fill="" ></path></symbol><symbol id="icon-roam-right" viewBox="0 0 1024 1024"><path d="M104.4 88.6c-7.7 6.8-10.5 17.6-7 27.3L240.9 512l-143 398.8c-3.5 9.7-0.7 20.5 7.1 27.3 7.8 6.8 18.9 8.1 28 3.3l781.4-407.6c8.29999999-4.3 13.4-12.9 13.4-22.2 0-9.30000001-5.2-17.9-13.49999999-22.2l-781.80000001-404.2c-9.3-4.7-20.4-3.4-28.1 3.4z" fill="" ></path></symbol><symbol id="icon-roam-up" viewBox="0 0 1024 1024"><path d="M88.6 919.6c6.8 7.7 17.6 10.5 27.3 7L512 783.1l398.8 143c9.7 3.5 20.5 0.7 27.3-7.1 6.8-7.8 8.1-18.9 3.3-28l-407.6-781.4c-4.3-8.29999999-12.9-13.4-22.2-13.4-9.30000001 0-17.9 5.2-22.2 13.49999999l-404.2 781.80000001c-4.7 9.3-3.4 20.4 3.4 28.1z" fill="" ></path></symbol><symbol id="icon-roam-down" viewBox="0 0 1024 1024"><path d="M935.4 104.4c-6.8-7.7-17.6-10.5-27.3-7L512 240.9l-398.8-143c-9.7-3.5-20.5-0.7-27.3 7.1-6.8 7.8-8.1 18.9-3.3 28l407.6 781.4c4.3 8.29999999 12.9 13.4 22.2 13.4 9.30000001 0 17.9-5.2 22.2-13.49999999l404.2-781.80000001c4.7-9.3 3.4-20.4-3.4-28.1z" fill="" ></path></symbol><symbol id="icon-point-roam" viewBox="0 0 1026 1024"><path d="M519.672328 627.084915q-6.137862-1.022977-11.252747 3.068931t-9.206793 9.206793q-5.114885 7.160839-7.672328 19.948052t-2.557443 26.085914 2.557443 25.062937 8.695305 17.902098q6.137862 7.160839 17.390609 9.206793 9.206793-2.045954 17.390609 1.022977 7.160839 2.045954 14.321678 8.695305t12.275724 20.971029q8.183816 22.505495 1.022977 41.942058t-20.45954 30.689311q-9.206793 8.183816-11.764236 14.833167t-1.534466 12.787213q2.045954 6.137862 6.137862 13.298701t9.206793 15.344655l-33.758242 65.470529-87.976024-343.72028-364.17982-98.205794 958.529471-520.695305-191.296703 363.156843q-17.390609-4.091908-39.896104-3.58042t-34.781219 11.764236q-4.091908 3.068931-5.114885 8.183816l-2.045954 10.22977q-1.022977 8.183816-6.137862 20.45954t-28.643357 21.482517q-11.252747 4.091908-19.948052 10.22977t-16.367632 10.22977-15.344655 4.603397-15.856144-7.672328q-10.22977-10.22977-20.45954-9.206793-8.183816 1.022977-16.879121 6.649351t-17.390609 13.298701-15.344655 16.879121-9.718282 17.390609q-4.091908 8.183816-3.58042 16.879121t5.626374 12.787213l0 1.022977 12.275724 12.275724q4.091908 4.091908 4.603397 8.183816t-2.045954 10.22977-6.649351 17.390609q-9.206793 21.482517-19.436563 38.361638t-32.735265 15.856144zM1020.931069 645.498501q4.091908 9.206793 4.091908 23.016983t-4.091908 27.108891q-2.045954 7.160839-6.649351 9.718282t-9.718282 2.557443q-14.321678-1.022977-28.643357 6.649351t-20.45954 21.994006-3.068931 28.643357 13.298701 24.551449q2.045954 2.045954 4.091908 5.114885 4.091908 5.114885 2.045954 13.298701-2.045954 10.22977-15.856144 24.03996t-26.085914 14.833167q-6.137862 1.022977-9.718282-1.022977t-7.672328-5.114885q-8.183816-7.160839-22.505495-13.298701t-28.643357 0q-14.321678 5.114885-21.994006 18.413586t-7.672328 27.62038q0 11.252747-8.183816 16.367632t-25.574426 5.114885-28.643357-5.114885q-10.22977-5.114885-8.183816-15.344655l-1.022977 0q1.022977-14.321678-6.137862-28.643357t-21.482517-20.45954-30.177822-2.045954-26.085914 15.344655q-6.137862 7.160839-19.436563 3.068931-6.137862-3.068931-12.787213-8.183816t-12.275724-11.764236-10.22977-13.298701-5.626374-11.764236q-2.045954-8.183816 9.206793-17.390609 8.183816-8.183816 12.787213-20.971029t-0.511489-27.108891q-3.068931-9.206793-10.22977-14.321678t-15.344655-8.183816q-9.206793-4.091908-19.436563-5.114885-8.183816-1.022977-12.275724-6.137862-7.160839-8.183816-6.649351-28.131868t6.649351-30.177822q6.137862-9.206793 13.298701-8.183816 14.321678 0 29.666334-7.160839t21.482517-21.482517 1.022977-29.666334-16.367632-25.574426l0-1.022977q-3.068931-2.045954-3.068931-8.183816t2.045954-11.252747q5.114885-11.252747 16.879121-22.505495t21.994006-13.298701q5.114885-1.022977 7.672328 1.022977t5.626374 5.114885q11.252747 10.22977 25.574426 13.81019t28.643357-1.534466q7.160839-3.068931 12.787213-9.206793t9.718282-13.298701 6.137862-12.787213 2.045954-8.695305q0-8.183816 4.091908-12.275724 5.114885-5.114885 13.81019-6.649351t17.390609-1.534466 16.367632 2.045954 11.764236 3.068931q5.114885 2.045954 7.160839 7.160839t2.045954 9.206793q-1.022977 14.321678 6.137862 27.108891t21.482517 18.925075 29.154845 3.58042 25.062937-13.81019q8.183816-8.183816 17.390609-5.114885 11.252747 5.114885 23.528472 17.902098t14.321678 27.108891q0 3.068931-2.045954 7.160839t-4.091908 5.114885q-11.252747 10.22977-14.833167 24.551449t2.557443 28.643357q5.114885 14.321678 19.948052 21.994006t29.154845 6.649351q5.114885 0 9.206793 2.045954t6.137862 7.160839zM798.945055 765.186813q19.436563 0 37.338661-7.672328t30.689311-20.45954 20.45954-30.177822 7.672328-37.85015q0-19.436563-7.672328-37.338661t-20.45954-30.689311-30.689311-20.45954-37.338661-7.672328-36.827173 7.672328-30.177822 20.45954-20.45954 30.689311-7.672328 37.338661q0 20.45954 7.672328 37.85015t20.45954 30.177822 30.177822 20.45954 36.827173 7.672328z"  ></path></symbol><symbol id="icon-attribute" viewBox="0 0 1025 1024"><path d="M225.536 256.768c-17.664 0-32 14.336-32 32s14.336 32 32 32l384 0c17.664 0 32-14.336 32-32s-14.336-32-32-32L225.536 256.768zM353.536 704.768c17.664 0 32-14.336 32-32s-14.336-32-32-32l-128 0c-17.664 0-32 14.336-32 32s14.336 32 32 32L353.536 704.768zM417.536 832.768l-288 0c-35.392 0-64-28.608-64-64l0-576c0-35.392 28.608-64 64-64l576 0c35.392 0 64 28.608 64 64l0 160c0 17.664 14.336 32 32 32s32-14.336 32-32l0-160c0-70.656-57.344-128-128-128l-576 0c-70.656 0-128 57.344-128 128l0 576c0 70.656 57.344 128 128 128l288 0c17.664 0 32-14.336 32-32S435.264 832.768 417.536 832.768zM417.536 448.768l-192 0c-17.664 0-32 14.336-32 32s14.336 32 32 32l192 0c17.664 0 32-14.336 32-32S435.264 448.768 417.536 448.768zM1014.272 902.4l-97.024-97.024c27.52-37.248 44.352-82.816 44.352-132.608 0-123.712-100.288-224-224-224s-224 100.288-224 224 100.288 224 224 224c49.792 0 95.424-16.832 132.608-44.288l97.024 97.024c12.992 12.992 34.048 12.992 47.04 0S1027.264 915.392 1014.272 902.4zM737.536 832.768c-88.384 0-160-71.616-160-160s71.616-160 160-160 160 71.616 160 160S825.92 832.768 737.536 832.768z"  ></path></symbol><symbol id="icon-point-roam-view" viewBox="0 0 1024 1024"><path d="M752.570589 101.250008c0-22.273283-15.231913-36.681434-38.072107-36.681433-22.144346 0-38.071084 14.169721-38.108946 36.681433 0 24.409946 38.108946 75.740008 38.108946 75.740009s38.072107-51.54905 38.072107-75.740009z m-52.462862-4.352121c0-7.479345 5.467525-13.661138 12.57848-14.646581a12.261255 12.261255 0 0 1 2.727111-0.293689c7.642051 0 13.840216 6.198166 13.840216 13.827936 0 0.127913-0.016373 0.218988-0.016373 0.309039 0.016373 0.290619 0.016373 0.547469 0.016373 0.804319 0 8.157797-6.509251 14.793938-14.569834 14.793937-8.027837-0.001023-14.575973-6.620791-14.575973-14.794961zM653.663952 322.56965c67.654866 0 122.514311-54.859445 122.514311-122.498962 0-25.933649-8.082072-50.01409-21.834284-69.838601-4.27742 9.640568-9.782807 19.695574-15.325034 29.003567h12.692067a105.869213 105.869213 0 0 1 7.825222 32.676214h-32.513507c-0.181125-4.166903-0.440022-8.206916-0.874927-12.253069-6.820336 10.285251-11.850909 17.102516-11.850909 17.102517s-1.369184-1.866511-3.621481-5.02955v0.198521h-48.825009v-32.694633h27.633361c-3.14462-5.281283-6.268774-10.785647-9.179057-16.350386h-18.4717V95.068216c1.409093 0.420579 2.816139 0.954745 4.228301 1.572821 0.436952-6.639211 2.025123-12.634762 4.585436-17.920138a123.516128 123.516128 0 0 0-16.983813-1.168615c-67.682495 0-122.521474 54.857399-122.521475 122.518404 0.001023 67.639516 54.841026 122.498962 122.522498 122.498962z m73.359798-114.309442h32.513508c-0.861624 11.249205-3.471055 22.218024-7.826246 32.639374h-28.745694c2.191922-10.292414 3.603061-21.284769 4.058432-32.639374z m-8.341992 48.993854h24.487717c-4.130064 6.432503-8.960069 12.396331-14.44499 17.896602a104.774275 104.774275 0 0 1-29.296233 20.756743c7.93574-10.496052 14.46955-23.661909 19.253506-38.653345z m-56.847729-48.993854h48.819892c-0.450255 11.249205-1.947352 22.218024-4.400217 32.639374h-44.419675v-32.639374z m0 48.993854h39.628555c-2.728134 7.699356-6.018064 14.753005-9.803273 21.047362-5.52176 9.175987-11.996219 16.526395-18.793018 21.300118-3.622504 2.560312-7.30436 4.357238-11.031241 5.465479v-47.812959z m-16.364713 47.812959v-0.00307c-3.722788-1.11438-7.413853-2.90926-11.025101-5.462409-6.789637-4.773723-13.280468-12.125155-18.761296-21.300118-3.807722-6.310729-7.079232-13.348006-9.844206-21.047362h39.631626v47.810912c0.00614 0.00307 0.00921 0.00307 0.017396 0.00307h-0.018419z m0.016373-64.168462h-44.438095c-2.449795-10.42135-3.908006-21.389146-4.403287-32.639375h48.841382v32.639375z m0-48.983621h-48.841382c0.494257-11.289114 1.953492-22.236444 4.403287-32.679284h44.438095v32.679284z m-11.028171-91.358731c3.624551-2.562359 7.297197-4.370541 11.047614-5.468548v47.817052h-39.643906c2.742461-7.67889 6.031367-14.739702 9.831926-21.048386 5.491061-9.16166 11.979846-16.510022 18.764366-21.300118z m-55.877635 24.430412a106.300025 106.300025 0 0 1 29.291116-20.756743c-7.919367 10.515494-14.481829 23.661909-19.253506 38.674835h-24.486694a106.153692 106.153692 0 0 1 14.449084-17.918092z m-22.972201 34.250059h28.728298c-2.193968 10.330276-3.563152 21.267373-4.003174 32.679283H547.77939c0.842181-11.283997 3.479241-22.25691 7.828292-32.679283z m-7.839549 49.02353h32.545231c0.438998 11.354606 1.829671 22.346961 4.006243 32.639374H555.607682a105.229646 105.229646 0 0 1-7.839549-32.639374z m40.866757 48.993854c4.771677 14.991436 11.335163 28.158317 19.237133 38.653345a105.232716 105.232716 0 0 1-29.291117-20.756743 107.805308 107.805308 0 0 1-14.43271-17.896602h24.486694z m312.419475 89.814561c-35.746132-57.669444-158.298306-3.908006-287.198048 76.807317l-142.822846-72.900333 3.387144-1.980098c6.984065-4.075829 9.389858-13.113669 5.344728-20.200064-4.016477-7.076162-12.958126-9.496282-19.940144-5.406127l-19.967774 11.672854-141.29198-72.122621c-13.969153-8.15882-30.589692-4.558829-38.672788 9.606799-8.058536 14.139022-1.957585 28.206412 9.454326 41.653678l185.888687 218.507596c-77.260641 56.874335-143.295614 110.343107-176.776146 137.993864a28.894074 28.894074 0 0 0-2.156106-0.761339L153.253918 632.248711c-15.670911-4.79112-31.41243 4.408403-35.147498 20.557199 0 0 55.013965 55.277978 75.40641 91.064018 20.345374 35.682687 39.963177 111.314225 39.963177 111.314225 15.691377 4.811586 31.408337-4.3951 35.146475-20.553105l18.608823-80.484056a75.317383 75.317383 0 0 0 9.836019-4.839215c0.005117 0.00614 672.01746-292.479331 603.987041-402.239154zM688.813496 753.246483l7.927554-139.139967c-49.152467 35.715433-101.298104 70.012563-150.077064 100.453876l73.699536 215.343533c5.870708 17.801435 13.031804 29.53978 29.167296 29.526477 16.136515-0.014326 29.217439-13.250792 29.217439-29.562293L686.795537 788.54236l16.007578-9.347902c6.976902-4.087085 9.384741-13.125949 5.345752-20.215414-3.923356-6.864338-12.435217-9.320273-19.335371-5.732561z"  ></path></symbol><symbol id="icon-file-tree" viewBox="0 0 1024 1024"><path d="M128 128h256v170.666667H128V128m512 298.666667h256v170.666666h-256v-170.666666m0 298.666666h256v170.666667h-256v-170.666667m-85.333333-170.666666H298.666667v213.333333h256v85.333333H213.333333V384h85.333334v85.333333h256v85.333334z" fill="" ></path></symbol><symbol id="icon-model-view" viewBox="0 0 1104 1024"><path d="M722.565521 1024H33.162646L28.976573 1020.535664l-1.876515-0.866084a17.89907 17.89907 0 0 1-2.886947-1.443473l-2.309558-1.299126a45.180716 45.180716 0 0 1-6.351282-4.763463L14.541839 1011.153087V1010.43135l-1.876515-1.876515a10.104314 10.104314 0 0 1-1.154779-1.443473l-1.154778-1.443474a20.06428 20.06428 0 0 1-2.598252-3.897378 5.340851 5.340851 0 0 1-0.866084-1.443473 9.671271 9.671271 0 0 1-0.866085-1.732168 5.340851 5.340851 0 0 1 0-1.587821 7.794756 7.794756 0 0 1 0-1.58782 9.815619 9.815619 0 0 1-1.154778-3.175642 6.639977 6.639977 0 0 1 0-1.876515 32.333803 32.333803 0 0 1-4.763462-6.062588 4.474767 4.474767 0 0 1 0-1.443474 33.344235 33.344235 0 0 1 0-5.340851V340.515365v-2.886947a21.6521 21.6521 0 0 1 0-3.175641v-2.020863a8.516493 8.516493 0 0 1 0-1.876515 36.086834 36.086834 0 0 0 1.010431-3.753031l1.154779-2.742599a32.045109 32.045109 0 0 1 1.58782-3.608684 46.191147 46.191147 0 0 1 2.453905-4.33042 28.869467 28.869467 0 0 1 2.16521-3.031294 21.6521 21.6521 0 0 1 2.886947-3.319988l1.443473-1.299126 1.154779-1.154779 1.443473-1.299126L382.338851 10.248661a46.0468 46.0468 0 0 1 28.869467-10.248661H1066.11218l2.16521 1.443473 3.608684 1.010432 2.453905 0.866084 4.186072 1.876515 3.031294 1.876515-10.681702 18.909501L1082.712124 7.939103l1.299126 0.866084 1.876515 1.443474 2.598252 2.16521 1.154779 1.154779 1.299126 1.299126 1.732168 2.020862 1.732168 2.453905a6.49563 6.49563 0 0 1 0.866084 1.154779l0.866084 1.299126a14.434734 14.434734 0 0 1 1.443474 2.453904 3.175641 3.175641 0 0 1 0.721736 1.154779 18.765154 18.765154 0 0 1 1.732168 3.464336v1.732168s0 2.16521 1.010432 2.7426a19.48689 19.48689 0 0 1 1.010431 4.474767v1.010431a5.196504 5.196504 0 0 0 0 1.443474 26.415562 26.415562 0 0 1 0 5.773893v1.587821a10.970398 10.970398 0 0 1 0 2.16521v635.128277a19.342543 19.342543 0 0 1 0 2.886947 17.754722 17.754722 0 0 1 0 2.886947V695.609811c0 0.866084 0 1.732168-0.721737 2.742599a11.259092 11.259092 0 0 1 0 2.020863 23.81731 23.81731 0 0 1-1.299126 3.031294 8.805187 8.805187 0 0 1 0 1.732168L1097.146858 707.301945a15.73386 15.73386 0 0 1-0.866084 1.587821c0 1.010431-1.876515 2.598252-2.886947 3.753031a8.372145 8.372145 0 0 1-1.443473 1.732168l-1.299126 1.299126-1.154779 1.154778-1.299126 1.154779-1.443474 1.154779L760.817565 1004.368762a47.634621 47.634621 0 0 1-38.252044 19.631238zM24.646153 1018.081759l2.886947 1.587821a12.413871 12.413871 0 0 1-2.7426-1.587821z m17.32168-32.766845l-7.361714 13.712997 8.805187-13.712997z m2.598252-3.753031v-0.866084z m2.453905 0h675.545531a4.041725 4.041725 0 0 0 3.464336-1.876515 28.869467 28.869467 0 0 1 4.186073-5.196504l328.823231-287.251198a1.876515 1.876515 0 0 1 0-0.866084V46.912884a4.186073 4.186073 0 0 1 0-1.299126V44.747674l-0.288695-1.443473H411.208318a2.598252 2.598252 0 0 0-1.732168 0L45.576516 337.051029l-0.866084 0.721737v0.866084H43.411306v637.726529h1.010432z m-2.16521 0z m0 0z m0 0z m0 0z m0 0z m0 0z m-1.443474-2.886946z m0-2.7426z m0 0z m0 0z m1044.497322-257.659994l1.299126-1.010432zM1080.258219 692.867212zM1059.472203 43.304201z m0 0z m5.629546-9.382577v0.721737l1.010431-1.299126 4.619115-8.372146z m27.281647-18.765154l1.010431 1.154779z" fill="" ></path><path d="M364.295434 148.389061s3.031294 0 3.031294 2.886947v138.71779a2.886947 2.886947 0 0 1-2.886947 2.886946h-173.216803a2.309557 2.309557 0 0 1-2.598252-1.876515 2.598252 2.598252 0 0 1 0.866084-3.319989l173.216803-139.006484a2.742599 2.742599 0 0 1 1.587821-0.721737m0-21.6521a23.961658 23.961658 0 0 0-15.15647 5.485199l-173.216803 139.150831a24.539047 24.539047 0 0 0 15.300817 43.304201h173.216803a24.3947 24.3947 0 0 0 24.3947-24.3947v-138.573442a24.539047 24.539047 0 0 0-24.683394-24.539047zM922.919623 94.114463a2.598252 2.598252 0 0 1 2.7426 1.876515 2.453905 2.453905 0 0 1-0.866084 3.175642L702.789936 291.870313H464.328138a2.886947 2.886947 0 0 1-2.886947-2.886947V97.00141a2.886947 2.886947 0 0 1 2.886947-2.886947h458.591485m0-21.6521H464.328138a24.3947 24.3947 0 0 0-24.3947 24.539047v192.559346a24.3947 24.3947 0 0 0 24.3947 24.539047l246.400902-0.721737L938.364788 115.477869a24.539047 24.539047 0 0 0-16.022554-43.304201zM679.694363 953.847195H110.244123a36.664223 36.664223 0 0 1-36.664223-36.664223V388.149986a36.808571 36.808571 0 0 1 36.664223-36.808571h569.45024a36.808571 36.808571 0 0 1 36.80857 36.808571v529.032986a36.808571 36.808571 0 0 1-36.80857 36.664223zM110.244123 372.993516a14.434734 14.434734 0 0 0-14.434734 15.15647v529.032986a14.434734 14.434734 0 0 0 14.434734 14.434733h569.45024a14.434734 14.434734 0 0 0 15.15647-14.434733V388.149986a14.434734 14.434734 0 0 0-15.15647-15.15647z" fill="" ></path><path d="M86.715507 516.186073a10.537356 10.537356 0 0 1-5.052157-1.299126 10.681703 10.681703 0 0 1-4.474767-14.434734l75.638004-141.171694a10.82605 10.82605 0 0 1 14.434734-4.474768 10.681703 10.681703 0 0 1 4.474767 14.434734l-75.782351 141.171694a11.114745 11.114745 0 0 1-9.23823 5.773894zM84.550297 612.321398a10.537356 10.537356 0 0 1-5.052157-1.299126 10.681703 10.681703 0 0 1-4.474767-14.434733l124.427403-237.30702a10.82605 10.82605 0 0 1 14.434734-4.474768 10.681703 10.681703 0 0 1 4.474767 14.434734L94.077221 606.25881a10.82605 10.82605 0 0 1-9.526924 6.062588zM88.447675 697.197632a10.537356 10.537356 0 0 1-5.052157-1.299126 10.82605 10.82605 0 0 1-4.474767-14.434734l165.566394-317.564139a10.82605 10.82605 0 0 1 19.198196 9.959967l-165.710742 317.564138a10.82605 10.82605 0 0 1-9.526924 5.773894zM89.458107 782.073865a10.537356 10.537356 0 0 1-5.052157-1.299126 10.82605 10.82605 0 0 1-4.474768-14.434733l219.840993-408.214266a10.970398 10.970398 0 0 1 14.434733-4.474767 10.681703 10.681703 0 0 1 4.33042 14.434733L98.985031 776.299972a10.681703 10.681703 0 0 1-9.526924 5.773893zM85.416381 873.012687a11.547787 11.547787 0 0 1-5.196504-1.299126 10.681703 10.681703 0 0 1-4.33042-14.434734l264.877361-490.780941a10.82605 10.82605 0 0 1 19.053848 10.24866l-264.877361 490.780942a10.970398 10.970398 0 0 1-9.526924 5.485199zM101.150241 942.876797a10.393008 10.393008 0 0 1-5.052157-1.154778 10.82605 10.82605 0 0 1-4.474767-14.434734L387.102313 366.642233a10.82605 10.82605 0 0 1 19.053848 10.104313L110.244123 937.247251a10.681703 10.681703 0 0 1-9.093882 5.629546zM140.557063 951.826332a11.40344 11.40344 0 0 1-5.052156-1.299126 10.82605 10.82605 0 0 1-4.474768-14.434733L434.736934 360.868339a10.970398 10.970398 0 0 1 14.434733-4.474767 10.82605 10.82605 0 0 1 4.619115 14.434734l-303.129405 575.801522a10.82605 10.82605 0 0 1-10.104314 5.196504zM191.65602 953.847195a10.393008 10.393008 0 0 1-4.907809-1.299126 10.82605 10.82605 0 0 1-4.619115-14.434734l301.685932-574.646744a10.82605 10.82605 0 0 1 19.198196 9.959967l-301.685932 574.646743a11.114745 11.114745 0 0 1-9.671272 5.773894zM242.899324 953.847195a10.82605 10.82605 0 0 1-9.526924-15.878207l303.129405-575.801523a10.82605 10.82605 0 1 1 19.053849 10.104314l-303.129405 575.801522a10.82605 10.82605 0 0 1-9.526925 5.773894zM305.257374 949.805469a10.537356 10.537356 0 0 1-5.052157-1.299126 10.82605 10.82605 0 0 1-4.474768-14.434733L598.426813 360.868339a10.82605 10.82605 0 0 1 14.434733-4.474767 10.681703 10.681703 0 0 1 4.474768 14.434734L314.784298 944.031576a10.82605 10.82605 0 0 1-9.526924 5.773893zM372.09019 949.805469a10.970398 10.970398 0 0 1-4.763462-1.154778 10.82605 10.82605 0 0 1-4.907809-14.434734l282.920778-570.749366a10.82605 10.82605 0 0 1 14.434733-4.907809 10.970398 10.970398 0 0 1 4.90781 14.434734l-282.920778 570.749365a10.970398 10.970398 0 0 1-9.671272 6.062588zM437.190838 948.795038a10.970398 10.970398 0 0 1-4.763462-1.154779 10.82605 10.82605 0 0 1-4.907809-14.434733L692.974317 396.955173a10.82605 10.82605 0 1 1 19.342543 9.526925L447.583847 942.73245a10.970398 10.970398 0 0 1-10.393009 6.062588zM496.084551 953.847195A11.547787 11.547787 0 0 1 490.888047 952.692416a10.681703 10.681703 0 0 1-4.763462-14.434733L694.417791 519.650409a10.82605 10.82605 0 1 1 19.342543 9.671271L505.322781 947.928954a11.114745 11.114745 0 0 1-9.23823 5.918241zM553.823486 952.692416a11.692134 11.692134 0 0 1-4.90781-1.154779 10.681703 10.681703 0 0 1-4.763462-14.434733L694.417791 635.128277a10.82605 10.82605 0 0 1 14.434733-4.907809 10.681703 10.681703 0 0 1 4.90781 14.434734L563.061715 946.774175a10.681703 10.681703 0 0 1-9.238229 5.918241zM616.325882 952.692416a10.248661 10.248661 0 0 1-4.619115-1.010431 10.82605 10.82605 0 0 1-5.052156-14.434734L692.974317 759.411334a10.681703 10.681703 0 1 1 19.342543 9.382576l-86.175359 177.835918a10.82605 10.82605 0 0 1-9.815619 6.062588zM1007.507162 140.30561s2.742599 0 2.742599 3.319989V663.997745L770.921879 885.426558V354.084015a3.753031 3.753031 0 0 1 1.154778-2.7426L1006.352383 140.883h1.154779m0-21.940795a23.384268 23.384268 0 0 0-15.878207 6.206935L757.353229 335.030166a25.405131 25.405131 0 0 0-8.372145 19.053849v534.085142a24.827742 24.827742 0 0 0 24.539047 25.260784l258.670426-239.616578V144.347336a24.827742 24.827742 0 0 0-24.683395-25.982521z" fill="" ></path><path d="M761.683649 450.21934a10.82605 10.82605 0 0 1-4.763462-1.010431 10.681703 10.681703 0 0 1-4.907809-14.434734l82.422329-168.45334a10.82605 10.82605 0 0 1 14.434733-4.90781 10.681703 10.681703 0 0 1 4.90781 14.434734l-82.422329 168.308993a10.681703 10.681703 0 0 1-9.671272 6.062588zM760.240176 571.03806a9.526924 9.526924 0 0 1-4.33042-1.010431 10.82605 10.82605 0 0 1-5.485199-14.434734l160.225543-356.682266a10.82605 10.82605 0 0 1 14.434733-5.485199 10.970398 10.970398 0 0 1 5.485199 14.434734L770.200142 564.686778a11.114745 11.114745 0 0 1-9.959966 6.351282zM761.683649 671.070764a10.248661 10.248661 0 0 1-4.619114-1.010431 10.82605 10.82605 0 0 1-5.196505-14.434734L998.701975 129.912602a10.681703 10.681703 0 0 1 19.48689 9.093882l-246.833944 525.857345a10.537356 10.537356 0 0 1-9.671272 6.206935zM762.261039 791.745137a12.558218 12.558218 0 0 1-4.474768-1.010432 10.681703 10.681703 0 0 1-5.196504-14.434733L1010.538456 222.872286a10.681703 10.681703 0 0 1 19.48689 9.093883L772.076657 785.538201a10.681703 10.681703 0 0 1-9.815618 6.206936zM767.746237 899.283902a12.558218 12.558218 0 0 1-4.474767-1.010431 10.970398 10.970398 0 0 1-5.340851-14.434734L1010.538456 343.402312a10.82605 10.82605 0 0 1 19.631238 9.093882l-252.607838 540.436425a10.82605 10.82605 0 0 1-9.815619 6.351283zM859.839838 829.419791a11.547787 11.547787 0 0 1-4.33042-0.866084 10.82605 10.82605 0 0 1-5.485199-14.434733L1011.548888 447.476741a10.970398 10.970398 0 0 1 14.434733-5.629546 10.970398 10.970398 0 0 1 5.485199 14.434733L869.655456 822.779814a10.681703 10.681703 0 0 1-9.815618 6.639977zM951.933438 739.491401a14.434734 14.434734 0 0 1-4.186073 0 10.970398 10.970398 0 0 1-5.918241-14.434733l69.575416-171.340288a10.82605 10.82605 0 1 1 20.06428 8.227798l-69.575416 170.907246a10.82605 10.82605 0 0 1-9.959966 6.639977z" fill="" ></path></symbol><symbol id="icon-list" viewBox="0 0 1024 1024"><path d="M896 256l-288 0c-17.696 0-32-14.336-32-32s14.304-32 32-32l288 0c17.696 0 32 14.336 32 32S913.696 256 896 256zM896 416l-288 0c-17.696 0-32-14.336-32-32s14.304-32 32-32l288 0c17.696 0 32 14.336 32 32S913.696 416 896 416zM896 672l-288 0c-17.696 0-32-14.304-32-32s14.304-32 32-32l288 0c17.696 0 32 14.304 32 32S913.696 672 896 672zM896 832l-288 0c-17.696 0-32-14.304-32-32s14.304-32 32-32l288 0c17.696 0 32 14.304 32 32S913.696 832 896 832zM384 480 192 480c-52.928 0-96-43.072-96-96L96 192c0-52.928 43.072-96 96-96l192 0c52.928 0 96 43.072 96 96l0 192C480 436.928 436.928 480 384 480zM192 160C174.368 160 160 174.368 160 192l0 192c0 17.632 14.368 32 32 32l192 0c17.632 0 32-14.368 32-32L416 192c0-17.632-14.368-32-32-32L192 160zM384 928 192 928c-52.928 0-96-43.072-96-96l0-192c0-52.928 43.072-96 96-96l192 0c52.928 0 96 43.072 96 96l0 192C480 884.928 436.928 928 384 928zM192 608c-17.632 0-32 14.336-32 32l0 192c0 17.664 14.368 32 32 32l192 0c17.632 0 32-14.336 32-32l0-192c0-17.664-14.368-32-32-32L192 608z" fill="" ></path></symbol><symbol id="icon-jiahao" viewBox="0 0 1024 1024"><path d="M469.333333 469.333333V170.666667h85.333334v298.666666h298.666666v85.333334h-298.666666v298.666666h-85.333334v-298.666666H170.666667v-85.333334h298.666666z" fill="" ></path></symbol><symbol id="icon-jianhao" viewBox="0 0 1024 1024"><path d="M170.666667 469.333333h682.666666v85.333334H170.666667z" fill="" ></path></symbol><symbol id="icon-guanlishitu" viewBox="0 0 1024 1024"><path d="M339.781818 549.236364h-162.909091c-69.818182 0-130.327273 60.509091-130.327272 130.327272v162.909091c0 69.818182 60.509091 130.327273 130.327272 130.327273h162.909091c74.472727 0 130.327273-55.854545 130.327273-130.327273v-162.909091c0-69.818182-60.509091-130.327273-130.327273-130.327272z m55.854546 293.236363c0 32.581818-23.272727 55.854545-55.854546 55.854546h-162.909091c-32.581818 0-55.854545-23.272727-55.854545-55.854546v-162.909091c0-32.581818 23.272727-55.854545 55.854545-55.854545h162.909091c32.581818 0 55.854545 23.272727 55.854546 55.854545v162.909091zM339.781818 51.2h-162.909091c-69.818182 0-130.327273 60.509091-130.327272 130.327273v162.909091c0 69.818182 60.509091 130.327273 130.327272 130.327272h162.909091c74.472727 0 130.327273-55.854545 130.327273-130.327272v-162.909091c0-69.818182-60.509091-130.327273-130.327273-130.327273z m55.854546 293.236364c0 32.581818-23.272727 55.854545-55.854546 55.854545h-162.909091c-32.581818 0-55.854545-23.272727-55.854545-55.854545v-162.909091c0-32.581818 23.272727-55.854545 55.854545-55.854546h162.909091c32.581818 0 55.854545 23.272727 55.854546 55.854546v162.909091zM847.127273 549.236364h-162.909091c-69.818182 0-130.327273 60.509091-130.327273 130.327272v162.909091c0 69.818182 60.509091 130.327273 130.327273 130.327273h162.909091c69.818182 0 130.327273-60.509091 130.327272-130.327273v-162.909091c0-69.818182-60.509091-130.327273-130.327272-130.327272z m55.854545 293.236363c0 32.581818-23.272727 55.854545-55.854545 55.854546h-162.909091c-32.581818 0-55.854545-23.272727-55.854546-55.854546v-162.909091c0-32.581818 23.272727-55.854545 55.854546-55.854545h162.909091c32.581818 0 55.854545 23.272727 55.854545 55.854545v162.909091zM847.127273 51.2h-162.909091c-69.818182 0-130.327273 60.509091-130.327273 130.327273v162.909091c0 69.818182 60.509091 130.327273 130.327273 130.327272h162.909091c69.818182 0 130.327273-60.509091 130.327272-130.327272v-162.909091c0-69.818182-60.509091-130.327273-130.327272-130.327273z m55.854545 293.236364c0 32.581818-23.272727 55.854545-55.854545 55.854545h-162.909091c-32.581818 0-55.854545-23.272727-55.854546-55.854545v-162.909091c0-32.581818 23.272727-55.854545 55.854546-55.854546h162.909091c32.581818 0 55.854545 23.272727 55.854545 55.854546v162.909091z"  ></path></symbol><symbol id="icon-setting" viewBox="0 0 1024 1024"><path d="M238.765 196.903c15.986 47.357 12.182 101.21-14.998 148.057-27.397 47.218-72.867 77.53-122.534 87.184-5.095 25.97-7.765 52.802-7.765 80.254 0 26.005 2.395 51.453 6.977 76.137 49.975 9.486 95.78 39.869 123.322 87.336 27.766 47.856 31.137 103.026 13.937 151.109 39.66 34.275 85.866 61.246 136.502 78.808 33.248-38.99 82.852-63.734 138.263-63.734 55.292 0 104.802 24.637 138.048 63.483 50.186-17.51 96.003-44.268 135.387-78.22-17.339-48.162-14.016-103.477 13.815-151.445 27.64-47.638 73.672-78.067 123.853-87.436 4.57-24.654 6.958-50.068 6.958-76.038 0-27.416-2.661-54.215-7.743-80.153-49.876-9.54-95.572-39.9-123.068-87.287C772.473 298 768.716 244 784.837 196.56c-39.144-33.514-84.587-59.948-134.32-77.299-33.246 38.844-82.756 63.482-138.048 63.482-55.411 0-105.015-24.744-138.263-63.734-50.185 17.406-96.019 44.053-135.44 77.892v0.001z m-61.053-70.423c48.672-41.778 104.857-74.18 165.733-95.294 36.485-12.654 77.034-1.665 102.032 27.651 16.658 19.534 40.794 30.901 66.993 30.901 26.144 0 50.232-11.318 66.888-30.778 25.053-29.271 65.623-40.186 102.085-27.465 60.332 21.049 116.036 53.194 164.36 94.567 28.868 24.72 39.777 64.393 27.578 100.292-8.069 23.744-5.67 49.771 7.285 72.101 13.075 22.534 34.805 37.682 59.766 42.457 37.468 7.166 66.798 36.275 74.098 73.54 6.283 32.07 9.47 64.832 9.47 97.947 0 31.38-2.862 62.445-8.51 92.909-7.01 37.82-36.691 67.445-74.678 74.54-25.112 4.688-47.004 19.876-60.146 42.527-13.233 22.808-15.443 49.48-6.768 73.58 13.01 36.141 2.368 76.524-26.791 101.66-48.62 41.913-104.785 74.45-165.664 95.69-36.462 12.721-77.032 1.806-102.085-27.465-16.656-19.461-40.744-30.778-66.888-30.778-26.2 0-50.336 11.367-66.993 30.9-24.998 29.317-65.547 40.306-102.032 27.652-61.42-21.303-118.063-54.095-167.03-96.412-29.045-25.101-39.669-65.346-26.767-101.411 8.608-24.062 6.377-50.661-6.826-73.416-13.096-22.571-34.88-37.732-59.89-42.48-37.855-7.185-67.399-36.754-74.4-74.465C2.87 574.928 0 543.822 0 512.4c0-33.16 3.196-65.963 9.495-98.075 7.289-37.154 36.48-66.205 73.818-73.463 24.858-4.831 46.48-19.953 59.508-42.407 12.926-22.277 15.342-48.232 7.34-71.935-12.091-35.82-1.202-75.358 27.55-100.04z m334.287 575.39c104.965 0 190.053-84.674 190.053-189.122 0-104.449-85.088-189.122-190.053-189.122-104.964 0-190.052 84.673-190.052 189.122 0 104.448 85.088 189.122 190.052 189.122z m0-93.006c-53.34 0-96.584-43.032-96.584-96.116 0-53.083 43.243-96.115 96.584-96.115 53.342 0 96.585 43.03 96.585 96.115 0 53.084-43.243 96.115-96.585 96.115z"  ></path></symbol><symbol id="icon-celiang" viewBox="0 0 1024 1024"><path d="M43.933358 473.011011l938.177933 0.061398-0.01842 285.520849-938.178956-0.060375L43.933358 473.011011zM941.305285 717.802226l0.013304-203.943902-101.975618-0.00614-0.007163 122.366955c-0.001023 11.271718-9.134405 20.392446-20.397375 20.391423-11.262969 0-20.394305-9.122775-20.394305-20.394493l0.008187-122.366955-61.185985-0.004093-0.004093 61.182454c0 11.272741-9.133382 20.394493-20.396352 20.393469-11.262969 0-20.394305-9.123798-20.393281-20.396539l0.00307-61.182454-61.185985-0.004093-0.007163 122.367979c-0.001023 11.271718-9.133382 20.392446-20.397375 20.391423-11.263993 0-20.395328-9.122775-20.394305-20.394493l0.008187-122.366955-61.185985-0.004093-0.00307 61.182454c-0.001023 11.272741-9.133382 20.394493-20.398398 20.393469-11.260923 0-20.392258-9.123798-20.392258-20.396539l0.004093-61.182454-61.185985-0.004093-0.008187 122.366955c-0.001023 11.271718-9.133382 20.393469-20.397375 20.392446-11.263993 0-20.394305-9.122775-20.393281-20.394493l0.007163-122.366955-61.185985-0.004093-0.00307 61.182454c-0.001023 11.272741-9.132359 20.394493-20.396352 20.394493-11.262969-0.001023-20.395328-9.124821-20.394305-20.397562l0.00307-61.182454-61.184961-0.004093-0.008187 122.366955c0 11.271718-9.131335 20.392446-20.395328 20.391423-11.262969 0-20.396352-9.121751-20.395328-20.393469l0.008187-122.366955-101.975618-0.007163L84.706618 717.746968 941.305285 717.802226z"  ></path><path d="M41.376011 335.577918l940.921529 0 0 53.721529-940.921529 0 0-53.721529Z"  ></path></symbol><symbol id="icon-dingwei" viewBox="0 0 1024 1024"><path d="M960 480h-65.6C879.2 293.6 730.4 144.8 544 129.6V64h-64v65.6C293.6 144.8 144.8 293.6 129.6 480H64v64h65.6c15.2 186.4 164 335.2 350.4 350.4v65.6h64v-65.6c186.4-15.2 335.2-164 350.4-350.4h65.6v-64z m-448 352c-176.8 0-320-143.2-320-320s143.2-320 320-320 320 143.2 320 320-143.2 320-320 320z m128-320c0 70.4-57.6 128-128 128s-128-57.6-128-128 57.6-128 128-128 128 57.6 128 128z"  ></path></symbol><symbol id="icon-codepen" viewBox="0 0 1024 1024"><path d="M123.428571 668l344.571429 229.714286v-205.142857L277.142857 565.142857z m-35.428571-82.285714l110.285714-73.714286-110.285714-73.714286v147.428572z m468 312l344.571429-229.714286-153.714286-102.857143-190.857143 127.428572v205.142857z m-44-281.714286l155.428571-104-155.428571-104-155.428571 104zM277.142857 458.857143l190.857143-127.428572V126.285714L123.428571 356z m548.571429 53.142857l110.285714 73.714286V438.285714z m-78.857143-53.142857l153.714286-102.857143-344.571429-229.714286v205.142857z m277.142857-102.857143v312q0 23.428571-19.428571 36.571429l-468 312q-12 7.428571-24.571429 7.428571t-24.571429-7.428571L19.428571 704.571429q-19.428571-13.142857-19.428571-36.571429V356q0-23.428571 19.428571-36.571429L487.428571 7.428571q12-7.428571 24.571429-7.428571t24.571429 7.428571l468 312q19.428571 13.142857 19.428571 36.571429z"  ></path></symbol><symbol id="icon-arrowsh" viewBox="0 0 1024 1024"><path d="M1024 512q0 14.857143-10.857143 25.714286l-146.285714 146.285714q-10.857143 10.857143-25.714286 10.857143t-25.714286-10.857143-10.857143-25.714286l0-73.142857-585.142857 0 0 73.142857q0 14.857143-10.857143 25.714286t-25.714286 10.857143-25.714286-10.857143l-146.285714-146.285714q-10.857143-10.857143-10.857143-25.714286t10.857143-25.714286l146.285714-146.285714q10.857143-10.857143 25.714286-10.857143t25.714286 10.857143 10.857143 25.714286l0 73.142857 585.142857 0 0-73.142857q0-14.857143 10.857143-25.714286t25.714286-10.857143 25.714286 10.857143l146.285714 146.285714q10.857143 10.857143 10.857143 25.714286z"  ></path></symbol><symbol id="icon-arrowsv" viewBox="0 0 1024 1024"><path d="M694.857143 182.857143q0 14.857143-10.857143 25.714286t-25.714286 10.857143l-73.142857 0 0 585.142857 73.142857 0q14.857143 0 25.714286 10.857143t10.857143 25.714286-10.857143 25.714286l-146.285714 146.285714q-10.857143 10.857143-25.714286 10.857143t-25.714286-10.857143l-146.285714-146.285714q-10.857143-10.857143-10.857143-25.714286t10.857143-25.714286 25.714286-10.857143l73.142857 0 0-585.142857-73.142857 0q-14.857143 0-25.714286-10.857143t-10.857143-25.714286 10.857143-25.714286l146.285714-146.285714q10.857143-10.857143 25.714286-10.857143t25.714286 10.857143l146.285714 146.285714q10.857143 10.857143 10.857143 25.714286z"  ></path></symbol><symbol id="icon-kuangxuan" viewBox="0 0 1024 1024"><path d="M832 1024H192a192 192 0 0 1-192-192V192a192 192 0 0 1 192-192h640a192 192 0 0 1 192 192v640a192 192 0 0 1-192 192zM192 128a64 64 0 0 0-64 64v640a64 64 0 0 0 64 64h640a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64z" fill="" ></path></symbol><symbol id="icon-pouqie" viewBox="0 0 1024 1024"><path d="M60.30222221 170.66666667L337.92 170.66666667l0 68.26666666-249.17333334 0a17.06666667 17.06666667 0 0 0-17.06666666 17.06666667L71.68 768a17.06666667 17.06666667 0 0 0 17.06666666 17.06666667L337.92 785.06666667l0 68.26666666-277.61777779 0a56.88888889 56.88888889 0 0 1-56.88888888-56.88888888l0-568.8888889a56.88888889 56.88888889 0 0 1 56.88888888-56.88888888zM440.32 3.41333332a34.13333333 34.13333333 0 0 1 34.13333334 34.13333335L474.45333334 986.45333333a34.13333333 34.13333333 0 0 1-68.26666668 0l0-948.90666666a34.13333333 34.13333333 0 0 1 34.13333334-34.13333335zM610.98666667 238.93333333l-68.26666667 0 0-68.26666666 68.26666667 0 0 68.26666666z m0 614.4l-68.26666667 0 0-68.26666666 68.26666667 0 0 68.26666666zM747.52 238.93333333l-68.26666667 0 0-68.26666666 68.26666667 0 0 68.26666666z m0 614.4l-68.26666667 0 0-68.26666666 68.26666667 0 0 68.26666666zM884.05333333 238.93333333l-68.26666666 0 0-68.26666666 68.26666666 0 0 68.26666666z m0 614.4l-68.26666666 0 0-68.26666666 68.26666666 0 0 68.26666666zM1020.58666667 227.55555555l0 45.51111112-68.26666667 0 0-102.40000001 11.37777779 1e-8a56.88888889 56.88888889 0 0 1 56.88888888 56.88888888z m0 182.04444445l-68.26666667 0 0-68.26666667L1020.58666667 341.33333333l0 68.26666667z m0 136.53333334l-68.26666668-1e-8 0-68.26666666L1020.58666667 477.86666666l0 68.26666668z m0 136.53333333l-68.26666667 0 0-68.26666667L1020.58666667 614.4l0 68.26666667z m0 113.77777778a56.88888889 56.88888889 0 0 1-56.88888888 56.88888888l-11.37777779 1e-8 0-102.40000001L1020.58666667 750.93333333l0 45.51111112z" fill="" ></path></symbol><symbol id="icon-xalxe" viewBox="0 0 1024 1024"><path d="M968.533333 665.6c-8.533333-34.133333-38.4-55.466667-72.533333-46.933333-34.133333 8.533333-55.466667 38.4-46.933333 72.533333l4.266666 12.8-42.666666-29.866667V337.066667c0-8.533333-4.266667-17.066667-8.533334-25.6-4.266667-8.533333-12.8-17.066667-21.333333-21.333334l-332.8-179.2c-17.066667-8.533333-34.133333-8.533333-46.933333 0L68.266667 290.133333l-12.8 12.8-4.266667 4.266667c-4.266667 12.8-8.533333 21.333333-8.533333 29.866667v349.866666c0 21.333333 8.533333 38.4 25.6 46.933334l332.8 179.2c8.533333 4.266667 17.066667 4.266667 25.6 4.266666h4.266666c8.533333 0 17.066667-4.266667 21.333334-4.266666l268.8-145.066667 59.733333 42.666667h-8.533333c-34.133333 8.533333-55.466667 38.4-51.2 72.533333 8.533333 34.133333 38.4 55.466667 72.533333 51.2l213.333333-42.666667-38.4-226.133333z m-537.6 179.2v-341.333333L742.4 341.333333h4.266667v281.6l-119.466667-81.066666c-29.866667-21.333333-68.266667-12.8-89.6 17.066666s-12.8 68.266667 17.066667 89.6l102.4 68.266667-226.133334 128z m358.4 46.933333c-12.8 4.266667-21.333333-4.266667-25.6-17.066666s4.266667-21.333333 17.066667-25.6l106.666667-21.333334-128-85.333333-64-42.666667-123.733334-81.066666c-8.533333-8.533333-12.8-21.333333-4.266666-29.866667s21.333333-12.8 29.866666-4.266667l140.8 93.866667 59.733334 38.4 110.933333 72.533333-21.333333-110.933333c0-8.533333 4.266667-21.333333 17.066666-21.333333s21.333333 4.266667 21.333334 17.066666l34.133333 187.733334-170.666667 29.866666z"  ></path></symbol><symbol id="icon-yaxle" viewBox="0 0 1024 1024"><path d="M42.666667 891.733333l213.333333 42.666667c34.133333 8.533333 68.266667-17.066667 72.533333-51.2 8.533333-34.133333-17.066667-68.266667-51.2-72.533333h-8.533333l59.733333-42.666667 268.8 145.066667c8.533333 4.266667 12.8 4.266667 21.333334 4.266666h4.266666c8.533333 0 17.066667 0 25.6-4.266666l332.8-179.2c17.066667-8.533333 25.6-25.6 25.6-46.933334V337.066667c0-8.533333-4.266667-21.333333-8.533333-25.6l-4.266667-4.266667-12.8-12.8-332.8-179.2c-17.066667-8.533333-34.133333-8.533333-46.933333 0L273.066667 290.133333c-8.533333 4.266667-17.066667 12.8-21.333334 21.333334-4.266667 8.533333-8.533333 17.066667-8.533333 25.6v337.066666l-38.4 25.6 4.266667-12.8c8.533333-34.133333-17.066667-68.266667-46.933334-72.533333-34.133333-4.266667-68.266667 17.066667-76.8 51.2l-42.666666 226.133333zM396.8 725.333333l102.4-68.266666c29.866667-21.333333 38.4-59.733333 17.066667-89.6-21.333333-29.866667-59.733333-38.4-89.6-17.066667l-119.466667 81.066667V345.6h4.266667l311.466666 162.133333v341.333334L396.8 725.333333z m-302.933333 132.266667l34.133333-183.466667c0-8.533333 12.8-17.066667 21.333333-17.066666s17.066667 12.8 17.066667 21.333333l-21.333333 110.933333L256 716.8l59.733333-38.4 140.8-93.866667c8.533333-8.533333 21.333333-4.266667 29.866667 4.266667s4.266667 21.333333-4.266667 29.866667l-123.733333 81.066666-64 42.666667-128 85.333333 106.666667 21.333334c12.8 4.266667 17.066667 12.8 17.066666 25.6s-12.8 17.066667-25.6 17.066666l-170.666666-34.133333z"  ></path></symbol><symbol id="icon-zaxle" viewBox="0 0 1024 1024"><path d="M878.933333 435.2l-12.8-12.8-285.866666-153.6v-29.866667l8.533333 8.533334c21.333333 21.333333 59.733333 21.333333 85.333333 0 12.8-12.8 17.066667-25.6 17.066667-42.666667s-4.266667-29.866667-17.066667-42.666667L516.266667 4.266667 362.666667 149.333333c-12.8 12.8-21.333333 29.866667-21.333334 42.666667 0 17.066667 4.266667 29.866667 17.066667 42.666667 21.333333 21.333333 64 21.333333 85.333333 0l4.266667-4.266667v42.666667L179.2 422.4c-8.533333 0-12.8 4.266667-17.066667 8.533333-8.533333 8.533333-12.8 21.333333-12.8 34.133334v337.066666c0 17.066667 8.533333 34.133333 25.6 42.666667l320 170.666667c8.533333 4.266667 12.8 4.266667 21.333334 4.266666h8.533333c8.533333 0 12.8 0 21.333333-4.266666l320-170.666667c17.066667-8.533333 25.6-25.6 25.6-42.666667v-337.066666c-4.266667-12.8-8.533333-21.333333-12.8-29.866667zM418.133333 209.066667c-8.533333 8.533333-21.333333 8.533333-29.866666 0-4.266667-8.533333-4.266667-21.333333 0-29.866667l119.466666-119.466667L640 192c4.266667 4.266667 4.266667 8.533333 4.266667 12.8 0 4.266667 0 8.533333-4.266667 12.8-8.533333 8.533333-17.066667 8.533333-25.6 0l-81.066667-81.066667v320c0 12.8-8.533333 21.333333-21.333333 21.333334s-21.333333-8.533333-21.333333-21.333334V132.266667L418.133333 209.066667z m102.4 413.866666L230.4 469.333333l226.133333-119.466666v110.933333c0 34.133333 25.6 59.733333 59.733334 59.733333s59.733333-25.6 59.733333-59.733333V341.333333l238.933333 128-294.4 153.6z"  ></path></symbol><symbol id="icon-celianggongju" viewBox="0 0 1024 1024"><path d="M953.9 718.7l-246-246 201.5-204.5c25.2-25.5 25.2-66.9 0-92.5l-58.7-59.6c-25.2-25.5-66-25.5-91.2 0L557 321.8 305.1 69.9c-3.5-3.5-8.2-5.5-13.2-5.5s-9.7 2-13.2 5.5L69.9 278.7c-3.5 3.5-5.5 8.2-5.5 13.2s2 9.7 5.5 13.2l94.7 94.7 159 159L217.8 666l-0.2-0.2-0.2 0.7-0.2 0.2 0.1 0.1-47 147.2-0.3 0.3-65 66c-7.2 7.3-7.2 18.9 0 26.2l22.6 23c3.5 3.6 8.3 5.6 13.3 5.6s9.8-2 13.3-5.6l59.9-60.8 152.6-50.2 0.3 0.3 0.7-0.7 106.8-108.4 157.9 157.9 86.3 86.3c3.6 3.6 8.4 5.5 13.2 5.5 4.8 0 9.5-1.8 13.2-5.5l208.8-208.8c7.3-7.3 7.3-19.1 0-26.4zM731.8 914.4l-60-60 48.1-48.1c7.3-7.3 7.3-19.1 0-26.4-7.3-7.3-19.1-7.3-26.4 0l-48 48.1-90.6-90.6 75.9-75.9c7.3-7.3 7.3-19.1 0-26.4-7.3-7.3-19.1-7.3-26.4 0L528.5 711 438 620.5l48.1-48.1c7.3-7.3 7.3-19.1 0-26.4-7.3-7.3-19.1-7.3-26.4 0l-48.1 48.1-90.6-90.6 70.4-70.4c7.3-7.3 7.3-19.1 0-26.4-7.3-7.3-19.1-7.3-26.4 0l-70.4 70.4-90.6-90.6 48.1-48.1c7.3-7.3 7.3-19.1 0-26.4-7.3-7.3-19.1-7.3-26.4 0l-48.1 48.1-68.3-68.3 182.5-182.5 622.4 622.4-182.4 182.7z"  ></path></symbol><symbol id="icon-roam" viewBox="0 0 1024 1024"><path d="M512 269.27407445c72.81777778 0 131.072-53.39970333 131.072-121.36296334S584.81777778 26.54814777 512 26.54814777 380.928 79.94785223 380.928 147.91111111 439.18222222 269.27407445 512 269.27407445z m165.05363001 116.50844445c-4.8545189-29.12711111-29.12711111-53.39970333-63.10874112-53.39970447h-33.98163001c-9.70903666 0-14.56355555 4.8545189-24.27259221 9.7090378l-43.69066667 33.98162887-43.69066667-38.83614777c-4.8545189-4.8545189-14.56355555-9.70903666-24.27259221-9.70903666h-33.98163001c-33.98163001 0-63.10874112 24.27259221-63.10874112 53.39970333L317.81925888 599.38133333c0 9.70903666 0 19.41807445 9.70903779 24.27259222 4.8545189 4.8545189 14.56355555 9.70903666 24.27259222 9.70903779h33.98163001l29.12711111 310.68918443c4.8545189 29.12711111 29.12711111 53.39970333 63.10873998 53.39970446h72.81777778c33.98163001 0 63.10874112-24.27259221 63.10874112-53.39970446l29.12711111-310.68918443h33.98163001c9.70903666 0 19.41807445-4.8545189 24.27259221-9.70903779 4.8545189-9.70903666 4.8545189-14.56355555 4.8545189-24.27259222l-29.12711111-213.59881443z"  ></path></symbol></svg>';var U=window,H=(H=document.getElementsByTagName("script"))[H.length-1];h=H.getAttribute("data-injectcss");if(!(H=H.getAttribute("data-disable-injectsvg"))){if(h&&!U.__iconfont__svg__cssinject__){U.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(H){console&&console.log(H)}}I=function(){var e,t,n,r=document.createElement("div");r.innerHTML=U._iconfont_svg_string_3854110,(r=r.getElementsByTagName("svg")[0])&&(r.setAttribute("aria-hidden","true"),r.style.position="absolute",r.style.width=0,r.style.height=0,r.style.overflow="hidden",(e=document.body).firstChild?(t=r,(n=e.firstChild).parentNode.insertBefore(t,n)):e.appendChild(r))},document.addEventListener?~d()(h=["complete","loaded","interactive"]).call(h,document.readyState)?a()(I,0):(k=function(){document.removeEventListener("DOMContentLoaded",k,!1),I()},document.addEventListener("DOMContentLoaded",k,!1)):document.attachEvent&&(D=I,z=U.document,N=!1,function e(){try{z.documentElement.doScroll("left")}catch(t){return void a()(e,50)}V()}(),z.onreadystatechange=function(){"complete"==z.readyState&&(z.onreadystatechange=null,V())})}function V(){N||(N=!0,D())}function G(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?W(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=o()(E=window.bimEngine.scene.children).call(E,(function(e){return"rootModel"==e.name})),r=[],i=[],a=[];if(e){var s,l=G(e);try{for(l.s();!(s=l.n()).done;){var c,u=s.value,h=G(n);try{for(h.s();!(c=h.n()).done;){var d=c.value;if(d&&d.material.length){var p,f=!1,m=G(d.ElementInfos);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(!t&&v.name===u){var g=v.center.clone();r.push(g.x),i.push(g.y),a.push(g.z),f=!0;break}if(t&&R(v.name)[0]===u){var y=v.center.clone();r.push(y.x),i.push(y.y),a.push(y.z),f=!0;break}}}catch(e){m.e(e)}finally{m.f()}if(f)break}}}catch(e){h.e(e)}finally{h.f()}}}catch(e){l.e(e)}finally{l.f()}}else{var x,w=G(n);try{for(w.s();!(x=w.n()).done;){var b,_=G(x.value.ElementInfos);try{for(_.s();!(b=_.n()).done;){var M=b.value.center.clone();r.push(M.x),i.push(M.y),a.push(M.z)}}catch(e){_.e(e)}finally{_.f()}}}catch(e){w.e(e)}finally{w.f()}}S()(r).call(r,(function(e,t){return e<t?-1:t<e?1:0})),S()(i).call(i,(function(e,t){return e<t?-1:t<e?1:0})),S()(a).call(a,(function(e,t){return e<t?-1:t<e?1:0}));var E=new THREE.Vector3(r[0],i[0],a[0]),T=(e=new THREE.Vector3(r[r.length-1],i[i.length-1],a[a.length-1]),E.clone().add(e.clone()).multiplyScalar(.5));return{min:E,max:e,center:T}}function q(e,t){var n=t.getWorldDirection().clone(),r=e.clone().sub(t.position.clone()),i=1,a=(n=(n.clone().dot(r.clone())<0&&(i=-1),e.project(t)),r=window.innerWidth,e=window.innerHeight,0),o=0;t.viewport&&(r=t.viewport.z,e=t.viewport.w,window.innerHeight,window.devicePixelRatio,a=t.viewport.x,o=t.viewport.y),t=r/2,r=e/2;return{x:(a+Math.round(n.x*t+t))*i,y:(o+Math.round(-n.y*r+r))*i}}function X(e,t){var n=!0;e=e.clone().applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix);return!(1<Math.abs(e.x)||1<Math.abs(e.y)||1<Math.abs(e.z))&&n}function Y(e){n(542)("./"+F()+"/SvgIcon.scss");var t="http://www.w3.org/2000/svg",r=document.createElementNS(t,"svg");return(t=(r.setAttribute("aria-hidden",!0),r.setAttribute("class","Svg-Icon"),document.createElementNS(t,"use"))).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+e),r.appendChild(t),r}var Z=n(2),J=(h=(Z.OrbitControls=function(e,t){void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new Z.Vector3,this.origin=new Z.Vector3(0,0,0),this.showOriginIcon=!0,this.originPosition={x:0,y:0},this.auto=!1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:Z.MOUSE.ROTATE,MIDDLE:Z.MOUSE.DOLLY,RIGHT:Z.MOUSE.PAN},this.touches={ONE:Z.TOUCH.ROTATE,TWO:Z.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return g.phi},this.getAzimuthalAngle=function(){return g.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",ae),this._domElementKeyEvents=e},this.saveState=function(){u.target0.copy(u.target),u.position0.copy(u.object.position),u.zoom0=u.object.zoom},this.reset=function(){u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.zoom=u.zoom0,u.object.updateProjectionMatrix(),u.dispatchEvent(h),u.update(),m=f.NONE},this.update=(n=new Z.Vector3,r=new Z.Vector3(0,0,0),i=new Z.Vector3,a=(new Z.Quaternion).setFromUnitVectors(e.up,new Z.Vector3(0,1,0)),o=a.clone().invert(),s=new Z.Vector3,l=new Z.Quaternion,c=2*Math.PI,function(){var e,t=u.object.position,d=(i.copy(t).sub(u.target),i.applyQuaternion(a),g.setFromVector3(i),u.autoRotate&&m===f.NONE&&k(2*Math.PI/60/60*u.autoRotateSpeed),u.enableDamping?(g.theta+=y.theta*u.dampingFactor,g.phi+=y.phi*u.dampingFactor):(g.theta+=y.theta,g.phi+=y.phi),u.minAzimuthAngle),p=u.maxAzimuthAngle;return 0!=(d=(isFinite(d)&&isFinite(p)&&(d<-Math.PI?d+=c:d>Math.PI&&(d-=c),p<-Math.PI?p+=c:p>Math.PI&&(p-=c),g.theta=d<=p?Math.max(d,Math.min(p,g.theta)):g.theta>(d+p)/2?Math.max(d,g.theta):Math.min(p,g.theta)),g.phi=Math.max(u.minPolarAngle,Math.min(u.maxPolarAngle,g.phi)),g.makeSafe(),g.radius*=x,g.radius=Math.max(u.minDistance,Math.min(u.maxDistance,g.radius)),!0===u.enableDamping?u.target.addScaledVector(w,u.dampingFactor):u.target.add(w),i.setFromSpherical(g),i.applyQuaternion(o),(r=u.origin.x!=u.target.x&&u.origin.y!=u.target.y&&u.origin.z!=u.target.z?u.origin.clone().sub(u.target):r).clone().sub(n))).x||0!=d.y||0!=d.z||0==y.theta&&0==y.phi?0==w.x&&0==w.y&&0==w.z?0==y.phi&&0==y.theta&&(this.auto?(t.copy(u.target).add(i),u.object.lookAt(u.target)):null!=window.bimEngine&&(p=window.bimEngine.scene.camera,.01<t.distanceTo(u.target.clone().add(i)))&&t.add(p.getWorldDirection().multiplyScalar(u.object.zoomdir*g.radius*.05))):(t.copy(u.target).add(i),this.auto&&u.object.lookAt(u.target)):(p=(d=window.bimEngine.scene.camera).position.distanceTo(u.origin.clone()),t=d.position.clone().sub(u.origin.clone()),d.position.copy(u.origin.clone()),d.rotateOnWorldAxis(new Z.Vector3(0,1,0),Math.PI*y.theta*u.dampingFactor*3),d.rotateOnAxis(new Z.Vector3(1,0,0),Math.PI*y.phi*u.dampingFactor*3),t=t.clone(),e=new Z.Vector3,d.getWorldDirection(e),t.applyAxisAngle(new Z.Vector3(0,1,0),Math.PI*y.theta*u.dampingFactor*3),t.applyAxisAngle(e.clone().cross(new Z.Vector3(0,1,0)).normalize(),Math.PI*y.phi*u.dampingFactor*3),d.position.copy(u.origin.clone().add(t.clone().normalize().multiplyScalar(p)))),n=r,!0===u.enableDamping?(y.theta*=1-u.dampingFactor,y.phi*=1-u.dampingFactor,w.multiplyScalar(1-u.dampingFactor)):(y.set(0,0,0),w.set(0,0,0)),x=1,!(!(b||s.distanceToSquared(u.object.position)>v||8*(1-l.dot(u.object.quaternion))>v)||(u.dispatchEvent(h),s.copy(u.object.position),l.copy(u.object.quaternion),b=!1))}),this.dispose=function(){u.domElement.removeEventListener("contextmenu",ce),u.domElement.removeEventListener("pointerdown",ee),u.domElement.removeEventListener("wheel",ie),u.domElement.removeEventListener("touchstart",oe),u.domElement.removeEventListener("touchend",le),u.domElement.removeEventListener("touchmove",se),u.domElement.ownerDocument.removeEventListener("pointermove",te),u.domElement.ownerDocument.removeEventListener("pointerup",ne),null!==u._domElementKeyEvents&&u._domElementKeyEvents.removeEventListener("keydown",ae)};var n,r,i,a,o,s,l,c,u=this,h={type:"change"},d={type:"start"},p={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},m=f.NONE,v=1e-6,g=new Z.Spherical,y=new Z.Spherical,x=1,w=new Z.Vector3,b=!1,_=new Z.Vector2,M=new Z.Vector2,E=new Z.Vector2,S=new Z.Vector2,T=new Z.Vector2,A=new Z.Vector2,L=new Z.Vector2,C=new Z.Vector2,R=new Z.Vector2;function I(){return Math.pow(.8,1/u.zoomSpeed)}function k(e){y.theta-=e}function D(e){y.phi-=e}z=new Z.Vector3;var z,N,O,B=function(e,t){z.setFromMatrixColumn(t,0),z.multiplyScalar(-e),w.add(z)},F=(N=new Z.Vector3,function(e,t){!0===u.screenSpacePanning?N.setFromMatrixColumn(t,1):(N.setFromMatrixColumn(t,0),N.crossVectors(u.object.up,N)),N.multiplyScalar(e),w.add(N)}),U=(O=new Z.Vector3,function(e,t){var n,r=u.domElement;u.object.isPerspectiveCamera?(n=u.object.position,O.copy(n).sub(u.target),n=O.length(),n*=Math.tan(u.object.fov/2*Math.PI/180),B(2*e*n/r.clientHeight,u.object.matrix),F(2*t*n/r.clientHeight,u.object.matrix)):u.object.isOrthographicCamera?(B(e*(u.object.right-u.object.left)/u.object.zoom/r.clientWidth,u.object.matrix),F(t*(u.object.top-u.object.bottom)/u.object.zoom/r.clientHeight,u.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),u.enablePan=!1)});function H(e,t){t=1<arguments.length&&void 0!==t&&t,u.object.zoomdir=-1,u.object.isPerspectiveCamera?t?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*e)),u.object.updateProjectionMatrix(),b=!0):x*=e:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*e)),u.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function V(e){u.object.zoomdir=1,u.object.isPerspectiveCamera?x*=e:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom/e)),u.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function G(e){_.set(e.clientX,e.clientY)}function W(e){S.set(e.clientX,e.clientY)}function j(e){var t;1==e.touches.length?_.set(e.touches[0].pageX,e.touches[0].pageY):(t=.5*(e.touches[0].pageX+e.touches[1].pageX),e=.5*(e.touches[0].pageY+e.touches[1].pageY),_.set(t,e))}function X(e){var t;1==e.touches.length?S.set(e.touches[0].pageX,e.touches[0].pageY):(t=.5*(e.touches[0].pageX+e.touches[1].pageX),e=.5*(e.touches[0].pageY+e.touches[1].pageY),S.set(t,e))}function J(e){var t=e.touches[0].pageX-e.touches[1].pageX;e=e.touches[0].pageY-e.touches[1].pageY,t=Math.sqrt(t*t+e*e);L.set(0,t)}function Q(e){1==e.touches.length?M.set(e.touches[0].pageX,e.touches[0].pageY):(t=.5*(e.touches[0].pageX+e.touches[1].pageX),e=.5*(e.touches[0].pageY+e.touches[1].pageY),M.set(t,e)),E.subVectors(M,_).multiplyScalar(u.rotateSpeed);var t=u.domElement;k(2*Math.PI*E.x/t.clientHeight),D(2*Math.PI*E.y/t.clientHeight),_.copy(M)}function K(e){var t;1==e.touches.length?T.set(e.touches[0].pageX,e.touches[0].pageY):(t=.5*(e.touches[0].pageX+e.touches[1].pageX),e=.5*(e.touches[0].pageY+e.touches[1].pageY),T.set(t,e)),A.subVectors(T,S).multiplyScalar(u.panSpeed),U(A.x,A.y),S.copy(T)}function $(e){var t=e.touches[0].pageX-e.touches[1].pageX;e=e.touches[0].pageY-e.touches[1].pageY,t=Math.sqrt(t*t+e*e);C.set(0,t),R.set(0,Math.pow(C.y/L.y,u.zoomSpeed)),H(R.y,!0),L.copy(C)}function ee(e){if(!1!==u.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t,n,r;switch(e.preventDefault(),u.showOriginIcon&&(window.bimEngine&&(!window.bimEngine.CurrentSelect||window.bimEngine.CurrentSelect&&!window.bimEngine.CurrentSelect.dbid)&&(u.origin=new Z.Vector3(0,0,0),t=new Z.Raycaster,(n=new Z.Vector2).x=(e.clientX-window.bimEngine.scene.camera.viewport.x)/window.bimEngine.scene.camera.viewport.z*2-1,n.y=-(e.clientY-window.bimEngine.scene.camera.viewport.y)/window.bimEngine.scene.camera.viewport.w*2+1,t.setFromCamera(n,window.bimEngine.scene.camera),0<(n=t.intersectObjects(window.bimEngine.GetAllVisibilityModel(),!0)).length)&&(u.origin=n[0].point),u.originPosition=q(u.origin.clone(),window.bimEngine.scene.camera)),(u.domElement.focus?u.domElement:window).focus(),e.button){case 0:r=u.mouseButtons.LEFT;break;case 1:r=u.mouseButtons.MIDDLE;break;case 2:r=u.mouseButtons.RIGHT;break;default:r=-1}switch(r){case Z.MOUSE.DOLLY:if(!1===u.enableZoom)return;!function(e){L.set(e.clientX,e.clientY)}(e),m=f.DOLLY;break;case Z.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===u.enablePan)return;W(e),m=f.PAN}else{if(!1===u.enableRotate)return;G(e),m=f.ROTATE}break;case Z.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===u.enableRotate)return;G(e),m=f.ROTATE}else{if(!1===u.enablePan)return;W(e),m=f.PAN}break;default:m=f.NONE}m!==f.NONE&&(u.domElement.ownerDocument.addEventListener("pointermove",te),u.domElement.ownerDocument.addEventListener("pointerup",ne),u.dispatchEvent(d))}(e)}}function te(e){if(!1!==u.enabled)switch(e.pointerType){case"mouse":case"pen":var t,n=e;if(!1!==u.enabled)switch(n.preventDefault(),m){case f.ROTATE:!1!==u.enableRotate&&(function(e){M.set(e.clientX,e.clientY),E.subVectors(M,_).multiplyScalar(u.rotateSpeed),e=u.domElement,k(2*Math.PI*E.x/e.clientHeight),D(2*Math.PI*E.y/e.clientHeight),_.copy(M),u.update()}(n),u.showOriginIcon&&(t=re()))&&(t.style.top=u.originPosition.y-t.clientWidth/2+"px",t.style.left=u.originPosition.x-t.clientHeight/2+"px",t.style.display="block");break;case f.DOLLY:!1!==u.enableZoom&&function(e){C.set(e.clientX,e.clientY),R.subVectors(C,L),0<R.y?H(I()):R.y<0&&V(I()),L.copy(C),u.update()}(n);break;case f.PAN:!1!==u.enablePan&&function(e){T.set(e.clientX,e.clientY),A.subVectors(T,S).multiplyScalar(u.panSpeed),U(A.x,A.y),S.copy(T),u.update()}(n)}}}function ne(e){switch(e.pointerType){case"mouse":case"pen":var t;u.showOriginIcon&&(t=re())&&(t.style.top=0-t.clientWidth/2+"px",t.style.left=0-t.clientHeight/2+"px",t.style.display="none"),u.domElement.ownerDocument.removeEventListener("pointermove",te),u.domElement.ownerDocument.removeEventListener("pointerup",ne),!1!==u.enabled&&(u.dispatchEvent(p),m=f.NONE)}}function re(){var e,t=document.getElementById("Three_OrbitControls_OriginIcon");return t||((e=Y("icon-baxin")).id="Three_OrbitControls_OriginIcon",e.style.display="none",e.style.position="absolute",e.style.width="30px",e.style.height="30px",u.domElement.parentElement.appendChild(e)),t}function ie(e){!1===u.enabled||!1===u.enableZoom||m!==f.NONE&&m!==f.ROTATE||(e.preventDefault(),e.stopPropagation(),u.dispatchEvent(d),(e=e).deltaY<0?V(I()):0<e.deltaY&&H(I()),u.update(),u.dispatchEvent(p))}function ae(e){if(!1!==u.enabled&&!1!==u.enablePan){var t=!1;switch(e.keyCode){case P()(u).UP:U(0,u.keyPanSpeed),t=!0;break;case P()(u).BOTTOM:U(0,-u.keyPanSpeed),t=!0;break;case P()(u).LEFT:U(u.keyPanSpeed,0),t=!0;break;case P()(u).RIGHT:U(-u.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),u.update())}}function oe(e){if(!1!==u.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(u.touches.ONE){case Z.TOUCH.ROTATE:if(!1===u.enableRotate)return;j(e),m=f.TOUCH_ROTATE;break;case Z.TOUCH.PAN:if(!1===u.enablePan)return;X(e),m=f.TOUCH_PAN;break;default:m=f.NONE}break;case 2:switch(u.touches.TWO){case Z.TOUCH.DOLLY_PAN:if(!1===u.enableZoom&&!1===u.enablePan)return;t=e,u.enableZoom&&J(t),u.enablePan&&X(t),m=f.TOUCH_DOLLY_PAN;break;case Z.TOUCH.DOLLY_ROTATE:if(!1===u.enableZoom&&!1===u.enableRotate)return;t=e,u.enableZoom&&J(t),u.enableRotate&&j(t),m=f.TOUCH_DOLLY_ROTATE;break;default:m=f.NONE}break;default:m=f.NONE}var t;m!==f.NONE&&u.dispatchEvent(d)}}function se(e){var t;if(!1!==u.enabled)switch(e.preventDefault(),e.stopPropagation(),m){case f.TOUCH_ROTATE:!1!==u.enableRotate&&(Q(e),u.update());break;case f.TOUCH_PAN:!1!==u.enablePan&&(K(e),u.update());break;case f.TOUCH_DOLLY_PAN:!1===u.enableZoom&&!1===u.enablePan||(t=e,u.enableZoom&&$(t),u.enablePan&&K(t),u.update());break;case f.TOUCH_DOLLY_ROTATE:!1===u.enableZoom&&!1===u.enableRotate||(t=e,u.enableZoom&&$(t),u.enableRotate&&Q(t),u.update());break;default:m=f.NONE}}function le(e){!1!==u.enabled&&(u.dispatchEvent(p),m=f.NONE)}function ce(e){!1!==u.enabled&&e.preventDefault()}u.domElement.addEventListener("contextmenu",ce),u.domElement.addEventListener("pointerdown",ee),u.domElement.addEventListener("wheel",ie),u.domElement.addEventListener("touchstart",oe),u.domElement.addEventListener("touchend",le),u.domElement.addEventListener("touchmove",se),this.update()},Z.OrbitControls.prototype=r()(Z.EventDispatcher.prototype),Z.OrbitControls.prototype.constructor=Z.OrbitControls,Z.MapControls=function(e,t){Z.OrbitControls.call(this,e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=Z.MOUSE.PAN,this.mouseButtons.RIGHT=Z.MOUSE.ROTATE,this.touches.ONE=Z.TOUCH.PAN,this.touches.TWO=Z.TOUCH.DOLLY_ROTATE},Z.MapControls.prototype=r()(Z.EventDispatcher.prototype),Z.MapControls.prototype.constructor=Z.MapControls,n(543),n(47)),n.n(h)),Q=(h=n(238),n.n(h)),K=n(2),$=(h=(K.TransformControls=function(e,t){void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),K.Object3D.call(this),this.visible=!1,this.domElement=t;var n=new K.TransformControlsGizmo,r=(this.add(n),new K.TransformControlsPlane),i=(this.add(r),this),a=(H("camera",e),H("object",void 0),H("enabled",!0),H("axis",null),H("mode","translate"),H("translationSnap",null),H("rotationSnap",null),H("scaleSnap",null),H("space","world"),H("size",1),H("dragging",!1),H("showX",!0),H("showY",!0),H("showZ",!0),{type:"change"}),o={type:"mouseDown"},s={type:"mouseUp",mode:i.mode},l={type:"objectChange"},c=new K.Raycaster;function u(e,t,n){for(var r=t.intersectObject(e,!0),i=0;i<r.length;i++)if(r[i].object.visible||n)return r[i];return!1}var h=new K.Vector3,p=new K.Vector3,f=new K.Quaternion,m={X:new K.Vector3(1,0,0),Y:new K.Vector3(0,1,0),Z:new K.Vector3(0,0,1)},v=new K.Vector3,g=new K.Vector3,y=new K.Vector3,x=new K.Vector3,w=new K.Vector3,b=new K.Vector3,_=0,M=new K.Vector3,E=new K.Quaternion,S=new K.Vector3,T=new K.Vector3,A=new K.Quaternion,L=new K.Quaternion,C=new K.Vector3,P=new K.Vector3,R=new K.Quaternion,I=new K.Vector3,k=new K.Vector3,D=new K.Quaternion,z=new K.Quaternion,N=new K.Vector3,O=new K.Vector3,B=new K.Vector3,F=new K.Quaternion,U=new K.Vector3;function H(e,t){var o=t;J()(i,e,{get:function(){return void 0!==o?o:t},set:function(t){o!==t&&(o=t,r[e]=t,n[e]=t,i.dispatchEvent({type:e+"-changed",value:t}),i.dispatchEvent(a))}}),i[e]=t,r[e]=t,n[e]=t}function V(e){var n,r;return i.domElement.ownerDocument.pointerLockElement?{x:0,y:0,button:e.button}:(n=e.changedTouches?e.changedTouches[0]:e,r=t.getBoundingClientRect(),{x:(n.clientX-r.left)/r.width*2-1,y:-(n.clientY-r.top)/r.height*2+1,button:e.button})}function G(e){if(i.enabled)switch(e.pointerType){case"mouse":case"pen":i.pointerHover(V(e))}}function W(e){i.enabled&&(i.domElement.style.touchAction="none",i.domElement.ownerDocument.addEventListener("pointermove",j),i.pointerHover(V(e)),i.pointerDown(V(e)))}function j(e){i.enabled&&i.pointerMove(V(e))}function q(e){i.enabled&&(i.domElement.style.touchAction="",i.domElement.ownerDocument.removeEventListener("pointermove",j),i.pointerUp(V(e)))}H("worldPosition",k),H("worldPositionStart",P),H("worldQuaternion",D),H("worldQuaternionStart",R),H("cameraPosition",M),H("cameraQuaternion",E),H("pointStart",v),H("pointEnd",g),H("rotationAxis",x),H("rotationAngle",_),H("eye",O),t.addEventListener("pointerdown",W),t.addEventListener("pointermove",G),i.domElement.ownerDocument.addEventListener("pointerup",q),this.dispose=function(){t.removeEventListener("pointerdown",W),t.removeEventListener("pointermove",G),i.domElement.ownerDocument.removeEventListener("pointermove",j),i.domElement.ownerDocument.removeEventListener("pointerup",q),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(T,A,C),this.object.matrixWorld.decompose(k,D,N),L.copy(A).invert(),z.copy(D).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(M,E,S),O.copy(M).sub(k).normalize(),K.Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){void 0!==this.object&&!0!==this.dragging&&(c.setFromCamera(e,this.camera),e=u(n.picker[this.mode],c),this.axis=e?e.object.name:null)},this.pointerDown=function(e){var t;void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis&&(c.setFromCamera(e,this.camera),(e=u(r,c,!0))&&(t=this.space,"scale"===this.mode?t="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(t="world"),"local"===t&&"rotate"===this.mode&&(t=this.rotationSnap,"X"===this.axis&&t&&(this.object.rotation.x=Math.round(this.object.rotation.x/t)*t),"Y"===this.axis&&t&&(this.object.rotation.y=Math.round(this.object.rotation.y/t)*t),"Z"===this.axis)&&t&&(this.object.rotation.z=Math.round(this.object.rotation.z/t)*t),this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),B.copy(this.object.position),F.copy(this.object.quaternion),U.copy(this.object.scale),this.object.matrixWorld.decompose(P,R,I),v.copy(e.point).sub(P)),this.dragging=!0,o.mode=this.mode,this.dispatchEvent(o))},this.pointerMove=function(e){var t=this.axis,n=this.mode,i=this.object,o=this.space;"scale"===n?o="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(o="world"),void 0!==i&&null!==t&&!1!==this.dragging&&-1===e.button&&(c.setFromCamera(e,this.camera),e=u(r,c,!0))&&(g.copy(e.point).sub(P),"translate"===n?(y.copy(g).sub(v),"local"===o&&"XYZ"!==t&&y.applyQuaternion(z),-1===d()(t).call(t,"X")&&(y.x=0),-1===d()(t).call(t,"Y")&&(y.y=0),-1===d()(t).call(t,"Z")&&(y.z=0),("local"===o&&"XYZ"!==t?y.applyQuaternion(F):y.applyQuaternion(L)).divide(C),i.position.copy(y).add(B),this.translationSnap&&("local"===o&&(i.position.applyQuaternion(f.copy(F).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(F)),"world"===o)&&(i.parent&&i.position.add(h.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent)&&i.position.sub(h.setFromMatrixPosition(i.parent.matrixWorld))):"scale"===n?(-1!==t.search("XYZ")?(e=g.length()/v.length(),g.dot(v)<0&&(e*=-1),p.set(e,e,e)):(h.copy(v),p.copy(g),h.applyQuaternion(z),p.applyQuaternion(z),p.divide(h),-1===t.search("X")&&(p.x=1),-1===t.search("Y")&&(p.y=1),-1===t.search("Z")&&(p.z=1)),i.scale.copy(U).multiply(p),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z"))&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap)):"rotate"===n&&(y.copy(g).sub(v),e=20/k.distanceTo(h.setFromMatrixPosition(this.camera.matrixWorld)),"E"===t?(x.copy(O),_=g.angleTo(v),w.copy(v).normalize(),b.copy(g).normalize(),_*=b.cross(w).dot(O)<0?1:-1):"XYZE"===t?(x.copy(y).cross(O).normalize(),_=y.dot(h.copy(x).cross(this.eye))*e):"X"!==t&&"Y"!==t&&"Z"!==t||(x.copy(m[t]),h.copy(m[t]),"local"===o&&h.applyQuaternion(D),_=y.dot(h.cross(O).normalize())*e),this.rotationSnap&&(_=Math.round(_/this.rotationSnap)*this.rotationSnap),this.rotationAngle=_,("local"===o&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(F),i.quaternion.multiply(f.setFromAxisAngle(x,_))):(x.applyQuaternion(L),i.quaternion.copy(f.setFromAxisAngle(x,_)),i.quaternion.multiply(F))).normalize()),this.dispatchEvent(a),this.dispatchEvent(l))},this.pointerUp=function(e){0===e.button&&(this.dragging&&null!==this.axis&&(s.mode=this.mode,this.dispatchEvent(s)),this.dragging=!1,this.axis=null)},this.getMode=function(){return i.mode},this.setMode=function(e){i.mode=e},this.setTranslationSnap=function(e){i.translationSnap=e},this.setRotationSnap=function(e){i.rotationSnap=e},this.setScaleSnap=function(e){i.scaleSnap=e},this.setSize=function(e){i.size=e},this.setSpace=function(e){i.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}},K.TransformControls.prototype=u()(r()(K.Object3D.prototype),{constructor:K.TransformControls,isTransformControls:!0}),K.TransformControlsGizmo=function(){K.Object3D.call(this),this.type="TransformControlsGizmo";var e=new K.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:K.DoubleSide,fog:!1,toneMapped:!1}),t=new K.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone(),r=(n.opacity=.15,e.clone()),i=((T=((S=(r.opacity=.33,e.clone())).color.set(16711680),e.clone())).color.set(65280),e.clone()),a=(i.color.set(255),e.clone()),o=(a.opacity=.25,a.clone()),s=(o.color.set(16776960),a.clone()),l=(s.color.set(65535),a.clone());function u(e,t){for(var n=new K.BufferGeometry,r=[],i=0;i<=64*t;++i)r.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return n.setAttribute("position",new K.Float32BufferAttribute(r,3)),n}function h(e){var t,n=new K.Object3D;for(t in e)for(var r=e[t].length;r--;){var i=e[t][r][0].clone(),a=e[t][r][1],o=e[t][r][2],s=e[t][r][3],l=e[t][r][4];(l=(i.name=t,i.tag=l,a&&i.position.set(a[0],a[1],a[2]),o&&i.rotation.set(o[0],o[1],o[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix(),i.geometry.clone())).applyMatrix4(i.matrix),i.geometry=l,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),n.add(i)}return n}l.color.set(16711935),e.clone().color.set(16776960);var p=((e=t.clone()).color.set(16711680),t.clone()),f=(p.color.set(65280),t.clone()),m=(f.color.set(255),t.clone()),v=(m.color.set(65535),t.clone()),g=(v.color.set(16711935),t.clone()),y=((M=((t=(g.color.set(16776960),t.clone())).color.set(7895160),g.clone())).opacity=.25,new K.CylinderGeometry(0,.05,.2,12,1,!1)),x=new K.BoxGeometry(.125,.125,.125),w=new K.BufferGeometry,b=(y=(w.setAttribute("position",new K.Float32BufferAttribute([0,0,0,1,0,0],3)),{X:[[new K.Mesh(y,S),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new K.Mesh(y,S),[1,0,0],[0,0,-Math.PI/2],null,"bwd"],[new K.Line(w,e)]],Y:[[new K.Mesh(y,T),[0,1,0],null,null,"fwd"],[new K.Mesh(y,T),[0,1,0],null,null,"bwd"],[new K.Line(w,p),null,[0,0,Math.PI/2]]],Z:[[new K.Mesh(y,i),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new K.Mesh(y,i),[0,0,1],[Math.PI/2,0,0],null,"bwd"],[new K.Line(w,f),null,[0,-Math.PI/2,0]]],XYZ:[[new K.Mesh(new K.OctahedronGeometry(.1,0),a.clone()),[0,0,0],[0,0,0]]],XY:[[new K.Mesh(new K.PlaneGeometry(.295,.295),o.clone()),[.15,.15,0]],[new K.Line(w,g),[.18,.3,0],null,[.125,1,1]],[new K.Line(w,g),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new K.Mesh(new K.PlaneGeometry(.295,.295),s.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new K.Line(w,m),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new K.Line(w,m),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new K.Mesh(new K.PlaneGeometry(.295,.295),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new K.Line(w,v),[.18,0,.3],null,[.125,1,1]],[new K.Line(w,v),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]}),{X:[[new K.Mesh(new K.CylinderGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new K.Mesh(new K.CylinderGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new K.Mesh(new K.CylinderGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new K.Mesh(new K.OctahedronGeometry(.2,0),n)]],XY:[[new K.Mesh(new K.PlaneGeometry(.4,.4),n),[.2,.2,0]]],YZ:[[new K.Mesh(new K.PlaneGeometry(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new K.Mesh(new K.PlaneGeometry(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]}),_={START:[[new K.Mesh(new K.OctahedronGeometry(.01,2),r),null,null,null,"helper"]],END:[[new K.Mesh(new K.OctahedronGeometry(.01,2),r),null,null,null,"helper"]],DELTA:[[new K.Line(((_=new K.BufferGeometry).setAttribute("position",new K.Float32BufferAttribute([0,0,0,1,1,1],3)),_),r),null,null,null,"helper"]],X:[[new K.Line(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new K.Line(w,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new K.Line(w,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},M={X:[[new K.Line(u(1,.5),e)],[new K.Mesh(new K.OctahedronGeometry(.04,0),S),[0,0,.99],null,[1,3,1]]],Y:[[new K.Line(u(1,.5),p),null,[0,0,-Math.PI/2]],[new K.Mesh(new K.OctahedronGeometry(.04,0),T),[0,0,.99],null,[3,1,1]]],Z:[[new K.Line(u(1,.5),f),null,[0,Math.PI/2,0]],[new K.Mesh(new K.OctahedronGeometry(.04,0),i),[.99,0,0],null,[1,3,1]]],E:[[new K.Line(u(1.25,1),M),null,[0,Math.PI/2,0]],[new K.Mesh(new K.CylinderGeometry(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new K.Mesh(new K.CylinderGeometry(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new K.Mesh(new K.CylinderGeometry(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new K.Mesh(new K.CylinderGeometry(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new K.Line(u(1,1),t),null,[0,Math.PI/2,0]]]},E=(t={AXIS:[[new K.Line(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},{X:[[new K.Mesh(new K.TorusGeometry(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new K.Mesh(new K.TorusGeometry(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new K.Mesh(new K.TorusGeometry(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new K.Mesh(new K.TorusGeometry(1.25,.1,2,24),n)]],XYZE:[[new K.Mesh(new K.SphereGeometry(.7,10,8),n)]]}),S={X:[[new K.Mesh(x,S),[.8,0,0],[0,0,-Math.PI/2]],[new K.Line(w,e),null,null,[.8,1,1]]],Y:[[new K.Mesh(x,T),[0,.8,0]],[new K.Line(w,p),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new K.Mesh(x,i),[0,0,.8],[Math.PI/2,0,0]],[new K.Line(w,f),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new K.Mesh(x,o),[.85,.85,0],null,[2,2,.2]],[new K.Line(w,g),[.855,.98,0],null,[.125,1,1]],[new K.Line(w,g),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new K.Mesh(x,s),[0,.85,.85],null,[.2,2,2]],[new K.Line(w,m),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new K.Line(w,m),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new K.Mesh(x,l),[.85,0,.85],null,[2,.2,2]],[new K.Line(w,v),[.855,0,.98],null,[.125,1,1]],[new K.Line(w,v),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new K.Mesh(new K.BoxGeometry(.125,.125,.125),a.clone()),[1.1,0,0]]],XYZY:[[new K.Mesh(new K.BoxGeometry(.125,.125,.125),a.clone()),[0,1.1,0]]],XYZZ:[[new K.Mesh(new K.BoxGeometry(.125,.125,.125),a.clone()),[0,0,1.1]]]},T=(e={X:[[new K.Mesh(new K.CylinderGeometry(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new K.Mesh(new K.CylinderGeometry(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new K.Mesh(new K.CylinderGeometry(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new K.Mesh(x,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new K.Mesh(x,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new K.Mesh(x,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new K.Mesh(new K.BoxGeometry(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new K.Mesh(new K.BoxGeometry(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new K.Mesh(new K.BoxGeometry(.2,.2,.2),n),[0,0,1.1]]]},{X:[[new K.Line(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new K.Line(w,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new K.Line(w,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]}),A=new K.Vector3(0,0,0),L=new K.Euler,C=new K.Vector3(0,1,0),P=new K.Vector3(0,0,0),R=new K.Matrix4,I=new K.Quaternion,k=new K.Quaternion,D=new K.Quaternion,z=new K.Vector3(1,0,0),N=new K.Vector3(0,1,0),O=new K.Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=h(y)),this.add(this.gizmo.rotate=h(M)),this.add(this.gizmo.scale=h(S)),this.add(this.picker.translate=h(b)),this.add(this.picker.rotate=h(E)),this.add(this.picker.scale=h(e)),this.add(this.helper.translate=h(_)),this.add(this.helper.rotate=h(t)),this.add(this.helper.scale=h(T)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space,t="local"===(e="scale"===this.mode?"local":e)?this.worldQuaternion:D,n=(this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode,[]);n=c()(n).call(n,this.picker[this.mode].children);n=c()(n).call(n,this.gizmo[this.mode].children),n=c()(n).call(n,this.helper[this.mode].children);for(var r=0;r<n.length;r++){var i,a=n[r];a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition),i=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(i*this.size/7),"helper"===a.tag?(a.visible=!1,"AXIS"===a.name?(a.position.copy(this.worldPositionStart),a.visible=!!this.axis,"X"===this.axis&&(I.setFromEuler(L.set(0,0,0)),a.quaternion.copy(t).multiply(I),.9<Math.abs(C.copy(z).applyQuaternion(t).dot(this.eye)))&&(a.visible=!1),"Y"===this.axis&&(I.setFromEuler(L.set(0,0,Math.PI/2)),a.quaternion.copy(t).multiply(I),.9<Math.abs(C.copy(N).applyQuaternion(t).dot(this.eye)))&&(a.visible=!1),"Z"===this.axis&&(I.setFromEuler(L.set(0,Math.PI/2,0)),a.quaternion.copy(t).multiply(I),.9<Math.abs(C.copy(O).applyQuaternion(t).dot(this.eye)))&&(a.visible=!1),"XYZE"===this.axis&&(I.setFromEuler(L.set(0,Math.PI/2,0)),C.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(R.lookAt(P,C,N)),a.quaternion.multiply(I),a.visible=this.dragging),"E"===this.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):"END"===a.name?(a.position.copy(this.worldPosition),a.visible=this.dragging):"DELTA"===a.name?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),A.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),A.applyQuaternion(this.worldQuaternionStart.clone().invert()),a.scale.copy(A),a.visible=this.dragging):(a.quaternion.copy(t),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=-1!==this.axis.search(a.name)))):(a.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"!==a.name&&"XYZX"!==a.name||.99<Math.abs(C.copy(z).applyQuaternion(t).dot(this.eye))&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Y"!==a.name&&"XYZY"!==a.name||.99<Math.abs(C.copy(N).applyQuaternion(t).dot(this.eye))&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Z"!==a.name&&"XYZZ"!==a.name||.99<Math.abs(C.copy(O).applyQuaternion(t).dot(this.eye))&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XY"===a.name&&Math.abs(C.copy(O).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"YZ"===a.name&&Math.abs(C.copy(z).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XZ"===a.name&&Math.abs(C.copy(N).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),-1!==a.name.search("X")&&(C.copy(z).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(C.copy(N).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(C.copy(O).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))):"rotate"===this.mode&&(k.copy(t),C.copy(this.eye).applyQuaternion(I.copy(t).invert()),-1!==a.name.search("E")&&a.quaternion.setFromRotationMatrix(R.lookAt(this.eye,P,N)),"X"===a.name&&(I.setFromAxisAngle(z,Math.atan2(-C.y,C.z)),I.multiplyQuaternions(k,I),a.quaternion.copy(I)),"Y"===a.name&&(I.setFromAxisAngle(N,Math.atan2(C.x,C.z)),I.multiplyQuaternions(k,I),a.quaternion.copy(I)),"Z"===a.name)&&(I.setFromAxisAngle(O,Math.atan2(C.y,C.x)),I.multiplyQuaternions(k,I),a.quaternion.copy(I)),a.visible=a.visible&&(-1===d()(i=a.name).call(i,"X")||this.showX),a.visible=a.visible&&(-1===d()(i=a.name).call(i,"Y")||this.showY),a.visible=a.visible&&(-1===d()(i=a.name).call(i,"Z")||this.showZ),a.visible=a.visible&&(-1===d()(i=a.name).call(i,"E")||this.showX&&this.showY&&this.showZ),a.material._opacity=a.material._opacity||a.material.opacity,a.material._color=a.material._color||a.material.color.clone(),a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled?this.axis&&(a.name===this.axis||Q()(i=this.axis.split("")).call(i,(function(e){return a.name===e}))?a.material.opacity=1:a.material.opacity*=.25,a.material.color.lerp(new K.Color(1,1,1),.5)):(a.material.opacity*=.5,a.material.color.lerp(new K.Color(1,1,1),.5)))}K.Object3D.prototype.updateMatrixWorld.call(this)}},K.TransformControlsGizmo.prototype=u()(r()(K.Object3D.prototype),{constructor:K.TransformControlsGizmo,isTransformControlsGizmo:!0}),K.TransformControlsPlane=function(){K.Mesh.call(this,new K.PlaneGeometry(1e5,1e5,2,2),new K.MeshBasicMaterial({visible:!1,wireframe:!0,side:K.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane";var e=new K.Vector3(1,0,0),t=new K.Vector3(0,1,0),n=new K.Vector3(0,0,1),r=new K.Vector3,i=new K.Vector3,a=new K.Vector3,o=new K.Matrix4,s=new K.Quaternion;this.updateMatrixWorld=function(){var l=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(l="local"),e.set(1,0,0).applyQuaternion("local"===l?this.worldQuaternion:s),t.set(0,1,0).applyQuaternion("local"===l?this.worldQuaternion:s),n.set(0,0,1).applyQuaternion("local"===l?this.worldQuaternion:s),a.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":a.copy(this.eye).cross(e),i.copy(e).cross(a);break;case"Y":a.copy(this.eye).cross(t),i.copy(t).cross(a);break;case"Z":a.copy(this.eye).cross(n),i.copy(n).cross(a);break;case"XY":i.copy(n);break;case"YZ":i.copy(e);break;case"XZ":a.copy(n),i.copy(t);break;case"XYZ":case"E":i.set(0,0,0)}break;default:i.set(0,0,0)}0===i.length()?this.quaternion.copy(this.cameraQuaternion):(o.lookAt(r.set(0,0,0),i,a),this.quaternion.setFromRotationMatrix(o)),K.Object3D.prototype.updateMatrixWorld.call(this)}},K.TransformControlsPlane.prototype=u()(r()(K.Mesh.prototype),{constructor:K.TransformControlsPlane,isTransformControlsPlane:!0}),n(136)),n.n(h));function ee(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?te(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ne(e,t){var n=new THREE.Color(.375,.63,1),r=new THREE.MeshBasicMaterial({color:n,transparent:!0,opacity:.4,depthTest:!1}),i=(new THREE.LineBasicMaterial({color:n,depthTest:!1}),n=o()(n=window.bimEngine.scene.children).call(n,(function(e){return"rootModel"==e.name})),o()(a=window.bimEngine.scene.children).call(a,(function(e){return"HighLightGroup"==e.name}))[0]);if(e&&e.length){var a,l,c=o()(a=window.bimEngine.scene.children).call(a,(function(e){return"rootModel"==e.name})),u=ee(e);try{var h,d=function(){var e=l.value;if("InstancedMesh"===e.TypeName||"InstancedMesh-Pipe"==e.TypeName){var n,a=ee(e.children);try{for(a.s();!(n=a.n()).done;)!function(){var a=n.value;h=o()(c).call(c,(function(t){return t.MeshId==a.name&&e.path==t.url})),s()(t).call(t,(function(t){switch(t.key){case"visible":var n,o=ee(h);try{for(o.s();!(n=o.n()).done;){var s,l,c=n.value,u=(l=t.val?p()(s=c.cloneInstanceMatrix).call(s,16*a.instanceId,16*(a.instanceId+1)):[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],new THREE.Matrix4);u.elements=l,c.setMatrixAt(a.instanceId,u),c.instanceMatrix.needsUpdate=!0}}catch(t){o.e(t)}finally{o.f()}if(i){var d,f=ee(i.children);try{for(f.s();!(d=f.n()).done;){var m=d.value;if(a.instanceId===m.ElementInfos.dbid&&a.name===m.ElementInfos.name){m.visible=t.val;break}}}catch(t){f.e(t)}finally{f.f()}}break;case"material":if(t.val){var v,g=new THREE.Group,y=(g.ElementInfos={TypeName:e.TypeName,dbid:a.instanceId,name:a.name,basePath:a.basePath,relativePath:a.relativePath},ee(h));try{for(y.s();!(v=y.n()).done;){var x,w=v.value,b=p()(x=w.instanceMatrix.array).call(x,16*a.instanceId,16*(a.instanceId+1)),_=new THREE.Matrix4,M=(_.elements=b,ae(w.geometry,_,r)),E=M.mesh,S=M.line;g.add(E,S),i.add(g)}}catch(t){y.e(t)}finally{y.f()}}else{var T,A=ee(i.children);try{for(A.s();!(T=A.n()).done;){var L=T.value;a.instanceId===L.ElementInfos.dbid&&a.name===L.ElementInfos.name&&i.remove(L)}}catch(t){A.e(t)}finally{A.f()}}}}))}()}catch(n){a.e(n)}finally{a.f()}}else if(("Mesh"===e.TypeName||"PipeMesh"===e.TypeName)&&e.children.length&&e.path){var u,d=ee(e.children);try{for(d.s();!(u=d.n()).done;){var f,m=u.value,v=!1,g=ee(c);try{var y=function(){var n=f.value;if(e.path===n.url&&n&&n.material.length){var a,o=ee(n.ElementInfos);try{for(o.s();!(a=o.n()).done;)!function(){var o=a.value;o.name===m&&s()(t).call(t,(function(t){switch(t.key){case"visible":if(n.material[o.dbid]=n.cloneMaterialArray[o.dbid].clone(),n.material[o.dbid].visible=t.val,n.cloneMaterialArray[o.dbid].visible=t.val,i){var a,s=ee(i.children);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(o.dbid===l.ElementInfos.dbid&&o.name===l.ElementInfos.name){l.visible=t.val;break}}}catch(t){s.e(t)}finally{s.f()}}break;case"material":if(t.val){n.material[o.dbid]=n.cloneMaterialArray[o.dbid].clone();var c=n.meshs[o.dbid],u=new THREE.Group,h=(d=(u.ElementInfos={TypeName:e.TypeName,dbid:o.dbid,name:o.name,basePath:o.basePath,relativePath:o.relativePath},ae(c.geometry,c.matrix,r))).mesh,d=d.line,p=isNaN(c.rotation.x)?0:c.rotation.x,f=isNaN(c.rotation.y)?0:c.rotation.y,m=isNaN(c.rotation.z)?0:c.rotation.z,v=isNaN(c.position.x)?0:c.position.x,g=isNaN(c.position.y)?0:c.position.y;c=isNaN(c.position.z)?0:c.position.z;0==p&&0==f&&0==m||(d.rotation._order="YXZ",h.rotation.set(p,f,m),d.rotation.set(p,f,m)),0==v&&0==g&&0==c||(h.position.set(v,g,c),d.position.set(v,g,c)),u.add(h,d),i.add(u)}else{var y,x=ee(i.children);try{for(x.s();!(y=x.n()).done;){var w=y.value;o.dbid===w.ElementInfos.dbid&&o.name===w.ElementInfos.name&&i.remove(w)}}catch(t){x.e(t)}finally{x.f()}}}}))}()}catch(a){o.e(a)}finally{o.f()}v=!0}if(v)return"break"};for(g.s();!(f=g.n()).done&&"break"!==y(););}catch(n){g.e(n)}finally{g.f()}}}catch(n){d.e(n)}finally{d.f()}}};for(u.s();!(l=u.n()).done;)d()}catch(e){u.e(e)}finally{u.f()}}else{var f,m=ee(n);try{var v=function(){var e=f.value;if("InstancedMesh"===e.TypeName||"InstancedMesh-Pipe"===e.TypeName)s()(t).call(t,(function(t){if("visible"===t.key){var n,r=[];if(t.val)n=new Float32Array(e.cloneInstanceMatrix);else{r=T()(e.instanceMatrix.array);for(var i=0;i<r.length;i++)r[i]=0;n=new Float32Array(r)}e.instanceMatrix.array=new Float32Array(n),e.instanceMatrix.needsUpdate=!0}}));else if("Mesh"===e.TypeName||"PipeMesh"===e.TypeName){var n,r=ee(e.ElementInfos);try{for(r.s();!(n=r.n()).done;)!function(){var r=n.value;s()(t).call(t,(function(t){switch(t.key){case"visible":e.material[r.dbid].visible=t.val,e.cloneMaterialArray[r.dbid].visible=t.val;break;case"material":var n;t.val&&((n=t.val.clone()).clippingPlanes=e.material[r.dbid].clippingPlanes),e.material[r.dbid]=n||e.cloneMaterialArray[r.dbid]}}))}()}catch(n){r.e(n)}finally{r.f()}}};for(m.s();!(f=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}i&&s()(t).call(t,(function(e){if("visible"===e.key&&i){var t,n=ee(i.children);try{for(n.s();!(t=n.n()).done;)t.value.visible=e.val}catch(e){n.e(e)}finally{n.f()}}}))}}function re(e,t){for(var n=o()(h=window.bimEngine.scene.children).call(h,(function(e){return"HighLightGroup"==e.name}))[0],r=window.bimEngine.scene.children,i=0;i<e.length;i++){var a,s,u=r[e[i][0]];null!=u&&(null==u.instanceMatrix&&null!=u.geometry&&null!=u.geometry.groups[e[i][1]]?(u.geometry.groups[e[i][1]].visibility=t,w(e[i],t),1==t&&(u.visible=!0)):null!=u.instanceMatrix&&(1==t?(s=p()(s=u.cloneInstanceMatrix).call(s,16*e[i][1],16*(e[i][1]+1)),(a=new THREE.Matrix4).elements=s,u.setMatrixAt(e[i][1],a),u.instanceMatrix.needsUpdate=!0,u.visible=!0):(s=(s=new THREE.Matrix4).clone().makeScale(0,0,0),u.setMatrixAt(e[i][1],s),u.instanceMatrix.needsUpdate=!0),w(e[i],t)))}var h,d=e,f=t,m=o()(h=window.bimEngine.scene.children).call(h,(function(e){return"ModelEdges"==e.name&&e.visible}));if(m&&m.length){for(var v=[],g=0;g<d.length;g++)!function(e){var t,n=M()(v).call(v,(function(t){return t.index===d[e][0]}));n<0?(t={index:d[e][0],children:[d[e][1]]},v.push(t)):v[n].children.push(d[e][1])}(g);for(var y=function(e){var t=o()(m).call(m,(function(t){return t.indexO==v[e].index}))[0];if(t){var n=t.ElementInfos.children;if(n&&n.length){for(var r=T()(t.geometry.getAttribute("position").array),i=0;i<v[e].children.length;i++)!function(n){var i=o()(i=t.ElementInfos.children).call(i,(function(t){return t.index==v[e].children[n]}))[0],a=f?i.EdgeList:$()(a=new Array(i.EdgeList.length)).call(a,0);l()(Array.prototype).apply(r,c()(i=[i.startIndex,i.EdgeList.length]).call(i,a))}(i);t.geometry.setAttribute("position",new THREE.Float32BufferAttribute(r,3))}}},x=0;x<v.length;x++)y(x)}function w(e,t){if(n){var r,i=ee(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.indexs.toString()===e.toString()){a.visible=t;break}}}catch(e){i.e(e)}finally{i.f()}}}window.bimEngine.RenderUpdata()}function ie(e,t){if(e&&e.length){var n,r,i=o()(n=window.bimEngine.scene.children).call(n,(function(e){return"rootModel"==e.name})),a=ee(e);try{var l,c=function(){var e,n=r.value,a=(l=o()(i).call(i,(function(e){return-1!=d()(e=e.basePath).call(e,n.path)})),ee(n.children));try{for(a.s();!(e=a.n()).done;){var c,u=e.value,h=!1,f=ee(l);try{var m=function(){var e,n=c.value,r=ee(n.ElementInfos);try{for(r.s();!(e=r.n()).done&&"break"!==function(){var r=e.value;if(R(r.name)[0]===u)return"InstancedMesh"===n.TypeName||"InstancedMesh-Pipe"===n.TypeName?s()(t).call(t,(function(e){switch(e.key){case"visible":var t=p()(t=n.instanceMatrix.array).call(t,16*r.dbid,16*(r.dbid+1)),i=new THREE.Matrix4;i.elements=t,i.elements[0]=e.val?1:0,i.elements[5]=e.val?1:0,i.elements[10]=e.val?1:0,n.setMatrixAt(r.dbid,i),n.instanceMatrix.needsUpdate=!0;break;case"material":if(t=e.val?new THREE.Color(.375,.63,1):new THREE.Color(1,1,1),r.dbid)n.getColorAt(r.dbid,window.color),n.setColorAt(r.dbid,t),n.instanceColor.needsUpdate=!0;else for(var a=0;a<n.material.length;a++)n.material[a].color=new THREE.Color(1,1,1)}})):"Mesh"!==n.TypeName&&"PipeMesh"!==n.TypeName||r.dbid&&n.material[r.dbid]&&s()(t).call(t,(function(e){switch(e.key){case"visible":n.material[r.dbid].visible=e.val,n.cloneMaterialArray[r.dbid].visible=e.val;break;case"material":var t;e.val&&((t=e.val.clone()).clippingPlanes=n.material[r.dbid].clippingPlanes),n.material[r.dbid]=t||n.cloneMaterialArray[r.dbid]}})),h=!0,"break"}(););}catch(e){r.e(e)}finally{r.f()}if(h)return"break"};for(f.s();!(c=f.n()).done&&"break"!==m(););}catch(e){f.e(e)}finally{f.f()}}}catch(e){a.e(e)}finally{a.f()}};for(a.s();!(r=a.n()).done;)c()}catch(e){a.e(e)}finally{a.f()}}}function ae(e,t,n){return(e=new THREE.Mesh(e,n)).applyMatrix4(t),e.TypeName="HighLightGroup-MeshLine",{mesh:e}}function oe(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?se(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var le=n(2);function ce(e,t){var r,i,a=e.scene.renderer.domElement.parentElement,o=[{value:"3",label:"",domItem:null,childContain:null},{value:"4",label:"",domItem:null,childContain:null},{value:"5",label:"",domItem:null,childContain:null},{value:"6",label:"",domItem:null,childContain:null}];if(n(553)("./"+F()+"/RightClickMenu.scss"),i)i.style.display="block";else{(i=document.createElement("div")).className="Right-Click-Menu-Container";for(var s=0;s<o.length;s++)!function(){var e=document.createElement("div");if(e.className="Menu-Item",o[s].children&&o[s].children.length){var t,n=((t=((t=document.createElement("span")).innerHTML=o[s].label,e.appendChild(t),document.createElement("span"))).className="Menu-Item-Icon",t.innerHTML=">",e.appendChild(t),document.createElement("div"));n.className="Menu_Child_Container";for(var r=0;r<o[s].children.length;r++){var a=document.createElement("div"),l=(a.className="Menu-Item",a.dataset.value=o[s].children[r].value,document.createElement("span"));l.innerHTML=o[s].children[r].label,l.dataset.value=o[s].children[r].value,a.appendChild(l),a.onclick=function(e){e.stopPropagation(),u(e.target.dataset.value)},n.appendChild(a)}e.addEventListener("mouseover",(function(t){n.style.display="block",e.style.background="#ffffff",e.style.color="#409EFF"})),e.appendChild(n),o[s].childContain=n,o[s].domItem=e}else(t=document.createElement("span")).innerHTML=o[s].label,e.appendChild(t),(o[s].domItem=e).addEventListener("mouseover",(function(e){for(var t=0;t<o.length;t++)o[t].childContain&&(o[t].childContain.style.display="none",o[t].domItem.style.background="transparent",o[t].domItem.style.color="#ffffff")}));e.dataset.value=o[s].value,e.onclick=function(e){u(e.target.dataset.value)},i.appendChild(e)}();a.appendChild(i)}function c(){i&&(i.style.display="none")}function u(t){for(var n,r=0;r<o.length;r++)o[r].domItem&&(o[r].domItem.style.background="#656565",o[r].domItem.style.color="#ffffff"),o[r].childContain&&(o[r].childContain.style.display="none");switch(e.UpdateRender(),t){case"1":case"2":break;case"3":(n=window.bimEngine.GetAllIndexesModel()).length&&window.bimEngine.ResetSelectedModels_("visible",n,!1),window.bimEngine.SelectedModels.indexesModels.length&&window.bimEngine.ResetSelectedModels_("visible",window.bimEngine.SelectedModels.indexesModels,!0);break;case"4":window.bimEngine.SelectedModels.indexesModels.length&&window.bimEngine.ResetSelectedModels_("visible",window.bimEngine.SelectedModels.indexesModels,!1);break;case"5":(n=window.bimEngine.GetAllIndexesModel()).length&&window.bimEngine.ResetSelectedModels_("visible",n,!0),sessionStorage.setItem("ShowAllModel","true");break;case"6":(n=window.bimEngine.GetAllIndexesModel()).length&&window.bimEngine.ResetSelectedModels_("visible",n,!1),sessionStorage.setItem("ShowAllModel","false")}c()}e.scene.renderer.domElement.addEventListener("click",(function(n){e.UpdateRender(),console.log(n);var i=n.ctrlKey||n.shiftKey?"keyEnter":"";if(0===n.button&&!e.StopClick&&(n.preventDefault(),r)&&Math.abs(n.x-r.x)<2&&Math.abs(n.y-r.y)<2){var a=new le.Raycaster,o=new le.Vector2,s=(n=(o.x=(n.clientX-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,o.y=-(n.clientY-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,a.setFromCamera(o,e.scene.camera),a.intersectObjects(e.GetAllVisibilityModel(),!0)),JSON.parse(_()(e.SelectedModels.indexesModels))),u=e.CurrentSelect||{dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null};if("keyEnter"==i){if(0<n.length){var h,d=oe(n);try{for(d.s();!(h=d.n()).done&&"break"!==function(){var e,t,n;if("Mesh"==(v=h.value).object.TypeName||"PipeMesh"==v.object.TypeName){if((m=ue(v.object,v.point))&&!1!==v.object.geometry.groups[m.dbid].visibility)return e=[v.object.index,m.dbid],(n=M()(s).call(s,(function(t){return t.toString()==e.toString()})))<0?(u={dbid:m.dbid,name:m.name,glb:v.object.url,TypeName:v.object.TypeName,basePath:m.basePath,relativePath:m.relativePath,indexs:[v.object.index,m.dbid],min:v.object.ElementInfos[m.dbid].min,center:v.object.ElementInfos[m.dbid].center,max:v.object.ElementInfos[m.dbid].max},s.push(e)):(u={dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null},l()(s).call(s,n,1)),"break"}else if(("InstancedMesh"==v.object.TypeName||"InstancedMesh-Pipe"==v.object.TypeName)&&!he(v.object.ElementInfos[v.instanceId].min,v.object.ElementInfos[v.instanceId].max,v.object.material.clippingPlanes,v.point))return t=[v.object.index,v.instanceId],(n=M()(s).call(s,(function(e){return e.toString()==t.toString()})))<0?(u={dbid:v.instanceId,name:v.object.ElementInfos[v.instanceId].name,glb:v.object.url,TypeName:v.object.TypeName,basePath:v.object.basePath,relativePath:v.object.relativePath,indexs:[v.object.index,v.instanceId],min:v.object.ElementInfos[v.instanceId].min,center:v.object.ElementInfos[v.instanceId].center,max:v.object.ElementInfos[v.instanceId].max},s.push(t)):(u={dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null},l()(s).call(s,n,1)),"break"}(););}catch(n){d.e(n)}finally{d.f()}}}else if(s=[],0<n.length&&1!=e.LockingSelect){var p,f=oe(n);try{for(f.s();!(p=f.n()).done;){var m,v=p.value;if("Mesh"==v.object.TypeName||"PipeMesh"==v.object.TypeName){if((m=ue(v.object,v.point))&&!1!==v.object.geometry.groups[m.dbid].visibility){var g=[v.object.index,m.dbid];u.toString()==g.toString()?u={dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null}:(u={dbid:m.dbid,name:m.name,glb:v.object.url,TypeName:v.object.TypeName,basePath:m.basePath,relativePath:m.relativePath,indexs:[v.object.index,m.dbid],min:v.object.ElementInfos[m.dbid].min,center:v.object.ElementInfos[m.dbid].center,max:v.object.ElementInfos[m.dbid].max},s.push(g));break}}else if(("InstancedMesh"==v.object.TypeName||"InstancedMesh-Pipe"==v.object.TypeName)&&!he(v.object.ElementInfos[v.instanceId].min,v.object.ElementInfos[v.instanceId].max,v.object.material.clippingPlanes,v.point)){var y=[v.object.index,v.instanceId];u.toString()==y.toString()?u={dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null}:(u={dbid:v.instanceId,name:v.object.ElementInfos[v.instanceId].name,glb:v.object.url,TypeName:v.object.TypeName,basePath:v.object.ElementInfos[0].basePath,relativePath:v.object.ElementInfos[0].relativePath,indexs:[v.object.index,v.instanceId],min:v.object.ElementInfos[v.instanceId].min,center:v.object.ElementInfos[v.instanceId].center,max:v.object.ElementInfos[v.instanceId].max},s.push(y));break}}}catch(n){f.e(n)}finally{f.f()}}else u={dbid:null,name:null,glb:null,TypeName:null,basePath:null,relativePath:null,indexs:[],min:null,center:null,max:null};u.dbid&&u.center?window.bimEngine.scene.controls.origin=u.center:window.bimEngine.scene.controls.origin=new le.Vector3(0,0,0),e.CurrentSelect=u,e.Selection=s,e.ResetSelectedModels_("highlight",s,!0),sessionStorage.setItem("SelectedSingleModelInfo",_()(u)),t({type:"LeftClick"}),c()}}),!1),e.scene.renderer.domElement.addEventListener("dblclick",(function(){var t,n,r,i,a;e.CurrentSelect.dbid&&(t=e.CurrentSelect.min,a=e.CurrentSelect.center,n=e.CurrentSelect.max,r=t.clone().add(n.clone()).multiplyScalar(.5),i=new le.Vector3(1,1,1),a=a.clone().add(i.multiplyScalar(+n.distanceTo(t))),window.bimEngine.ViewCube.animateCamera(window.bimEngine.scene.camera.position,a,window.bimEngine.scene.controls.target.clone(),r))})),e.scene.renderer.domElement.addEventListener("contextmenu",(function(e){if(2===e.button)if(e.preventDefault(),Math.abs(e.x-r.x)<2&&Math.abs(e.y-r.y)<2){t({type:"RightClick",position:{x:e.x,y:e.y}}),i&&(i.style.display="block"),i&&(i.style.top=event.y+"px"),i&&(i.style.left=event.x+"px");for(var n=0;n<o.length;n++)"5"!==o[n].value&&"6"!==o[n].value&&(o[n].domItem.style.display=window.bimEngine.SelectedModels.indexesModels.length?"block":"none")}else t({type:"LeftClick"}),c()}),!1),e.scene.renderer.domElement.addEventListener("pointerdown",(function(e){e.preventDefault(),r={x:e.x,y:e.y}}),!1)}function ue(e,t){var n=e.ElementInfos;if(null==n||0==n.length)return null;for(var r=[],i=0;i<e.material.length;i++){var a=he(n[i].min,n[i].max,e.material[i].clippingPlanes,t);!function(e,t,n){if(n.x>=e.x-.001&&n.y>=e.y-.001&&n.z>=e.z-.001&&n.x<=t.x+.001&&n.y<=t.y+.001&&n.z<=t.z+.001)return 1}(n[i].min,n[i].max,t)||a||r.push(n[i])}return 0==r.length?null:(S()(r).call(r,(function(e,n){return e.center.distanceTo(t)-n.center.distanceTo(t)})),r[0])}function he(e,t,n,r){var i,a=!1;return n&&n.length?1===n.length?(-1==(i=n[0]).normal.x&&(e.x>=i.constant||r.x>i.constant)||-1==i.normal.y&&(e.y>=i.constant||r.y>i.constant)||-1==i.normal.z&&(e.z>=i.constant||r.z>i.constant))&&(a=!0):6===n.length&&(t.z<=-1*n[1].constant||r.z<-1*n[1].constant||e.z>=n[0].constant||r.z>n[0].constant||t.x<=-1*n[3].constant||r.x<-1*n[3].constant||e.x>=n[2].constant||r.x>n[2].constant||t.y<=-1*n[5].constant||r.y<-1*n[5].constant||e.y>=n[4].constant||r.y>n[4].constant)&&(a=!0):a=!1,a}h=n(113);var de=n.n(h),pe=(h=n(78),n.n(h)),fe=(h=n(29),n.n(h)),me=(h=n(95),n.n(h)),ve=(h=n(137),n.n(h)),ge=n(3),ye=n(138),xe=n(77);function we(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function be(e,t){this._pairs=[],e&&Object(xe.a)(e,this,t)}var _e=((h=be.prototype).append=function(e,t){this._pairs.push([e,t])},h.toString=function(e){const t=e?function(t){return e.call(this,t,we)}:we;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")},be);function Me(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ee(e,t,n){if(t){var r=n&&n.encode||Me,i=n&&n.serialize;let a;(a=i?i(t,n):ge.a.isURLSearchParams(t)?t.toString():new _e(t,n).toString(r))&&(-1!==(i=e.indexOf("#"))&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+a)}return e}var Se=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ge.a.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Te=n(21),Ae={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Le={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:_e,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},isStandardBrowserEnv:("undefined"==typeof navigator||"ReactNative"!==(h=navigator.product)&&"NativeScript"!==h&&"NS"!==h)&&"undefined"!=typeof window&&"undefined"!=typeof document,isStandardBrowserWebWorkerEnv:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]},Ce=function(e){if(ge.a.isFormData(e)&&ge.a.isFunction(e.entries)){const t={};return ge.a.forEachEntry(e,(e,n)=>{!function e(t,n,r,i){var a=t[i++],o=Number.isFinite(+a),s=i>=t.length;return a=!a&&ge.a.isArray(r)?r.length:a,s?ge.a.hasOwnProp(r,a)?r[a]=[r[a],n]:r[a]=n:(r[a]&&ge.a.isObject(r[a])||(r[a]=[]),e(t,n,r[a],i)&&ge.a.isArray(r[a])&&(r[a]=function(e){var t={},n=Object.keys(e);let r;var i,a=n.length;for(r=0;r<a;r++)t[i=n[r]]=e[i];return t}(r[a]))),!o}(ge.a.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0]),n,t,0)}),t}return null};const Pe={"Content-Type":void 0},Re={transitional:Ae,adapter:["xhr","http"],transformRequest:[function(e,t){var n,r=t.getContentType()||"",i=-1<r.indexOf("application/json"),a=ge.a.isObject(e),o=(a&&ge.a.isHTMLForm(e)&&(e=new FormData(e)),ge.a.isFormData(e));if(o)return i?JSON.stringify(Ce(e)):e;if(!(ge.a.isArrayBuffer(e)||ge.a.isBuffer(e)||ge.a.isStream(e)||ge.a.isFile(e)||ge.a.isBlob(e))){if(ge.a.isArrayBufferView(e))return e.buffer;if(ge.a.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(a){if(-1<r.indexOf("application/x-www-form-urlencoded"))return o=e,n=this.formSerializer,Object(xe.a)(o,new Le.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return Le.isNode&&ge.a.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},n)).toString();if((o=ge.a.isFileList(e))||-1<r.indexOf("multipart/form-data"))return n=this.env&&this.env.FormData,Object(xe.a)(o?{"files[]":e}:e,n&&new n,this.formSerializer)}if(a||i){if(t.setContentType("application/json",!1),r=e,o=void 0,a=void 0,ge.a.isString(r))try{return(o||JSON.parse)(r),ge.a.trim(r)}catch(e){if("SyntaxError"!==e.name)throw e}return(a||JSON.stringify)(r)}}return e}],transformResponse:[function(e){var t=this.transitional||Re.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&ge.a.isString(e)&&(n&&!this.responseType||r)){n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw Te.a.from(e,Te.a.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Le.classes.FormData,Blob:Le.classes.Blob},validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ge.a.forEach(["delete","get","head"],(function(e){Re.headers[e]={}})),ge.a.forEach(["post","put","patch"],(function(e){Re.headers[e]=ge.a.merge(Pe)}));var Ie=Re;const ke=ge.a.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),De=Symbol("internals");function ze(e){return e&&String(e).trim().toLowerCase()}function Ne(e){return!1===e||null==e?e:ge.a.isArray(e)?e.map(Ne):String(e)}function Oe(e,t,n,r,i){return ge.a.isFunction(r)?r.call(this,t,n):ge.a.isString(t=i?n:t)&&(ge.a.isString(r)?-1!==t.indexOf(r):ge.a.isRegExp(r)&&r.test(t))}class Be{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){var i=ze(t);if(!i)throw new Error("header name must be a non-empty string");(i=ge.a.findKey(r,i))&&void 0!==r[i]&&!0!==n&&(void 0!==n||!1===r[i])||(r[i||t]=Ne(e))}var a=(e,t)=>ge.a.forEach(e,(e,n)=>i(e,n,t));return ge.a.isPlainObject(e)||e instanceof this.constructor?a(e,t):ge.a.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z]+$/.test(e.trim())?a((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach((function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&ke[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t):null!=e&&i(t,e,n),this}get(e,t){if((e=ze(e))&&(e=ge.a.findKey(this,e))){var n=this[e];if(!t)return n;if(!0===t){for(var r,i=n,a=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;r=o.exec(i);)a[r[1]]=r[2];return a}if(ge.a.isFunction(t))return t.call(this,n,e);if(ge.a.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}has(e,t){return!!(e=ze(e))&&!(!(e=ge.a.findKey(this,e))||void 0===this[e]||t&&!Oe(0,this[e],e,t))}delete(e,t){const n=this;let r=!1;function i(e){(e=ze(e))&&(e=ge.a.findKey(n,e))&&(!t||Oe(0,n[e],e,t))&&(delete n[e],r=!0)}return ge.a.isArray(e)?e.forEach(i):i(e),r}clear(e){var t=Object.keys(this);let n=t.length,r=!1;for(;n--;){var i=t[n];e&&!Oe(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return ge.a.forEach(this,(r,i)=>{var a=ge.a.findKey(n,i);a?(t[a]=Ne(r),delete t[i]):((a=e?i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n):String(i).trim())!==i&&delete t[i],t[a]=Ne(r),n[a]=!0)}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ge.a.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&ge.a.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=(this[De]=this[De]={accessors:{}}).accessors,n=this.prototype;function r(e){var r=ze(e);if(!t[r]){{var i=n,a=e;const t=ge.a.toCamelCase(" "+a);["get","set","has"].forEach(e=>{Object.defineProperty(i,e+t,{value:function(t,n,r){return this[e].call(this,a,t,n,r)},configurable:!0})})}t[r]=!0}}return ge.a.isArray(e)?e.forEach(r):r(e),this}}Be.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ge.a.freezeMethods(Be.prototype),ge.a.freezeMethods(Be);var Fe=Be;function Ue(e,t){const n=this||Ie;var r=t||n;const i=Fe.from(r.headers);let a=r.data;return ge.a.forEach(e,(function(e){a=e.call(n,a,i.normalize(),t?t.status:void 0)})),i.normalize(),a}function He(e){return!(!e||!e.__CANCEL__)}function Ve(e,t,n){Te.a.call(this,null==e?"canceled":e,Te.a.ERR_CANCELED,t,n),this.name="CanceledError"}ge.a.inherits(Ve,Te.a,{__CANCEL__:!0});var Ge=Ve,We=(h=n(139),Le.isStandardBrowserEnv?{write:function(e,t,n,r,i,a){var o=[];o.push(e+"="+encodeURIComponent(t)),ge.a.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),ge.a.isString(r)&&o.push("path="+r),ge.a.isString(i)&&o.push("domain="+i),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){return(e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)")))?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}});function je(e,t){var n;return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?(e=e,(n=t)?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e):t}var qe=Le.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function r(n){let r=n;return e&&(t.setAttribute("href",r),r=t.href),t.setAttribute("href",r),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(e){return(e=ge.a.isString(e)?r(e):e).protocol===n.protocol&&e.host===n.host}}():function(){return!0};function Xe(e,t){let n=0;const r=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,a=0,o=0;return t=void 0!==t?t:1e3,function(s){var l=Date.now(),c=r[o];i=i||l,n[a]=s,r[a]=l;let u=o,h=0;for(;u!==a;)h+=n[u++],u%=e;return(a=(a+1)%e)===o&&(o=(o+1)%e),l-i<t||!(s=c&&l-c)?void 0:Math.round(1e3*h/s)}}(50,250);return i=>{var a,o=i.loaded,s=i.lengthComputable?i.total:void 0,l=r(a=o-n);(a={loaded:n=o,total:s,progress:s?o/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&o<=s?(s-o)/l:void 0,event:i})[t?"download":"upload"]=!0,e(a)}}var Ye="undefined"!=typeof XMLHttpRequest;const Ze={http:h.a,xhr:Ye&&function(e){return new Promise((function(t,n){var r=e.data,i=Fe.from(e.headers).normalize();const a=e.responseType;let o;function s(){e.cancelToken&&e.cancelToken.unsubscribe(o),e.signal&&e.signal.removeEventListener("abort",o)}ge.a.isFormData(r)&&(Le.isStandardBrowserEnv||Le.isStandardBrowserWebWorkerEnv)&&i.setContentType(!1);let l=new XMLHttpRequest;e.auth&&(u=e.auth.username||"",c=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"",i.set("Authorization","Basic "+btoa(u+":"+c)));var c,u=je(e.baseURL,e.url);function h(){var r,i,o,c;l&&(o=Fe.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),r=function(e){t(e),s()},i=function(e){n(e),s()},c=(o=o={data:a&&"text"!==a&&"json"!==a?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:o,config:e,request:l}).config.validateStatus,o.status&&c&&!c(o.status)?i(new Te.a("Request failed with status code "+o.status,[Te.a.ERR_BAD_REQUEST,Te.a.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o)):r(o),l=null)}l.open(e.method.toUpperCase(),Ee(u,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,"onloadend"in l?l.onloadend=h:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(h)},l.onabort=function(){l&&(n(new Te.a("Request aborted",Te.a.ECONNABORTED,e,l)),l=null)},l.onerror=function(){n(new Te.a("Network Error",Te.a.ERR_NETWORK,e,l)),l=null},l.ontimeout=function(){let t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";var r=e.transitional||Ae;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new Te.a(t,r.clarifyTimeoutError?Te.a.ETIMEDOUT:Te.a.ECONNABORTED,e,l)),l=null},Le.isStandardBrowserEnv&&(c=(e.withCredentials||qe(u))&&e.xsrfCookieName&&We.read(e.xsrfCookieName))&&i.set(e.xsrfHeaderName,c),void 0===r&&i.setContentType(null),"setRequestHeader"in l&&ge.a.forEach(i.toJSON(),(function(e,t){l.setRequestHeader(t,e)})),ge.a.isUndefined(e.withCredentials)||(l.withCredentials=!!e.withCredentials),a&&"json"!==a&&(l.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",Xe(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",Xe(e.onUploadProgress)),(e.cancelToken||e.signal)&&(o=t=>{l&&(n(!t||t.type?new Ge(null,e,l):t),l.abort(),l=null)},e.cancelToken&&e.cancelToken.subscribe(o),e.signal)&&(e.signal.aborted?o():e.signal.addEventListener("abort",o)),(i=(c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(c=u))&&c[1]||"")&&-1===Le.protocols.indexOf(i)?n(new Te.a("Unsupported protocol "+i+":",Te.a.ERR_BAD_REQUEST,e)):l.send(r||null)}))}};ge.a.forEach(Ze,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});function Je(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ge(null,e)}function Qe(e){return Je(e),e.headers=Fe.from(e.headers),e.data=Ue.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),(e=>{var t=(e=ge.a.isArray(e)?e:[e]).length;let n,r;for(let i=0;i<t&&(n=e[i],!(r=ge.a.isString(n)?Ze[n.toLowerCase()]:n));i++);if(!r){if(!1===r)throw new Te.a(`Adapter ${n} is not supported by the environment`,"ERR_NOT_SUPPORT");throw new Error(ge.a.hasOwnProp(Ze,n)?`Adapter '${n}' is not available in the build`:`Unknown adapter '${n}'`)}if(ge.a.isFunction(r))return r;throw new TypeError("adapter is not a function")})(e.adapter||Ie.adapter)(e).then((function(t){return Je(e),t.data=Ue.call(e,e.transformResponse,t),t.headers=Fe.from(t.headers),t}),(function(t){return He(t)||(Je(e),t&&t.response&&(t.response.data=Ue.call(e,e.transformResponse,t.response),t.response.headers=Fe.from(t.response.headers))),Promise.reject(t)}))}const Ke=e=>e instanceof Fe?e.toJSON():e;function $e(e,t){t=t||{};const n={};function r(e,t,n){return ge.a.isPlainObject(e)&&ge.a.isPlainObject(t)?ge.a.merge.call({caseless:n},e,t):ge.a.isPlainObject(t)?ge.a.merge({},t):ge.a.isArray(t)?t.slice():t}function i(e,t,n){return ge.a.isUndefined(t)?ge.a.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function a(e,t){if(!ge.a.isUndefined(t))return r(void 0,t)}function o(e,t){return ge.a.isUndefined(t)?ge.a.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,i,a){return a in t?r(n,i):a in e?r(void 0,n):void 0}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t)=>i(Ke(e),Ke(t),!0)};return ge.a.forEach(Object.keys(e).concat(Object.keys(t)),(function(r){var a=l[r]||i,o=a(e[r],t[r],r);ge.a.isUndefined(o)&&a!==s||(n[r]=o)})),n}const et={},tt=(["object","boolean","number","function","string","symbol"].forEach((e,t)=>{et[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}),{});et.transitional=function(e,t,n){function r(e,t){return"[Axios v1.3.4] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,a)=>{if(!1===e)throw new Te.a(r(i," has been removed"+(t?" in "+t:"")),Te.a.ERR_DEPRECATED);return t&&!tt[i]&&(tt[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,a)}};var nt={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Te.a("options must be an object",Te.a.ERR_BAD_OPTION_VALUE);var r=Object.keys(e);let i=r.length;for(;0<i--;){var a=r[i];if(o=t[a]){var o,s=e[a];if(!0!==(o=void 0===s||o(s,a,e)))throw new Te.a("option "+a+" must be "+o,Te.a.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Te.a("Unknown option "+a,Te.a.ERR_BAD_OPTION)}},validators:et};const rt=nt.validators;class it{constructor(e){this.defaults=e,this.interceptors={request:new Se,response:new Se}}request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{};const{transitional:n,paramsSerializer:r,headers:i}=t=$e(this.defaults,t);void 0!==n&&nt.assertOptions(n,{silentJSONParsing:rt.transitional(rt.boolean),forcedJSONParsing:rt.transitional(rt.boolean),clarifyTimeoutError:rt.transitional(rt.boolean)},!1),void 0!==r&&nt.assertOptions(r,{encode:rt.function,serialize:rt.function},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase(),(e=i&&ge.a.merge(i.common,i[t.method]))&&ge.a.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=Fe.concat(e,i);const a=[];let o=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(o=o&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));const s=[];this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)}));let l,c,u=0;if(o){c=a.length;let n=t;for(u=0;u<c;){var h=a[u++],d=a[u++];try{n=h(n)}catch(e){d.call(this,e);break}}try{l=Qe.call(this,n)}catch(e){return Promise.reject(e)}for(u=0,c=s.length;u<c;)l=l.then(s[u++],s[u++])}else{var p=[Qe.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,s),c=p.length,l=Promise.resolve(t);u<c;)l=l.then(p[u++],p[u++])}return l}getUri(e){return Ee(je((e=$e(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}ge.a.forEach(["delete","get","head","options"],(function(e){it.prototype[e]=function(t,n){return this.request($e(n||{},{method:e,url:t,data:(n||{}).data}))}})),ge.a.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request($e(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}it.prototype[e]=t(),it.prototype[e+"Form"]=t(!0)}));var at=it;h=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then(e=>{if(n._listeners){let t=n._listeners.length;for(;0<t--;)n._listeners[t](e);n._listeners=null}}),this.promise.then=e=>{let t;return(e=new Promise(e=>{n.subscribe(e),t=e}).then(e)).cancel=function(){n.unsubscribe(t)},e},e((function(e,r,i){n.reason||(n.reason=new Ge(e,r,i),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){this._listeners&&-1!==(e=this._listeners.indexOf(e))&&this._listeners.splice(e,1)}static source(){let t;return{token:new e((function(e){t=e})),cancel:t}}};const ot={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ot).forEach(([e,t])=>{ot[t]=e}),Ye=ot;var st=((dt=function e(t){var n=new at(t),r=Object(ye.a)(at.prototype.request,n);return ge.a.extend(r,at.prototype,n,{allOwnKeys:!0}),ge.a.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e($e(t,n))},r}(Ie)).Axios=at,dt.CanceledError=Ge,dt.CancelToken=h,dt.isCancel=He,dt.VERSION="1.3.4",dt.toFormData=xe.a,dt.AxiosError=Te.a,dt.Cancel=dt.CanceledError,dt.all=function(e){return Promise.all(e)},dt.spread=function(e){return function(t){return e.apply(null,t)}},dt.isAxiosError=function(e){return ge.a.isObject(e)&&!0===e.isAxiosError},dt.mergeConfig=$e,dt.AxiosHeaders=Fe,dt.formToJSON=e=>Ce(ge.a.isHTMLForm(e)?new FormData(e):e),dt.HttpStatusCode=Ye,dt.default=dt);function lt(e,t){var n;window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject?n=new window.ActiveXObject:alert(""),null!=n&&(e=e+"?timestamp="+(new Date).getTime(),n.open("GET",e,!0),n.send(null),n.onreadystatechange=function(){var e;4==n.readyState&&200==n.status&&(O()(e=n.responseText).call(e,"</html>",0)&&O()(e=n.responseText).call(e,"</body>",0)&&O()(e=n.responseText).call(e,"</head>",0)?t(null):t(n.responseText))},n.onloadend=function(){4==n.readyState&&404==n.status&&502==n.status&&t(null)})}function ct(e,t){st({method:"get",responseType:"blob",url:e+"?timestamp="+(new Date).getTime()}).then((function(e){e=new window.File([e.data],"semantics",{type:"zip"}),ve.a.loadAsync(e).then((function(e){for(var n in e.files)e.file(e.files[n].name).async("blob").then((function(e){var n,r;e=e,n=function(e,n){t(n)},r=new FileReader,e=new Blob([e]),r.onload=function(e){n(0,e.target.result)},r.onerror=function(e){n(e.error,null)},r.readAsText(e,"utf-8")}))}))}))}h=n(53);var ut=n.n(h),ht=(Ye=n(45),n.n(Ye)),dt=n(239),pt=n.n(dt),ft=n(2);function mt(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?vt(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ft.BufferGeometryUtils={computeTangents:function(e){e.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(e,t){for(var n=null!==e[0].index,r=new E.a(ut()(e[0].attributes)),i=new E.a(ut()(e[0].morphAttributes)),a={},o={},s=e[0].morphTargetsRelative,l=new ft.BufferGeometry,c=0,u=0;u<e.length;++u){var h,d,p=e[u],f=0;if(n!=(null!==p.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(h in p.attributes){if(!r.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+h+'" attribute exists among all geometries, or in none of them.'),null;void 0===a[h]&&(a[h]=[]),a[h].push(p.attributes[h]),f++}if(f!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(s!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(h in p.morphAttributes){if(!i.has(h))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===o[h]&&(o[h]=[]),o[h].push(p.morphAttributes[h])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(p.userData),t){if(n)d=p.index.count;else{if(void 0===p.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;d=p.attributes.position.count}l.addGroup(c,d,u),c+=d}}if(n){var m=0,v=[];for(u=0;u<e.length;++u){for(var g=e[u].index,y=0;y<g.count;++y)v.push(g.getX(y)+m);m+=e[u].attributes.position.count}l.setIndex(v)}for(h in a){var x=this.mergeBufferAttributes(a[h]);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,x)}for(h in o){var w=o[h][0].length;if(0===w)break;for(l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[],u=0;u<w;++u){var b=[];for(y=0;y<o[h].length;++y)b.push(o[h][y][u]);var _=this.mergeBufferAttributes(b);if(!_)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(_)}}return l},mergeBufferAttributes:function(e){for(var t,n,r,i=0,a=0;a<e.length;++a){var o=e[a];if(o.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if((t=void 0===t?o.array.constructor:t)!==o.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if((n=void 0===n?o.itemSize:n)!==o.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if((r=void 0===r?o.normalized:r)!==o.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=o.array.length}var s=new t(i),l=0;for(a=0;a<e.length;++a)s.set(e[a].array,l),l+=e[a].array.length;return new ft.BufferAttribute(s,n,r)},interleaveAttributes:function(e){for(var t,n=0,r=0,i=0,a=e.length;i<a;++i){var o=e[i];if((t=void 0===t?o.array.constructor:t)!==o.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;n+=o.array.length,r+=o.itemSize}var s=new ft.InterleavedBuffer(new t(n),r),l=0,c=[],u=["getX","getY","getZ","getW"],h=["setX","setY","setZ","setW"],d=0;for(a=e.length;d<a;d++){var p=(o=e[d]).itemSize,f=o.count,m=new ft.InterleavedBufferAttribute(s,p,l,o.normalized);c.push(m),l+=p;for(var v=0;v<f;v++)for(var g=0;g<p;g++)m[h[g]](v,o[u[g]](v))}return c},estimateBytesUsed:function(e){var t,n=0;for(t in e.attributes){var r=e.getAttribute(t);n+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}var i=e.getIndex();return n+(i?i.count*i.itemSize*i.array.BYTES_PER_ELEMENT:0)},mergeVertices:function(e){for(var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e-4,r=(n=Math.max(n,ht.a),{}),i=e.getIndex(),a=e.getAttribute("position"),o=(i||a).count,l=0,c=ut()(e.attributes),u={},h={},d=[],p=["getX","getY","getZ","getW"],f=0,m=c.length;f<m;f++)u[w=c[f]]=[],(E=e.morphAttributes[w])&&(h[w]=s()(t=$()(t=new Array(E.length)).call(t)).call(t,(function(){return[]})));a=pt()(1/n);var v=Math.pow(10,a);for(f=0;f<o;f++){var g=i?i.getX(f):f,y="",x=0;for(m=c.length;x<m;x++)for(var w=c[x],b=(M=e.getAttribute(w)).itemSize,_=0;_<b;_++)y+="".concat(~~(M[p[_]](g)*v),",");if(y in r)d.push(r[y]);else{for(x=0,m=c.length;x<m;x++){w=c[x];var M=e.getAttribute(w),E=e.morphAttributes[w],S=(b=M.itemSize,u[w]),T=h[w];for(_=0;_<b;_++){var A=p[_];if(S.push(M[A](g)),E)for(var L=0,C=E.length;L<C;L++)T[L].push(E[L][A](g))}}r[y]=l,d.push(l),l++}}var P=e.clone();for(f=0,m=c.length;f<m;f++){w=c[f];var R=e.getAttribute(w),I=new R.array.constructor(u[w]);M=new ft.BufferAttribute(I,R.itemSize,R.normalized);if(P.setAttribute(w,M),w in h)for(x=0;x<h[w].length;x++){I=new(k=e.morphAttributes[w][x]).array.constructor(h[w][x]);var k=new ft.BufferAttribute(I,k.itemSize,k.normalized);P.morphAttributes[w][x]=k}}return P.setIndex(d),P},toTrianglesDrawMode:function(e,t){if(t===ft.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==ft.TriangleFanDrawMode&&t!==ft.TriangleStripDrawMode)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<i.count;a++)r.push(a);e.setIndex(r),n=e.getIndex()}var o=n.count-2,s=[];if(t===ft.TriangleFanDrawMode)for(a=1;a<=o;a++)s.push(n.getX(0)),s.push(n.getX(a)),s.push(n.getX(a+1));else for(a=0;a<o;a++)a%2==0?(s.push(n.getX(a)),s.push(n.getX(a+1)),s.push(n.getX(a+2))):(s.push(n.getX(a+2)),s.push(n.getX(a+1)),s.push(n.getX(a)));return s.length/3!=o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles."),(t=e.clone()).setIndex(s),t.clearGroups(),t},computeMorphedAttributes:function(e){if(!0!==e.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var t=new ft.Vector3,n=new ft.Vector3,r=new ft.Vector3,i=new ft.Vector3,a=new ft.Vector3,o=new ft.Vector3,s=new ft.Vector3,l=new ft.Vector3,c=new ft.Vector3;function u(e,u,h,d,p,f,m,v,g){t.fromBufferAttribute(h,f),n.fromBufferAttribute(h,m),r.fromBufferAttribute(h,v);var y=e.morphTargetInfluences;if(u.morphTargets&&d&&y){s.set(0,0,0),l.set(0,0,0),c.set(0,0,0);for(var x=0,w=d.length;x<w;x++){var b=y[x],_=d[x];0!==b&&(i.fromBufferAttribute(_,f),a.fromBufferAttribute(_,m),o.fromBufferAttribute(_,v),p?(s.addScaledVector(i,b),l.addScaledVector(a,b),c.addScaledVector(o,b)):(s.addScaledVector(i.sub(t),b),l.addScaledVector(a.sub(n),b),c.addScaledVector(o.sub(r),b)))}t.add(s),n.add(l),r.add(c)}e.isSkinnedMesh&&(e.boneTransform(f,t),e.boneTransform(m,n),e.boneTransform(v,r)),g[3*f+0]=t.x,g[3*f+1]=t.y,g[3*f+2]=t.z,g[3*m+0]=n.x,g[3*m+1]=n.y,g[3*m+2]=n.z,g[3*v+0]=r.x,g[3*v+1]=r.y,g[3*v+2]=r.z}var h,d,p,f,m,v,g,y,x,w=e.geometry,b=e.material,_=w.index,M=w.attributes.position,E=w.morphAttributes.position,S=w.morphTargetsRelative,T=w.attributes.normal,A=w.morphAttributes.position,L=w.groups,P=w.drawRange,R=new Float32Array(M.count*M.itemSize),I=new Float32Array(T.count*T.itemSize);if(null!==_)if(C()(b))for(f=0,v=L.length;f<v;f++)for(x=b[(y=L[f]).materialIndex],m=Math.max(y.start,P.start),g=Math.min(y.start+y.count,P.start+P.count);m<g;m+=3)u(e,x,M,E,S,h=_.getX(m),d=_.getX(m+1),p=_.getX(m+2),R),u(e,x,T,A,S,h,d,p,I);else for(f=Math.max(0,P.start),v=Math.min(_.count,P.start+P.count);f<v;f+=3)u(e,b,M,E,S,h=_.getX(f),d=_.getX(f+1),p=_.getX(f+2),R),u(e,b,T,A,S,h,d,p,I);else if(void 0!==M)if(C()(b))for(f=0,v=L.length;f<v;f++)for(x=b[(y=L[f]).materialIndex],m=Math.max(y.start,P.start),g=Math.min(y.start+y.count,P.start+P.count);m<g;m+=3)u(e,x,M,E,S,h=m,d=m+1,p=m+2,R),u(e,x,T,A,S,h,d,p,I);else for(f=Math.max(0,P.start),v=Math.min(M.count,P.start+P.count);f<v;f+=3)u(e,b,M,E,S,h=f,d=f+1,p=f+2,R),u(e,b,T,A,S,h,d,p,I);return{positionAttribute:M,normalAttribute:T,morphedPositionAttribute:new ft.Float32BufferAttribute(R,3),morphedNormalAttribute:new ft.Float32BufferAttribute(I,3)}}};var gt=n(2);function yt(e){window.addEventListener("bimengine:camerachange",function(e,t){var n=1<arguments.length&&void 0!==t?t:500;return function(){var t=arguments,r=this;clearTimeout(e.timerId),e.timerId=a()((function(){var n;e.call.apply(e,c()(n=[r]).call(n,b()(t)))}),n)}}((function(){r=e.scene.children;var a=e.ModelOctreeBox;if(null!=a){s=[];for(var c=0;c<a.length;c++){var u=a[c];!function e(t){if(1==i(t))if(0==t.isLeaf){l(t,!0);var n,r=mt(t.children);try{for(r.s();!(n=r.n()).done;){e(n.value)}}catch(e){r.e(e)}finally{r.f()}}else l(t,!0);else l(t,!1)}(u),function e(t){if(1==o(t))if(0==t.isLeaf){l(t,!0);var n,r=mt(t.children);try{for(r.s();!(n=r.n()).done;){e(n.value)}}catch(e){r.e(e)}finally{r.f()}}else l(t,!0);else l(t,!1)}(u)}}!function(){var r=e.ModelInstanceBox;if(r&&r.length){var a,o=mt(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;i(s.box)&&function(n){if((i=e.scene.camera.position).x>n.min.x&&i.y>n.min.y&&i.z>n.min.z&&i.x<n.max.x&&i.y<n.max.y&&i.z<n.max.z)return!0;var r,i,a=mt(i=n.DensePoint);try{for(a.s();!(r=a.n()).done;)if(r.value.clone().distanceTo(e.scene.camera.position)<t*n.length*2)return!0}catch(n){a.e(n)}finally{a.f()}return!1}(s.box)?0!=e.scene.children[n+s.i].Treevisible&&(e.scene.children[n+s.i].visible=!0):e.scene.children[n+s.i].visible=!1}}catch(r){o.e(r)}finally{o.f()}}}()}),200));var t=15,n=6,r=e.scene.children;function i(t){var n,r=mt(t.DensePoint);try{for(r.s();!(n=r.n()).done;)if(1==X(n.value,e.scene.camera))return!0}catch(t){r.e(t)}finally{r.f()}}function o(n){var r,i=e.scene.camera.position;return i.x>n.min.x&&i.y>n.min.y&&i.z>n.min.z&&i.x<n.max.x&&i.y<n.max.y&&i.z<n.max.z?n.keepFresh=!0:(r=n.min.distanceTo(i),i=n.max.distanceTo(i),r=Math.min(r,i),n.keepFresh=r<40,!(r>t*n.length))}new gt.MeshStandardMaterial({color:new gt.Color("rgb(220,0,0)"),side:gt.DoubleSide,depthTest:!0,visible:!1});var s=[];function l(e,t){if(0==t&&null!=e.elements){for(var i=!0,a=0;a<s.length;a++)if(s[a]==e.id){i=!1;break}if(i&&s.push(e.id),null!=e&&null!=e.elements){for(var o=0;o<e.elements.length;o++){var c=e.elements[o];null!=c&&0!=r[n+c.i].geometry.groups.length&&(r[n+c.i].geometry.groups[c.j].hide=!0,r[n+c.i].geometry.groups[c.j].keepFresh=e.keepFresh)}if(0==e.isLeaf){var u,h=mt(e.children);try{for(h.s();!(u=h.n()).done;)l(u.value,t)}catch(e){h.e(e)}finally{h.f()}}}}else{for(var d=!0,p=0;p<s.length;p++)if(s[p]==e.id){d=!1;break}if(0!=d&&null!=e&&null!=e.elements){for(var f=0;f<e.elements.length;f++){var m=e.elements[f];null!=m&&0!=r[n+m.i].geometry.groups.length&&(r[n+m.i].geometry.groups[m.j].hide=!1,r[n+m.i].geometry.groups[m.j].keepFresh=e.keepFresh)}if(0==e.isLeaf){var v,g=mt(e.children);try{for(g.s();!(v=g.n()).done;)l(v.value,t)}catch(e){g.e(e)}finally{g.f()}}}}}}function xt(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?wt(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bt=n(2);function _t(e,t,n,r,i,a){function l(e,t){e.transparent=t.transparent,e.opacity=t.opacity,e.side=bt[t.side],e.color=new bt.Color(t.color),e.emissive=new bt.Color(t.emissive),e.roughness=t.roughness,e.metalness=t.metalness,e.reflectivity=t.reflectivity,e.clearcoat=t.clearcoat,e.clearcoatRoughness=t.clearcoatRoughness,e.flatShading=t.flatShading,e.vertexColors=t.vertexColors,e.envMap=t.envMap.url?(new bt.TextureLoader).load(t.envMap.url,(function(e){e.wrapS=bt.RepeatWrapping,e.wrapT=bt.RepeatWrapping,fe()(e).set(fe()(t.envMap).u,fe()(t.envMap).v),e.offset.set(t.envMap.offset.u,t.envMap.offset.v)})):null,e.map=s()(t).url?(new bt.TextureLoader).load(s()(t).url,(function(e){e.wrapS=bt.RepeatWrapping,e.wrapT=bt.RepeatWrapping,fe()(e).set(fe()(s()(t)).u,fe()(s()(t)).v),e.offset.set(s()(t).offset.u,s()(t).offset.v)})):null,e.normalMap=t.normalMap.url?(new bt.TextureLoader).load(t.normalMap.url,(function(e){e.wrapS=bt.RepeatWrapping,e.wrapT=bt.RepeatWrapping,fe()(e).set(fe()(t.normalMap).u,fe()(t.normalMap).v),e.offset.set(t.normalMap.offset.u,t.normalMap.offset.v)})):null,e.roughnessMap=t.roughnessMap.url?(new bt.TextureLoader).load(t.roughnessMap.url,(function(e){e.wrapS=bt.RepeatWrapping,e.wrapT=bt.RepeatWrapping,fe()(e).set(fe()(t.roughnessMap).u,fe()(t.roughnessMap).v),e.offset.set(t.roughnessMap.offset.u,t.roughnessMap.offset.v)})):null,e.alphaMap=t.alphaMap.url?(new bt.TextureLoader).load(t.alphaMap.url,(function(e){e.wrapS=bt.RepeatWrapping,e.wrapT=bt.RepeatWrapping,fe()(e).set(fe()(t.alphaMap).u,fe()(t.alphaMap).v),e.offset.set(t.alphaMap.offset.u,t.alphaMap.offset.v)})):null}window.bimEngine.GLTFLoader.load(r,(function(s){s.scene.scale.set(1,1,1);var c,u=s.scene.children,h=[],d=xt(u);try{for(d.s();!(c=d.n()).done;){var p=c.value;if("Group"===p.type){if(p.children&&p.children.length)for(var f=0;f<p.children.length;f++){var m=p.children[f];m.userData=p.userData,m.IsMerge=!0,m.MergeCount=p.children.length,m.MergeIndex=f,m.MergeName=p.name,h.push(m)}}else"Mesh"===p.type&&(p.IsMerge=!1,p.MergeIndex=0,p.MergeCount=1,p.MergeName=p.name,h.push(p))}}catch(s){d.e(s)}finally{d.f()}if(h.length){if(null==i&&e.add(s.scene),i&&"modelList"===i.name){for(var v=0;v<h.length;v++){var g=h[v];null==i.position||null==i.position.Point||0==i.position.Point.X&&0==i.position.Point.Y&&0==i.position.Point.Z||(g.matrix.elements[12]=.3048*i.position.Point.X,g.matrix.elements[13]=.3048*i.position.Point.Z,g.matrix.elements[14]=.3048*-i.position.Point.Y,g.rotation.y=i.position.angle_a)}u=e;var y,x,w=h,b=[],_=[],M=[],E=[],S=(window.bimEngine.scene,xt(w));try{for(S.s();!(y=S.n()).done;)!function(){var e,i,a,s;null!=(x=y.value).geometry&&null!=x.matrix&&(s=x.geometry.clone().applyMatrix4(x.matrix.clone()),a=o()(a=window.bimEngine.MaterialMapList).call(a,(function(e){return e.path===t})),a=(e=a.length?o()(a=a[0].mapList).call(a,(function(e){return e.glb===r}))[0]:null)?o()(a=window.bimEngine.MaterialList).call(a,(function(t){return t.Id===e.materialId}))[0]:null,e&&e.meshId===x.userData.name&&a&&a.Param?l(x.material,a.Param):x.material.side=bt.DoubleSide,b.push(s),_.push(x.material),M.push(x.material.clone()),a=x.geometry.boundingBox.min.clone().applyMatrix4(x.matrix.clone()),s=x.geometry.boundingBox.max.clone().applyMatrix4(x.matrix.clone()),i=new bt.Vector3(Math.min(a.x,s.x),Math.min(a.y,s.y),Math.min(a.z,s.z)),a=new bt.Vector3(Math.max(a.x,s.x),Math.max(a.y,s.y),Math.max(a.z,s.z)),s=i.clone().add(a.clone()).multiplyScalar(.5),E.push({name:x.userData.name,min:i,max:a,center:s,dbid:E.length,IsMerge:x.IsMerge,MergeIndex:x.MergeIndex,MergeCount:x.MergeCount,MergeName:x.MergeName,EdgeList:[],basePath:n,relativePath:t}))}()}catch(s){S.e(s)}finally{S.f()}var A=bt.BufferGeometryUtils.mergeBufferGeometries(b,!0);(A=new bt.Mesh(A,_)).ElementInfos=E,A.cloneMaterialArray=M,A.name="rootModel",A.TypeName="Mesh",A.meshs=w,A.url=r,A.basePath=n,A.relativePath=t,u.add(A)}else if(i&&"instanceList"===i.name){var L,C=(u=o()(w=window.bimEngine.MaterialMapList).call(w,(function(e){return e.path===t}))).length?o()(A=u[0].mapList).call(A,(function(e){return e.glb===r}))[0]:null,P=C?o()(u=window.bimEngine.MaterialList).call(u,(function(e){return e.Id===C.materialId}))[0]:null,R=xt(i.children);try{var I=function(){var i,a=L.value;for(v=0;v<h.length;v++)i=void 0,C&&C.meshId===h[v].userData.name&&P&&P.Param&&l(h[v].material,P.Param),a.meshId===h[v].userData.name&&((i=function(i){var s,l,c,u=null;if(0==i?u=new bt.InstancedMesh(h[v].geometry.clone(),h[v].material,a.children.length):1==i||3==i?null!=a.children[0].FacingDir&&(s=new bt.Vector3(a.children[0].FacingDir.X,0,-a.children[0].FacingDir.Y),(l=new bt.Matrix4).set(1-2*s.x*s.x,-2*s.x*s.y,-2*s.x*s.z,0,-2*s.x*s.y,1-2*s.y*s.y,-2*s.y*s.z,0,-2*s.x*s.z,-2*s.y*s.z,1-2*s.z*s.z,0,0,0,0,1),(c=h[v].geometry.clone().applyMatrix4(l)).verticesNeedUpdate=!0,c.normalsNeedUpdate=!0,c.computeBoundingSphere(),c.computeFaceNormals(),c.computeVertexNormals(),u=new bt.InstancedMesh(c,h[v].material,a.children.length)):2==i&&null!=a.children[0].handleDir&&(s=new bt.Vector3(a.children[0].handleDir.X,0,-a.children[0].handleDir.Y),(l=new bt.Matrix4).set(1-2*s.x*s.x,-2*s.x*s.y,-2*s.x*s.z,0,-2*s.x*s.y,1-2*s.y*s.y,-2*s.y*s.z,0,-2*s.x*s.z,-2*s.y*s.z,1-2*s.z*s.z,0,0,0,0,1),(c=h[v].geometry.clone().applyMatrix4(l)).verticesNeedUpdate=!0,c.normalsNeedUpdate=!0,c.computeBoundingSphere(),c.computeFaceNormals(),c.computeVertexNormals(),u=new bt.InstancedMesh(c,h[v].material,a.children.length)),null!=u){for(var d=[],p=(window.color=new bt.Color,o()(s=a.children).call(s,(function(e){return e.Mirrored==i}))),f=0;f<p.length;f++){var m,g,y,x=p[f],w=new bt.Matrix4;x.Mirrored==i&&((w=2==i?w.clone().makeRotationY(x.angle_a+Math.PI):w.clone().makeRotationY(x.angle_a)).elements[12]=.3048*x.Point.X,w.elements[13]=.3048*x.Point.Z,w.elements[14]=.3048*-x.Point.Y,u.setMatrixAt(f,w),u.setColorAt(f,window.color),g=u.geometry.boundingBox.min.clone().applyMatrix4(w.clone()),y=u.geometry.boundingBox.max.clone().applyMatrix4(w.clone()),m=new bt.Vector3(Math.min(g.x,y.x),Math.min(g.y,y.y),Math.min(g.z,y.z)),g=new bt.Vector3(Math.max(g.x,y.x),Math.max(g.y,y.y),Math.max(g.z,y.z)),y=m.clone().add(g.clone()).multiplyScalar(.5),u.geometry.groups.push({}),d.push({name:x.name,min:m,max:g,center:y,dbid:f,IsMerge:h[v].IsMerge,MergeIndex:h[v].MergeIndex,MergeCount:h[v].MergeCount,MergeName:h[v].MergeName,url:r,EdgeList:[],matrix:w,basePath:n,relativePath:t}))}0!=d.length&&(u.ElementInfos=d,u.name="rootModel",u.TypeName="InstancedMesh",u.MeshId=a.meshId,u.cloneMaterialArray=h[v].material.clone(),u.basePath=n,u.relativePath=t,u.meshs=h[v],u.url=r,u.cloneInstanceMatrix=T()(u.instanceMatrix.array),e.add(u))}})(0),i(1),i(2),i(3),h[v].material.side=bt.DoubleSide)};for(R.s();!(L=R.n()).done;)I()}catch(s){R.e(s)}finally{R.f()}}a(s)}else a(null)}),(function(e){}),(function(e){}))}n(2);var Mt=n(2);var Et,St,Tt,At,Lt,Ct,Pt,Rt,It,kt,Dt,zt,Nt,Ot,Bt,Ft=n(2);function Ut(e,t,n){this.camera=e,this.scene=t,this.startPoint=new Ft.Vector3,this.endPoint=new Ft.Vector3,this.collection=[],this.deep=n||Number.MAX_VALUE}Ft.SelectionBox=(Et=new Ft.Frustum,St=new Ft.Vector3,Tt=new Ft.Vector3,At=new Ft.Vector3,Lt=new Ft.Vector3,Ct=new Ft.Vector3,Pt=new Ft.Vector3,Rt=new Ft.Vector3,It=new Ft.Vector3,kt=new Ft.Vector3,Dt=new Ft.Vector3,zt=new Ft.Vector3,Nt=new Ft.Vector3,Ot=new Ft.Vector3,Bt=new Ft.Vector3,Ut.prototype.select=function(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(Et,this.scene),this.collection},Ut.prototype.updateFrustum=function(e,t){var n,r,i,a;e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=ht.a),e.y===t.y&&(t.y+=ht.a),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera?(Tt.copy(e),Tt.x=Math.min(e.x,t.x),Tt.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),At.setFromMatrixPosition(this.camera.matrixWorld),Lt.copy(Tt),Ct.set(t.x,Tt.y,0),Pt.copy(t),Rt.set(Tt.x,t.y,0),Lt.unproject(this.camera),Ct.unproject(this.camera),Pt.unproject(this.camera),Rt.unproject(this.camera),Nt.copy(Lt).sub(At),Ot.copy(Ct).sub(At),Bt.copy(Pt).sub(At),Nt.normalize(),Ot.normalize(),Bt.normalize(),Nt.multiplyScalar(this.deep),Ot.multiplyScalar(this.deep),Bt.multiplyScalar(this.deep),Nt.add(At),Ot.add(At),Bt.add(At),(a=Et.planes)[0].setFromCoplanarPoints(At,Lt,Ct),a[1].setFromCoplanarPoints(At,Ct,Pt),a[2].setFromCoplanarPoints(Pt,Rt,At),a[3].setFromCoplanarPoints(Rt,Lt,At),a[4].setFromCoplanarPoints(Ct,Pt,Rt),a[5].setFromCoplanarPoints(Bt,Ot,Nt),a[5].normal.multiplyScalar(-1)):this.camera.isOrthographicCamera?(n=Math.min(e.x,t.x),r=Math.max(e.y,t.y),i=Math.max(e.x,t.x),e=Math.min(e.y,t.y),Lt.set(n,r,-1),Ct.set(i,r,-1),Pt.set(i,e,-1),Rt.set(n,e,-1),It.set(n,r,1),kt.set(i,r,1),Dt.set(i,e,1),zt.set(n,e,1),Lt.unproject(this.camera),Ct.unproject(this.camera),Pt.unproject(this.camera),Rt.unproject(this.camera),It.unproject(this.camera),kt.unproject(this.camera),Dt.unproject(this.camera),zt.unproject(this.camera),(a=Et.planes)[0].setFromCoplanarPoints(Lt,It,kt),a[1].setFromCoplanarPoints(Ct,kt,Dt),a[2].setFromCoplanarPoints(Dt,zt,Rt),a[3].setFromCoplanarPoints(zt,It,Lt),a[4].setFromCoplanarPoints(Ct,Pt,Rt),a[5].setFromCoplanarPoints(Dt,kt,It),a[5].normal.multiplyScalar(-1)):console.error("THREE.SelectionBox: Unsupported camera type.")},Ut.prototype.searchChildInFrustum=function(e,t){if((t.isMesh||t.isLine||t.isPoints)&&void 0!==t.material&&(null===t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),St.copy(t.geometry.boundingSphere.center),St.applyMatrix4(t.matrixWorld),e.containsPoint(St))&&this.collection.push(t),0<t.children.length)for(var n=0;n<t.children.length;n++)this.searchChildInFrustum(e,t.children[n])},Ut);h=n(44);var Ht=n.n(h),Vt=n(2);function Gt(e,t){this.element=document.createElement("div"),this.element.classList.add(t),this.element.style.pointerEvents="none",this.renderer=e,this.startPoint=new Vt.Vector2,this.pointTopLeft=new Vt.Vector2,this.pointBottomRight=new Vt.Vector2,this.isDown=!1,this.renderer.domElement.addEventListener("pointerdown",Ht()(t=function(e){this.element&&(this.isDown=!0,this.onSelectStart(e))}).call(t,this)),this.renderer.domElement.addEventListener("pointermove",Ht()(e=function(e){this.isDown&&this.element&&this.onSelectMove(e)}).call(e,this)),this.renderer.domElement.addEventListener("pointerup",Ht()(t=function(e){this.element&&(this.isDown=!1,this.onSelectOver(e))}).call(t,this))}function Wt(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?jt(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Vt.SelectionHelper=(Gt.prototype.onSelectStart=function(e){this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY},Gt.prototype.onSelectMove=function(e){this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"},Gt.prototype.onSelectOver=function(){this.element.parentElement.removeChild(this.element)},Gt);var qt=n(2);function Xt(e){n(563)("./"+F()+"/selectBox.scss");var t,r,i,a=new Object,s=e.scene,c=e.scene.camera,u=e.scene.renderer,h=e.scene.controls,d=[],p=!1;function f(t){if(0===t.button){if(p=!0,e.UpdateRender(),i){var n,a=Wt(i.children);try{for(a.s();!(n=a.n()).done;)n.value,i.children=[]}catch(t){a.e(t)}finally{a.f()}}(r={startPoint:null,endPoint:null}).startPoint={x:t.clientX,y:t.clientY}}}function m(n){p&&(e.UpdateRender(),t.isDown)&&(r.endPoint={x:n.clientX,y:n.clientY})}function v(t){0===t.button&&(e.UpdateRender(),r.endPoint={x:t.clientX,y:t.clientY},function e(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(r.startPoint&&r.endPoint){var n={x:0,y:0},i={x:0,y:0};if(r.startPoint.x>=r.endPoint.x?(n.x=r.endPoint.x,i.x=r.startPoint.x):(n.x=r.startPoint.x,i.x=r.endPoint.x),r.startPoint.y>=r.endPoint.y?(n.y=r.endPoint.y,i.y=r.startPoint.y):(n.y=r.startPoint.y,i.y=r.endPoint.y),t&&2<Math.abs(n.x-i.x)&&2<Math.abs(n.y-i.y)){var a,o=[],s=Wt(d);try{for(s.s();!(a=s.n()).done;){var c=a.value;if("InstancedMesh"===c.TypeName||"InstancedMesh-Pipe"===c.TypeName){var u,h=Wt(c.ElementInfos);try{var p=function(){var e,t=u.value;t.screenPosition.x>=n.x&&t.screenPosition.y>=n.y&&t.screenPosition.x<=i.x&&t.screenPosition.y<=i.y&&(e=[c.index,t.dbid],(t=M()(o).call(o,(function(t){return t.toString()==e.toString()})))<0?o.push(e):l()(o).call(o,t,1))};for(h.s();!(u=h.n()).done;)p()}catch(e){h.e(e)}finally{h.f()}}else if(("Mesh"===c.TypeName||"PipeMesh"===c.TypeName)&&c&&c.material.length){var f,m=Wt(c.ElementInfos);try{var v=function(){var e,t=f.value;t.screenPosition.x>=n.x&&t.screenPosition.y>=n.y&&t.screenPosition.x<=i.x&&t.screenPosition.y<=i.y&&(e=[c.index,t.dbid],(t=M()(o).call(o,(function(t){return t.toString()==e.toString()})))<0?o.push(e):l()(o).call(o,t,1))};for(m.s();!(f=m.n()).done;)v()}catch(e){m.e(e)}finally{m.f()}}}}catch(e){s.e(e)}finally{s.f()}bimEngine.Selection=o,bimEngine.ResetSelectedModels_("highlight",o,!0),r.endPoint={x:0,y:0},r.startPoint={x:0,y:0},e()}}}(!0),p=!1)}return a.Active=function(){d=o()(n=s.children).call(n,(function(e){return"rootModel"==e.name}));var e,n=o()(n=window.bimEngine.scene.children).call(n,(function(e){return"HighLightGroup"==e.name})),a=(i=n[0],Wt(d));try{for(a.s();!(e=a.n()).done;){var l,p=Wt(e.value.ElementInfos);try{for(p.s();!(l=p.n()).done;){var g=l.value,y=g.center.clone().project(c),x=s.renderer.domElement.clientWidth/2,w=s.renderer.domElement.clientHeight/2,b={x:Math.round(y.x*x+x),y:Math.round(-y.y*w+w)};g.screenPosition=b}}catch(e){p.e(e)}finally{p.f()}}}catch(e){a.e(e)}finally{a.f()}t=new qt.SelectionHelper(u,"selectBox"),r={startPoint:null,endPoint:null},h.enabled=!1,u.domElement.addEventListener("pointerdown",f,!1),u.domElement.addEventListener("pointermove",m,!1),u.domElement.addEventListener("pointerup",v,!1)},a.DisActive=function(){h.enabled=!0,u.domElement.removeEventListener("pointerdown",f),u.domElement.removeEventListener("pointermove",m),u.domElement.removeEventListener("pointerup",v),t&&(t.element=null,t=null)},a}function Yt(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Zt(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zt(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(2);var Jt=n(2);function Qt(e){n(564)("./"+F()+"/RenderSetDialog.scss"),n(232)("./"+F()+"/FormStyle.scss");var t,r=new Object,i=(r.isActive=!1,e.scene.renderer.domElement.parentElement),a=[{id:"1",color:"linear-gradient(rgb(241, 243, 244), rgb(241, 243, 244))",status:!1},{id:"2",color:"linear-gradient(rgb(40, 44, 53), rgb(248, 249, 249))",status:!1},{id:"3",color:"linear-gradient(rgb(255, 255, 255), rgb(255, 255, 255))",status:!1},{id:"4",color:"linear-gradient(rgb(0, 0, 0), rgb(0, 0, 0))",status:!1},{id:"5",color:"linear-gradient(rgb(127, 191, 225), rgb(198, 226, 255))",status:!1}],l=[{id:"1",label:"",color:"rgb(226, 227, 224)"},{id:"2",label:"",color:"rgb(170, 168, 165)"},{id:"3",label:"",color:"rgb(152, 160, 176)"},{id:"4",label:"",color:"rgb(225, 227, 223)"},{id:"5",label:"",color:"rgb(199, 213, 227)"},{id:"6",label:"",color:"rgb(235, 235, 234)"},{id:"7",label:"",color:"rgb(203, 204, 208)"},{id:"8",label:"",color:"rgb(202, 203, 208)"}];function c(e){var n=t.offsetLeft,r=t.offsetTop,a=e.clientX-n,o=e.clientY-r;t.style.cursor="move",document.onmousemove=function(e){var n=e.clientX-a,r=(e=e.clientY-o,i.offsetWidth-t.offsetWidth),s=i.offsetHeight-t.offsetHeight;s<(e=e<0?0:e)&&(e=s),t.style.left=(n=r<(n=n<0?0:n)?r:n)+"px",t.style.top=e+"px"},document.onmouseup=function(){t.style.cursor="auto",document.onmousemove=function(){}}}return r.Active=function(){if(r.isActive=!0,t)t.style.display="block",t.addEventListener("mousedown",c);else{(t=document.createElement("div")).className="Render-Set-Dialog",t.addEventListener("mousedown",c);var n=((h=((n=((s=document.createElement("div")).className="Feader-Contain",document.createElement("div"))).className="Title",n.innerText="",document.createElement("div"))).className="Close-Btn",h.innerText="",h.onclick=function(){var t;o()(t=e.TopMenu.MenuList).call(t,(function(e){return""===e.label}))[0].domEl.click()},s.appendChild(n),s.appendChild(h),t.appendChild(s),document.createElement("div")),s=((u=((s=((h=(n.className="Main-Contain",t.appendChild(n),document.createElement("div"))).className="Module-Header",document.createElement("div"))).className="Icon",document.createElement("div"))).className="Title",u.innerText="",h.appendChild(s),h.appendChild(u),n.appendChild(h),document.createElement("div")),u=((h=((u=(s.className="Form_Item",n.appendChild(s),document.createElement("div"))).className="Form_Item_Label",u.innerText="",s.appendChild(u),document.createElement("input"))).className="switch",h.type="checkbox",h.checked=!0,h.onchange=function(e){},s.appendChild(h),document.createElement("div")),h=(s=((h=((s=(u.className="Form_Item",n.appendChild(u),document.createElement("div"))).className="Form_Item_Label",s.innerText="",u.appendChild(s),document.createElement("input"))).className="switch",h.type="checkbox",h.checked=!1,h.onchange=function(t){e.RenderSAO.enableRenderSAO(t.target.checked),e.RenderSAO.saoPass.params.output=0,e.RenderSAO.saoPass.params.saoBias=1,e.RenderSAO.saoPass.params.saoBlur=0,e.RenderSAO.saoPass.params.saoBlurDepthCutoff=.1,e.RenderSAO.saoPass.params.saoBlurRadius=1,e.RenderSAO.saoPass.params.saoBlurStdDev=5,e.RenderSAO.saoPass.params.saoIntensity=.18,e.RenderSAO.saoPass.params.saoKernelRadius=5,e.RenderSAO.saoPass.params.saoMinResolution=0,e.RenderSAO.saoPass.params.saoScale=2},u.appendChild(h),document.createElement("div")),u=((h=((u=(s.className="Form_Item",n.appendChild(s),document.createElement("div"))).className="Form_Item_Label",u.innerText="",s.appendChild(u),document.createElement("input"))).className="switch",h.type="checkbox",h.checked=!1,h.onchange=function(e){r.DisplayEdge(e.target.checked)},s.appendChild(h),document.createElement("div")),s=((h=((s=(u.className="Module-Header",document.createElement("div"))).className="Icon",document.createElement("div"))).className="Title",h.innerText="",u.appendChild(s),u.appendChild(h),n.appendChild(u),document.createElement("div")),(u=((h=(s.className="Form_Item",n.appendChild(s),document.createElement("div"))).className="Form_Item_Label",h.innerText="",s.appendChild(h),document.createElement("input"))).className="inputtext",u.type="number",u.min=0,u.max=1,u.step=.1,u.value=.2,u.onchange=function(t){e.RenderSAO.saoPass.params.saoIntensity=t.target.value},s.appendChild(u),document.createElement("div")),d=(s=((u=((s=(h.className="Form_Item",n.appendChild(h),document.createElement("div"))).className="Form_Item_Label",s.innerText="",h.appendChild(s),document.createElement("input"))).className="inputtext",u.type="number",u.min=0,u.max=1,u.step=.1,u.value=.6,u.onchange=function(e){r.SetAmbientLightIntensity(e.target.value)},h.appendChild(u),document.createElement("div")),(u=((h=(s.className="Module-Header",document.createElement("div"))).className="Icon",document.createElement("div"))).className="Title",u.innerText="",s.appendChild(h),s.appendChild(u),n.appendChild(s),document.createElement("div"));(h=(d.className="Bg-Color-List",document.createElement("div"))).className="Form_Item_Label",h.innerText="",d.appendChild(h);for(var p=0;p<a.length;p++){var f=document.createElement("div");f.className="Item",f.style.backgroundImage=a[p].color,f.dataset.value=a[p].id,f.dataset.color=a[p].color,(a[p].domEl=f).onclick=function(e){for(var t=0;t<a.length;t++)a[t].id===e.target.dataset.value?a[t].domEl.className="Item Actived":a[t].domEl.className="Item";r.SetBackGroundColor(e.target.dataset.color)},d.appendChild(f)}n.appendChild(d);var m=((h=((s=((u=document.createElement("div")).className="Light-Color-List",document.createElement("div"))).className="Form_Item_Label",s.innerText="",u.appendChild(s),document.createElement("div"))).className="Item-Contain",document.createElement("div"));m.className="Item-Inside-Contain",h.appendChild(m),u.appendChild(h);for(var v=0;v<l.length;v++){var g=document.createElement("div"),y=(g.className="Item",document.createElement("div")),x=(y.className="Legened",y.style.backgroundColor=l[v].color,document.createElement("div"));x.className="Title",x.innerText=l[v].label,g.appendChild(y),g.appendChild(x),g.dataset.value=l[v].id,g.dataset.color=l[v].color,(l[v].domEl=g).onclick=function(e){for(var t=0;t<l.length;t++)l[t].id===e.target.dataset.value?l[t].domEl.className="Item Actived":l[t].domEl.className="Item";r.SetAmbientLightColor(e.target.dataset.color)},m.appendChild(g)}n.appendChild(u),i.appendChild(t)}},r.DisActive=function(){r.isActive=!1,t.style.display="none",t.style.left="0px",t.style.top="0px",t.removeEventListener("mousedown",c)},r.DisplayEdge=function(t){var n,r,i,a,l;if(t){var c,u=new Jt.LineBasicMaterial({color:"#000000"}),h=Yt(e.AllEdgeList);try{for(h.s();!(c=h.n()).done;){var d=c.value;d.Created||(d.Created=!0,n=d.Indexs,r=d.EdgeList,i=d.ElementInfos,a=u,l=void 0,(l=new Jt.BufferGeometry).setAttribute("position",new Jt.Float32BufferAttribute(r,3)),(r=new Jt.LineSegments(l,a)).indexO=n,r.name="ModelEdges",r.TypeName="ModelEdges",r.ElementInfos=i,r.visible=!0,window.bimEngine.scene.add(r),window.bimEngine.RenderUpdata())}}catch(n){h.e(n)}finally{h.f()}}var p=o()(p=e.scene.children).call(p,(function(e){return"ModelEdges"==e.name}));s()(p).call(p,(function(e){e.visible=t})),e.RenderUpdata()},r.SetBackGroundColor=function(t){e.scene.renderer.domElement.parentElement.style.background=t},r.SetAmbientLightColor=function(t){e.scene.ambientLight.color=new Jt.Color(t),e.RenderUpdata()},r.SetAmbientLightIntensity=function(t){e.scene.ambientLight.intensity=t,e.RenderUpdata()},r}const Kt=1001,$t=1003,en=1006,tn=1008,nn=1015,rn=1020,an=1022,on=1023,sn=1026,ln=1027,cn=3e3,un=35044,hn=35048;function dn(){}Object.assign(dn.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){var n;return void 0!==this._listeners&&void 0!==(n=this._listeners)[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){var n;void 0!==this._listeners&&void 0!==(e=this._listeners[e])&&-1!==(n=e.indexOf(t))&&e.splice(n,1)},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;var n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}}});const pn=[];for(let e=0;e<256;e++)pn[e]=(e<16?"0":"")+e.toString(16);let fn=1234567;const mn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(pn[255&e]+pn[e>>8&255]+pn[e>>16&255]+pn[e>>24&255]+"-"+pn[255&t]+pn[t>>8&255]+"-"+pn[t>>16&15|64]+pn[t>>24&255]+"-"+pn[63&n|128]+pn[n>>8&255]+"-"+pn[n>>16&255]+pn[n>>24&255]+pn[255&r]+pn[r>>8&255]+pn[r>>16&255]+pn[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,r){return mn.lerp(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(mn.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return((fn=16807*(fn=void 0!==e?e%2147483647:fn)%2147483647)-1)/2147483646},degToRad:function(e){return e*mn.DEG2RAD},radToDeg:function(e){return e*mn.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),c=a((t+r)/2),u=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),p=a((r-t)/2),f=o((r-t)/2);switch(i){case"XYX":e.set(s*u,l*h,l*d,s*c);break;case"YZY":e.set(l*d,s*u,l*h,s*c);break;case"ZXZ":e.set(l*h,l*d,s*u,s*c);break;case"XZX":e.set(s*u,l*f,l*p,s*c);break;case"YXY":e.set(l*p,s*u,l*f,s*c);break;case"ZYZ":e.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};class vn{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){var t=this.x,n=this.y;e=e.elements;return this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){var t=this.x-e.x;return t*t+(e=this.y-e.y)*e}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){var n=Math.cos(t),r=(t=Math.sin(t),this.x-e.x),i=this.y-e.y;return this.x=r*n-i*t+e.x,this.y=r*t+i*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}vn.prototype.isVector2=!0;class gn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,i,a,o,s,l){var c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){var t=this.elements;e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){e=e.elements,t=t.elements;var n=this.elements,r=e[0],i=e[3],a=e[6],o=e[1],s=e[4],l=e[7],c=e[2],u=e[5],h=(e=e[8],t[0]),d=t[3],p=t[6],f=t[1],m=t[4],v=t[7],g=t[2],y=t[5];t=t[8];return n[0]=r*h+i*f+a*g,n[3]=r*d+i*m+a*y,n[6]=r*p+i*v+a*t,n[1]=o*h+s*f+l*g,n[4]=o*d+s*m+l*y,n[7]=o*p+s*v+l*t,n[2]=c*h+u*f+e*g,n[5]=c*d+u*m+e*y,n[8]=c*p+u*v+e*t,this}multiplyScalar(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){var e,t=(e=this.elements)[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7];return t*a*(e=e[8])-t*o*l-n*i*e+n*o*s+r*i*l-r*a*s}invert(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,h=o*s-c*i,d=l*i-a*s,p=t*u+n*h+r*d;return 0==p?this.set(0,0,0,0,0,0,0,0,0):(e[0]=u*(u=1/p),e[1]=(r*l-c*n)*u,e[2]=(o*n-r*a)*u,e[3]=h*u,e[4]=(c*t-r*s)*u,e[5]=(r*i-o*t)*u,e[6]=d*u,e[7]=(n*s-l*t)*u,e[8]=(a*t-n*i)*u,this)}transpose(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,o){var s=Math.cos(i);i=Math.sin(i);return this.set(n*s,n*i,-n*(s*a+i*o)+a+e,-r*i,r*s,-r*(-i*a+s*o)+o+t,0,0,1),this}scale(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){var t=Math.cos(e),n=(e=Math.sin(e),this.elements),r=n[0],i=n[3],a=n[6],o=n[1],s=n[4],l=n[7];return n[0]=t*r+e*o,n[3]=t*i+e*s,n[6]=t*a+e*l,n[1]=-e*r+t*o,n[4]=-e*i+t*s,n[7]=-e*a+t*l,this}translate(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){var t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let yn;gn.prototype.isMatrix3=!0;const xn={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;var n;return 2048<(t=e instanceof HTMLCanvasElement?e:((yn=void 0===yn?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):yn).width=e.width,yn.height=e.height,n=yn.getContext("2d"),e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),yn)).width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let wn=0;class bn extends dn{constructor(e=bn.DEFAULT_IMAGE,t=bn.DEFAULT_MAPPING,n=Kt,r=Kt,i=en,a=tn,o=on,s=1009,l=1,c=cn){super(),Object.defineProperty(this,"id",{value:wn++}),this.uuid=mn.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new vn(0,0),this.repeat=new vn(1,1),this.center=new vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new gn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=mn.generateUUID()),!t&&void 0===e.images[r.uuid]){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(_n(r[e].image)):t.push(_n(r[e]))}else t=_n(r);e.images[r.uuid]={uuid:r.uuid,url:t}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case Kt:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case Kt:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}return e}set needsUpdate(e){!0===e&&this.version++}}function _n(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?xn.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}bn.DEFAULT_IMAGE=void 0,bn.DEFAULT_MAPPING=300,bn.prototype.isTexture=!0;class Mn{constructor(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){var t=this.x,n=this.y,r=this.z,i=this.w;e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;var a,o,s,l,c,u,h=(e=e.elements)[0],d=e[4],p=e[8],f=e[1],m=e[5],v=e[9],g=e[2],y=e[6];e=e[10];if(Math.abs(d-f)<.01&&Math.abs(p-g)<.01&&Math.abs(v-y)<.01)Math.abs(d+f)<.1&&Math.abs(p+g)<.1&&Math.abs(v+y)<.1&&Math.abs(h+m+e-3)<.1?this.set(1,0,0,0):(t=Math.PI,s=(e+1)/2,l=(d+f)/4,c=(p+g)/4,u=(v+y)/4,(o=(m+1)/2)<(a=(h+1)/2)&&s<a?i=a<.01?(n=0,r=.707106781):(n=Math.sqrt(a),r=l/n,c/n):s<o?i=o<.01?(n=.707106781,r=0,.707106781):(r=Math.sqrt(o),n=l/r,u/r):s<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(s),n=c/i,r=u/i),this.set(n,r,i,t));else{let t=Math.sqrt((y-v)*(y-v)+(p-g)*(p-g)+(f-d)*(f-d));Math.abs(t)<.001&&(t=1),this.x=(y-v)/t,this.y=(p-g)/t,this.z=(f-d)/t,this.w=Math.acos((h+m+e-1)/2)}return this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Mn.prototype.isVector4=!0;class En extends dn{constructor(e,t,n){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Mn(0,0,e,t),this.scissorTest=!1,this.viewport=new Mn(0,0,e,t),n=n||{},this.texture=new bn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:en,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}En.prototype.isWebGLRenderTarget=!0;class Sn{constructor(e=0,t=0,n=0,r=1){this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return n.copy(e).slerp(t,r)}static slerpFlat(e,t,n,r,i,a,o){let s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];n=i[a+0],r=i[a+1];var h=i[a+2];i=i[a+3];if(0===o)e[t+0]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u;else if(1===o)e[t+0]=n,e[t+1]=r,e[t+2]=h,e[t+3]=i;else{if(u!==i||s!==n||l!==r||c!==h){let e=1-o;var d=0<=(a=s*n+l*r+c*h+u*i)?1:-1,p=1-a*a;a=(p>Number.EPSILON&&(p=Math.sqrt(p),a=Math.atan2(p,a*d),e=Math.sin(e*a)/p,o=Math.sin(o*a)/p),o*d);s=s*e+n*a,l=l*e+r*a,c=c*e+h*a,u=u*e+i*a,e===1-o&&(s*=p=1/Math.sqrt(s*s+l*l+c*c+u*u),l*=p,c*=p,u*=p)}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}}static multiplyQuaternionsFlat(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],c=(n=n[r+3],r=i[a],i[a+1]),u=i[a+2];i=i[a+3];return e[t]=o*i+n*r+s*u-l*c,e[t+1]=s*i+n*c+l*r-o*u,e[t+2]=l*i+n*u+o*c-s*r,e[t+3]=n*i-o*r-s*c-l*u,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=(e=Math.cos,Math.sin),s=e(n/2),l=e(r/2),c=e(i/2),u=o(n/2),h=o(r/2),d=o(i/2);switch(a){case"XYZ":this._x=u*l*c+s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c-u*h*d;break;case"YXZ":this._x=u*l*c+s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c+u*h*d;break;case"ZXY":this._x=u*l*c-s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c-u*h*d;break;case"ZYX":this._x=u*l*c-s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c+u*h*d;break;case"YZX":this._x=u*l*c+s*h*d,this._y=s*h*c+u*l*d,this._z=s*l*d-u*h*c,this._w=s*l*c-u*h*d;break;case"XZY":this._x=u*l*c-s*h*d,this._y=s*h*c-u*l*d,this._z=s*l*d+u*h*c,this._w=s*l*c+u*h*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){t/=2;var n=Math.sin(t);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(t),this._onChangeCallback(),this}setFromRotationMatrix(e){var t=(e=e.elements)[0],n=e[4],r=e[8],i=e[1],a=e[5],o=e[9],s=e[2],l=e[6],c=t+a+(e=e[10]);return 0<c?(c=.5/Math.sqrt(c+1),this._w=.25/c,this._x=(l-o)*c,this._y=(r-s)*c,this._z=(i-n)*c):a<t&&e<t?(c=2*Math.sqrt(1+t-a-e),this._w=(l-o)/c,this._x=.25*c,this._y=(n+i)/c,this._z=(r+s)/c):e<a?(c=2*Math.sqrt(1+a-t-e),this._w=(r-s)/c,this._x=(n+i)/c,this._y=.25*c,this._z=(o+l)/c):(c=2*Math.sqrt(1+e-t-a),this._w=(i-n)/c,this._x=(r+s)/c,this._y=(o+l)/c,this._z=.25*c),this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mn.clamp(this.dot(e),-1,1)))}rotateTowards(e,t){var n=this.angleTo(e);return 0!==n&&(t=Math.min(1,t/n),this.slerp(e,t)),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(e=1/e),this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){var n=e._x,r=e._y,i=e._z,a=(e=e._w,t._x),o=t._y,s=t._z;t=t._w;return this._x=n*t+e*a+r*s-i*o,this._y=r*t+e*o+i*a-n*s,this._z=i*t+e*s+n*o-r*a,this._w=e*t-n*a-r*o-i*s,this._onChangeCallback(),this}slerp(e,t){if(0!==t){if(1===t)return this.copy(e);var n,r,i=this._x,a=this._y,o=this._z,s=this._w;let l=s*e._w+i*e._x+a*e._y+o*e._z;l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),1<=l?(this._w=s,this._x=i,this._y=a,this._z=o):((e=1-l*l)<=Number.EPSILON?(this._w=(n=1-t)*s+t*this._w,this._x=n*i+t*this._x,this._y=n*a+t*this._y,this._z=n*o+t*this._z,this.normalize()):(n=Math.sqrt(e),e=Math.atan2(n,l),r=Math.sin((1-t)*e)/n,t=Math.sin(t*e)/n,this._w=s*r+this._w*t,this._x=i*r+this._x*t,this._y=a*r+this._y*t,this._z=o*r+this._z*t),this._onChangeCallback())}return this}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Sn.prototype.isQuaternion=!0;class Tn{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ln.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Ln.setFromAxisAngle(e,t))}applyMatrix3(e){var t=this.x,n=this.y,r=this.z;e=e.elements;return this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){var t=this.x,n=this.y,r=this.z,i=1/((e=e.elements)[3]*t+e[7]*n+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i,this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i,this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i,this}applyQuaternion(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=(e=e.w)*t+a*r-o*n,l=e*n+o*t-i*r,c=e*r+i*n-a*t;t=-i*t-a*n-o*r;return this.x=s*e+t*-i+l*-o-c*-a,this.y=l*e+t*-a+c*-i-s*-o,this.z=c*e+t*-o+s*-a-l*-i,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){var t=this.x,n=this.y,r=this.z;e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){var n=e.x,r=e.y,i=(e=e.z,t.x),a=t.y;t=t.z;return this.x=r*t-e*a,this.y=e*i-n*t,this.z=n*a-r*i,this}projectOnVector(e){var t=e.lengthSq();return 0===t?this.set(0,0,0):(t=e.dot(this)/t,this.copy(e).multiplyScalar(t))}projectOnPlane(e){return An.copy(this).projectOnVector(e),this.sub(An)}reflect(e){return this.sub(An.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:(e=this.dot(e)/t,Math.acos(mn.clamp(e,-1,1)))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n+(e=this.z-e.z)*e}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();e=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=e,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}Tn.prototype.isVector3=!0;const An=new Tn,Ln=new Sn;class Cn{constructor(e=new Tn(1/0,1/0,1/0),t=new Tn(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let u=0,h=e.length;u<h;u+=3){var s=e[u],l=e[u+1],c=e[u+2];s<t&&(t=s),l<n&&(n=l),c<r&&(r=c),s>i&&(i=s),l>a&&(a=l),c>o&&(o=c)}return this.min.set(t,n,r),this.max.set(i,a,o),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let u=0,h=e.count;u<h;u++){var s=e.getX(u),l=e.getY(u),c=e.getZ(u);s<t&&(t=s),l<n&&(n=l),c<r&&(r=c),s>i&&(i=s),l>a&&(a=l),c>o&&(o=c)}return this.min.set(t,n,r),this.max.set(i,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){return t=Rn.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Tn),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Tn),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);var t=e.geometry,n=(void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),In.copy(t.boundingBox),In.applyMatrix4(e.matrixWorld),this.union(In)),e.children);for(let e=0,t=n.length;e<t;e++)this.expandByObject(n[e]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Tn),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Rn),Rn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){return!this.isEmpty()&&(this.getCenter(Fn),Un.subVectors(this.max,Fn),kn.subVectors(e.a,Fn),Dn.subVectors(e.b,Fn),zn.subVectors(e.c,Fn),Nn.subVectors(Dn,kn),On.subVectors(zn,Dn),Bn.subVectors(kn,zn),!!Gn([0,-Nn.z,Nn.y,0,-On.z,On.y,0,-Bn.z,Bn.y,Nn.z,0,-Nn.x,On.z,0,-On.x,Bn.z,0,-Bn.x,-Nn.y,Nn.x,0,-On.y,On.x,0,-Bn.y,Bn.x,0],kn,Dn,zn,Un))&&!!Gn([1,0,0,0,1,0,0,0,1],kn,Dn,zn,Un)&&(Hn.crossVectors(Nn,On),Gn([Hn.x,Hn.y,Hn.z],kn,Dn,zn,Un))}clampPoint(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Tn),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Rn.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Rn).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Pn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Pn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Pn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Pn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Pn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Pn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Pn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Pn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Pn)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Cn.prototype.isBox3=!0;const Pn=[new Tn,new Tn,new Tn,new Tn,new Tn,new Tn,new Tn,new Tn],Rn=new Tn,In=new Cn,kn=new Tn,Dn=new Tn,zn=new Tn,Nn=new Tn,On=new Tn,Bn=new Tn,Fn=new Tn,Un=new Tn,Hn=new Tn,Vn=new Tn;function Gn(e,t,n,r,i){for(let c=0,u=e.length-3;c<=u;c+=3){Vn.fromArray(e,c);var a=i.x*Math.abs(Vn.x)+i.y*Math.abs(Vn.y)+i.z*Math.abs(Vn.z),o=t.dot(Vn),s=n.dot(Vn),l=r.dot(Vn);if(Math.max(-Math.max(o,s,l),Math.min(o,s,l))>a)return!1}return!0}const Wn=new Cn;class jn{constructor(e=new Tn,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){var n=this.center;void 0!==t?n.copy(t):Wn.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Tn),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Cn),this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const qn=new Tn,Xn=new Tn,Yn=new Tn,Zn=new Tn,Jn=new Tn,Qn=new Tn,Kn=new Tn;class $n{constructor(e=new Tn,t=new Tn(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Tn),t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,qn)),this}closestPointToPoint(e,t){return void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Tn),t.subVectors(e,this.origin),(e=t.dot(this.direction))<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){var t=qn.subVectors(e,this.origin).dot(this.direction);return(t<0?this.origin:(qn.copy(this.direction).multiplyScalar(t).add(this.origin),qn)).distanceToSquared(e)}distanceSqToSegment(e,t,n,r){Xn.copy(e).add(t).multiplyScalar(.5),Yn.copy(t).sub(e).normalize(),Zn.copy(this.origin).sub(Xn);e=.5*e.distanceTo(t),t=-this.direction.dot(Yn);var i=Zn.dot(this.direction),a=-Zn.dot(Yn),o=Zn.lengthSq(),s=Math.abs(1-t*t);let l,c,u,h;return u=0<s?(l=t*a-i,c=t*i-a,h=e*s,0<=l?c>=-h?c<=h?(l*=s=1/s,c*=s,l*(l+t*c+2*i)+c*(t*l+c+2*a)+o):(c=e,-(l=Math.max(0,-(t*c+i)))*l+c*(c+2*a)+o):(c=-e,-(l=Math.max(0,-(t*c+i)))*l+c*(c+2*a)+o):c<=-h?(l=Math.max(0,-(-t*e+i)),c=0<l?-e:Math.min(Math.max(-e,-a),e),-l*l+c*(c+2*a)+o):c<=h?(l=0,(c=Math.min(Math.max(-e,-a),e))*(c+2*a)+o):(l=Math.max(0,-(t*e+i)),c=0<l?e:Math.min(Math.max(-e,-a),e),-l*l+c*(c+2*a)+o)):(c=0<t?-e:e,-(l=Math.max(0,-(t*c+i)))*l+c*(c+2*a)+o),n&&n.copy(this.direction).multiplyScalar(l).add(this.origin),r&&r.copy(Yn).multiplyScalar(c).add(Xn),u}intersectSphere(e,t){qn.subVectors(e.center,this.origin);var n=qn.dot(this.direction),r=qn.dot(qn)-n*n;return(e=e.radius*e.radius)<r||(r=n+(e=Math.sqrt(e-r)),(n-=e)<0&&r<0)?null:n<0?this.at(r,t):this.at(n,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){var t=e.normal.dot(this.direction);return 0===t?0===e.distanceToPoint(this.origin)?0:null:0<=(e=-(this.origin.dot(e.normal)+e.constant)/t)?e:null}intersectPlane(e,t){return null===(e=this.distanceToPlane(e))?null:this.at(e,t)}intersectsPlane(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,o,s;var l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return r=0<=l?(n=(e.min.x-h.x)*l,(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,(e.min.x-h.x)*l),a=0<=c?(i=(e.min.y-h.y)*c,(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,(e.min.y-h.y)*c),n>a||i>r||((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),s=0<=u?(o=(e.min.z-h.z)*u,(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,(e.min.z-h.z)*u),n>s)||o>r||((o>n||n!=n)&&(n=o),(r=s<r||r!=r?s:r)<0)?null:this.at(0<=n?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,qn)}intersectTriangle(e,t,n,r,i){Jn.subVectors(t,e),Qn.subVectors(n,e),Kn.crossVectors(Jn,Qn);let a,o=this.direction.dot(Kn);if(0<o){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}return Zn.subVectors(this.origin,e),(t=a*this.direction.dot(Qn.crossVectors(Zn,Qn)))<0||(n=a*this.direction.dot(Jn.cross(Zn)))<0||t+n>o||(r=-a*Zn.dot(Kn))<0?null:this.at(r/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class er{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,i,a,o,s,l,c,u,h,d,p,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new er).fromArray(this.elements)}copy(e){var t=this.elements;e=e.elements;return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this}copyPosition(e){var t=this.elements;e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this}setFromMatrix3(e){return e=e.elements,this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){var t=this.elements,n=e.elements,r=1/tr.setFromMatrixColumn(e,0).length(),i=1/tr.setFromMatrixColumn(e,1).length();e=1/tr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t,n,r,i,a=this.elements,o=e.x,s=e.y,l=e.z,c=Math.cos(o),u=(o=Math.sin(o),Math.cos(s)),h=(s=Math.sin(s),Math.cos(l));l=Math.sin(l);return"XYZ"===e.order?(n=c*h,r=c*l,i=o*h,t=o*l,a[0]=u*h,a[4]=-u*l,a[8]=s,a[1]=r+i*s,a[5]=n-t*s,a[9]=-o*u,a[2]=t-n*s,a[6]=i+r*s,a[10]=c*u):"YXZ"===e.order?(t=u*l,n=s*h,a[0]=(i=u*h)+(r=s*l)*o,a[4]=n*o-t,a[8]=c*s,a[1]=c*l,a[5]=c*h,a[9]=-o,a[2]=t*o-n,a[6]=r+i*o,a[10]=c*u):"ZXY"===e.order?(t=u*l,n=s*h,a[0]=(r=u*h)-(i=s*l)*o,a[4]=-c*l,a[8]=n+t*o,a[1]=t+n*o,a[5]=c*h,a[9]=i-r*o,a[2]=-c*s,a[6]=o,a[10]=c*u):"ZYX"===e.order?(t=c*h,n=c*l,i=o*h,r=o*l,a[0]=u*h,a[4]=i*s-n,a[8]=t*s+r,a[1]=u*l,a[5]=r*s+t,a[9]=n*s-i,a[2]=-s,a[6]=o*u,a[10]=c*u):"YZX"===e.order?(r=c*u,t=c*s,n=o*u,i=o*s,a[0]=u*h,a[4]=i-r*l,a[8]=n*l+t,a[1]=l,a[5]=c*h,a[9]=-o*h,a[2]=-s*h,a[6]=t*l+n,a[10]=r-i*l):"XZY"===e.order&&(t=c*u,n=c*s,r=o*u,i=o*s,a[0]=u*h,a[4]=-l,a[8]=s*h,a[1]=t*l+i,a[5]=c*h,a[9]=n*l-r,a[2]=r*l-n,a[6]=o*h,a[10]=i*l+t),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rr,e,ir)}lookAt(e,t,n){var r=this.elements;return sr.subVectors(e,t),0===sr.lengthSq()&&(sr.z=1),sr.normalize(),ar.crossVectors(n,sr),0===ar.lengthSq()&&(1===Math.abs(n.z)?sr.x+=1e-4:sr.z+=1e-4,sr.normalize(),ar.crossVectors(n,sr)),ar.normalize(),or.crossVectors(sr,ar),r[0]=ar.x,r[4]=or.x,r[8]=sr.x,r[1]=ar.y,r[5]=or.y,r[9]=sr.y,r[2]=ar.z,r[6]=or.z,r[10]=sr.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){e=e.elements,t=t.elements;var n=this.elements,r=e[0],i=e[4],a=e[8],o=e[12],s=e[1],l=e[5],c=e[9],u=e[13],h=e[2],d=e[6],p=e[10],f=e[14],m=e[3],v=e[7],g=e[11],y=(e=e[15],t[0]),x=t[4],w=t[8],b=t[12],_=t[1],M=t[5],E=t[9],S=t[13],T=t[2],A=t[6],L=t[10],C=t[14],P=t[3],R=t[7],I=t[11];t=t[15];return n[0]=r*y+i*_+a*T+o*P,n[4]=r*x+i*M+a*A+o*R,n[8]=r*w+i*E+a*L+o*I,n[12]=r*b+i*S+a*C+o*t,n[1]=s*y+l*_+c*T+u*P,n[5]=s*x+l*M+c*A+u*R,n[9]=s*w+l*E+c*L+u*I,n[13]=s*b+l*S+c*C+u*t,n[2]=h*y+d*_+p*T+f*P,n[6]=h*x+d*M+p*A+f*R,n[10]=h*w+d*E+p*L+f*I,n[14]=h*b+d*S+p*C+f*t,n[3]=m*y+v*_+g*T+e*P,n[7]=m*x+v*M+g*A+e*R,n[11]=m*w+v*E+g*L+e*I,n[15]=m*b+v*S+g*C+e*t,this}multiplyScalar(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*l*u-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*c-i*s*c)+e[11]*(+t*l*u-t*o*d-i*a*u+n*a*d+i*o*c-n*l*c)+e[15]*(-r*o*c-t*s*u+t*o*h+r*a*u-n*a*h+n*s*c)}transpose(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],m=e[14],v=e[15],g=u*m*l-f*h*l+f*s*d-o*m*d-u*s*v+o*h*v,y=p*h*l-c*m*l-p*s*d+a*m*d+c*s*v-a*h*v,x=c*f*l-p*u*l+p*o*d-a*f*d-c*o*v+a*u*v,w=p*u*s-c*f*s-p*o*h+a*f*h+c*o*m-a*u*m,b=t*g+n*y+r*x+i*w;return 0==b?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=g*(g=1/b),e[1]=(f*h*i-u*m*i-f*r*d+n*m*d+u*r*v-n*h*v)*g,e[2]=(o*m*i-f*s*i+f*r*l-n*m*l-o*r*v+n*s*v)*g,e[3]=(u*s*i-o*h*i-u*r*l+n*h*l+o*r*d-n*s*d)*g,e[4]=y*g,e[5]=(c*m*i-p*h*i+p*r*d-t*m*d-c*r*v+t*h*v)*g,e[6]=(p*s*i-a*m*i-p*r*l+t*m*l+a*r*v-t*s*v)*g,e[7]=(a*h*i-c*s*i+c*r*l-t*h*l-a*r*d+t*s*d)*g,e[8]=x*g,e[9]=(p*u*i-c*f*i-p*n*d+t*f*d+c*n*v-t*u*v)*g,e[10]=(a*f*i-p*o*i+p*n*l-t*f*l-a*n*v+t*o*v)*g,e[11]=(c*o*i-a*u*i-c*n*l+t*u*l+a*n*d-t*o*d)*g,e[12]=w*g,e[13]=(c*f*r-p*u*r+p*n*h-t*f*h-c*n*m+t*u*m)*g,e[14]=(p*o*r-a*f*r-p*n*s+t*f*s+a*n*m-t*o*m)*g,e[15]=(a*u*r-c*o*r+c*n*s-t*u*s-a*n*h+t*o*h)*g,this)}scale(e){var t=this.elements,n=e.x,r=e.y;e=e.z;return t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this}getMaxScaleOnAxis(){var e=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],t=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(e,t,n))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){var t=Math.cos(e);e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this}makeRotationY(e){var t=Math.cos(e);e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this}makeRotationZ(e){var t=Math.cos(e);e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){var n=Math.cos(t),r=(t=Math.sin(t),1-n),i=e.x,a=e.y,o=(e=e.z,r*i),s=r*a;return this.set(o*i+n,o*a-t*e,o*e+t*a,0,o*a+t*e,s*a+n,s*e-t*i,0,o*e-t*a,s*e+t*i,r*e*e+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}compose(e,t,n){var r=this.elements,i=(o=t._x)*(u=o+o),a=o*(h=(l=t._y)+l),o=o*(d=(c=t._z)+c),s=l*h,l=l*d,c=c*d,u=(t=t._w)*u,h=t*h,d=(t=t*d,n.x),p=n.y;n=n.z;return r[0]=(1-(s+c))*d,r[1]=(a+t)*d,r[2]=(o-h)*d,r[3]=0,r[4]=(a-t)*p,r[5]=(1-(i+c))*p,r[6]=(l+u)*p,r[7]=0,r[8]=(o+h)*n,r[9]=(l-u)*n,r[10]=(1-(i+s))*n,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){var r=this.elements;let i=tr.set(r[0],r[1],r[2]).length();var a=tr.set(r[4],r[5],r[6]).length(),o=tr.set(r[8],r[9],r[10]).length(),s=(e=(this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],nr.copy(this),1/i),r=1/a,1/o);return nr.elements[0]*=e,nr.elements[1]*=e,nr.elements[2]*=e,nr.elements[4]*=r,nr.elements[5]*=r,nr.elements[6]*=r,nr.elements[8]*=s,nr.elements[9]*=s,nr.elements[10]*=s,t.setFromRotationMatrix(nr),n.x=i,n.y=a,n.z=o,this}makePerspective(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(n-r),l=(t+e)/(t-e);n=(n+r)/(n-r),r=-(a+i)/(a-i),a=-2*a*i/(a-i);return o[0]=2*i/(t-e),o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=s,o[9]=n,o[13]=0,o[2]=0,o[6]=0,o[10]=r,o[14]=a,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),l=1/(n-r),c=1/(a-i);t=(t+e)*s,e=(n+r)*l,n=(a+i)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-t,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-e,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-n,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){var t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}er.prototype.isMatrix4=!0;const tr=new Tn,nr=new er,rr=new Tn(0,0,0),ir=new Tn(1,1,1),ar=new Tn,or=new Tn,sr=new Tn,lr=new er,cr=new Sn;class ur{constructor(e=0,t=0,n=0,r=ur.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t,n){var r=mn.clamp,i=(e=e.elements)[0],a=e[4],o=e[8],s=e[1],l=e[5],c=e[9],u=e[2],h=e[6],d=e[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return lr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(lr,t,n)}setFromVector3(e,t){return this.set(e.x,e.y,e.z,t||this._order)}reorder(e){return cr.setFromEuler(this),this.setFromQuaternion(cr,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new Tn(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}ur.prototype.isEuler=!0,ur.DefaultOrder="XYZ",ur.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class hr{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}}let dr=0;const pr=new Tn,fr=new Sn,mr=new er,vr=new Tn,gr=new Tn,yr=new Tn,xr=new Sn,wr=new Tn(1,0,0),br=new Tn(0,1,0),_r=new Tn(0,0,1),Mr={type:"added"},Er={type:"removed"};function Sr(){Object.defineProperty(this,"id",{value:dr++}),this.uuid=mn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Sr.DefaultUp.clone();var e=new Tn;const t=new ur,n=new Sn;var r=new Tn(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new er},normalMatrix:{value:new gn}}),this.matrix=new er,this.matrixWorld=new er,this.matrixAutoUpdate=Sr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Sr.DefaultUp=new Tn(0,1,0),Sr.DefaultMatrixAutoUpdate=!0,Sr.prototype=Object.assign(Object.create(dn.prototype),{constructor:Sr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return fr.setFromAxisAngle(e,t),this.quaternion.multiply(fr),this},rotateOnWorldAxis:function(e,t){return fr.setFromAxisAngle(e,t),this.quaternion.premultiply(fr),this},rotateX:function(e){return this.rotateOnAxis(wr,e)},rotateY:function(e){return this.rotateOnAxis(br,e)},rotateZ:function(e){return this.rotateOnAxis(_r,e)},translateOnAxis:function(e,t){return pr.copy(e).applyQuaternion(this.quaternion),this.position.add(pr.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(wr,e)},translateY:function(e){return this.translateOnAxis(br,e)},translateZ:function(e){return this.translateOnAxis(_r,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(mr.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?vr.copy(e):vr.set(e,t,n),e=this.parent,this.updateWorldMatrix(!0,!1),gr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mr.lookAt(gr,vr,this.up):mr.lookAt(vr,gr,this.up),this.quaternion.setFromRotationMatrix(mr),e&&(mr.extractRotation(e.matrixWorld),fr.setFromRotationMatrix(mr),this.quaternion.premultiply(fr.invert()))},add:function(e){if(1<arguments.length)for(let e=0;e<arguments.length;e++)this.add(arguments[e]);else e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),(e.parent=this).children.push(e),e.dispatchEvent(Mr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e);return this},remove:function(e){if(1<arguments.length)for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);else{var t=this.children.indexOf(e);-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Er))}return this},clear:function(){for(let t=0;t<this.children.length;t++){var e=this.children[t];e.parent=null,e.dispatchEvent(Er)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),mr.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),mr.multiply(e.parent.matrixWorld)),e.applyMatrix4(mr),this.add(e),e.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){var n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Tn),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Sn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gr,e,yr),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Tn),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gr,xr,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Tn),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);var t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);var t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));var t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){var r=this.children;for(let e=0,t=r.length;e<t;e++)r[e].updateWorldMatrix(!1,!0)}},toJSON:function(e){var t,n,r,i,a,o=void 0===e||"string"==typeof e,s={},l=(o&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},s.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),{});function c(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(l.uuid=this.uuid,l.type=this.type,""!==this.name&&(l.name=this.name),!0===this.castShadow&&(l.castShadow=!0),!0===this.receiveShadow&&(l.receiveShadow=!0),!1===this.visible&&(l.visible=!1),!1===this.frustumCulled&&(l.frustumCulled=!1),0!==this.renderOrder&&(l.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){l.geometry=c(e.geometries,this.geometry);var u=this.geometry.parameters;if(void 0!==u&&void 0!==u.shapes){var h=u.shapes;if(Array.isArray(h))for(let t=0,n=h.length;t<n;t++){var d=h[t];c(e.shapes,d)}else c(e.shapes,h)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton)&&(c(e.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid),void 0!==this.material)if(Array.isArray(this.material)){var p=[];for(let t=0,n=this.material.length;t<n;t++)p.push(c(e.materials,this.material[t]));l.material=p}else l.material=c(e.materials,this.material);if(0<this.children.length){l.children=[];for(let t=0;t<this.children.length;t++)l.children.push(this.children[t].toJSON(e).object)}if(0<this.animations.length){l.animations=[];for(let t=0;t<this.animations.length;t++){var f=this.animations[t];l.animations.push(c(e.animations,f))}}return o&&(u=m(e.geometries),o=m(e.materials),t=m(e.textures),n=m(e.images),r=m(e.shapes),i=m(e.skeletons),a=m(e.animations),0<u.length&&(s.geometries=u),0<o.length&&(s.materials=o),0<t.length&&(s.textures=t),0<n.length&&(s.images=n),0<r.length&&(s.shapes=r),0<i.length&&(s.skeletons=i),0<a.length)&&(s.animations=a),s.object=l,s;function m(e){var t=[];for(const r in e){var n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){var n=e.children[t];this.add(n.clone())}return this}});const Tr=new Tn,Ar=new Tn,Lr=new gn;class Cr{constructor(e=new Tn(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){return n=Tr.subVectors(n,t).cross(Ar.subVectors(e,t)).normalize(),this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Tn),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Tn);var n=e.delta(Tr),r=this.normal.dot(n);return 0===r?0===this.distanceToPoint(e.start)?t.copy(e.start):void 0:(r=-(e.start.dot(this.normal)+this.constant)/r)<0||1<r?void 0:t.copy(n).multiplyScalar(r).add(e.start)}intersectsLine(e){var t=this.distanceToPoint(e.start);e=this.distanceToPoint(e.end);return t<0&&0<e||e<0&&0<t}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Tn),e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){return t=t||Lr.getNormalMatrix(e),e=this.coplanarPoint(Tr).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize(),this.constant=-e.dot(t),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Cr.prototype.isPlane=!0;const Pr=new Tn,Rr=new Tn,Ir=new Tn,kr=new Tn,Dr=new Tn,zr=new Tn,Nr=new Tn,Or=new Tn,Br=new Tn,Fr=new Tn;class Ur{constructor(e=new Tn,t=new Tn,n=new Tn){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){return void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Tn),r.subVectors(n,t),Pr.subVectors(e,t),r.cross(Pr),0<(n=r.lengthSq())?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Pr.subVectors(r,t),Rr.subVectors(n,t),Ir.subVectors(e,t);r=Pr.dot(Pr),n=Pr.dot(Rr),e=Pr.dot(Ir),t=Rr.dot(Rr);var a=Rr.dot(Ir),o=r*t-n*n;return void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Tn),0==o?i.set(-2,-1,-1):i.set(1-(t=(t*e-n*a)*(i=1/o))-(o=(r*a-n*e)*i),o,t)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,kr),0<=kr.x&&0<=kr.y&&kr.x+kr.y<=1}static getUV(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,kr),s.set(0,0),s.addScaledVector(i,kr.x),s.addScaledVector(a,kr.y),s.addScaledVector(o,kr.z),s}static isFrontFacing(e,t,n,r){return Pr.subVectors(n,t),Rr.subVectors(e,t),Pr.cross(Rr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Pr.subVectors(this.c,this.b),Rr.subVectors(this.a,this.b),.5*Pr.cross(Rr).length()}getMidpoint(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Tn),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ur.getNormal(this.a,this.b,this.c,e)}getPlane(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Cr),e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ur.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,i){return Ur.getUV(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Ur.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ur.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Tn);var n=this.a,r=this.b,i=this.c;let a,o;Dr.subVectors(r,n),zr.subVectors(i,n),Or.subVectors(e,n);var s=Dr.dot(Or),l=zr.dot(Or);if(s<=0&&l<=0)return t.copy(n);Br.subVectors(e,r);var c=Dr.dot(Br),u=zr.dot(Br);if(0<=c&&u<=c)return t.copy(r);var h=s*u-c*l;if(h<=0&&0<=s&&c<=0)return a=s/(s-c),t.copy(n).addScaledVector(Dr,a);Fr.subVectors(e,i);e=Dr.dot(Fr);var d=zr.dot(Fr);return 0<=d&&e<=d?t.copy(i):(s=e*l-s*d)<=0&&0<=l&&d<=0?(o=l/(l-d),t.copy(n).addScaledVector(zr,o)):(l=c*d-e*u)<=0&&0<=u-c&&0<=e-d?(Nr.subVectors(i,r),o=(u-c)/(u-c+(e-d)),t.copy(r).addScaledVector(Nr,o)):(a=s*(i=1/(l+s+h)),o=h*i,t.copy(n).addScaledVector(Dr,a).addScaledVector(zr,o))}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Hr=0;function Vr(){Object.defineProperty(this,"id",{value:Hr++}),this.uuid=mn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Vr.prototype=Object.assign(Object.create(dn.prototype),{constructor:Vr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(const r in e){var t,n=e[r];void 0===n?console.warn("THREE.Material: '"+r+"' parameter is undefined."):"shading"===r?(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n):void 0===(t=this[r])?console.warn("THREE."+this.type+": '"+r+"' is not a property of this material."):t&&t.isColor?t.set(n):t&&t.isVector3&&n&&n.isVector3?t.copy(n):this[r]=n}},toJSON:function(e){var t=void 0===e||"string"==typeof e,n=(t&&(e={textures:{},images:{}}),{metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}});function r(e){var t=[];for(const r in e){var n=e[r];delete n.metadata,t.push(n)}return t}return n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity)&&(n.envMapIntensity=this.envMapIntensity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t&&(t=r(e.textures),e=r(e.images),0<t.length&&(n.textures=t),0<e.length)&&(n.images=e),n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes;let n=null;if(null!==t){var r=t.length;n=new Array(r);for(let e=0;e!==r;++e)n[e]=t[e].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Vr.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});const Gr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Wr={h:0,s:0,l:0},jr={h:0,s:0,l:0};function qr(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Xr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Yr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class Zr{constructor(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,n){return this.r=e,this.g=t,this.b=n,this}setHSL(e,t,n){return e=mn.euclideanModulo(e,1),t=mn.clamp(t,0,1),n=mn.clamp(n,0,1),0===t?this.r=this.g=this.b=n:(this.r=qr(t=2*n-(n=n<=.5?n*(1+t):n+t-n*t),n,e+1/3),this.g=qr(t,n,e),this.b=qr(t,n,e-1/3)),this}setStyle(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;var n,r,i,a=s[1],o=s[2];switch(a){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n=parseFloat(e[1])/360,r=parseInt(e[2],10)/100,i=parseInt(e[3],10)/100,t(e[4]),this.setHSL(n,r,i)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=(a=s[1]).length;if(3===s)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,this;if(6===s)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this}setColorName(e){var t=Gr[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){return t=0<t?1/t:1,this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Xr(e.r),this.g=Xr(e.g),this.b=Xr(e.b),this}copyLinearToSRGB(e){return this.r=Yr(e.r),this.g=Yr(e.g),this.b=Yr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t=this.r,n=this.g,r=this.b,i=Math.max(t,n,r),a=Math.min(t,n,r);let o,s;var l=(a+i)/2;if(a===i)o=0,s=0;else{var c=i-a;switch(s=l<=.5?c/(i+a):c/(2-i-a),i){case t:o=(n-r)/c+(n<r?6:0);break;case n:o=(r-t)/c+2;break;case r:o=(t-n)/c+4}o/=6}return e.h=o,e.s=s,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,n){return this.getHSL(Wr),Wr.h+=e,Wr.s+=t,Wr.l+=n,this.setHSL(Wr.h,Wr.s,Wr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Wr),e.getHSL(jr);e=mn.lerp(Wr.h,jr.h,t);var n=mn.lerp(Wr.s,jr.s,t);t=mn.lerp(Wr.l,jr.l,t);return this.setHSL(e,n,t),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Zr.NAMES=Gr,Zr.prototype.isColor=!0,Zr.prototype.r=1,Zr.prototype.g=1,Zr.prototype.b=1;class Jr extends Vr{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}Jr.prototype.isMeshBasicMaterial=!0;const Qr=new Tn,Kr=new vn;function $r(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=un,this.updateRange={offset:0,count:-1},this.version=0}function ei(e,t,n){$r.call(this,new Int8Array(e),t,n)}function ti(e,t,n){$r.call(this,new Uint8Array(e),t,n)}function ni(e,t,n){$r.call(this,new Uint8ClampedArray(e),t,n)}function ri(e,t,n){$r.call(this,new Int16Array(e),t,n)}function ii(e,t,n){$r.call(this,new Uint16Array(e),t,n)}function ai(e,t,n){$r.call(this,new Int32Array(e),t,n)}function oi(e,t,n){$r.call(this,new Uint32Array(e),t,n)}function si(e,t,n){$r.call(this,new Uint16Array(e),t,n)}function li(e,t,n){$r.call(this,new Float32Array(e),t,n)}function ci(e,t,n){$r.call(this,new Float64Array(e),t,n)}function ui(e){if(0===e.length)return-1/0;let t=e[0];for(let n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty($r.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign($r.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){var t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Zr),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this},copyVector2sArray:function(e){var t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new vn),t[n++]=i.x,t[n++]=i.y}return this},copyVector3sArray:function(e){var t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new Tn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this},copyVector4sArray:function(e){var t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new Mn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Kr.fromBufferAttribute(this,t),Kr.applyMatrix3(e),this.setXY(t,Kr.x,Kr.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Qr.fromBufferAttribute(this,t),Qr.applyMatrix3(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this},applyMatrix4:function(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.applyMatrix4(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this},applyNormalMatrix:function(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.applyNormalMatrix(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this},transformDirection:function(e){for(let t=0,n=this.count;t<n;t++)Qr.x=this.getX(t),Qr.y=this.getY(t),Qr.z=this.getZ(t),Qr.transformDirection(e),this.setXYZ(t,Qr.x,Qr.y,Qr.z);return this},set:function(e,t=0){return this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(ei.prototype=Object.create($r.prototype)).constructor=ei,(ti.prototype=Object.create($r.prototype)).constructor=ti,(ni.prototype=Object.create($r.prototype)).constructor=ni,(ri.prototype=Object.create($r.prototype)).constructor=ri,ii.prototype=Object.create($r.prototype),ii.prototype.constructor=ii,(ai.prototype=Object.create($r.prototype)).constructor=ai,oi.prototype=Object.create($r.prototype),oi.prototype.constructor=oi,((si.prototype=Object.create($r.prototype)).constructor=si).prototype.isFloat16BufferAttribute=!0,(li.prototype=Object.create($r.prototype)).constructor=li,(ci.prototype=Object.create($r.prototype)).constructor=ci,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let hi=0;const di=new er,pi=new Sr,fi=new Tn,mi=new Cn,vi=new Cn,gi=new Tn;function yi(){Object.defineProperty(this,"id",{value:hi++}),this.uuid=mn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}yi.prototype=Object.assign(Object.create(dn.prototype),{constructor:yi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(65535<ui(e)?oi:ii)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t,n=(void 0!==(t=(void 0!==(t=this.attributes.position)&&(t.applyMatrix4(e),t.needsUpdate=!0),this.attributes.normal))&&(n=(new gn).getNormalMatrix(e),t.applyNormalMatrix(n),t.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return di.makeRotationX(e),this.applyMatrix4(di),this},rotateY:function(e){return di.makeRotationY(e),this.applyMatrix4(di),this},rotateZ:function(e){return di.makeRotationZ(e),this.applyMatrix4(di),this},translate:function(e,t,n){return di.makeTranslation(e,t,n),this.applyMatrix4(di),this},scale:function(e,t,n){return di.makeScale(e,t,n),this.applyMatrix4(di),this},lookAt:function(e){return pi.lookAt(e),pi.updateMatrix(),this.applyMatrix4(pi.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(fi).negate(),this.translate(fi.x,fi.y,fi.z),this},setFromPoints:function(e){var t=[];for(let r=0,i=e.length;r<i;r++){var n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new li(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Cn);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Tn(-1/0,-1/0,-1/0),new Tn(1/0,1/0,1/0));else{if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){var n=t[e];mi.setFromBufferAttribute(n),this.morphTargetsRelative?(gi.addVectors(this.boundingBox.min,mi.min),this.boundingBox.expandByPoint(gi),gi.addVectors(this.boundingBox.max,mi.max),this.boundingBox.expandByPoint(gi)):(this.boundingBox.expandByPoint(mi.min),this.boundingBox.expandByPoint(mi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new jn);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Tn,1/0);else if(e){var n=this.boundingSphere.center;if(mi.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){var r=t[e];vi.setFromBufferAttribute(r),this.morphTargetsRelative?(gi.addVectors(mi.min,vi.min),mi.expandByPoint(gi),gi.addVectors(mi.max,vi.max),mi.expandByPoint(gi)):(mi.expandByPoint(vi.min),mi.expandByPoint(vi.max))}mi.getCenter(n);let o=0;for(let t=0,r=e.count;t<r;t++)gi.fromBufferAttribute(e,t),o=Math.max(o,n.distanceToSquared(gi));if(t)for(let r=0,s=t.length;r<s;r++){var i=t[r],a=this.morphTargetsRelative;for(let t=0,r=i.count;t<r;t++)gi.fromBufferAttribute(i,t),a&&(fi.fromBufferAttribute(e,t),gi.add(fi)),o=Math.max(o,n.distanceToSquared(gi))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{var n=e.array;const p=t.position.array,f=t.normal.array,m=t.uv.array;var r,i,a,o,s=p.length/3;void 0===t.tangent&&this.setAttribute("tangent",new $r(new Float32Array(4*s),4));const v=t.tangent.array,g=[],y=[];for(let e=0;e<s;e++)g[e]=new Tn,y[e]=new Tn;const x=new Tn,w=new Tn,b=new Tn,_=new vn,M=new vn,E=new vn,S=new Tn,T=new Tn;let A=this.groups;for(let e=0,t=(A=0===A.length?[{start:0,count:n.length}]:A).length;e<t;++e){var l=A[e],c=l.start;for(let e=c,t=c+l.count;e<t;e+=3)r=n[e+0],i=n[e+1],a=n[e+2],void 0,x.fromArray(p,3*r),w.fromArray(p,3*i),b.fromArray(p,3*a),_.fromArray(m,2*r),M.fromArray(m,2*i),E.fromArray(m,2*a),w.sub(x),b.sub(x),M.sub(_),E.sub(_),o=1/(M.x*E.y-E.x*M.y),isFinite(o)&&(S.copy(w).multiplyScalar(E.y).addScaledVector(b,-M.y).multiplyScalar(o),T.copy(b).multiplyScalar(M.x).addScaledVector(w,-E.x).multiplyScalar(o),g[r].add(S),g[i].add(S),g[a].add(S),y[r].add(T),y[i].add(T),y[a].add(T))}const L=new Tn,C=new Tn,P=new Tn,R=new Tn;for(let e=0,t=A.length;e<t;++e){var u=A[e],h=u.start;for(let e=h,t=h+u.count;e<t;e+=3)d(n[e+0]),d(n[e+1]),d(n[e+2])}function d(e){P.fromArray(f,3*e),R.copy(P);var t=g[e];t=(t=(L.copy(t),L.sub(P.multiplyScalar(P.dot(t))).normalize(),C.crossVectors(R,t),C.dot(y[e])))<0?-1:1;v[4*e]=L.x,v[4*e+1]=L.y,v[4*e+2]=L.z,v[4*e+3]=t}}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){let p=this.getAttribute("normal");if(void 0===p)p=new $r(new Float32Array(3*t.count),3),this.setAttribute("normal",p);else for(let e=0,t=p.count;e<t;e++)p.setXYZ(e,0,0,0);var n=new Tn,r=new Tn,i=new Tn,a=new Tn,o=new Tn,s=new Tn,l=new Tn,c=new Tn;if(e)for(let f=0,m=e.count;f<m;f+=3){var u=e.getX(f+0),h=e.getX(f+1),d=e.getX(f+2);n.fromBufferAttribute(t,u),r.fromBufferAttribute(t,h),i.fromBufferAttribute(t,d),l.subVectors(i,r),c.subVectors(n,r),l.cross(c),a.fromBufferAttribute(p,u),o.fromBufferAttribute(p,h),s.fromBufferAttribute(p,d),a.add(l),o.add(l),s.add(l),p.setXYZ(u,a.x,a.y,a.z),p.setXYZ(h,o.x,o.y,o.z),p.setXYZ(d,s.x,s.y,s.z)}else for(let e=0,a=t.count;e<a;e+=3)n.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),i.fromBufferAttribute(t,e+2),l.subVectors(i,r),c.subVectors(n,r),l.cross(c),p.setXYZ(e+0,l.x,l.y,l.z),p.setXYZ(e+1,l.x,l.y,l.z),p.setXYZ(e+2,l.x,l.y,l.z);this.normalizeNormals(),p.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(const s in n)if(void 0!==e.attributes[s]){var r=n[s].array,i=(a=e.attributes[s]).array,a=a.itemSize*t,o=Math.min(i.length,r.length-a);for(let e=0,t=a;e<o;e++,t++)r[t]=i[e]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)gi.fromBufferAttribute(e,t),gi.normalize(),e.setXYZ(t,gi.x,gi.y,gi.z)},toNonIndexed:function(){function e(e,t){var n=e.array,r=e.itemSize,i=(e=e.normalized,new n.constructor(t.length*r));let a=0,o=0;for(let e=0,s=t.length;e<s;e++){a=t[e]*r;for(let e=0;e<r;e++)i[o++]=n[a++]}return new $r(i,r,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new yi,n=this.index.array,r=this.attributes;for(const a in r){var i=e(r[a],n);t.setAttribute(a,i)}var a=this.morphAttributes;for(const r in a){var o=[],s=a[r];for(let t=0,r=s.length;t<r;t++){var l=e(s[t],n);o.push(l)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;var c=this.groups;for(let e=0,n=c.length;e<n;e++){var u=c[e];t.addGroup(u.start,u.count,u.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n])}else{e.data={attributes:{}};var n=this.index,r=(null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)}),this.attributes);for(const t in r){var i=r[t],a=i.toJSON(e.data);""!==i.name&&(a.name=i.name),e.data.attributes[t]=a}var o={};let t=!1;for(const n in this.morphAttributes){var s=this.morphAttributes[n],l=[];for(let t=0,n=s.length;t<n;t++){var c=s[t],u=c.toJSON(e.data);""!==c.name&&(u.name=c.name),l.push(u)}0<l.length&&(o[n]=l,t=!0)}t&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative),0<(n=this.groups).length&&(e.data.groups=JSON.parse(JSON.stringify(n))),null!==(n=this.boundingSphere)&&(e.data.boundingSphere={center:n.center.toArray(),radius:n.radius})}return e},clone:function(){return(new yi).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={},n=(this.name=e.name,e.index),r=(null!==n&&this.setIndex(n.clone(t)),e.attributes);for(const e in r){var i=r[e];this.setAttribute(e,i.clone(t))}var a=e.morphAttributes;for(const e in a){var o=[],s=a[e];for(let e=0,n=s.length;e<n;e++)o.push(s[e].clone(t));this.morphAttributes[e]=o}this.morphTargetsRelative=e.morphTargetsRelative;var l=e.groups;for(let e=0,t=l.length;e<t;e++){var c=l[e];this.addGroup(c.start,c.count,c.materialIndex)}return null!==(n=e.boundingBox)&&(this.boundingBox=n.clone()),null!==(n=e.boundingSphere)&&(this.boundingSphere=n.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const xi=new er,wi=new $n,bi=new jn,_i=new Tn,Mi=new Tn,Ei=new Tn,Si=new Tn,Ti=new Tn,Ai=new Tn,Li=new Tn,Ci=new Tn,Pi=new Tn,Ri=new vn,Ii=new vn,ki=new vn,Di=new Tn,zi=new Tn;function Ni(e=new yi,t=new Jr){Sr.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function Oi(e,t,n,r,i,a,o,s,l,c,u,h){_i.fromBufferAttribute(i,c),Mi.fromBufferAttribute(i,u),Ei.fromBufferAttribute(i,h);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){Li.set(0,0,0),Ci.set(0,0,0),Pi.set(0,0,0);for(let e=0,t=a.length;e<t;e++){var p=d[e],f=a[e];0!==p&&(Si.fromBufferAttribute(f,c),Ti.fromBufferAttribute(f,u),Ai.fromBufferAttribute(f,h),o?(Li.addScaledVector(Si,p),Ci.addScaledVector(Ti,p),Pi.addScaledVector(Ai,p)):(Li.addScaledVector(Si.sub(_i),p),Ci.addScaledVector(Ti.sub(Mi),p),Pi.addScaledVector(Ai.sub(Ei),p)))}_i.add(Li),Mi.add(Ci),Ei.add(Pi)}return e.isSkinnedMesh&&t.skinning&&(e.boneTransform(c,_i),e.boneTransform(u,Mi),e.boneTransform(h,Ei)),(i=function(e,t,n,r,i,a,o,s){let l;return null===(l=1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,2!==t.side,s))||(zi.copy(s),zi.applyMatrix4(e.matrixWorld),(r=n.ray.origin.distanceTo(zi))<n.near)||r>n.far?null:{distance:r,point:zi.clone(),object:e}}(e,t,n,r,_i,Mi,Ei,Di))&&(s&&(Ri.fromBufferAttribute(s,c),Ii.fromBufferAttribute(s,u),ki.fromBufferAttribute(s,h),i.uv=Ur.getUV(Di,_i,Mi,Ei,Ri,Ii,ki,new vn)),l&&(Ri.fromBufferAttribute(l,c),Ii.fromBufferAttribute(l,u),ki.fromBufferAttribute(l,h),i.uv2=Ur.getUV(Di,_i,Mi,Ei,Ri,Ii,ki,new vn)),e={a:c,b:u,c:h,normal:new Tn,materialIndex:0},Ur.getNormal(_i,Mi,Ei,e.normal),i.face=e),i}Ni.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Ni,isMesh:!0,copy:function(e){return Sr.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){var i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,t){var n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),bi.copy(n.boundingSphere),bi.applyMatrix4(i),!1!==e.ray.intersectsSphere(bi))&&(xi.copy(i).invert(),wi.copy(e.ray).applyMatrix4(xi),null===n.boundingBox||!1!==wi.intersectsBox(n.boundingBox))){let i;if(n.isBufferGeometry){var a=n.index,o=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==a)if(Array.isArray(r))for(let n=0,y=h.length;n<y;n++){var p=h[n],f=r[p.materialIndex];for(let n=Math.max(p.start,d.start),r=Math.min(p.start+p.count,d.start+d.count);n<r;n+=3){var m=a.getX(n),v=a.getX(n+1),g=a.getX(n+2);(i=Oi(this,f,e,wi,o,s,l,c,u,m,v,g))&&(i.faceIndex=Math.floor(n/3),i.face.materialIndex=p.materialIndex,t.push(i))}}else for(let n=Math.max(0,d.start),h=Math.min(a.count,d.start+d.count);n<h;n+=3){var y=a.getX(n),x=a.getX(n+1),w=a.getX(n+2);(i=Oi(this,r,e,wi,o,s,l,c,u,y,x,w))&&(i.faceIndex=Math.floor(n/3),t.push(i))}else if(void 0!==o)if(Array.isArray(r))for(let n=0,a=h.length;n<a;n++){var b=h[n],_=r[b.materialIndex];for(let n=Math.max(b.start,d.start),r=Math.min(b.start+b.count,d.start+d.count);n<r;n+=3){(i=Oi(this,_,e,wi,o,s,l,c,u,n,n+1,n+2))&&(i.faceIndex=Math.floor(n/3),i.face.materialIndex=b.materialIndex,t.push(i))}}else for(let n=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);n<a;n+=3){(i=Oi(this,r,e,wi,o,s,l,c,u,n,n+1,n+2))&&(i.faceIndex=Math.floor(n/3),t.push(i))}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});class Bi extends yi{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const o=this,s=(r=Math.floor(r),i=Math.floor(i),a=Math.floor(a),[]),l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,r,i,a,p,f,m,v,g){var y=a/m,x=p/v,w=a/2,b=p/2,_=f/2,M=m+1,E=v+1;let S=0,T=0;var A=new Tn;for(let a=0;a<E;a++){var L=a*x-b;for(let o=0;o<M;o++){var C=o*y-w;A[e]=C*r,A[t]=L*i,A[n]=_,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=0<f?1:-1,c.push(A.x,A.y,A.z),u.push(o/m),u.push(1-a/v),S+=1}}for(let e=0;e<v;e++)for(let t=0;t<m;t++){var P=h+t+M*e,R=h+t+M*(e+1),I=h+(t+1)+M*(e+1),k=h+(t+1)+M*e;s.push(P,R,k),s.push(R,I,k),T+=6}o.addGroup(d,T,g),d+=T,h+=S}p("z","y","x",-1,-1,n,t,e,a,i,0),p("z","y","x",1,-1,n,t,-e,a,i,1),p("x","z","y",1,1,e,n,t,r,a,2),p("x","z","y",1,-1,e,n,-t,r,a,3),p("x","y","z",1,-1,e,t,n,r,i,4),p("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new li(l,3)),this.setAttribute("normal",new li(c,3)),this.setAttribute("uv",new li(u,2))}}function Fi(e){var t={};for(const r in e){t[r]={};for(const i in e[r]){var n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Ui(e){var t={};for(let r=0;r<e.length;r++){var n=Fi(e[r]);for(const e in n)t[e]=n[e]}return t}const Hi={clone:Fi,merge:Ui};function Vi(e){Vr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Gi(){Sr.call(this),this.type="Camera",this.matrixWorldInverse=new er,this.projectionMatrix=new er,this.projectionMatrixInverse=new er}function Wi(e=50,t=1,n=.1,r=2e3){Gi.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}((Vi.prototype=Object.create(Vr.prototype)).constructor=Vi).prototype.isShaderMaterial=!0,Vi.prototype.copy=function(e){return Vr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Fi(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Vi.prototype.toJSON=function(e){var t=Vr.prototype.toJSON.call(this,e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){var n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var r={};for(const e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return 0<Object.keys(r).length&&(t.extensions=r),t},Gi.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Gi,isCamera:!0,copy:function(e,t){return Sr.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Tn),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Sr.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){Sr.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Wi.prototype=Object.assign(Object.create(Gi.prototype),{constructor:Wi,isPerspectiveCamera:!0,copy:function(e,t){return Gi.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*mn.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*mn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*mn.RAD2DEG*Math.atan(Math.tan(.5*mn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near;let t=e*Math.tan(.5*mn.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;var a,o=this.view,s=(null!==this.view&&this.view.enabled&&(s=o.fullWidth,a=o.fullHeight,i+=o.offsetX*r/s,t-=o.offsetY*n/a,r*=o.width/s,n*=o.height/a),this.filmOffset);0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){return(e=Sr.prototype.toJSON.call(this,e)).object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});class ji extends Sr{constructor(e,t,n){super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget?console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."):(this.renderTarget=n,(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Tn(1,0,0)),this.add(n),(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Tn(-1,0,0)),this.add(n),(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,0,1),n.lookAt(new Tn(0,1,0)),this.add(n),(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,0,-1),n.lookAt(new Tn(0,-1,0)),this.add(n),(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Tn(0,0,1)),this.add(n),(n=new Wi(90,1,e,t)).layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Tn(0,0,-1)),this.add(n))}update(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,[r,i,a,o,s,l]=this.children,c=e.xr.enabled,u=e.getRenderTarget(),h=(e.xr.enabled=!1,n.texture.generateMipmaps);n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c}}class qi extends bn{constructor(e,t,n,r,i,a,o,s,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,r,i,a,o=void 0!==o?o:an,s,l,c),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}qi.prototype.isCubeTexture=!0;class Xi extends En{constructor(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),super(e,e,t),t=t||{},this.texture=new qi(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:en,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=on,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new Bi(5,5,5);(n=new Vi({name:"CubemapFromEquirect",uniforms:Fi(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0})).uniforms.tEquirect.value=t,r=new Ni(r,n),n=t.minFilter;return t.minFilter===tn&&(t.minFilter=en),new ji(1,10,this).update(e,r),t.minFilter=n,r.geometry.dispose(),r.material.dispose(),this}clear(e,t,n,r){var i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}Xi.prototype.isWebGLCubeRenderTarget=!0;class Yi extends bn{constructor(e,t,n,r,i,a,o,s,l,c,u,h){super(null,a,o,s,l,c,r,i,u,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==l?l:$t,this.minFilter=void 0!==c?c:$t,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Yi.prototype.isDataTexture=!0;const Zi=new jn,Ji=new Tn;class Qi{constructor(e=new Cr,t=new Cr,n=new Cr,r=new Cr,i=new Cr,a=new Cr){this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}copy(e){var t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){var t=this.planes,n=(e=e.elements)[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],v=e[14];e=e[15];return t[0].setComponents(a-n,c-o,p-u,e-f).normalize(),t[1].setComponents(a+n,c+o,p+u,e+f).normalize(),t[2].setComponents(a+r,c+s,p+h,e+m).normalize(),t[3].setComponents(a-r,c-s,p-h,e-m).normalize(),t[4].setComponents(a-i,c-l,p-d,e-v).normalize(),t[5].setComponents(a+i,c+l,p+d,e+v).normalize(),this}intersectsObject(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Zi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Zi)}intersectsSprite(e){return Zi.center.set(0,0,0),Zi.radius=.7071067811865476,Zi.applyMatrix4(e.matrixWorld),this.intersectsSphere(Zi)}intersectsSphere(e){var t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){var t=this.planes;for(let r=0;r<6;r++){var n=t[r];if(Ji.x=(0<n.normal.x?e.max:e.min).x,Ji.y=(0<n.normal.y?e.max:e.min).y,Ji.z=(0<n.normal.z?e.max:e.min).z,n.distanceToPoint(Ji)<0)return!1}return!0}containsPoint(e){var t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ki(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function $i(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){var a,o,s,l;t.isGLBufferAttribute?(!(a=r.get(t))||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}):(t.isInterleavedBufferAttribute&&(t=t.data),void 0===(a=r.get(t))?r.set(t,function(t,r){var i=t.array,a=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,i,a),t.onUploadCallback();let s=5126;return i instanceof Float32Array?s=5126:i instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):i instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:i instanceof Int16Array?s=5122:i instanceof Uint32Array?s=5125:i instanceof Int32Array?s=5124:i instanceof Int8Array?s=5120:i instanceof Uint8Array&&(s=5121),{buffer:o,type:s,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(o=a.buffer,i=i,l=(s=t).array,s=s.updateRange,e.bindBuffer(i,o),-1===s.count?e.bufferSubData(i,0,l):(n?e.bufferSubData(i,s.offset*l.BYTES_PER_ELEMENT,l,s.offset,s.count):e.bufferSubData(i,s.offset*l.BYTES_PER_ELEMENT,l.subarray(s.offset,s.offset+s.count)),s.count=-1),a.version=t.version))}}}class ea extends yi{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i=e/2,a=t/2,o=Math.floor(n),s=Math.floor(r),l=o+1,c=s+1,u=e/o,h=t/s,d=[],p=[],f=[],m=[];for(let e=0;e<c;e++){var v=e*h-a;for(let t=0;t<l;t++){var g=t*u-i;p.push(g,-v,0),f.push(0,0,1),m.push(t/o),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){var y=t+l*e,x=t+l*(e+1),w=t+1+l*(e+1),b=t+1+l*e;d.push(y,x,b),d.push(x,w,b)}this.setIndex(d),this.setAttribute("position",new li(p,3)),this.setAttribute("normal",new li(f,3)),this.setAttribute("uv",new li(m,2))}}const ta={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},na={common:{diffuse:{value:new Zr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new gn},uv2Transform:{value:new gn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new vn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new gn}},sprite:{diffuse:{value:new Zr(15658734)},opacity:{value:1},center:{value:new vn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new gn}}},ra={basic:{uniforms:Ui([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.fog]),vertexShader:ta.meshbasic_vert,fragmentShader:ta.meshbasic_frag},lambert:{uniforms:Ui([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.fog,na.lights,{emissive:{value:new Zr(0)}}]),vertexShader:ta.meshlambert_vert,fragmentShader:ta.meshlambert_frag},phong:{uniforms:Ui([na.common,na.specularmap,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.fog,na.lights,{emissive:{value:new Zr(0)},specular:{value:new Zr(1118481)},shininess:{value:30}}]),vertexShader:ta.meshphong_vert,fragmentShader:ta.meshphong_frag},standard:{uniforms:Ui([na.common,na.envmap,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.roughnessmap,na.metalnessmap,na.fog,na.lights,{emissive:{value:new Zr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ta.meshphysical_vert,fragmentShader:ta.meshphysical_frag},toon:{uniforms:Ui([na.common,na.aomap,na.lightmap,na.emissivemap,na.bumpmap,na.normalmap,na.displacementmap,na.gradientmap,na.fog,na.lights,{emissive:{value:new Zr(0)}}]),vertexShader:ta.meshtoon_vert,fragmentShader:ta.meshtoon_frag},matcap:{uniforms:Ui([na.common,na.bumpmap,na.normalmap,na.displacementmap,na.fog,{matcap:{value:null}}]),vertexShader:ta.meshmatcap_vert,fragmentShader:ta.meshmatcap_frag},points:{uniforms:Ui([na.points,na.fog]),vertexShader:ta.points_vert,fragmentShader:ta.points_frag},dashed:{uniforms:Ui([na.common,na.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ta.linedashed_vert,fragmentShader:ta.linedashed_frag},depth:{uniforms:Ui([na.common,na.displacementmap]),vertexShader:ta.depth_vert,fragmentShader:ta.depth_frag},normal:{uniforms:Ui([na.common,na.bumpmap,na.normalmap,na.displacementmap,{opacity:{value:1}}]),vertexShader:ta.normal_vert,fragmentShader:ta.normal_frag},sprite:{uniforms:Ui([na.sprite,na.fog]),vertexShader:ta.sprite_vert,fragmentShader:ta.sprite_frag},background:{uniforms:{uvTransform:{value:new gn},t2D:{value:null}},vertexShader:ta.background_vert,fragmentShader:ta.background_frag},cube:{uniforms:Ui([na.envmap,{opacity:{value:1}}]),vertexShader:ta.cube_vert,fragmentShader:ta.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ta.equirect_vert,fragmentShader:ta.equirect_frag},distanceRGBA:{uniforms:Ui([na.common,na.displacementmap,{referencePosition:{value:new Tn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ta.distanceRGBA_vert,fragmentShader:ta.distanceRGBA_frag},shadow:{uniforms:Ui([na.lights,na.fog,{color:{value:new Zr(0)},opacity:{value:1}}]),vertexShader:ta.shadow_vert,fragmentShader:ta.shadow_frag}};function ia(e,t,n,r,i){const a=new Zr(0);let o,s,l=0,c=null,u=0,h=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return a},setClearColor:function(e,t=1){a.set(e),l=t,d(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(e){l=e,d(a,l)},render:function(n,i,p,f){let m=!0===i.isScene?i.background:null;m&&m.isTexture&&(m=t.get(m)),null===(m=(i=(i=e.xr).getSession&&i.getSession())&&"additive"===i.environmentBlendMode?null:m)?d(a,l):m&&m.isColor&&(d(m,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.isWebGLCubeRenderTarget||306===m.mapping)?(void 0===s&&((s=new Ni(new Bi(1,1,1),new Vi({name:"BackgroundCubeMaterial",uniforms:Fi(ra.cube.uniforms),vertexShader:ra.cube.vertexShader,fragmentShader:ra.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(s)),m.isWebGLCubeRenderTarget&&(m=m.texture),s.material.uniforms.envMap.value=m,s.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m._needsFlipEnvMap?-1:1,c===m&&u===m.version&&h===e.toneMapping||(s.material.needsUpdate=!0,c=m,u=m.version,h=e.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null)):m&&m.isTexture&&(void 0===o&&((o=new Ni(new ea(2,2),new Vi({name:"BackgroundMaterial",uniforms:Fi(ra.background.uniforms),vertexShader:ra.background.vertexShader,fragmentShader:ra.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(o)),!0===(o.material.uniforms.t2D.value=m).matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),c===m&&u===m.version&&h===e.toneMapping||(o.material.needsUpdate=!0,c=m,u=m.version,h=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function aa(e,t,n,r){const i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=d(null);let c=l;function u(t){if(r.isWebGL2)return e.bindVertexArray(t);a.bindVertexArrayOES(t)}function h(t){if(r.isWebGL2)return e.deleteVertexArray(t);a.deleteVertexArrayOES(t)}function d(e){var t=[],n=[],r=[];for(let e=0;e<i;e++)t[e]=0,n[e]=0,r[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){var e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,i){var a=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function v(){var t=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function y(){x(),c!==l&&u((c=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,y,x){let w=!1;if(o){var b=function(t,n,i){i=!0===i.wireframe;let o=s[t.id];void 0===o&&(o={},s[t.id]=o);let l=o[n.id];void 0===l&&(l={},o[n.id]=l);let c=l[i];return void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[i]=c),c}(y,h,l);if(c!==b&&u((c=b).object),w=function(e,t){var n=c.attributes,r=e.attributes;let i=0;for(const e in r){var a=n[e],o=r[e];if(void 0===a)return!0;if(a.attribute!==o)return!0;if(a.data!==o.data)return!0;i++}return c.attributesNum!==i||c.index!==t}(y,x)){b=x;var _={},M=y.attributes;let e=0;for(const t in M){var E=M[t],S={};(S.attribute=E).data&&(S.data=E.data),_[t]=S,e++}c.attributes=_,c.attributesNum=e,c.index=b}}else b=!0===l.wireframe,c.geometry===y.id&&c.program===h.id&&c.wireframe===b||(c.geometry=y.id,c.program=h.id,c.wireframe=b,w=!0);!0===i.isInstancedMesh&&(w=!0),null!==x&&n.update(x,34963),w&&(function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){p();var l=s.attributes,c=o.getAttributes(),u=a.defaultAttributeValues;for(const t in c){var h=c[t];if(0<=h){var d=l[t];if(void 0!==d){var y,x=d.normalized,w=d.itemSize;void 0!==(S=n.get(d))&&(E=S.buffer,y=S.type,S=S.bytesPerElement,d.isInterleavedBufferAttribute?(b=(M=d.data).stride,_=d.offset,M&&M.isInstancedInterleavedBuffer?(m(h,M.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=M.meshPerAttribute*M.count)):f(h),e.bindBuffer(34962,E),g(h,w,y,x,b*S,_*S)):(d.isInstancedBufferAttribute?(m(h,d.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=d.meshPerAttribute*d.count)):f(h),e.bindBuffer(34962,E),g(h,w,y,x,0,0)))}else if("instanceMatrix"===t){var b,_,M=n.get(i.instanceMatrix);void 0!==M&&(b=M.buffer,_=M.type,m(h+0,1),m(h+1,1),m(h+2,1),m(h+3,1),e.bindBuffer(34962,b),e.vertexAttribPointer(h+0,4,_,!1,64,0),e.vertexAttribPointer(h+1,4,_,!1,64,16),e.vertexAttribPointer(h+2,4,_,!1,64,32),e.vertexAttribPointer(h+3,4,_,!1,64,48))}else if("instanceColor"===t){var E,S;void 0!==(S=n.get(i.instanceColor))&&(d=S.buffer,E=S.type,m(h,1),e.bindBuffer(34962,d),e.vertexAttribPointer(h,3,E,!1,12,0))}else if(void 0!==u){var T=u[t];if(void 0!==T)switch(T.length){case 2:e.vertexAttrib2fv(h,T);break;case 3:e.vertexAttrib3fv(h,T);break;case 4:e.vertexAttrib4fv(h,T);break;default:e.vertexAttrib1fv(h,T)}}}}v()}}(i,l,h,y),null!==x)&&e.bindBuffer(34963,n.get(x).buffer)},reset:y,resetDefaultState:x,dispose:function(){y();for(const n in s){var e=s[n];for(const n in e){var t=e[n];for(const e in t)h(t[e].object),delete t[e];delete e[n]}delete s[n]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(const e in t){var n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(const r in s){var t=s[r];if(void 0!==t[e.id]){var n=t[e.id];for(const e in n)h(n[e].object),delete n[e];delete t[e.id]}}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:v}}function oa(e,t,n,r){const i=r.isWebGL2;let a;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,o,s){if(0!==s){let l,c;if(i)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](a,r,o,s),n.update(o,a,s)}}}function sa(e,t,n){let r;function i(t){if("highp"===t){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";t="mediump"}return"mediump"===t&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";var s=((s=i(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s),!0===n.logarithmicDepthBuffer),l=(n=e.getParameter(34930),e.getParameter(35660)),c=e.getParameter(3379),u=e.getParameter(34076),h=e.getParameter(34921),d=e.getParameter(36347),p=e.getParameter(36348),f=e.getParameter(36349),m=0<l,v=a||t.has("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){var n;return r=void 0===r?!0===t.has("EXT_texture_filter_anisotropic")?(n=t.get("EXT_texture_filter_anisotropic"),e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)):0:r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:s,maxTextures:n,maxVertexTextures:l,maxTextureSize:c,maxCubemapSize:u,maxAttributes:h,maxVertexUniforms:d,maxVaryings:p,maxFragmentUniforms:f,vertexTextures:m,floatFragmentTextures:v,floatVertexTextures:m&&v,maxSamples:a?e.getParameter(36183):0}}function la(e){const t=this;let n=null,r=0,i=!1,a=!1;const o=new Cr,s=new gn,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=0<r),t.numPlanes=r,t.numIntersection=0}function u(e,n,r,i){var a=null!==e?e.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){i=r+4*a;var u=n.matrixWorldInverse;s.getNormalMatrix(u),(null===c||c.length<i)&&(c=new Float32Array(i));for(let t=0,n=r;t!==a;++t,n+=4)o.copy(e[t]).applyMatrix4(u,s),o.normal.toArray(c,n),c[n+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=u(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,c()},this.setState=function(t,o,s){var h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows;t=e.get(t);if(!i||null===h||0===h.length||a&&!p)a?u(null):c();else{var f=4*(p=a?0:r),m=t.clippingState||null;l.value=m,m=u(h,o,f,s);for(let e=0;e!==f;++e)m[e]=n[e];t.clippingState=m,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=p}}}function ca(e){let t=new WeakMap;function n(e,t){return 303===t?e.mapping=301:304===t&&(e.mapping=302),e}function r(e){var n=((e=e.target).removeEventListener("dispose",r),t.get(e));void 0!==n&&(t.delete(e),n.dispose())}return{get:function(i){if(i&&i.isTexture){var a,o=i.mapping;if(303===o||304===o)return t.has(i)?n(t.get(i).texture,i.mapping):(o=i.image)&&0<o.height?(a=e.getRenderTarget(),(o=new Xi(o.height/2)).fromEquirectangularTexture(e,i),t.set(i,o),e.setRenderTarget(a),i.addEventListener("dispose",r),n(o.texture,i.mapping)):null}return i},dispose:function(){t=new WeakMap}}}function ua(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ha(e,t,n,r){const i={},a=new WeakMap;function o(e){var s=e.target;null!==s.index&&t.remove(s.index);for(const e in s.attributes)t.remove(s.attributes[e]);s.removeEventListener("dispose",o),delete i[s.id],(e=a.get(s))&&(t.remove(e),a.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}return{get:function(e,t){return!0!==i[t.id]&&(t.addEventListener("dispose",o),i[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(const e in n)t.update(n[e],34962);var r=e.morphAttributes;for(const e in r){var i=r[e];for(let e=0,n=i.length;e<n;e++)t.update(i[e],34962)}},getWireframeAttribute:function(e){var n,r=a.get(e);return(!r||null!==(n=e.index)&&r.version<n.version)&&function(e){var n=[],r=e.index,i=e.attributes.position;let o=0;if(null!==r){var s=r.array;o=r.version;for(let e=0,t=s.length;e<t;e+=3){var l=s[e+0],c=s[e+1],u=s[e+2];n.push(l,c,c,u,u,l)}}else{r=i.array,o=i.version;for(let e=0,t=r.length/3-1;e<t;e+=3){var h=e+0,d=e+1,p=e+2;n.push(h,d,d,p,p,h)}}(i=new(65535<ui(n)?oi:ii)(n,1)).version=o,(r=a.get(e))&&t.remove(r),a.set(e,i)}(e),a.get(e)}}}function da(e,t,n,r){const i=r.isWebGL2;let a,o,s;this.setMode=function(e){a=e},this.setIndex=function(e){o=e.type,s=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,o,t*s),n.update(r,a,1)},this.renderInstances=function(r,l,c){if(0!==c){let u,h;if(i)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](a,l,o,r*s,c),n.update(l,a,c)}}}function pa(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function fa(e,t){return e[0]-t[0]}function ma(e,t){return Math.abs(t[1])-Math.abs(e[1])}function va(e){const t={},n=new Float32Array(8),r=[];for(let e=0;e<8;e++)r[e]=[e,0];return{update:function(i,a,o,s){var l=i.morphTargetInfluences,c=void 0===l?0:l.length;let u=t[a.id];if(void 0===u){u=[];for(let e=0;e<c;e++)u[e]=[e,0];t[a.id]=u}for(let e=0;e<c;e++){var h=u[e];h[0]=e,h[1]=l[e]}u.sort(ma);for(let e=0;e<8;e++)e<c&&u[e][1]?(r[e][0]=u[e][0],r[e][1]=u[e][1]):(r[e][0]=Number.MAX_SAFE_INTEGER,r[e][1]=0);r.sort(fa);var d=o.morphTargets&&a.morphAttributes.position,p=o.morphNormals&&a.morphAttributes.normal;let f=0;for(let e=0;e<8;e++){var m=(v=r[e])[0],v=v[1];m!==Number.MAX_SAFE_INTEGER&&v?(d&&a.getAttribute("morphTarget"+e)!==d[m]&&a.setAttribute("morphTarget"+e,d[m]),p&&a.getAttribute("morphNormal"+e)!==p[m]&&a.setAttribute("morphNormal"+e,p[m]),n[e]=v,f+=v):(d&&!0===a.hasAttribute("morphTarget"+e)&&a.deleteAttribute("morphTarget"+e),p&&!0===a.hasAttribute("morphNormal"+e)&&a.deleteAttribute("morphNormal"+e),n[e]=0)}i=a.morphTargetsRelative?1:1-f,s.getUniforms().setValue(e,"morphTargetBaseInfluence",i),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function ga(e,t,n,r){let i=new WeakMap;function a(e){(e=e.target).removeEventListener("dispose",a),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry;s=t.get(e,s);return i.get(s)!==o&&(t.update(s),i.set(s,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",a)&&e.addEventListener("dispose",a),n.update(e.instanceMatrix,34962),null!==e.instanceColor)&&n.update(e.instanceColor,34962),s},dispose:function(){i=new WeakMap}}}ra.physical={uniforms:Ui([ra.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new vn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Zr(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:ta.meshphysical_vert,fragmentShader:ta.meshphysical_frag};class ya extends bn{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=Kt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}class xa extends bn{constructor(e=null,t=1,n=1,r=1){super(null),this.image={data:e,width:t,height:n,depth:r},this.magFilter=$t,this.minFilter=$t,this.wrapR=Kt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}xa.prototype.isDataTexture3D=ya.prototype.isDataTexture2DArray=!0;const wa=new bn,ba=new ya,_a=new xa,Ma=new qi,Ea=[],Sa=[],Ta=new Float32Array(16),Aa=new Float32Array(9),La=new Float32Array(4);function Ca(e,t,n){var r=e[0];if(r<=0||0<r)return e;var i=t*n;let a=Ea[i];if(void 0===a&&(a=new Float32Array(i),Ea[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function Pa(e,t){if(e.length===t.length){for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return;return 1}}function Ra(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function Ia(e,t){let n=Sa[t];void 0===n&&(n=new Int32Array(t),Sa[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ka(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Da(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y):Pa(n,t)||(e.uniform2fv(this.addr,t),Ra(n,t))}function za(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z):void 0!==t.r?n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b):Pa(n,t)||(e.uniform3fv(this.addr,t),Ra(n,t))}function Na(e,t){var n=this.cache;void 0!==t.x?n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w):Pa(n,t)||(e.uniform4fv(this.addr,t),Ra(n,t))}function Oa(e,t){var n=this.cache,r=t.elements;void 0===r?Pa(n,t)||(e.uniformMatrix2fv(this.addr,!1,t),Ra(n,t)):Pa(n,r)||(La.set(r),e.uniformMatrix2fv(this.addr,!1,La),Ra(n,r))}function Ba(e,t){var n=this.cache,r=t.elements;void 0===r?Pa(n,t)||(e.uniformMatrix3fv(this.addr,!1,t),Ra(n,t)):Pa(n,r)||(Aa.set(r),e.uniformMatrix3fv(this.addr,!1,Aa),Ra(n,r))}function Fa(e,t){var n=this.cache,r=t.elements;void 0===r?Pa(n,t)||(e.uniformMatrix4fv(this.addr,!1,t),Ra(n,t)):Pa(n,r)||(Ta.set(r),e.uniformMatrix4fv(this.addr,!1,Ta),Ra(n,r))}function Ua(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||wa,i)}function Ha(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||ba,i)}function Va(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||_a,i)}function Ga(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Ma,i)}function Wa(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ja(e,t){var n=this.cache;Pa(n,t)||(e.uniform2iv(this.addr,t),Ra(n,t))}function qa(e,t){var n=this.cache;Pa(n,t)||(e.uniform3iv(this.addr,t),Ra(n,t))}function Xa(e,t){var n=this.cache;Pa(n,t)||(e.uniform4iv(this.addr,t),Ra(n,t))}function Ya(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Za(e,t){e.uniform1fv(this.addr,t)}function Ja(e,t){e.uniform1iv(this.addr,t)}function Qa(e,t){e.uniform2iv(this.addr,t)}function Ka(e,t){e.uniform3iv(this.addr,t)}function $a(e,t){e.uniform4iv(this.addr,t)}function eo(e,t){t=Ca(t,this.size,2),e.uniform2fv(this.addr,t)}function to(e,t){t=Ca(t,this.size,3),e.uniform3fv(this.addr,t)}function no(e,t){t=Ca(t,this.size,4),e.uniform4fv(this.addr,t)}function ro(e,t){t=Ca(t,this.size,4),e.uniformMatrix2fv(this.addr,!1,t)}function io(e,t){t=Ca(t,this.size,9),e.uniformMatrix3fv(this.addr,!1,t)}function ao(e,t){t=Ca(t,this.size,16),e.uniformMatrix4fv(this.addr,!1,t)}function oo(e,t,n){var r=t.length,i=Ia(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTexture2D(t[e]||wa,i[e])}function so(e,t,n){var r=t.length,i=Ia(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTextureCube(t[e]||Ma,i[e])}function lo(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ka;case 35664:return Da;case 35665:return za;case 35666:return Na;case 35674:return Oa;case 35675:return Ba;case 35676:return Fa;case 5124:case 35670:return Wa;case 35667:case 35671:return ja;case 35668:case 35672:return qa;case 35669:case 35673:return Xa;case 5125:return Ya;case 35678:case 36198:case 36298:case 36306:case 35682:return Ua;case 35679:case 36299:case 36307:return Va;case 35680:case 36300:case 36308:case 36293:return Ga;case 36289:case 36303:case 36311:case 36292:return Ha}}(t.type)}function co(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Za;case 35664:return eo;case 35665:return to;case 35666:return no;case 35674:return ro;case 35675:return io;case 35676:return ao;case 5124:case 35670:return Ja;case 35667:case 35671:return Qa;case 35668:case 35672:return Ka;case 35669:case 35673:return $a;case 35678:case 36198:case 36298:case 36306:case 35682:return oo;case 35680:case 36300:case 36308:case 36293:return so}}(t.type)}function uo(e){this.id=e,this.seq=[],this.map={}}co.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Ra(t,e)},uo.prototype.setValue=function(e,t,n){var r=this.seq;for(let a=0,o=r.length;a!==o;++a){var i=r[a];i.setValue(e,t[i.id],n)}};const ho=/(\w+)(\])?(\[|\.)?/g;function po(e,t){e.seq.push(t),e.map[t.id]=t}function fo(e,t){this.seq=[],this.map={};var n=e.getProgramParameter(t,35718);for(let d=0;d<n;++d){var r=e.getActiveUniform(t,d),i=(h=u=c=o=i=void 0,r),a=e.getUniformLocation(t,r.name),o=this,s=i.name,l=s.length;for(ho.lastIndex=0;;){var c=ho.exec(s),u=ho.lastIndex;let e=c[1];var h="]"===c[2];c=c[3];if(h&&(e|=0),void 0===c||"["===c&&u+2===l){po(o,new(void 0===c?lo:co)(e,i,a));break}{let t=o.map[e];void 0===t&&po(o,t=new uo(e)),o=t}}}}function mo(e,t,n){return t=e.createShader(t),e.shaderSource(t,n),e.compileShader(t),t}fo.prototype.setValue=function(e,t,n,r){void 0!==(t=this.map[t])&&t.setValue(e,n,r)},fo.prototype.setOptional=function(e,t,n){void 0!==(t=t[n])&&this.setValue(e,n,t)},fo.upload=function(e,t,n,r){for(let o=0,s=t.length;o!==s;++o){var i=t[o],a=n[i.id];!1!==a.needsUpdate&&i.setValue(e,a.value,r)}},fo.seqWithValue=function(e,t){var n=[];for(let i=0,a=e.length;i!==a;++i){var r=e[i];r.id in t&&n.push(r)}return n};let vo=0;function go(e){switch(e){case cn:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function yo(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){var t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function xo(e,t){return"vec4 "+e+"( vec4 value ) { return "+(t=go(t))[0]+"ToLinear"+t[1]+"; }"}function wo(e){return""!==e}function bo(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function _o(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Mo=/^[ \t]*#include +<([\w\d./]+)>/gm;function Eo(e){return e.replace(Mo,So)}function So(e,t){var n=ta[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Eo(n)}const To=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ao=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Lo(e){return e.replace(Ao,Po).replace(To,Co)}function Co(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Po(0,t,n,r)}function Po(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function Ro(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Io(e,t,n,r){const i=e.getContext();var a=n.defines,o=n.vertexShader,s=n.fragmentShader,l=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 307:t="ENVMAP_MODE_REFRACTION"}return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),d=0<e.gammaFactor?e.gammaFactor:1,p=n.isWebGL2?"":[(p=n).extensionDerivatives||p.envMapCubeUV||p.bumpMap||p.tangentSpaceNormalMap||p.clearcoatNormalMap||p.flatShading||"physical"===p.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(p.extensionFragDepth||p.logarithmicDepthBuffer)&&p.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",p.extensionDrawBuffers&&p.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(p.extensionShaderTextureLOD||p.envMap)&&p.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(wo).join("\n");a=function(e){var t=[];for(const r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(a);const f=i.createProgram();let m,v,g,y,x=n.glslVersion?"#version "+n.glslVersion+"\n":"";if(n.isRawShaderMaterial?(0<(m=[a].filter(wo).join("\n")).length&&(m+="\n"),0<(v=[p,a].filter(wo).join("\n")).length&&(v+="\n")):(m=[Ro(n),"#define SHADER_NAME "+n.shaderName,a,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(wo).join("\n"),v=[p,Ro(n),"#define SHADER_NAME "+n.shaderName,a,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ta.tonemapping_pars_fragment:"",0!==n.toneMapping?function(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,n.toneMapping):"",n.dithering?"#define DITHERING":"",ta.encodings_pars_fragment,n.map?xo("mapTexelToLinear",n.mapEncoding):"",n.matcap?xo("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?xo("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?xo("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?xo("lightMapTexelToLinear",n.lightMapEncoding):"",(a="linearToOutputTexel",d=go(d=n.outputEncoding),"vec4 "+a+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(wo).join("\n")),o=_o(bo(Eo(o),n),n),s=_o(bo(Eo(s),n),n),o=Lo(o),s=Lo(s),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",m=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#define varying in","300 es"===n.glslVersion?"":"out highp vec4 pc_fragColor;","300 es"===n.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v),u=x+v+s,h=mo(i,35633,c=x+m+o),l=mo(i,35632,u),i.attachShader(f,h),i.attachShader(f,l),void 0!==n.index0AttributeName?i.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(f,0,"position"),i.linkProgram(f),e.debug.checkShaderErrors){a=i.getProgramInfoLog(f).trim(),d=i.getShaderInfoLog(h).trim(),o=i.getShaderInfoLog(l).trim();let e=!0,t=!0;!1===i.getProgramParameter(f,35714)?(e=!1,s=yo(i,h,"vertex"),c=yo(i,l,"fragment"),console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(f,35715),"gl.getProgramInfoLog",a,s,c)):""!==a?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",a):""!==d&&""!==o||(t=!1),t&&(this.diagnostics={runnable:e,programLog:a,vertexShader:{log:d,prefix:m},fragmentShader:{log:o,prefix:v}})}return i.deleteShader(h),i.deleteShader(l),this.getUniforms=function(){return g=void 0===g?new fo(i,f):g},this.getAttributes=function(){return y=void 0===y?function(e,t){var n={},r=e.getProgramParameter(t,35721);for(let a=0;a<r;a++){var i=e.getActiveAttrib(t,a).name;n[i]=e.getAttribLocation(t,i)}return n}(i,f):y},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=vo++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=h,this.fragmentShader=l,this}function ko(e,t,n,r,i,a){const o=[],s=r.isWebGL2,l=r.logarithmicDepthBuffer,c=r.floatVertexTextures,u=r.maxVertexUniforms,h=r.vertexTextures;let d=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function m(e){return e&&e.isTexture?e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e.texture.encoding):cn}return{getParameters:function(i,o,f,v,g){var y,x=v.fog,w=(v=i.isMeshStandardMaterial?v.environment:null,v=t.get(i.envMap||v),p[i.type]),b=g.isSkinnedMesh?(b=(b=g).skeleton.bones,c?1024:(y=u,y=Math.floor((y-20)/4),(y=Math.min(y,b.length))<b.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+b.length+" bones. This GPU supports "+y+"."),0):y)):0;let _,M;null!==i.precision&&(d=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",d,"instead."),M=(w?(y=ra[w],_=y.vertexShader,y):(_=i.vertexShader,i)).fragmentShader;var E=e.getRenderTarget();return{isWebGL2:s,shaderID:w,shaderName:i.type,vertexShader:_,fragmentShader:M,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:d,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:h,outputEncoding:null!==E?m(E.texture):e.outputEncoding,map:!!i.map,mapEncoding:m(i.map),matcap:!!i.matcap,matcapEncoding:m(i.matcap),envMap:!!v,envMapMode:v&&v.mapping,envMapEncoding:m(v),envMapCubeUV:!!v&&(306===v.mapping||307===v.mapping),lightMap:!!i.lightMap,lightMapEncoding:m(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:m(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!x,useFog:i.fog,fogExp2:x&&x.isFogExp2,flatShading:!!i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:l,skinning:i.skinning&&0<b,maxBones:b,useVertexTexture:c,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<f.length,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);if(!1===t.isRawShaderMaterial){for(let e=0;e<f.length;e++)n.push(t[f[e]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t=p[e.type];return t?(t=ra[t],Hi.clone(t.uniforms)):e.uniforms},acquireProgram:function(t,n){let r;for(let e=0,t=o.length;e<t;e++){var a=o[e];if(a.cacheKey===n){++(r=a).usedTimes;break}}return void 0===r&&(r=new Io(e,n,t,i),o.push(r)),r},releaseProgram:function(e){var t;0==--e.usedTimes&&(t=o.indexOf(e),o[t]=o[o.length-1],o.pop(),e.destroy())},programs:o}}function Do(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function zo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function No(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Oo(e){const t=[];let n=0;const r=[],i=[],a={id:-1};function o(r,i,o,s,l,c){let u=t[n];var h=e.get(o);return void 0===u?(u={id:r.id,object:r,geometry:i,material:o,program:h.program||a,groupOrder:s,renderOrder:r.renderOrder,z:l,group:c},t[n]=u):(u.id=r.id,u.object=r,u.geometry=i,u.material=o,u.program=h.program||a,u.groupOrder=s,u.renderOrder=r.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,a,s,l){e=o(e,t,n,a,s,l),(!0===n.transparent?i:r).push(e)},unshift:function(e,t,n,a,s,l){e=o(e,t,n,a,s,l),(!0===n.transparent?i:r).unshift(e)},finish:function(){for(let r=n,i=t.length;r<i;r++){var e=t[r];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.program=null,e.group=null}},sort:function(e,t){1<r.length&&r.sort(e||zo),1<i.length&&i.sort(t||No)}}}function Bo(e){let t=new WeakMap;return{get:function(n,r){let i;return!1===t.has(n)?(i=new Oo(e),t.set(n,[i])):r>=t.get(n).length?(i=new Oo(e),t.get(n).push(i)):i=t.get(n)[r],i},dispose:function(){t=new WeakMap}}}function Fo(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Tn,color:new Zr};break;case"SpotLight":n={position:new Tn,direction:new Tn,color:new Zr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Tn,color:new Zr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Tn,skyColor:new Zr,groundColor:new Zr};break;case"RectAreaLight":n={color:new Zr,position:new Tn,halfWidth:new Tn,halfHeight:new Tn}}return e[t.id]=n}}}let Uo=0;function Ho(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Vo(e,t){const n=new Fo,r=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new vn,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)i.probe.push(new Tn);const a=new Tn,o=new er,s=new er;return{setup:function(a){let o=0,s=0,l=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let c=0,u=0,h=0,d=0,p=0,f=0,m=0,v=0;a.sort(Ho);for(let e=0,t=a.length;e<t;e++){var g,y,x,w,b=a[e],_=b.color,M=b.intensity,E=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)o+=_.r*M,s+=_.g*M,l+=_.b*M;else if(b.isLightProbe)for(let e=0;e<9;e++)i.probe[e].addScaledVector(b.sh.coefficients[e],M);else b.isDirectionalLight?((x=n.get(b)).color.copy(b.color).multiplyScalar(b.intensity),b.castShadow&&(g=b.shadow,(y=r.get(b)).shadowBias=g.bias,y.shadowNormalBias=g.normalBias,y.shadowRadius=g.radius,y.shadowMapSize=g.mapSize,i.directionalShadow[c]=y,i.directionalShadowMap[c]=S,i.directionalShadowMatrix[c]=b.shadow.matrix,f++),i.directional[c]=x,c++):b.isSpotLight?((g=n.get(b)).position.setFromMatrixPosition(b.matrixWorld),g.color.copy(_).multiplyScalar(M),g.distance=E,g.coneCos=Math.cos(b.angle),g.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),g.decay=b.decay,b.castShadow&&(y=b.shadow,(x=r.get(b)).shadowBias=y.bias,x.shadowNormalBias=y.normalBias,x.shadowRadius=y.radius,x.shadowMapSize=y.mapSize,i.spotShadow[h]=x,i.spotShadowMap[h]=S,i.spotShadowMatrix[h]=b.shadow.matrix,v++),i.spot[h]=g,h++):b.isRectAreaLight?((E=n.get(b)).color.copy(_).multiplyScalar(M),E.halfWidth.set(.5*b.width,0,0),E.halfHeight.set(0,.5*b.height,0),i.rectArea[d]=E,d++):b.isPointLight?((_=n.get(b)).color.copy(b.color).multiplyScalar(b.intensity),_.distance=b.distance,_.decay=b.decay,b.castShadow&&(E=b.shadow,(w=r.get(b)).shadowBias=E.bias,w.shadowNormalBias=E.normalBias,w.shadowRadius=E.radius,w.shadowMapSize=E.mapSize,w.shadowCameraNear=E.camera.near,w.shadowCameraFar=E.camera.far,i.pointShadow[u]=w,i.pointShadowMap[u]=S,i.pointShadowMatrix[u]=b.shadow.matrix,m++),i.point[u]=_,u++):b.isHemisphereLight&&((E=n.get(b)).skyColor.copy(b.color).multiplyScalar(M),E.groundColor.copy(b.groundColor).multiplyScalar(M),i.hemi[p]=E,p++)}0<d&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=na.LTC_FLOAT_1,i.rectAreaLTC2=na.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=na.LTC_HALF_1,i.rectAreaLTC2=na.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=o,i.ambient[1]=s,i.ambient[2]=l;var T=i.hash;T.directionalLength===c&&T.pointLength===u&&T.spotLength===h&&T.rectAreaLength===d&&T.hemiLength===p&&T.numDirectionalShadows===f&&T.numPointShadows===m&&T.numSpotShadows===v||(i.directional.length=c,i.spot.length=h,i.rectArea.length=d,i.point.length=u,i.hemi.length=p,i.directionalShadow.length=f,i.directionalShadowMap.length=f,i.pointShadow.length=m,i.pointShadowMap.length=m,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=f,i.pointShadowMatrix.length=m,i.spotShadowMatrix.length=v,T.directionalLength=c,T.pointLength=u,T.spotLength=h,T.rectAreaLength=d,T.hemiLength=p,T.numDirectionalShadows=f,T.numPointShadows=m,T.numSpotShadows=v,i.version=Uo++)},setupView:function(e,t){let n=0,r=0,l=0,c=0,u=0;var h=t.matrixWorldInverse;for(let t=0,v=e.length;t<v;t++){var d,p,f,m=e[t];m.isDirectionalLight?((d=i.directional[n]).direction.setFromMatrixPosition(m.matrixWorld),a.setFromMatrixPosition(m.target.matrixWorld),d.direction.sub(a),d.direction.transformDirection(h),n++):m.isSpotLight?((d=i.spot[l]).position.setFromMatrixPosition(m.matrixWorld),d.position.applyMatrix4(h),d.direction.setFromMatrixPosition(m.matrixWorld),a.setFromMatrixPosition(m.target.matrixWorld),d.direction.sub(a),d.direction.transformDirection(h),l++):m.isRectAreaLight?((p=i.rectArea[c]).position.setFromMatrixPosition(m.matrixWorld),p.position.applyMatrix4(h),s.identity(),o.copy(m.matrixWorld),o.premultiply(h),s.extractRotation(o),p.halfWidth.set(.5*m.width,0,0),p.halfHeight.set(0,.5*m.height,0),p.halfWidth.applyMatrix4(s),p.halfHeight.applyMatrix4(s),c++):m.isPointLight?((p=i.point[r]).position.setFromMatrixPosition(m.matrixWorld),p.position.applyMatrix4(h),r++):m.isHemisphereLight&&((f=i.hemi[u]).direction.setFromMatrixPosition(m.matrixWorld),f.direction.transformDirection(h),f.direction.normalize(),u++)}},state:i}}function Go(e,t){const n=new Vo(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Wo(e,t){let n=new WeakMap;return{get:function(r,i=0){let a;return!1===n.has(r)?(a=new Go(e,t),n.set(r,[a])):i>=n.get(r).length?(a=new Go(e,t),n.get(r).push(a)):a=n.get(r)[i],a},dispose:function(){n=new WeakMap}}}class jo extends Vr{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}jo.prototype.isMeshDepthMaterial=!0;class qo extends Vr{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Tn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}qo.prototype.isMeshDistanceMaterial=!0;function Xo(e,t,n){let r=new Qi;const i=new vn,a=new vn,o=new Mn,s=[],l=[],c={},u={0:1,1:0,2:2},h=new Vi({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new vn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONTAL_PASS=1;var p=new yi;p.setAttribute("position",new $r(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new Ni(p,h),m=this;function v(e,t,n){let r=s[n=e<<0|t<<1|n<<2];return void 0===r&&(r=new jo({depthPacking:3201,morphTargets:e,skinning:t}),s[n]=r),r}function g(e,t,n){let r=l[n=e<<0|t<<1|n<<2];return void 0===r&&(r=new qo({morphTargets:e,skinning:t}),l[n]=r),r}function y(t,n,r,i,a,o,s){let l=null,h=v,d=t.customDepthMaterial;if(!0===i.isPointLight&&(h=g,d=t.customDistanceMaterial),void 0===d){let e=!1,i=(!0===r.morphTargets&&(e=n.morphAttributes&&n.morphAttributes.position&&0<n.morphAttributes.position.length),!1);!0===t.isSkinnedMesh&&(!0===r.skinning?i=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=h(e,i,n=!0===t.isInstancedMesh)}else l=d;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){t=l.uuid,n=r.uuid;let e=c[t],i=(void 0===e&&(e={},c[t]=e),e[n]);void 0===i&&(i=l.clone(),e[n]=i),l=i}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:u[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=a,l.farDistance=o),l}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(s,l,c){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==s.length){var u,p,v=e.getRenderTarget(),g=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),w=e.state;w.setBlending(0),w.buffers.color.setClear(1,1,1,1),w.buffers.depth.setTest(!0),w.setScissorTest(!1);for(let m=0,v=s.length;m<v;m++){var b=s[m],_=b.shadow;if(void 0===_)console.warn("THREE.WebGLShadowMap:",b,"has no shadow.");else if(!1!==_.autoUpdate||!1!==_.needsUpdate){i.copy(_.mapSize);var M=_.getFrameExtents(),E=(i.multiply(M),a.copy(_.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(a.x=Math.floor(n/M.x),i.x=a.x*M.x,_.mapSize.x=a.x),i.y>n)&&(a.y=Math.floor(n/M.y),i.y=a.y*M.y,_.mapSize.y=a.y),null!==_.map||_.isPointLightShadow||3!==this.type||(M={minFilter:en,magFilter:en,format:on},_.map=new En(i.x,i.y,M),_.map.texture.name=b.name+".shadowMap",_.mapPass=new En(i.x,i.y,M),_.camera.updateProjectionMatrix()),null===_.map&&(M={minFilter:$t,magFilter:$t,format:on},_.map=new En(i.x,i.y,M),_.map.texture.name=b.name+".shadowMap",_.camera.updateProjectionMatrix()),e.setRenderTarget(_.map),e.clear(),_.getViewportCount());for(let n=0;n<E;n++){var S=_.getViewport(n);o.set(a.x*S.x,a.y*S.y,a.x*S.z,a.y*S.w),w.viewport(o),_.updateMatrices(b,n),r=_.getFrustum(),function n(i,a,o,s,l){if(!1===i.visible)return;if(i.layers.test(a.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===l)&&(!i.frustumCulled||r.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);const n=t.update(i),r=i.material;if(Array.isArray(r)){const t=n.groups;for(let a=0,c=t.length;a<c;a++){const c=t[a],u=r[c.materialIndex];if(u&&u.visible){const t=y(i,n,u,s,o.near,o.far,l);e.renderBufferDirect(o,null,n,t,i,c)}}}else if(r.visible){const t=y(i,n,r,s,o.near,o.far,l);e.renderBufferDirect(o,null,n,t,i,null)}}const c=i.children;for(let e=0,t=c.length;e<t;e++)n(c[e],a,o,s,l)}(l,c,_.camera,b,this.type)}_.isPointLightShadow||3!==this.type||(M=_,u=c,void 0,p=t.update(f),h.uniforms.shadow_pass.value=M.map.texture,h.uniforms.resolution.value=M.mapSize,h.uniforms.radius.value=M.radius,e.setRenderTarget(M.mapPass),e.clear(),e.renderBufferDirect(u,null,p,h,f,null),d.uniforms.shadow_pass.value=M.mapPass.texture,d.uniforms.resolution.value=M.mapSize,d.uniforms.radius.value=M.radius,e.setRenderTarget(M.map),e.clear(),e.renderBufferDirect(u,null,p,d,f,null)),_.needsUpdate=!1}}m.needsUpdate=!1,e.setRenderTarget(v,g,x)}}}function Yo(e,t,n){n=n.isWebGL2;const r=new function(){let t=!1;const n=new Mn;let r=null;const i=new Mn(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},i=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){(e?I:k)(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},a=new function(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(e){t||(e?I:k)(2960)},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null}}};let o={},s=null,l=!1,c=null,u=null,h=null,d=null,p=null,f=null,m=null,v=!1,g=null,y=null,x=null,w=null,b=null;const _=e.getParameter(35661);let M=!1,E=0;var S=e.getParameter(7938);-1!==S.indexOf("WebGL")?(E=parseFloat(/^WebGL (\d)/.exec(S)[1]),M=1<=E):-1!==S.indexOf("OpenGL ES")&&(E=parseFloat(/^OpenGL ES (\d)/.exec(S)[1]),M=2<=E);let T=null,A={};const L=new Mn,C=new Mn;function P(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<r;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,i);return a}const R={};function I(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function k(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}R[3553]=P(3553,3553,1),R[34067]=P(34067,34069,6),r.setClear(0,0,0,1),i.setClear(1),a.setClear(0),I(2929),i.setFunc(3),O(!1),B(1),I(2884),N(0);const D={100:32774,101:32778,102:32779},z=(n?(D[103]=32775,D[104]=32776):null!==(S=t.get("EXT_blend_minmax"))&&(D[103]=S.MIN_EXT,D[104]=S.MAX_EXT),{200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773});function N(t,n,r,i,a,o,s,g){if(0===t)!0===l&&(k(3042),l=!1);else if(!1===l&&(I(3042),l=!0),5!==t){if(t!==c||g!==v){if(100===u&&100===p||(e.blendEquation(32774),u=100,p=100),g)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}h=null,d=null,f=null,m=null,c=t,v=g}}else a=a||n,o=o||r,s=s||i,n===u&&a===p||(e.blendEquationSeparate(D[n],D[a]),u=n,p=a),r===h&&i===d&&o===f&&s===m||(e.blendFuncSeparate(z[r],z[i],z[o],z[s]),h=r,d=i,f=o,m=s),c=t,v=null}function O(t){g!==t&&(t?e.frontFace(2304):e.frontFace(2305),g=t)}function B(t){0!==t?(I(2884),t!==y&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):k(2884),y=t}function F(t,n,r){t?(I(32823),w===n&&b===r||(e.polygonOffset(n,r),w=n,b=r)):k(32823)}function U(t){void 0===t&&(t=33984+_-1),T!==t&&(e.activeTexture(t),T=t)}return{buffers:{color:r,depth:i,stencil:a},enable:I,disable:k,useProgram:function(t){return s!==t&&(e.useProgram(t),s=t,!0)},setBlending:N,setMaterial:function(e,t){(2===e.side?k:I)(2884);let n=1===e.side;O(n=t?!n:n),1===e.blending&&!1===e.transparent?N(0):N(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),t=e.stencilWrite,a.setTest(t),t&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),F(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:O,setCullFace:B,setLineWidth:function(t){t!==x&&(M&&e.lineWidth(t),x=t)},setPolygonOffset:F,setScissorTest:function(e){(e?I:k)(3089)},activeTexture:U,bindTexture:function(t,n){null===T&&U();let r=A[T];void 0===r&&(r={type:void 0,texture:void 0},A[T]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||R[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=A[T];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===L.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),L.copy(t))},viewport:function(t){!1===C.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),C.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},T=null,A={},s=null,l=!1,c=null,u=null,h=null,d=null,p=null,f=null,m=null,v=!1,g=null,y=null,x=null,w=null,b=null,r.reset(),i.reset(),a.reset()}}}function Zo(e,t,n,r,i,a,o){const s=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=new WeakMap;let p,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return f?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function v(e,t,n,r){let i=1;return(i=e.width>r||e.height>r?r/Math.max(e.width,e.height):i)<1||!0===t?"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?(t=(r=t?mn.floorPowerOfTwo:Math.floor)(i*e.width),r=r(i*e.height),void 0===p&&(p=m(t,r)),(n=n?m(t,r):p).width=t,n.height=r,n.getContext("2d").drawImage(e,0,0,t,r),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+t+"x"+r+")."),n):("data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e):e}function g(e){return mn.isPowerOfTwo(e.width)&&mn.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==$t&&e.minFilter!==en}function x(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(i,a))}function w(n,r,i){if(!1===s)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i)&&(a=33321),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i)&&(a=32849),33325!==(a=6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i)?32856:a)&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function b(e){return e===$t||1004===e||1005===e?9728:9729}function _(t){var n,i;(t=t.target).removeEventListener("dispose",_),n=t,void 0!==(i=r.get(n)).__webglInit&&(e.deleteTexture(i.__webglTexture),r.remove(n)),t.isVideoTexture&&d.delete(t),o.memory.textures--}function M(t){var n=((t=t.target).removeEventListener("dispose",M),t.texture),i=r.get(t),a=r.get(n);if(t){if(void 0!==a.__webglTexture&&e.deleteTexture(a.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(i.__webglFramebuffer[t]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[t]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&e.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer&&e.deleteRenderbuffer(i.__webglColorRenderbuffer),i.__webglDepthRenderbuffer&&e.deleteRenderbuffer(i.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}o.memory.textures--}let E=0;function S(e,t){var i,a=r.get(e);if(e.isVideoTexture&&(i=e,s=o.render.frame,d.get(i)!==s)&&(d.set(i,s),i.update()),0<e.version&&a.__version!==e.version){var s=e.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void R(a,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,a.__webglTexture)}function T(t,i){var o=r.get(t);if(0<t.version&&o.__version!==t.version){var l=o,u=t;t=i;if(6===u.image.length){P(l,u),n.activeTexture(33984+t),n.bindTexture(34067,l.__webglTexture),e.pixelStorei(37440,u.flipY),e.pixelStorei(37441,u.premultiplyAlpha),e.pixelStorei(3317,u.unpackAlignment),e.pixelStorei(37443,0);var h=u&&(u.isCompressedTexture||u.image[0].isCompressedTexture),d=u.image[0]&&u.image[0].isDataTexture,p=[];for(let e=0;e<6;e++)p[e]=h||d?d?u.image[e].image:u.image[e]:v(u.image[e],!1,!0,c);var f=g(t=p[0])||s,m=a.convert(u.format),b=a.convert(u.type),_=w(u.internalFormat,m,b);let r;if(C(34067,u,f),h){for(let e=0;e<6;e++){r=p[e].mipmaps;for(let t=0;t<r.length;t++){var M=r[t];u.format!==on&&u.format!==an?null!==m?n.compressedTexImage2D(34069+e,t,_,M.width,M.height,0,M.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+e,t,_,M.width,M.height,0,m,b,M.data)}}l.__maxMipLevel=r.length-1}else{r=u.mipmaps;for(let e=0;e<6;e++)if(d){n.texImage2D(34069+e,0,_,p[e].width,p[e].height,0,m,b,p[e].data);for(let t=0;t<r.length;t++){var E=r[t].image[e].image;n.texImage2D(34069+e,t+1,_,E.width,E.height,0,m,b,E.data)}}else{n.texImage2D(34069+e,0,_,m,b,p[e]);for(let t=0;t<r.length;t++){var S=r[t];n.texImage2D(34069+e,t+1,_,m,b,S.image[e])}}l.__maxMipLevel=r.length}y(u,f)&&x(34067,u,t.width,t.height),l.__version=u.version,u.onUpdate&&u.onUpdate(u)}}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}const A={1e3:10497,[Kt]:33071,1002:33648},L={[$t]:9728,1004:9984,1005:9986,[en]:9729,1007:9985,[tn]:9987};function C(n,a,o){o?(e.texParameteri(n,10242,A[a.wrapS]),e.texParameteri(n,10243,A[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,A[a.wrapR]),e.texParameteri(n,10240,L[a.magFilter]),e.texParameteri(n,10241,L[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===Kt&&a.wrapT===Kt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,b(a.magFilter)),e.texParameteri(n,10241,b(a.minFilter)),a.minFilter!==$t&&a.minFilter!==en&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")&&(o=t.get("EXT_texture_filter_anisotropic"),a.type===nn&&!1===t.has("OES_texture_float_linear")||!1===s&&1016===a.type&&!1===t.has("OES_texture_half_float_linear")||(1<a.anisotropy||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy))}function P(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",_),t.__webglTexture=e.createTexture(),o.memory.textures++)}function R(t,r,i){let o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),P(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0),i=r;i=!s&&(i.wrapS!==Kt||i.wrapT!==Kt||i.minFilter!==$t&&i.minFilter!==en)&&!1===g(r.image);var l=g(i=v(r.image,i,!1,u))||s,c=a.convert(r.format);let h,d=a.convert(r.type),p=w(r.internalFormat,c,d);C(o,r,l);var f=r.mipmaps;if(r.isDepthTexture)p=6402,s?p=r.type===nn?36012:1014===r.type?33190:r.type===rn?35056:33189:r.type===nn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===sn&&6402===p&&1012!==r.type&&1014!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=1012,d=a.convert(r.type)),r.format===ln&&6402===p&&(p=34041,r.type!==rn)&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=rn,d=a.convert(r.type)),n.texImage2D(3553,0,p,i.width,i.height,0,c,d,null);else if(r.isDataTexture)if(0<f.length&&l){for(let e=0,t=f.length;e<t;e++)h=f[e],n.texImage2D(3553,e,p,h.width,h.height,0,c,d,h.data);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,p,i.width,i.height,0,c,d,i.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(let e=0,t=f.length;e<t;e++)h=f[e],r.format!==on&&r.format!==an?null!==c?n.compressedTexImage2D(3553,e,p,h.width,h.height,0,h.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,e,p,h.width,h.height,0,c,d,h.data);t.__maxMipLevel=f.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,i.width,i.height,i.depth,0,c,d,i.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,i.width,i.height,i.depth,0,c,d,i.data),t.__maxMipLevel=0;else if(0<f.length&&l){for(let e=0,t=f.length;e<t;e++)h=f[e],n.texImage2D(3553,e,p,c,d,h);r.generateMipmaps=!1,t.__maxMipLevel=f.length-1}else n.texImage2D(3553,0,p,c,d,i),t.__maxMipLevel=0;y(r,l)&&x(o,r,i.width,i.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function I(t,i,o,s){var l=i.texture,c=a.convert(l.format),u=a.convert(l.type),h=w(l.internalFormat,c,u);32879===s||35866===s?n.texImage3D(s,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(s,0,h,i.width,i.height,0,c,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(l).__webglTexture,0),e.bindFramebuffer(36160,null)}function k(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;r?((o=n.depthTexture)&&o.isDepthTexture&&(o.type===nn?i=36012:1014===o.type&&(i=33190)),o=D(n),e.renderbufferStorageMultisample(36161,o,i,n.width,n.height)):e.renderbufferStorage(36161,i,n.width,n.height),e.framebufferRenderbuffer(36160,36096,36161,t)}else{var i,o;n.depthBuffer&&n.stencilBuffer?(r?(o=D(n),e.renderbufferStorageMultisample(36161,o,35056,n.width,n.height)):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)):(o=n.texture,t=a.convert(o.format),i=a.convert(o.type),o=w(o.internalFormat,t,i),r?(t=D(n),e.renderbufferStorageMultisample(36161,t,o,n.width,n.height)):e.renderbufferStorage(36161,o,n.width,n.height))}e.bindRenderbuffer(36161,null)}function D(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(h,e.samples):0}let z=!1,N=!1;this.allocateTextureUnit=function(){var e=E;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),E+=1,e},this.resetTextureUnits=function(){E=0},this.setTexture2D=S,this.setTexture2DArray=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?R(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);0<e.version&&i.__version!==e.version?R(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=T,this.setupRenderTarget=function(t){var i,l=t.texture,c=r.get(t),u=r.get(l),h=(t.addEventListener("dispose",M),u.__webglTexture=e.createTexture(),o.memory.textures++,!0===t.isWebGLCubeRenderTarget),d=!0===t.isWebGLMultisampleRenderTarget,p=l.isDataTexture3D||l.isDataTexture2DArray,f=g(t)||s;if(!s||l.format!==an||l.type!==nn&&1016!==l.type||(l.format=on,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else c.__webglFramebuffer=e.createFramebuffer(),d&&(s?(c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer),d=a.convert(l.format),i=a.convert(l.type),d=w(l.internalFormat,d,i),i=D(t),e.renderbufferStorageMultisample(36161,i,d,t.width,t.height),e.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),k(c.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(h){n.bindTexture(34067,u.__webglTexture),C(34067,l,f);for(let e=0;e<6;e++)I(c.__webglFramebuffer[e],t,36064,34069+e);y(l,f)&&x(34067,l,t.width,t.height),n.bindTexture(34067,null)}else{let e=3553;p&&(s?e=(i=l.isDataTexture3D)?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(e,u.__webglTexture),C(e,l,f),I(c.__webglFramebuffer,t,36064,e),y(l,f)&&x(3553,l,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&function(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");var a=n.__webglFramebuffer,o=t;if(o&&o.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,a),!o.depthTexture||!o.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(o.depthTexture).__webglTexture&&o.depthTexture.image.width===o.width&&o.depthTexture.image.height===o.height||(o.depthTexture.image.width=o.width,o.depthTexture.image.height=o.height,o.depthTexture.needsUpdate=!0),S(o.depthTexture,0),a=r.get(o.depthTexture).__webglTexture,o.depthTexture.format===sn)e.framebufferTexture2D(36160,36096,3553,a,0);else{if(o.depthTexture.format!==ln)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,a,0)}}else if(i){n.__webglDepthbuffer=[];for(let r=0;r<6;r++)e.bindFramebuffer(36160,n.__webglFramebuffer[r]),n.__webglDepthbuffer[r]=e.createRenderbuffer(),k(n.__webglDepthbuffer[r],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),k(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){var t,i,a=e.texture;y(a,g(e)||s)&&(t=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(a).__webglTexture,n.bindTexture(t,i),x(t,a,e.width,e.height),n.bindTexture(t,null))},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){var n=r.get(t),i=(e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer),t.width),a=t.height;let o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),S(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),N=!0),e=e.texture),T(e,t)}}function Jo(e,t,n){const r=n.isWebGL2;return{convert:function(e){let n;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(e===nn)return 5126;if(1016===e)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===an)return 6407;if(e===on)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(e===sn)return 6402;if(e===ln)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(33776===e||33777===e||33778===e||33779===e){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===e)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===e)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===e||37496===e)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(37492===e)return n.COMPRESSED_RGB8_ETC2;if(37496===e)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:36492===e?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===rn?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Qo(e=[]){Wi.call(this),this.cameras=e}Qo.prototype=Object.assign(Object.create(Wi.prototype),{constructor:Qo,isArrayCamera:!0});class Ko extends Sr{constructor(){super(),this.type="Group"}}function $o(){this._targetRay=null,this._grip=null,this._hand=null}function es(e,t){const n=this;let r=null,i=1,a=null,o="local-floor",s=null;const l=[],c=new Map,u=new Wi,h=(u.layers.enable(1),u.viewport=new Mn,new Wi),d=(h.layers.enable(2),h.viewport=new Mn,[u,h]),p=new Qo;p.layers.enable(1),p.layers.enable(2);let f=null,m=null;function v(e){var t=c.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function g(){c.forEach((function(e,t){e.disconnect(t)})),c.clear(),f=null,m=null,e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),M.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(e){var t=r.inputSources;for(let e=0;e<l.length;e++)c.set(t[e],l[e]);for(let t=0;t<e.removed.length;t++){var n=e.removed[t],i=c.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),c.delete(n))}for(let t=0;t<e.added.length;t++){var a=e.added[t],o=c.get(a);o&&o.dispatchEvent({type:"connected",data:a})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=l[e];return void 0===t&&(t=new $o,l[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=l[e];return void 0===t&&(t=new $o,l[e]=t),t.getGripSpace()},this.getHand=function(e){let t=l[e];return void 0===t&&(t=new $o,l[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=async function(e){null!==(r=e)&&(r.addEventListener("select",v),r.addEventListener("selectstart",v),r.addEventListener("selectend",v),r.addEventListener("squeeze",v),r.addEventListener("squeezestart",v),r.addEventListener("squeezeend",v),r.addEventListener("end",g),r.addEventListener("inputsourceschange",y),!0!==(e=t.getContextAttributes()).xrCompatible&&await t.makeXRCompatible(),e={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:i},e=new XRWebGLLayer(r,t,e),r.updateRenderState({baseLayer:e}),a=await r.requestReferenceSpace(o),M.setContext(r),M.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"}))};const x=new Tn,w=new Tn;function b(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){p.near=h.near=u.near=e.near,p.far=h.far=u.far=e.far,f===p.near&&m===p.far||(r.updateRenderState({depthNear:p.near,depthFar:p.far}),f=p.near,m=p.far);var t=e.parent,n=p.cameras;b(p,t);for(let e=0;e<n.length;e++)b(n[e],t);e.matrixWorld.copy(p.matrixWorld),e.matrix.copy(p.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);var i,a,o,s,l,c,d,v,g,y,_=e.children;for(let e=0,t=_.length;e<t;e++)_[e].updateMatrixWorld(!0);return 2===n.length?(e=p,i=u,a=h,x.setFromMatrixPosition(i.matrixWorld),w.setFromMatrixPosition(a.matrixWorld),o=x.distanceTo(w),s=i.projectionMatrix.elements,a=a.projectionMatrix.elements,l=s[14]/(s[10]-1),c=s[14]/(s[10]+1),d=(s[9]+1)/s[5],v=(s[9]-1)/s[5],g=l*(s=(s[8]-1)/s[0]),y=l*(a=(a[8]+1)/a[0]),s=(a=o/(a-s))*-s,i.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(s),e.translateZ(a),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),i=l+a,l=c+a,e.projectionMatrix.makePerspective(g-s,o-s+y,d*c/l*i,v*c/l*i,i,l)):p.projectionMatrix.copy(u.projectionMatrix),p};let _=null;const M=new Ki;M.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(a))){var i=s.views,o=r.renderState.baseLayer;e.setFramebuffer(o.framebuffer);let t=!1;i.length!==p.cameras.length&&(p.cameras.length=0,t=!0);for(let e=0;e<i.length;e++){var c=i[e],u=o.getViewport(c),h=d[e];h.matrix.fromArray(c.transform.matrix),h.projectionMatrix.fromArray(c.projectionMatrix),h.viewport.set(u.x,u.y,u.width,u.height),0===e&&p.matrix.copy(h.matrix),!0===t&&p.cameras.push(h)}}var f=r.inputSources;for(let e=0;e<l.length;e++){var m=l[e],v=f[e];m.update(v,n,a)}_&&_(t,n)})),this.setAnimationLoop=function(e){_=e},this.dispose=function(){}}function ts(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r=e.get(n).envMap;let i,a;r&&(t.envMap.value=r,t.flipEnvMap.value=r.isCubeTexture&&r._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio,void 0!==(r=e.get(r).__maxMipLevel))&&(t.maxMipLevel.value=r),n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?i=n.map:n.specularMap?i=n.specularMap:n.displacementMap?i=n.displacementMap:n.normalMap?i=n.normalMap:n.bumpMap?i=n.bumpMap:n.roughnessMap?i=n.roughnessMap:n.metalnessMap?i=n.metalnessMap:n.alphaMap?i=n.alphaMap:n.emissiveMap?i=n.emissiveMap:n.clearcoatMap?i=n.clearcoatMap:n.clearcoatNormalMap?i=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(i=n.clearcoatRoughnessMap),void 0!==i&&(!0===(i=i.isWebGLRenderTarget?i.texture:i).matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(!0===(a=a.isWebGLRenderTarget?a.texture:a).matrixAutoUpdate&&a.updateMatrix(),t.uv2Transform.value.copy(a.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side)&&(t.bumpScale.value*=-1),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side)&&t.normalScale.value.negate(),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a){if(r.isMeshBasicMaterial)t(e,r);else if(r.isMeshLambertMaterial)t(e,r),f=e,(m=r).emissiveMap&&(f.emissiveMap.value=m.emissiveMap);else if(r.isMeshToonMaterial)t(e,r),f=e,(m=r).gradientMap&&(f.gradientMap.value=m.gradientMap),m.emissiveMap&&(f.emissiveMap.value=m.emissiveMap),m.bumpMap&&(f.bumpMap.value=m.bumpMap,f.bumpScale.value=m.bumpScale,1===m.side)&&(f.bumpScale.value*=-1),m.normalMap&&(f.normalMap.value=m.normalMap,f.normalScale.value.copy(m.normalScale),1===m.side)&&f.normalScale.value.negate(),m.displacementMap&&(f.displacementMap.value=m.displacementMap,f.displacementScale.value=m.displacementScale,f.displacementBias.value=m.displacementBias);else if(r.isMeshPhongMaterial){t(e,r);var o=e,s=r;o.specular.value.copy(s.specular),o.shininess.value=Math.max(s.shininess,1e-4),s.emissiveMap&&(o.emissiveMap.value=s.emissiveMap),s.bumpMap&&(o.bumpMap.value=s.bumpMap,o.bumpScale.value=s.bumpScale,1===s.side)&&(o.bumpScale.value*=-1),s.normalMap&&(o.normalMap.value=s.normalMap,o.normalScale.value.copy(s.normalScale),1===s.side)&&o.normalScale.value.negate(),s.displacementMap&&(o.displacementMap.value=s.displacementMap,o.displacementScale.value=s.displacementScale,o.displacementBias.value=s.displacementBias)}else if(r.isMeshStandardMaterial)t(e,r),r.isMeshPhysicalMaterial?(n(o=e,s=r),o.reflectivity.value=s.reflectivity,o.clearcoat.value=s.clearcoat,o.clearcoatRoughness.value=s.clearcoatRoughness,s.sheen&&o.sheen.value.copy(s.sheen),s.clearcoatMap&&(o.clearcoatMap.value=s.clearcoatMap),s.clearcoatRoughnessMap&&(o.clearcoatRoughnessMap.value=s.clearcoatRoughnessMap),s.clearcoatNormalMap&&(o.clearcoatNormalScale.value.copy(s.clearcoatNormalScale),o.clearcoatNormalMap.value=s.clearcoatNormalMap,1===s.side)&&o.clearcoatNormalScale.value.negate(),o.transmission.value=s.transmission,s.transmissionMap&&(o.transmissionMap.value=s.transmissionMap)):n(e,r);else if(r.isMeshMatcapMaterial){t(e,r);var l=e,c=r;c.matcap&&(l.matcap.value=c.matcap),c.bumpMap&&(l.bumpMap.value=c.bumpMap,l.bumpScale.value=c.bumpScale,1===c.side)&&(l.bumpScale.value*=-1),c.normalMap&&(l.normalMap.value=c.normalMap,l.normalScale.value.copy(c.normalScale),1===c.side)&&l.normalScale.value.negate(),c.displacementMap&&(l.displacementMap.value=c.displacementMap,l.displacementScale.value=c.displacementScale,l.displacementBias.value=c.displacementBias)}else if(r.isMeshDepthMaterial)t(e,r),l=e,(c=r).displacementMap&&(l.displacementMap.value=c.displacementMap,l.displacementScale.value=c.displacementScale,l.displacementBias.value=c.displacementBias);else if(r.isMeshDistanceMaterial){t(e,r);var u=e,h=r;h.displacementMap&&(u.displacementMap.value=h.displacementMap,u.displacementScale.value=h.displacementScale,u.displacementBias.value=h.displacementBias),u.referencePosition.value.copy(h.referencePosition),u.nearDistance.value=h.nearDistance,u.farDistance.value=h.farDistance}else if(r.isMeshNormalMaterial)t(e,r),u=e,(h=r).bumpMap&&(u.bumpMap.value=h.bumpMap,u.bumpScale.value=h.bumpScale,1===h.side)&&(u.bumpScale.value*=-1),h.normalMap&&(u.normalMap.value=h.normalMap,u.normalScale.value.copy(h.normalScale),1===h.side)&&u.normalScale.value.negate(),h.displacementMap&&(u.displacementMap.value=h.displacementMap,u.displacementScale.value=h.displacementScale,u.displacementBias.value=h.displacementBias);else if(r.isLineBasicMaterial)p=r,(d=e).diffuse.value.copy(p.color),d.opacity.value=p.opacity,r.isLineDashedMaterial&&(d=r,(p=e).dashSize.value=d.dashSize,p.totalSize.value=d.dashSize+d.gapSize,p.scale.value=d.scale);else if(r.isPointsMaterial){let t;d=r,(p=e).diffuse.value.copy(d.color),p.opacity.value=d.opacity,p.size.value=d.size*i,p.scale.value=.5*a,d.map&&(p.map.value=d.map),d.alphaMap&&(p.alphaMap.value=d.alphaMap),d.map?t=d.map:d.alphaMap&&(t=d.alphaMap),void 0!==t&&(!0===t.matrixAutoUpdate&&t.updateMatrix(),p.uvTransform.value.copy(t.matrix))}else if(r.isSpriteMaterial){let t;a=r,(i=e).diffuse.value.copy(a.color),i.opacity.value=a.opacity,i.rotation.value=a.rotation,a.map&&(i.map.value=a.map),a.alphaMap&&(i.alphaMap.value=a.alphaMap),a.map?t=a.map:a.alphaMap&&(t=a.alphaMap),void 0!==t&&(!0===t.matrixAutoUpdate&&t.updateMatrix(),i.uvTransform.value.copy(t.matrix))}else r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1);var d,p,f,m}}}function ns(e){const t=void 0!==(e=e||{}).canvas?e.canvas:((h=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",h),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;var h;let d=null,p=null;const f=[],m=[],v=(this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=cn,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this);let g=!1,y=null,x=0,w=0,b=null,_=null,M=-1,E=null;const S=new Mn,T=new Mn;let A=null,L=t.width,C=t.height,P=1,R=null,I=null;const k=new Mn(0,0,L,C),D=new Mn(0,0,L,C);let z=!1;const N=new Qi;let O=!1,B=!1;const F=new er,U=new Tn,H={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===b?P:1}let G,W,j,q,X,Y,Z,J,Q,K,$,ee,te,ne,re,ie,ae,oe,se,le,ce,ue=n;function he(e,n){for(let i=0;i<e.length;i++){var r=e[i];if(null!==(r=t.getContext(r,n)))return r}return null}try{var de={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if(t.addEventListener("webglcontextlost",ge,!1),t.addEventListener("webglcontextrestored",ye,!1),null===ue){var pe=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&pe.shift(),null===(ue=he(pe,de)))throw he(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function fe(){G=new ua(ue),W=new sa(ue,G,e),G.init(W),le=new Jo(ue,G,W),(j=new Yo(ue,G,W)).scissor(T.copy(D).multiplyScalar(P).floor()),j.viewport(S.copy(k).multiplyScalar(P).floor()),q=new pa(ue),X=new Do,Y=new Zo(ue,G,j,X,W,le,q),Z=new ca(v),J=new $i(ue,W),ce=new aa(ue,G,J,W),Q=new ha(ue,J,q,ce),K=new ga(ue,Q,J,q),ae=new va(ue),re=new la(X),$=new ko(v,Z,G,W,ce,re),ee=new ts(X),te=new Bo(X),ne=new Wo(G,W),ie=new ia(v,Z,j,K,s),oe=new oa(ue,G,q,W),se=new da(ue,G,q,W),q.programs=$.programs,v.capabilities=W,v.extensions=G,v.properties=X,v.renderLists=te,v.state=j,v.info=q}fe();const me=new es(v,ue),ve=(this.xr=me,new Xo(v,K,W.maxTextureSize));function ge(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ye(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1,fe()}function xe(e){(e=e.target).removeEventListener("dispose",xe),we(e=e),X.remove(e)}function we(e){void 0!==(e=X.get(e).program)&&$.releaseProgram(e)}this.shadowMap=ve,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){var e=G.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=G.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(e){void 0!==e&&(P=e,this.setSize(L,C,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new vn),e.set(L,C)},this.setSize=function(e,n,r){me.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(L=e,C=n,t.width=Math.floor(e*P),t.height=Math.floor(n*P),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new vn),e.set(L*P,C*P).floor()},this.setDrawingBufferSize=function(e,n,r){L=e,C=n,P=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Mn),e.copy(S)},this.getViewport=function(e){return e.copy(k)},this.setViewport=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),j.viewport(S.copy(k).multiplyScalar(P).floor())},this.getScissor=function(e){return e.copy(D)},this.setScissor=function(e,t,n,r){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,n,r),j.scissor(T.copy(D).multiplyScalar(P).floor())},this.getScissorTest=function(){return z},this.setScissorTest=function(e){j.setScissorTest(z=e)},this.setOpaqueSort=function(e){R=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new Zr),e.copy(ie.getClearColor())},this.setClearColor=function(){ie.setClearColor.apply(ie,arguments)},this.getClearAlpha=function(){return ie.getClearAlpha()},this.setClearAlpha=function(){ie.setClearAlpha.apply(ie,arguments)},this.clear=function(e,t,n){let r=0;void 0!==e&&!e||(r|=16384),void 0!==t&&!t||(r|=256),void 0!==n&&!n||(r|=1024),ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ge,!1),t.removeEventListener("webglcontextrestored",ye,!1),te.dispose(),ne.dispose(),X.dispose(),Z.dispose(),K.dispose(),ce.dispose(),me.dispose(),_e.stop()},this.renderBufferImmediate=function(e,t){ce.initAttributes();var n=X.get(e);e.hasPositions&&!n.position&&(n.position=ue.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ue.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ue.createBuffer()),e.hasColors&&!n.color&&(n.color=ue.createBuffer()),t=t.getAttributes();e.hasPositions&&(ue.bindBuffer(34962,n.position),ue.bufferData(34962,e.positionArray,35048),ce.enableAttribute(t.position),ue.vertexAttribPointer(t.position,3,5126,!1,0,0)),e.hasNormals&&(ue.bindBuffer(34962,n.normal),ue.bufferData(34962,e.normalArray,35048),ce.enableAttribute(t.normal),ue.vertexAttribPointer(t.normal,3,5126,!1,0,0)),e.hasUvs&&(ue.bindBuffer(34962,n.uv),ue.bufferData(34962,e.uvArray,35048),ce.enableAttribute(t.uv),ue.vertexAttribPointer(t.uv,2,5126,!1,0,0)),e.hasColors&&(ue.bindBuffer(34962,n.color),ue.bufferData(34962,e.colorArray,35048),ce.enableAttribute(t.color),ue.vertexAttribPointer(t.color,3,5126,!1,0,0)),ce.disableUnusedAttributes(),ue.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=H);var o=i.isMesh&&i.matrixWorld.determinant()<0;e=Te(e,t,r,i);j.setMaterial(r,o);let s=n.index;if(t=n.attributes.position,null===s){if(void 0===t||0===t.count)return}else if(0===s.count)return;let l=1,c=(!0===r.wireframe&&(s=Q.getWireframeAttribute(n),l=2),(r.morphTargets||r.morphNormals)&&ae.update(i,n,r,e),ce.setup(i,r,e,n,s),oe);null!==s&&(o=J.get(s),(c=se).setIndex(o));e=(null!==s?s:t).count,o=n.drawRange.start*l,t=n.drawRange.count*l;var u=null!==a?a.start*l:0,h=(a=null!==a?a.count*l:1/0,Math.max(o,u));e=Math.min(e,o+t,u+a)-1;if(0!==(o=Math.max(0,e-h+1))){if(i.isMesh)!0===r.wireframe?(j.setLineWidth(r.wireframeLinewidth*V()),c.setMode(1)):c.setMode(4);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),j.setLineWidth(e*V()),i.isLineSegments?c.setMode(1):i.isLineLoop?c.setMode(2):c.setMode(3)}else i.isPoints?c.setMode(0):i.isSprite&&c.setMode(4);i.isInstancedMesh?c.renderInstances(h,o,i.count):n.isInstancedBufferGeometry?(t=Math.min(n.instanceCount,n._maxInstanceCount),c.renderInstances(h,o,t)):c.render(h,o)}},this.compile=function(e,t){(p=ne.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(p.pushLight(e),e.castShadow)&&p.pushShadow(e)})),p.setupLights();const n=new WeakMap;e.traverse((function(t){var r=t.material;if(r)if(Array.isArray(r))for(let a=0;a<r.length;a++){var i=r[a];!1===n.has(i)&&(Se(i,e,t),n.set(i))}else!1===n.has(r)&&(Se(r,e,t),n.set(r))}))};let be=null;const _e=new Ki;function Me(e,t,n){var r=!0===t.isScene?t.overrideMaterial:null;for(let h=0,d=e.length;h<d;h++){var i=e[h],a=i.object,o=i.geometry,s=null===r?i.material:r,l=i.group;if(n.isArrayCamera){var c=n.cameras;for(let e=0,n=c.length;e<n;e++){var u=c[e];a.layers.test(u.layers)&&(j.viewport(S.copy(u.viewport)),p.setupLightsView(u),Ee(a,t,u,o,s,l))}}else Ee(a,t,n,o,s,l)}}function Ee(e,t,n,r,i,a){var o,s;e.onBeforeRender(v,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject?(o=Te(n,t,i,e),j.setMaterial(i),ce.reset(),s=o,e.render((function(e){v.renderBufferImmediate(e,s)}))):v.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(v,t,n,r,i,a)}function Se(e,t,n){!0!==t.isScene&&(t=H);var r=X.get(e),i=p.state.lights,a=p.state.shadowsArray,o=i.state.version,s=(a=$.getParameters(e,i.state,a,t,n),n=$.getProgramCacheKey(a),r.program);let l=!0;if(r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=Z.get(e.envMap||r.environment),void 0===s)e.addEventListener("dispose",xe);else if(s.cacheKey!==n)we(e);else{if(r.lightsStateVersion===o&&void 0!==a.shaderID)return;l=!1}l&&(a.uniforms=$.getUniforms(e),e.onBeforeCompile(a,v),s=$.acquireProgram(a,n),r.program=s,r.uniforms=a.uniforms,r.outputEncoding=a.outputEncoding),t=r.uniforms,(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=re.numPlanes,r.numIntersection=re.numIntersection,t.clippingPlanes=re.uniform),r.needsLights=(n=e).isMeshLambertMaterial||n.isMeshToonMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isShadowMaterial||n.isShaderMaterial&&!0===n.lights,r.lightsStateVersion=o,r.needsLights&&(t.ambientLightColor.value=i.state.ambient,t.lightProbe.value=i.state.probe,t.directionalLights.value=i.state.directional,t.directionalLightShadows.value=i.state.directionalShadow,t.spotLights.value=i.state.spot,t.spotLightShadows.value=i.state.spotShadow,t.rectAreaLights.value=i.state.rectArea,t.ltc_1.value=i.state.rectAreaLTC1,t.ltc_2.value=i.state.rectAreaLTC2,t.pointLights.value=i.state.point,t.pointLightShadows.value=i.state.pointShadow,t.hemisphereLights.value=i.state.hemi,t.directionalShadowMap.value=i.state.directionalShadowMap,t.directionalShadowMatrix.value=i.state.directionalShadowMatrix,t.spotShadowMap.value=i.state.spotShadowMap,t.spotShadowMatrix.value=i.state.spotShadowMatrix,t.pointShadowMap.value=i.state.pointShadowMap,t.pointShadowMatrix.value=i.state.pointShadowMatrix),s=r.program.getUniforms(),a=fo.seqWithValue(s.seq,t),r.uniformsList=a}function Te(e,t,n,r){!0!==t.isScene&&(t=H),Y.resetTextureUnits();var i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===b?v.outputEncoding:b.texture.encoding,s=Z.get(n.envMap||a),l=X.get(n),c=p.state.lights;!0!==O||!0!==B&&e===E||(f=e===E&&n.id===M,re.setState(n,e,f)),n.version===l.__version?(n.fog&&l.fog!==i||l.environment!==a||l.needsLights&&l.lightsStateVersion!==c.state.version||void 0!==l.numClippingPlanes&&(l.numClippingPlanes!==re.numPlanes||l.numIntersection!==re.numIntersection)||l.outputEncoding!==o||l.envMap!==s)&&Se(n,t,r):(Se(n,t,r),l.__version=n.version);let u=!1,h=!1,d=!1;var f=l.program;a=f.getUniforms(),c=l.uniforms;return j.useProgram(f.program)&&(u=!0,h=!0,d=!0),n.id!==M&&(M=n.id,h=!0),(u||E!==e)&&(a.setValue(ue,"projectionMatrix",e.projectionMatrix),W.logarithmicDepthBuffer&&a.setValue(ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),E!==e&&(E=e,h=!0,d=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(o=a.map.cameraPosition)&&o.setValue(ue,U.setFromMatrixPosition(e.matrixWorld)),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&a.setValue(ue,"isOrthographic",!0===e.isOrthographicCamera),n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&a.setValue(ue,"viewMatrix",e.matrixWorldInverse),n.skinning&&(a.setOptional(ue,r,"bindMatrix"),a.setOptional(ue,r,"bindMatrixInverse"),s=r.skeleton)&&(t=s.bones,W.floatVertexTextures?(null===s.boneTexture&&(o=Math.sqrt(4*t.length),o=mn.ceilPowerOfTwo(o),o=Math.max(o,4),(e=new Float32Array(o*o*4)).set(s.boneMatrices),t=new Yi(e,o,o,on,nn),s.boneMatrices=e,s.boneTexture=t,s.boneTextureSize=o),a.setValue(ue,"boneTexture",s.boneTexture,Y),a.setValue(ue,"boneTextureSize",s.boneTextureSize)):a.setOptional(ue,s,"boneMatrices")),!h&&l.receiveShadow===r.receiveShadow||(l.receiveShadow=r.receiveShadow,a.setValue(ue,"receiveShadow",r.receiveShadow)),h&&(a.setValue(ue,"toneMappingExposure",v.toneMappingExposure),l.needsLights&&(t=d,(e=c).ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t),i&&n.fog&&ee.refreshFogUniforms(c,i),ee.refreshMaterialUniforms(c,n,P,C),fo.upload(ue,l.uniformsList,c,Y)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(fo.upload(ue,l.uniformsList,c,Y),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&a.setValue(ue,"center",r.center),a.setValue(ue,"modelViewMatrix",r.modelViewMatrix),a.setValue(ue,"normalMatrix",r.normalMatrix),a.setValue(ue,"modelMatrix",r.matrixWorld),f}_e.setAnimationLoop((function(e){me.isPresenting||be&&be(e)})),"undefined"!=typeof window&&_e.setContext(window),this.setAnimationLoop=function(e){be=e,me.setAnimationLoop(e),null===e?_e.stop():_e.start()},this.render=function(e,t){let n,r;var i,a;void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0!==t&&!0!==t.isCamera?console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."):!0!==g&&(ce.resetDefaultState(),M=-1,!(E=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===me.enabled&&!0===me.isPresenting&&(t=me.getCamera(t)),!0===e.isScene&&e.onBeforeRender(v,e,t,n||b),(p=ne.get(e,m.length)).init(),m.push(p),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),N.setFromProjectionMatrix(F),B=this.localClippingEnabled,O=re.init(this.clippingPlanes,B,t),(d=te.get(e,f.length)).init(),f.push(d),function e(t,n,r,i){if(!1===t.visible)return;if(t.layers.test(n.layers))if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(n);else if(t.isLight)p.pushLight(t),t.castShadow&&p.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||N.intersectsSprite(t)){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=K.update(t),n=t.material;n.visible&&d.push(t,e,n,r,U.z,null)}}else if(t.isImmediateRenderObject)i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F),d.push(t,null,t.material,r,U.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==q.render.frame&&(t.skeleton.update(),t.skeleton.frame=q.render.frame),!t.frustumCulled||N.intersectsObject(t))){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=K.update(t),n=t.material;if(Array.isArray(n)){const i=e.groups;for(let a=0,o=i.length;a<o;a++){const o=i[a],s=n[o.materialIndex];s&&s.visible&&d.push(t,e,s,r,U.z,o)}}else n.visible&&d.push(t,e,n,r,U.z,null)}const a=t.children;for(let t=0,o=a.length;t<o;t++)e(a[t],n,r,i)}(e,t,0,v.sortObjects),d.finish(),!0===v.sortObjects&&d.sort(R,I),!0===O&&re.beginShadows(),i=p.state.shadowsArray,ve.render(i,e,t),p.setupLights(),p.setupLightsView(t),!0===O&&re.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ie.render(d,e,t,r),i=d.opaque,a=d.transparent,0<i.length&&Me(i,e,t),0<a.length&&Me(a,e,t),!0===e.isScene&&e.onAfterRender(v,e,t),null!==b&&(Y.updateRenderTargetMipmap(b),Y.updateMultisampleRenderTarget(b)),j.buffers.depth.setTest(!0),j.buffers.depth.setMask(!0),j.buffers.color.setMask(!0),j.setPolygonOffset(!1),m.pop(),p=0<m.length?m[m.length-1]:null,f.pop(),d=0<f.length?f[f.length-1]:null)},this.setFramebuffer=function(e){y!==e&&null===b&&ue.bindFramebuffer(36160,e),y=e},this.getActiveCubeFace=function(){return x},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e,t=0,n=0){b=e,x=t,w=n,e&&void 0===X.get(e).__webglFramebuffer&&Y.setupRenderTarget(e);let r=y,i=!1,a=!1;var o;A=e?(((o=e.texture).isDataTexture3D||o.isDataTexture2DArray)&&(a=!0),o=X.get(e).__webglFramebuffer,e.isWebGLCubeRenderTarget?(r=o[t],i=!0):r=e.isWebGLMultisampleRenderTarget?X.get(e).__webglMultisampledFramebuffer:o,S.copy(e.viewport),T.copy(e.scissor),e.scissorTest):(S.copy(k).multiplyScalar(P).floor(),T.copy(D).multiplyScalar(P).floor(),z),_!==r&&(ue.bindFramebuffer(36160,r),_=r),j.viewport(S),j.scissor(T),j.setScissorTest(A),i?(o=X.get(e.texture),ue.framebufferTexture2D(36160,36064,34069+t,o.__webglTexture,n)):a&&(o=X.get(e.texture),e=t||0,ue.framebufferTextureLayer(36160,36064,o.__webglTexture,n||0,e))},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){let h=X.get(e).__webglFramebuffer;if(h=e.isWebGLCubeRenderTarget&&void 0!==o?h[o]:h){let o=!1;h!==_&&(ue.bindFramebuffer(36160,h),o=!0);try{var s,l=e.texture,c=l.format,u=l.type;c!==on&&le.convert(c)!==ue.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):(s=1016===u&&(G.has("EXT_color_buffer_half_float")||W.isWebGL2&&G.has("EXT_color_buffer_float")),1009===u||le.convert(u)===ue.getParameter(35738)||u===nn&&(W.isWebGL2||G.has("OES_texture_float")||G.has("WEBGL_color_buffer_float"))||s?36053===ue.checkFramebufferStatus(36160)?0<=t&&t<=e.width-r&&0<=n&&n<=e.height-i&&ue.readPixels(t,n,r,i,le.convert(c),le.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type."))}finally{o&&ue.bindFramebuffer(36160,_)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n=0){var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=(r=Math.floor(t.image.height*r),le.convert(t.format));Y.setTexture2D(t,0),ue.copyTexImage2D(3553,n,a,e.x,e.y,i,r,0),j.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r=0){var i=t.image.width,a=t.image.height,o=le.convert(n.format),s=le.convert(n.type);Y.setTexture2D(n,0),ue.pixelStorei(37440,n.flipY),ue.pixelStorei(37441,n.premultiplyAlpha),ue.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ue.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ue.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ue.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ue.generateMipmap(3553),j.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r,i=0){if(v.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var{width:n,height:a,data:o}=n.image,s=le.convert(r.format),l=le.convert(r.type);let f;if(r.isDataTexture3D)Y.setTexture3D(r,0),f=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Y.setTexture2DArray(r,0),f=35866}ue.pixelStorei(37440,r.flipY),ue.pixelStorei(37441,r.premultiplyAlpha),ue.pixelStorei(3317,r.unpackAlignment);var c=ue.getParameter(3314),u=ue.getParameter(32878),h=ue.getParameter(3316),d=ue.getParameter(3315),p=ue.getParameter(32877);ue.pixelStorei(3314,n),ue.pixelStorei(32878,a),ue.pixelStorei(3316,e.min.x),ue.pixelStorei(3315,e.min.y),ue.pixelStorei(32877,e.min.z),ue.texSubImage3D(f,i,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,s,l,o),ue.pixelStorei(3314,c),ue.pixelStorei(32878,u),ue.pixelStorei(3316,h),ue.pixelStorei(3315,d),ue.pixelStorei(32877,p),0===i&&r.generateMipmaps&&ue.generateMipmap(f),j.unbindTexture()}},this.initTexture=function(e){Y.setTexture2D(e,0),j.unbindTexture()},this.resetState=function(){j.reset(),ce.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ko.prototype.isGroup=!0,Object.assign($o.prototype,{constructor:$o,getHandSpace:function(){return null===this._hand&&(this._hand=new Ko,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ko,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ko,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){let r=null,i=null,a=null;var o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(l&&e.hand){a=!0;for(const r of e.hand.values()){var c=t.getJointPose(r,n),u=(void 0===l.joints[r.jointName]&&((u=new Ko).matrixAutoUpdate=!1,u.visible=!1,l.joints[r.jointName]=u,l.add(u)),l.joints[r.jointName]);null!==c&&(u.matrix.fromArray(c.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.jointRadius=c.radius),u.visible=null!==c}var h=l.joints["index-finger-tip"],d=l.joints["thumb-tip"];h=h.position.distanceTo(d.position);l.inputState.pinching&&.025<h?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}}),Object.assign(es.prototype,dn.prototype);class rs{constructor(e,t){this.name="",this.color=new Zr(e),this.density=void 0!==t?t:25e-5}clone(){return new rs(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}rs.prototype.isFogExp2=class extends ns{}.prototype.isWebGL1Renderer=!0;class is{constructor(e,t,n){this.name="",this.color=new Zr(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}clone(){return new is(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}is.prototype.isFog=!0;class as extends Sr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){var t=super.toJSON(e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}function os(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=un,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=mn.generateUUID()}as.prototype.isScene=!0,Object.defineProperty(os.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(os.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t=0){return this.array.set(e,t),this},clone:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mn.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer),(e=new os(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride)).setUsage(this.usage),e},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mn.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const ss=new Tn;function ls(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}Object.defineProperties(ls.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(ls.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,n=this.data.count;t<n;t++)ss.x=this.getX(t),ss.y=this.getY(t),ss.z=this.getZ(t),ss.applyMatrix4(e),this.setXYZ(t,ss.x,ss.y,ss.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},clone:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ls(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");var t=[];for(let e=0;e<this.count;e++){var n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new $r(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");var t=[];for(let e=0;e<this.count;e++){var n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}});class cs extends Vr{constructor(e){super(),this.type="SpriteMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let us;cs.prototype.isSpriteMaterial=!0;const hs=new Tn,ds=new Tn,ps=new Tn,fs=new vn,ms=new vn,vs=new er,gs=new Tn,ys=new Tn,xs=new Tn,ws=new vn,bs=new vn,_s=new vn;function Ms(e,t,n,r,i,a){fs.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(ms.x=a*fs.x-i*fs.y,ms.y=i*fs.x+a*fs.y):ms.copy(fs),e.copy(t),e.x+=ms.x,e.y+=ms.y,e.applyMatrix4(vs)}(class extends Sr{constructor(e){var t;super(),this.type="Sprite",void 0===us&&(us=new yi,t=new os(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5),us.setIndex([0,1,2,0,2,3]),us.setAttribute("position",new ls(t,3,0,!1)),us.setAttribute("uv",new ls(t,2,3,!1))),this.geometry=us,this.material=void 0!==e?e:new cs,this.center=new vn(.5,.5)}raycast(e,t){let n,r;null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ds.setFromMatrixScale(this.matrixWorld),vs.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ps.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ds.multiplyScalar(-ps.z),0!==(i=this.material.rotation)&&(r=Math.cos(i),n=Math.sin(i));var i=this.center,a=(Ms(gs.set(-.5,-.5,0),ps,i,ds,n,r),Ms(ys.set(.5,-.5,0),ps,i,ds,n,r),Ms(xs.set(.5,.5,0),ps,i,ds,n,r),ws.set(0,0),bs.set(1,0),_s.set(1,1),e.ray.intersectTriangle(gs,ys,xs,!1,hs));null===a&&(Ms(ys.set(-.5,.5,0),ps,i,ds,n,r),bs.set(0,1),null===(a=e.ray.intersectTriangle(gs,xs,ys,!1,hs)))||(i=e.ray.origin.distanceTo(hs))<e.near||i>e.far||t.push({distance:i,point:hs.clone(),uv:Ur.getUV(hs,gs,ys,xs,ws,bs,_s,new vn),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const Es=new Tn,Ss=new Tn;const Ts=new Tn,As=new Mn,Ls=new Mn,Cs=new Tn,Ps=new er;function Rs(e,t){Ni.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new er,this.bindMatrixInverse=new er}function Is(){Sr.call(this),this.type="Bone"}Rs.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Rs,isSkinnedMesh:!0,copy:function(e){return Ni.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e=new Mn,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);var n=1/e.manhattanLength();n!=1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Ni.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;As.fromBufferAttribute(r.attributes.skinIndex,e),Ls.fromBufferAttribute(r.attributes.skinWeight,e),Ts.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){var i,a=Ls.getComponent(e);0!==a&&(i=As.getComponent(e),Ps.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(Cs.copy(Ts).applyMatrix4(Ps),a))}return t.applyMatrix4(this.bindMatrixInverse)}}),Is.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Is,isBone:!0});const ks=new er,Ds=new er;class zs{constructor(e=[],t=[]){this.uuid=mn.generateUUID(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new er)}}calculateInverses(){for(let t=this.boneInverses.length=0,n=this.bones.length;t<n;t++){var e=new er;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,n=this.bones.length;t<n;t++){var e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let e=0,n=this.bones.length;e<n;e++){var t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,a=e.length;r<a;r++){var i=e[r]?e[r].matrixWorld:Ds;ks.multiplyMatrices(i,t[r]),ks.toArray(n,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new zs(this.bones,this.boneInverses)}getBoneByName(e){for(let n=0,r=this.bones.length;n<r;n++){var t=this.bones[n];if(t.name===e)return t}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){var n=e.bones[r];let i=t[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new Is),this.bones.push(i),this.boneInverses.push((new er).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]},t=(e.uuid=this.uuid,this.bones),n=this.boneInverses;for(let i=0,a=t.length;i<a;i++){var r=t[i];r=(e.bones.push(r.uuid),n[i]);e.boneInverses.push(r.toArray())}return e}}const Ns=new er,Os=new er,Bs=[],Fs=new Ni;function Us(e,t,n){Ni.call(this,e,t),this.instanceMatrix=new $r(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}Us.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Us,isInstancedMesh:!0,copy:function(e){return Ni.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Fs.geometry=this.geometry,Fs.material=this.material,void 0!==Fs.material)for(let a=0;a<r;a++){this.getMatrixAt(a,Ns),Os.multiplyMatrices(n,Ns),Fs.matrixWorld=Os,Fs.raycast(e,Bs);for(let e=0,n=Bs.length;e<n;e++){var i=Bs[e];i.instanceId=a,i.object=this,t.push(i)}Bs.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new $r(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Hs extends Vr{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Zr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}Hs.prototype.isLineBasicMaterial=!0;const Vs=new Tn,Gs=new Tn,Ws=new er,js=new $n,qs=new jn;function Xs(e=new yi,t=new Hs){Sr.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}Xs.prototype=Object.assign(Object.create(Sr.prototype),{constructor:Xs,isLine:!0,copy:function(e){return Sr.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){var t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Vs.fromBufferAttribute(t,e-1),Gs.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Vs.distanceTo(Gs);e.setAttribute("lineDistance",new li(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),qs.copy(n.boundingSphere),qs.applyMatrix4(r),qs.radius+=i,!1!==e.ray.intersectsSphere(qs)){Ws.copy(r).invert(),js.copy(e.ray).applyMatrix4(Ws);var a=(r=i/((this.scale.x+this.scale.y+this.scale.z)/3))*r,o=new Tn,s=new Tn,l=new Tn,c=new Tn,u=this.isLineSegments?2:1;if(n.isBufferGeometry){i=n.index;var h,d=n.attributes.position;if(null!==i){var p=i.array;for(let n=0,r=p.length-1;n<r;n+=u){var f=p[n],m=p[n+1];a<(f=(o.fromBufferAttribute(d,f),s.fromBufferAttribute(d,m),js.distanceSqToSegment(o,s,c,l)))||(c.applyMatrix4(this.matrixWorld),(m=e.ray.origin.distanceTo(c))<e.near)||m>e.far||t.push({distance:m,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else for(let n=0,r=d.count-1;n<r;n+=u)o.fromBufferAttribute(d,n),s.fromBufferAttribute(d,n+1),a<js.distanceSqToSegment(o,s,c,l)||(c.applyMatrix4(this.matrixWorld),(h=e.ray.origin.distanceTo(c))<e.near)||h>e.far||t.push({distance:h,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){var i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});const Ys=new Tn,Zs=new Tn;function Js(e,t){Xs.call(this,e,t),this.type="LineSegments"}Js.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Js,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){var t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)Ys.fromBufferAttribute(t,e),Zs.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Ys.distanceTo(Zs);e.setAttribute("lineDistance",new li(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});(class extends Xs{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Qs extends Vr{constructor(e){super(),this.type="PointsMaterial",this.color=new Zr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}Qs.prototype.isPointsMaterial=!0;const Ks=new er,$s=new $n,el=new jn,tl=new Tn;function nl(e=new yi,t=new Qs){Sr.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function rl(e,t,n,r,i,a,o){var s=$s.distanceSqToPoint(e);s<n&&(n=new Tn,$s.closestPointToPoint(e,n),n.applyMatrix4(r),(e=i.ray.origin.distanceTo(n))<i.near||e>i.far||a.push({distance:e,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:o}))}nl.prototype=Object.assign(Object.create(Sr.prototype),{constructor:nl,isPoints:!0,copy:function(e){return Sr.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),el.copy(n.boundingSphere),el.applyMatrix4(r),el.radius+=i,!1!==e.ray.intersectsSphere(el)){Ks.copy(r).invert(),$s.copy(e.ray).applyMatrix4(Ks);var a=(i=i/((this.scale.x+this.scale.y+this.scale.z)/3))*i;if(n.isBufferGeometry){i=n.index;var o=n.attributes.position;if(null!==i){var s=i.array;for(let n=0,i=s.length;n<i;n++){var l=s[n];tl.fromBufferAttribute(o,l),rl(tl,l,a,r,e,t,this)}}else for(let n=0,i=o.count;n<i;n++)tl.fromBufferAttribute(o,n),rl(tl,n,a,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(0<n.length){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){var i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}else void 0!==(t=e.morphTargets)&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}});class il extends bn{constructor(e,t,n,r,i,a,o,s,l,c,u,h){super(null,a,o,s,l,c,r,i,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}il.prototype.isCompressedTexture=class extends bn{constructor(e,t,n,r,i,a,o,s,l){super(e,t,n,r,i,a,o,s,l),this.format=void 0!==o?o:an,this.minFilter=void 0!==a?a:en,this.magFilter=void 0!==i?i:en,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){var e=this.image;0=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class extends bn{constructor(e,t,n,r,i,a,o,s,l,c){if((c=void 0!==c?c:sn)!==sn&&c!==ln)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,i,a,o,s,c,n=void 0===(n=void 0===n&&c===sn?1012:n)&&c===ln?rn:n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:$t,this.minFilter=void 0!==s?s:$t,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=class extends bn{constructor(e,t,n,r,i,a,o,s,l){super(e,t,n,r,i,a,o,s,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;new Tn,new Tn,new Tn,new Ur;const al=function(e,t,n){n=n||2;var r=t&&t.length,i=r?t[0]*n:e.length;let a=ol(e,0,i,n,!0);var o=[];if(a&&a.next!==a.prev){let s,l,c,u,h,d,p;if(r&&(a=function(e,t,n,r){var i=[];let a,o,s,l,c;for(a=0,o=t.length;a<o;a++)s=t[a]*r,l=a<o-1?t[a+1]*r:e.length,(c=ol(e,s,l,r,!1))===c.next&&(c.steiner=!0),i.push(function(e){let t=e,n=e;for(;(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next,t!==e;);return n}(c));for(i.sort(ll),a=0;a<i.length;a++)!function(e,t){(t=function(e,t){let n=t;var r=e.x,i=e.y;let a,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if((o=s)===r){if(i===n.y)return n;if(i===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}}while(n=n.next,n!==t);if(!a)return null;if(r!==o){var l=a,c=a.x,u=a.y;let t,s=1/0;for(n=a;r>=n.x&&n.x>=c&&r!==n.x&&ul(i<u?r:o,i,c,u,i<u?o:r,i,n.x,n.y)&&(t=Math.abs(i-n.y)/(r-n.x),vl(n,e))&&(t<s||t===s&&(n.x>a.x||n.x===a.x&&function(e,t){return hl(e.prev,e,t.prev)<0&&hl(t.next,e,e.next)<0}(a,n)))&&(a=n,s=t),(n=n.next)!==l;);}return a}(e,t))&&(e=gl(t,e),sl(t,t.next),sl(e,e.next))}(i[a],n),n=sl(n,n.next);return n}(e,t,a,n)),e.length>80*n){s=c=e[0],l=u=e[1];for(let t=n;t<i;t+=n)h=e[t],d=e[t+1],h<s&&(s=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=0!==(p=Math.max(c-s,u-l))?1/p:0}!function e(t,n,r,i,a,o,s){if(t){if(!s&&o){var l=t,c=i,u=a,h=o;let e=l;for(;null===e.z&&(e.z=cl(e.x,e.y,c,u,h)),e.prevZ=e.prev,e.nextZ=e.next,(e=e.next)!==l;);e.prevZ.nextZ=null,e.prevZ=null;{var d=e;let t,n,r,i,a,o,s,l,c=1;do{for(n=d,d=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(l=c;0<s||0<l&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(n=(i=n).nextZ,s--):(r=(i=r).nextZ,l--),a?a.nextZ=i:d=i,i.prevZ=a,a=i;n=r}}while(a.nextZ=null,c*=2,1<o)}}let p,f,m=t;for(;t.prev!==t.next;)if(p=t.prev,f=t.next,o?function(e,t,n,r){var i=e.prev,a=e,o=e.next;if(0<=hl(i,a,o))return;var s=(i.x<a.x?i.x<o.x?i:o:a.x<o.x?a:o).x,l=(i.y<a.y?i.y<o.y?i:o:a.y<o.y?a:o).y,c=(i.x>a.x?i.x>o.x?i:o:a.x>o.x?a:o).x,u=(i.y>a.y?i.y>o.y?i:o:a.y>o.y?a:o).y,h=cl(s,l,t,n,r),d=cl(c,u,t,n,r);let p=e.prevZ,f=e.nextZ;for(;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&ul(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=hl(p.prev,p,p.next))return;if(p=p.prevZ,f!==e.prev&&f!==e.next&&ul(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=hl(f.prev,f,f.next))return;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&ul(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&0<=hl(p.prev,p,p.next))return;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&ul(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=hl(f.prev,f,f.next))return;f=f.nextZ}return 1}(t,i,a,o):function(e){var t=e.prev,n=e,r=e.next;if(0<=hl(t,n,r))return;let i=e.next.next;for(;i!==e.prev;){if(ul(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=hl(i.prev,i,i.next))return;i=i.next}return 1}(t))n.push(p.i/r),n.push(t.i/r),n.push(f.i/r),xl(t),t=f.next,m=f.next;else if((t=f)===m){s?1===s?e(t=function(e,t,n){let r=e;do{var i=r.prev,a=r.next.next;!dl(i,a)&&pl(i,r,r.next,a)&&vl(i,a)&&vl(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),xl(r),xl(r.next),r=e=a),r=r.next}while(r!==e);return sl(r)}(sl(t),n,r),n,r,i,a,o,2):2===s&&function(t,n,r,i,a,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){var l;if(s.i!==t.i&&function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&pl(n,n.next,e,t))return 1}while(n=n.next,n!==e)}(e,t)&&(vl(e,t)&&vl(t,e)&&function(e,t){let n=e,r=!1;for(var i=(e.x+t.x)/2,a=(e.y+t.y)/2;n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==e;);return r}(e,t)&&(hl(e.prev,e,t.prev)||hl(e,t.prev,t))||dl(e,t)&&0<hl(e.prev,e,e.next)&&0<hl(t.prev,t,t.next))}(s,t))return l=gl(s,t),s=sl(s,s.next),l=sl(l,l.next),e(s,n,r,i,a,o),e(l,n,r,i,a,o);t=t.next}}while(s=s.next,s!==t)}(t,n,r,i,a,o):e(sl(t),n,r,i,a,o,1);break}}}(a,o,n,s,l,p)}return o};function ol(e,t,n,r,i){let a,o;if(i===0<function(e,t,n,r){let i=0;for(let a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r))for(a=t;a<n;a+=r)o=yl(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=yl(a,e[a],e[a+1],o);return o&&dl(o,o.next)&&(xl(o),o=o.next),o}function sl(e,t){if(!e)return e;t=t||e;let n,r=e;do{if(n=!1,r.steiner||!dl(r,r.next)&&0!==hl(r.prev,r,r.next))r=r.next;else{if(xl(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function ll(e,t){return e.x-t.x}function cl(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ul(e,t,n,r,i,a,o,s){return 0<=(i-o)*(t-s)-(e-o)*(a-s)&&0<=(e-o)*(r-s)-(n-o)*(t-s)&&0<=(n-o)*(a-s)-(i-o)*(r-s)}function hl(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function dl(e,t){return e.x===t.x&&e.y===t.y}function pl(e,t,n,r){var i=ml(hl(e,t,n)),a=ml(hl(e,t,r)),o=ml(hl(n,r,e)),s=ml(hl(n,r,t));return i!==a&&o!==s||0===i&&fl(e,n,t)||0===a&&fl(e,r,t)||0===o&&fl(n,e,r)||!(0!==s||!fl(n,t,r))}function fl(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function ml(e){return 0<e?1:e<0?-1:0}function vl(e,t){return hl(e.prev,e,e.next)<0?0<=hl(e,t,e.next)&&0<=hl(e,e.prev,t):hl(e,t,e.prev)<0||hl(e,e.next,t)<0}function gl(e,t){var n=new wl(e.i,e.x,e.y),r=new wl(t.i,t.x,t.y),i=e.next,a=t.prev;return(e.next=t).prev=e,(n.next=i).prev=n,(r.next=n).prev=r,(a.next=r).prev=a,r}function yl(e,t,n,r){return e=new wl(e,t,n),r?(e.next=r.next,(e.prev=r).next.prev=e,r.next=e):(e.prev=e).next=e,e}function xl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function wl(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const bl={area:function(e){var t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return bl.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];_l(e),Ml(n,e);let a=e.length;t.forEach(_l);for(let e=0;e<t.length;e++)r.push(a),a+=t[e].length,Ml(n,t[e]);var o=al(n,r);for(let e=0;e<o.length;e+=3)i.push(o.slice(e,e+3));return i}};function _l(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Ml(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class El extends yi{constructor(e,t){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let a=0,o=e.length;a<o;a++)!function(e){const a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:100,c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:6,h=void 0!==t.bevelSize?t.bevelSize:u-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const f=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Sl;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let v,g,y,x,w,b=!1;f&&(v=f.getSpacedPoints(s),b=!0,c=!1,g=f.computeFrenetFrames(s,!1),y=new Tn,x=new Tn,w=new Tn),c||(p=0,u=0,h=0,d=0);let _=(e=e.extractPoints(o)).shape;const M=e.holes;if(!bl.isClockWise(_)){_=_.reverse();for(let e=0,t=M.length;e<t;e++){var E=M[e];bl.isClockWise(E)&&(M[e]=E.reverse())}}const S=bl.triangulateShape(_,M),T=_;for(let e=0,t=M.length;e<t;e++){var A=M[e];_=_.concat(A)}function L(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const C=_.length,P=S.length;function R(e,t,n){let r,i,a;var o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=o*o+s*s;if(Math.abs(o*c-s*l)>Number.EPSILON){var h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-s/h;t=t.y+o/h;if((n=(r=p+o*(h=((n.x-c/d-p)*c-(n.y+l/d-t)*l)/(o*c-s*l))-e.x,i=t+s*h-e.y,r*r+i*i))<=2)return new vn(r,i);a=Math.sqrt(n/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(c)&&(e=!0),a=e?(r=-s,i=o,Math.sqrt(u)):(r=o,i=s,Math.sqrt(u/2))}return new vn(r/a,i/a)}var I=[];for(let e=0,t=T.length,n=t-1,r=e+1;e<t;e++,n++,r++)n===t&&(n=0),r===t&&(r=0),I[e]=R(T[e],T[n],T[r]);var k=[];let D,z=I.concat();for(let e=0,t=M.length;e<t;e++){var N=M[e];D=[];for(let e=0,t=N.length,n=t-1,r=e+1;e<t;e++,n++,r++)n===t&&(n=0),r===t&&(r=0),D[e]=R(N[e],N[n],N[r]);k.push(D),z=z.concat(D)}for(let e=0;e<p;e++){var O=e/p,B=u*Math.cos(O*Math.PI/2);const t=h*Math.sin(O*Math.PI/2)+d;for(let e=0,n=T.length;e<n;e++){var F=L(T[e],I[e],t);Q(F.x,F.y,-B)}for(let e=0,n=M.length;e<n;e++){var U=M[e];D=k[e];for(let e=0,n=U.length;e<n;e++){var H=L(U[e],D[e],t);Q(H.x,H.y,-B)}}}const V=h+d;for(let e=0;e<C;e++){var G=c?L(_[e],z[e],V):_[e];b?(x.copy(g.normals[0]).multiplyScalar(G.x),y.copy(g.binormals[0]).multiplyScalar(G.y),w.copy(v[0]).add(x).add(y),Q(w.x,w.y,w.z)):Q(G.x,G.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<C;t++){var W=c?L(_[t],z[t],V):_[t];b?(x.copy(g.normals[e]).multiplyScalar(W.x),y.copy(g.binormals[e]).multiplyScalar(W.y),w.copy(v[e]).add(x).add(y),Q(w.x,w.y,w.z)):Q(W.x,W.y,l/s*e)}for(let e=p-1;0<=e;e--){var j=e/p,q=u*Math.cos(j*Math.PI/2);const t=h*Math.sin(j*Math.PI/2)+d;for(let e=0,n=T.length;e<n;e++){var X=L(T[e],I[e],t);Q(X.x,X.y,l+q)}for(let e=0,n=M.length;e<n;e++){var Y=M[e];D=k[e];for(let e=0,n=Y.length;e<n;e++){var Z=L(Y[e],D[e],t);b?Q(Z.x,Z.y+v[s-1].y,v[s-1].x+q):Q(Z.x,Z.y,l+q)}}}function J(e,t){let i=e.length;for(;0<=--i;){var a=i;let f=i-1;f<0&&(f=e.length-1);for(let e=0,i=s+2*p;e<i;e++){var o=C*e,l=C*(e+1),c=(u=c=void 0,t+a+o),u=t+f+o,h=t+f+l,d=t+a+l;$(c),$(u),$(d),$(u),$(h),$(d),c=r.length/3,ee((u=m.generateSideWallUV(n,r,c-6,c-3,c-2,c-1))[0]),ee(u[1]),ee(u[3]),ee(u[1]),ee(u[2]),ee(u[3])}}}function Q(e,t,n){a.push(e),a.push(t),a.push(n)}function K(e,t,i){$(e),$(t),$(i),e=r.length/3,ee((t=m.generateTopUV(n,r,e-3,e-2,e-1))[0]),ee(t[1]),ee(t[2])}function $(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function ee(e){i.push(e.x),i.push(e.y)}(function(){var e=r.length/3;if(c){let e=0*C;for(let n=0;n<P;n++){var t=S[n];K(t[2]+e,t[1]+e,t[0]+e)}e=C*(s+2*p);for(let t=0;t<P;t++){var i=S[t];K(i[0]+e,i[1]+e,i[2]+e)}}else{for(let e=0;e<P;e++){var a=S[e];K(a[2],a[1],a[0])}for(let e=0;e<P;e++){var o=S[e];K(o[0]+C*s,o[1]+C*s,o[2]+C*s)}}n.addGroup(e,r.length/3-e,0)})(),function(){var e=r.length/3;let t=0;J(T,t),t+=T.length;for(let e=0,n=M.length;e<n;e++){var i=M[e];J(i,t),t+=i.length}n.addGroup(e,r.length/3-e,1)}()}(e[a]);this.setAttribute("position",new li(r,3)),this.setAttribute("uv",new li(i,2)),this.computeVertexNormals()}toJSON(){var e=yi.prototype.toJSON.call(this),t=n=this.parameters.shapes,n=this.parameters.options,r=e;if(r.shapes=[],Array.isArray(t))for(let e=0,n=t.length;e<n;e++){var i=t[e];r.shapes.push(i.uuid)}else r.shapes.push(t.uuid);return void 0!==n.extrudePath&&(r.options.extrudePath=n.extrudePath.toJSON()),r}}const Sl={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=(n=t[3*n+1],t[3*r]),s=(r=t[3*r+1],t[3*i]);t=t[3*i+1];return[new vn(a,n),new vn(o,r),new vn(s,t)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=(n=t[3*n+2],t[3*r]),c=t[3*r+1],u=(r=t[3*r+2],t[3*i]),h=t[3*i+1],d=(i=t[3*i+2],t[3*a]),p=t[3*a+1];t=t[3*a+2];return Math.abs(s-c)<.01?[new vn(o,1-n),new vn(l,1-r),new vn(u,1-i),new vn(d,1-t)]:[new vn(s,1-n),new vn(c,1-r),new vn(h,1-i),new vn(p,1-t)]}};function Tl(e,t,n){yi.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],i=[],a=[],o=[],s=new Tn,l=new Tn,c=new Tn,u=new Tn,h=new Tn,d=(e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter."),t+1);for(let r=0;r<=n;r++){var p=r/n;for(let n=0;n<=t;n++){var f=n/t;e(f,p,l),i.push(l.x,l.y,l.z),0<=f-1e-5?(e(f-1e-5,p,c),u.subVectors(l,c)):(e(1e-5+f,p,c),u.subVectors(c,l)),0<=p-1e-5?(e(f,p-1e-5,c),h.subVectors(l,c)):(e(f,1e-5+p,c),h.subVectors(c,l)),s.crossVectors(u,h).normalize(),a.push(s.x,s.y,s.z),o.push(f,p)}}for(let e=0;e<n;e++)for(let n=0;n<t;n++){var m=e*d+n,v=e*d+n+1,g=(e+1)*d+n+1,y=(e+1)*d+n;r.push(m,v,y),r.push(v,g,y)}this.setIndex(r),this.setAttribute("position",new li(i,3)),this.setAttribute("normal",new li(a,3)),this.setAttribute("uv",new li(o,2))}(Tl.prototype=Object.create(yi.prototype)).constructor=Tl;class Al extends yi{constructor(e,t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],a=[];let o=0,s=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,s,t),o+=s,s=0;function l(e){var o=r.length/3;let l=(e=e.extractPoints(t)).shape;var c=e.holes;!1===bl.isClockWise(l)&&(l=l.reverse());for(let e=0,t=c.length;e<t;e++){var u=c[e];!0===bl.isClockWise(u)&&(c[e]=u.reverse())}var h=bl.triangulateShape(l,c);for(let e=0,t=c.length;e<t;e++){var d=c[e];l=l.concat(d)}for(let e=0,t=l.length;e<t;e++){var p=l[e];r.push(p.x,p.y,0),i.push(0,0,1),a.push(p.x,p.y)}for(let e=0,t=h.length;e<t;e++){var f=(v=h[e])[0]+o,m=v[1]+o,v=v[2]+o;n.push(f,m,v),s+=3}}this.setIndex(n),this.setAttribute("position",new li(r,3)),this.setAttribute("normal",new li(i,3)),this.setAttribute("uv",new li(a,2))}toJSON(){var e=yi.prototype.toJSON.call(this),t=this.parameters.shapes,n=e;if(n.shapes=[],Array.isArray(t))for(let e=0,i=t.length;e<i;e++){var r=t[e];n.shapes.push(r.uuid)}else n.shapes.push(t.uuid);return n}}class Ll extends Vi{constructor(e){super(e),this.type="RawShaderMaterial"}}function Cl(e){Vr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Zr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function Pl(e){Cl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new vn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=mn.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}Ll.prototype.isRawShaderMaterial=!0,((Cl.prototype=Object.create(Vr.prototype)).constructor=Cl).prototype.isMeshStandardMaterial=!0,Cl.prototype.copy=function(e){return Vr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this},((Pl.prototype=Object.create(Cl.prototype)).constructor=Pl).prototype.isMeshPhysicalMaterial=!0,Pl.prototype.copy=function(e){return Cl.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Zr).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};class Rl extends Vr{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Zr(16777215),this.specular=new Zr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Rl.prototype.isMeshPhongMaterial=!0;const Il={arraySlice:function(e,t,n){return Il.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){var t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){var r=e.length,i=new e.constructor(r);for(let o=0,s=0;s!==r;++o){var a=n[o]*t;for(let n=0;n!==t;++n)i[s++]=e[a+n]}return i},flattenJSON:function(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){let o=a[r];if(void 0!==o)if(Array.isArray(o))for(;void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),void 0!==(a=e[i++]););else if(void 0!==o.toArray)for(;void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),void 0!==(a=e[i++]););else for(;void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),void 0!==(a=e[i++]););}},subclip:function(e,t,n,r,i=30){var a=e.clone(),o=(a.name=t,[]);for(let e=0;e<a.tracks.length;++e){var s=a.tracks[e],l=s.getValueSize(),c=[],u=[];for(let e=0;e<s.times.length;++e){var h=s.times[e]*i;if(!(h<n||r<=h)){c.push(s.times[e]);for(let t=0;t<l;++t)u.push(s.values[e*l+t])}}0!==c.length&&(s.times=Il.convertArray(c,s.times.constructor),s.values=Il.convertArray(u,s.values.constructor),o.push(s))}a.tracks=o;let d=1/0;for(let e=0;e<a.tracks.length;++e)d>a.tracks[e].times[0]&&(d=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*d);return a.resetDuration(),a},makeClipAdditive:function(e,t=0,n=e,r=30){var i=n.tracks.length,a=t/(r=r<=0?30:r);for(let t=0;t<i;++t){const r=n.tracks[t],i=r.ValueTypeName;if("bool"!==i&&"string"!==i){var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0!==o){let e=0;var s=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(e=s/3);let t=0;var l,c,u,h=o.getValueSize(),d=(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(t=h/3),r.times.length-1);let n;n=a<=r.times[0]?(c=s-(l=e),Il.arraySlice(r.values,l,c)):a>=r.times[d]?(c=(l=d*s+e)+s-e,Il.arraySlice(r.values,l,c)):(u=s-(s=e),(d=r.createInterpolant()).evaluate(a),Il.arraySlice(d.resultBuffer,s,u)),"quaternion"===i&&(new Sn).fromArray(n).normalize().conjugate().toArray(n);var p=o.times.length;for(let e=0;e<p;++e){var f=e*h+t;if("quaternion"===i)Sn.multiplyQuaternionsFlat(o.values,f,n,0,o.values,f);else{var m=h-2*t;for(let e=0;e<m;++e)o.values[f+e]-=n[e]}}}}}return e.blendMode=2501,e}};function kl(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Dl(e,t,n,r){kl.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function zl(e,t,n,r){kl.call(this,e,t,n,r)}function Nl(e,t,n,r){kl.call(this,e,t,n,r)}Object.assign(kl.prototype,{evaluate:function(e){var t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let c;n:{r:if(!(e<r)){for(var a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,e<(r=t[++n]))break t}c=t.length;break n}if(e>=i)break e;var o=t[1];e<o&&(n=2,i=o);for(var s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===s)break;if(r=i,e>=(i=t[--n-1]))break t}c=n,n=0}for(;n<c;){var l=n+c>>>1;e<t[l]?c=l:n=1+l}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(kl.prototype,{beforeStart_:kl.prototype.copySampleValue_,afterEnd_:kl.prototype.copySampleValue_}),Dl.prototype=Object.assign(Object.create(kl.prototype),{constructor:Dl,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var r=this.parameterPositions;let i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=e,o=2*t-n;break;case 2402:i=r.length-2,o=t+r[i]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=e,s=2*n-t;break;case 2402:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c},interpolate_:function(e,t,n,r){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=(e=this._weightPrev,this._weightNext),d=-e*(t=(r=(n=(n-t)/(r-t))*n)*n)+2*e*r-e*n,p=(1+e)*t+(-1.5-2*e)*r+(-.5+e)*n+1,f=(-1-h)*t+(1.5+h)*r+.5*n,m=h*t-h*r;for(let e=0;e!==o;++e)i[e]=d*a[c+e]+p*a[l+e]+f*a[s+e]+m*a[u+e];return i}}),zl.prototype=Object.assign(Object.create(kl.prototype),{constructor:zl,interpolate_:function(e,t,n,r){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(r-t),u=1-c;for(let e=0;e!==o;++e)i[e]=a[l+e]*u+a[s+e]*c;return i}}),Nl.prototype=Object.assign(Object.create(kl.prototype),{constructor:Nl,interpolate_:function(e){return this.copySampleValue_(e-1)}});class Ol{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Il.convertArray(t,this.TimeBufferType),this.values=Il.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){var t=e.constructor;let n;return t.toJSON!==this.toJSON?n=t.toJSON(e):(n={name:e.name,times:Il.convertArray(e.times,Array),values:Il.convertArray(e.values,Array)},(t=e.getInterpolation())!==e.DefaultInterpolation&&(n.interpolation=t)),n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Nl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new zl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Dl(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}else this.createInterpolant=t;return this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){var t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){var t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){var n,r=this.times,i=r.length;let a=0,o=i-1;for(;a!==i&&r[a]<e;)++a;for(;-1!==o&&r[o]>t;)--o;return++o,0===a&&o===i||(a>=o&&(o=Math.max(o,1),a=o-1),n=this.getValueSize(),this.times=Il.arraySlice(r,a,o),this.values=Il.arraySlice(this.values,a*n,o*n)),this}validate(){let e=!0;var t=this.getValueSize(),n=(t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1),this.times),r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){var o=n[t];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,o),e=!1;break}if(null!==a&&a>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,o,a),e=!1;break}a=o}if(void 0!==r&&Il.isTypedArray(r))for(let t=0,n=r.length;t!==n;++t){var s=r[t];if(isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,s),e=!1;break}}return e}optimize(){var e=Il.arraySlice(this.times),t=Il.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),i=e.length-1;let a=1;for(let p=1;p<i;++p){let i=!1;var o=e[p];if(o!==e[p+1]&&(1!==p||o!==e[0]))if(r)i=!0;else{var s=p*n,l=s-n,c=s+n;for(let e=0;e!==n;++e){var u=t[s+e];if(u!==t[l+e]||u!==t[c+e]){i=!0;break}}}if(i){if(p!==a){e[a]=e[p];var h=p*n,d=a*n;for(let e=0;e!==n;++e)t[d+e]=t[h+e]}++a}}if(0<i){e[a]=e[i];for(let e=i*n,r=a*n,o=0;o!==n;++o)t[r+o]=t[e+o];++a}return a!==e.length?(this.times=Il.arraySlice(e,0,a),this.values=Il.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}clone(){var e=Il.arraySlice(this.times,0),t=Il.arraySlice(this.values,0);return(e=new this.constructor(this.name,e,t)).createInterpolant=this.createInterpolant,e}}Ol.prototype.TimeBufferType=Float32Array,Ol.prototype.ValueBufferType=Float32Array,Ol.prototype.DefaultInterpolation=2301;class Bl extends Ol{}Bl.prototype.ValueTypeName="bool",Bl.prototype.ValueBufferType=Array,Bl.prototype.DefaultInterpolation=2300,Bl.prototype.InterpolantFactoryMethodLinear=void 0,Bl.prototype.InterpolantFactoryMethodSmooth=void 0;class Fl extends Ol{}Fl.prototype.ValueTypeName="color";class Ul extends Ol{}function Hl(e,t,n,r){kl.call(this,e,t,n,r)}Ul.prototype.ValueTypeName="number",Hl.prototype=Object.assign(Object.create(kl.prototype),{constructor:Hl,interpolate_:function(e,t,n,r){var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t);let l=e*o;for(var c=l+o;l!==c;l+=4)Sn.slerpFlat(i,0,a,l-o,a,l,s);return i}});class Vl extends Ol{InterpolantFactoryMethodLinear(e){return new Hl(this.times,this.values,this.getValueSize(),e)}}Vl.prototype.ValueTypeName="quaternion",Vl.prototype.DefaultInterpolation=2301,Vl.prototype.InterpolantFactoryMethodSmooth=void 0;class Gl extends Ol{}Gl.prototype.ValueTypeName="string",Gl.prototype.ValueBufferType=Array,Gl.prototype.DefaultInterpolation=2300,Gl.prototype.InterpolantFactoryMethodLinear=void 0,Gl.prototype.InterpolantFactoryMethodSmooth=void 0;class Wl extends Ol{}class jl{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=mn.generateUUID(),this.duration<0&&this.resetDuration()}static parse(e){var t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,i=n.length;e!==i;++e)t.push(function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t,n,r=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ul;case"vector":case"vector2":case"vector3":case"vector4":return Wl;case"color":return Fl;case"quaternion":return Vl;case"bool":case"boolean":return Bl;case"string":return Gl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);return void 0===e.times&&(t=[],n=[],Il.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n),void 0!==r.parse?r.parse(e):new r(e.name,e.times,e.values,e.interpolation)}(n[e]).scale(r));var i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){var t=[],n=e.tracks;e={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=n.length;e!==r;++e)t.push(Ol.toJSON(n[e]));return e}static CreateFromMorphTargetSequence(e,t,n,r){var i=t.length,a=[];for(let e=0;e<i;e++){let s=[],l=[];s.push((e+i-1)%i,e,(e+1)%i),l.push(0,1,0);var o=Il.getKeyframeOrder(s);s=Il.sortedArray(s,1,o),l=Il.sortedArray(l,1,o),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new Ul(".morphTargetInfluences["+t[e].name+"]",s,l).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations);for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){var r={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){var a=e[t],o=a.name.match(i);if(o&&1<o.length){let e=r[o=o[1]];e||(r[o]=e=[]),e.push(a)}}var s=[];for(const e in r)s.push(this.CreateFromMorphTargetSequence(e,r[e],t,n));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;function n(e,t,n,r,i){var a,o;0!==n.length&&(a=[],o=[],Il.flattenJSON(n,a,o,r),0!==a.length)&&i.push(new e(t,a,o))}var r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode;let s=e.length||-1;var l=e.hierarchy||[];for(let e=0;e<l.length;e++){var c=l[e].keys;if(c&&0!==c.length)if(c[0].morphTargets){var u={};let e;for(e=0;e<c.length;e++)if(c[e].morphTargets)for(let t=0;t<c[e].morphTargets.length;t++)u[c[e].morphTargets[t]]=-1;for(const t in u){var h=[],d=[];for(let n=0;n!==c[e].morphTargets.length;++n){var p=c[e];h.push(p.time),d.push(p.morphTarget===t?1:0)}r.push(new Ul(".morphTargetInfluence["+t+"]",h,d))}s=u.length*(a||1)}else{var f=".bones["+t[e].name+"]";n(Wl,f+".position",c,"pos",r),n(Vl,f+".quaternion",c,"rot",r),n(Wl,f+".scale",c,"scl",r)}}return 0===r.length?null:new this(i,s,r,o)}resetDuration(){let e=0;for(let n=0,r=this.tracks.length;n!==r;++n){var t=this.tracks[n];e=Math.max(e,t.times[t.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){var e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const ql={enabled:!(Wl.prototype.ValueTypeName="vector"),files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};const Xl=new function(e,t,n){const r=this;let i=!1,a=0,o=0,s=void 0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){return-1!==(e=l.indexOf(e))&&l.splice(e,2),this},this.getHandler=function(e){for(let r=0,i=l.length;r<i;r+=2){var t=l[r],n=l[r+1];if(t.global&&(t.lastIndex=0),t.test(e))return n}return null}};function Yl(e){this.manager=void 0!==e?e:Xl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Yl.prototype,{load:function(){},loadAsync:function(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});const Zl={};function Jl(e){Yl.call(this,e)}function Ql(e){Yl.call(this,e)}Jl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Jl,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=ql.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===Zl[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);let d;if(o){var s=o[1],l=!!o[2];let n=o[3];n=decodeURIComponent(n),l&&(n=atob(n));try{let r;var c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":var u=new Uint8Array(n.length);for(let e=0;e<n.length;e++)u[e]=n.charCodeAt(e);r="blob"===c?new Blob([u.buffer],{type:s}):u.buffer;break;case"document":var h=new DOMParser;r=h.parseFromString(n,s);break;case"json":r=JSON.parse(n);break;default:r=n}setTimeout((function(){t&&t(r),i.manager.itemEnd(e)}),0)}catch(a){setTimeout((function(){r&&r(a),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{Zl[e]=[],Zl[e].push({onLoad:t,onProgress:n,onError:r}),(d=new XMLHttpRequest).open("GET",e,!0),d.addEventListener("load",(function(t){var n=this.response,r=Zl[e];if(delete Zl[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ql.add(e,n);for(let e=0,t=r.length;e<t;e++){var a=r[e];a.onLoad&&a.onLoad(n)}}else{for(let e=0,n=r.length;e<n;e++){var o=r[e];o.onError&&o.onError(t)}i.manager.itemError(e)}i.manager.itemEnd(e)}),!1),d.addEventListener("progress",(function(t){var n=Zl[e];for(let e=0,i=n.length;e<i;e++){var r=n[e];r.onProgress&&r.onProgress(t)}}),!1),d.addEventListener("error",(function(t){var n=Zl[e];delete Zl[e];for(let e=0,i=n.length;e<i;e++){var r=n[e];r.onError&&r.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),d.addEventListener("abort",(function(t){var n=Zl[e];delete Zl[e];for(let e=0,i=n.length;e<i;e++){var r=n[e];r.onError&&r.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(d.responseType=this.responseType),void 0!==this.withCredentials&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)d.setRequestHeader(e,this.requestHeader[e]);d.send(null)}return i.manager.itemStart(e),d}Zl[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}}),Ql.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Ql,load:function(e,t,n,r){const i=this,a=[],o=new il,s=new Jl(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let l=0;if(Array.isArray(e))for(let c=0,u=e.length;c<u;++c)!function(c){s.load(e[c],(function(e){e=i.parse(e,!0),a[c]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},6===(l+=1)&&(1===e.mipmapCount&&(o.minFilter=en),o.image=a,o.format=e.format,o.needsUpdate=!0,t)&&t(o)}),n,r)}(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap){var r=n.mipmaps.length/n.mipmapCount;for(let e=0;e<r;e++){a[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)a[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),a[e].format=n.format,a[e].width=n.width,a[e].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=en),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}});class Kl extends Yl{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=ql.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),ql.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}class $l extends Yl{constructor(e){super(e)}load(e,t,n,r){const i=new qi,a=new Kl(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;for(let n=0;n<e.length;++n)!function(n){a.load(e[n],(function(e){i.images[n]=e,6==++o&&(i.needsUpdate=!0,t)&&t(i)}),void 0,r)}(n);return i}}function ec(e){Yl.call(this,e)}function tc(e){Yl.call(this,e)}function nc(){this.type="Curve",this.arcLengthDivisions=200}ec.prototype=Object.assign(Object.create(Yl.prototype),{constructor:ec,load:function(e,t,n,r){const i=this,a=new Yi;var o=new Jl(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){(e=i.parse(e))&&(void 0!==e.image?a.image=e.image:void 0!==e.data&&(a.image.width=e.width,a.image.height=e.height,a.image.data=e.data),a.wrapS=void 0!==e.wrapS?e.wrapS:Kt,a.wrapT=void 0!==e.wrapT?e.wrapT:Kt,a.magFilter=void 0!==e.magFilter?e.magFilter:en,a.minFilter=void 0!==e.minFilter?e.minFilter:en,a.anisotropy=void 0!==e.anisotropy?e.anisotropy:1,void 0!==e.encoding&&(a.encoding=e.encoding),void 0!==e.flipY&&(a.flipY=e.flipY),void 0!==e.format&&(a.format=e.format),void 0!==e.type&&(a.type=e.type),void 0!==e.mipmaps&&(a.mipmaps=e.mipmaps,a.minFilter=tn),1===e.mipmapCount&&(a.minFilter=en),a.needsUpdate=!0,t)&&t(a,e)}),n,r),a}}),tc.prototype=Object.assign(Object.create(Yl.prototype),{constructor:tc,load:function(e,t,n,r){const i=new bn;var a=new Kl(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n,n=0<e.search(/\.jpe?g($|\?)/i)||0===e.search(/^data\:image\/jpeg/),i.format=n?an:on,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),Object.assign(nc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(e=5){var t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e=5){var t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n=this.getLengths();let r=0;var i=n.length;let a,o,s=(a=t||e*n[i-1],0),l=i-1;for(;s<=l;)if((o=n[r=Math.floor(s+(l-s)/2)]-a)<0)s=r+1;else{if(!(0<o)){l=r;break}l=r-1}return n[r=l]===a?r/(i-1):(r+(e=(a-(t=n[r]))/((e=n[r+1])-t)))/(i-1)},getTangent:function(e,t){let n=e-1e-4,r=e+1e-4;n<0&&(n=0),1<r&&(r=1);e=this.getPoint(n);var i=this.getPoint(r);return(t=t||new(e.isVector2?vn:Tn)).copy(i).sub(e).normalize(),t},getTangentAt:function(e,t){return e=this.getUtoTmapping(e),this.getTangent(e,t)},computeFrenetFrames:function(e,t){var n=new Tn,r=[],i=[],a=[],o=new Tn,s=new er;for(let t=0;t<=e;t++){var l=t/e;r[t]=this.getTangentAt(l,new Tn),r[t].normalize()}i[0]=new Tn,a[0]=new Tn;let c=Number.MAX_VALUE;var u,h=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),p<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(let t=1;t<=e;t++)i[t]=i[t-1].clone(),a[t]=a[t-1].clone(),o.crossVectors(r[t-1],r[t]),o.length()>Number.EPSILON&&(o.normalize(),u=Math.acos(mn.clamp(r[t-1].dot(r[t]),-1,1)),i[t].applyMatrix4(s.makeRotationAxis(o,u))),a[t].crossVectors(r[t],i[t]);if(!0===t){let t=Math.acos(mn.clamp(i[0].dot(i[e]),-1,1));t/=e,0<r[0].dot(o.crossVectors(i[0],i[e]))&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});class rc extends nc{constructor(e=0,t=0,n=1,r=1,i=0,a=2*Math.PI,o=!1,s=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e,t){t=t||new vn;var n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;for(var i=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);var a,o;i=this.aStartAngle+e*r;let s=this.aX+this.xRadius*Math.cos(i),l=this.aY+this.yRadius*Math.sin(i);return 0!==this.aRotation&&(e=Math.cos(this.aRotation),i=Math.sin(this.aRotation),s=(a=s-this.aX)*e-(o=l-this.aY)*i+this.aX,l=a*i+o*e+this.aY),t.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){var e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}rc.prototype.isEllipseCurve=!0;class ic extends rc{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.type="ArcCurve"}}function ac(){let e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){e=(t-e)/a-(n-e)/(a+o)+(n-t)/o,a=(n-t)/o-(r-t)/(o+s)+(r-n)/s,i(t,n,e*=o,a*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}ic.prototype.isArcCurve=!0;const oc=new Tn,sc=new ac,lc=new ac,cc=new ac;class uc extends nc{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Tn){var n=this.points,r=n.length;e=(r-(this.closed?0:1))*e;let i,a,o=Math.floor(e),s=e-o;this.closed?o+=0<o?0:(Math.floor(Math.abs(o)/r)+1)*r:0===s&&o===r-1&&(o=r-2,s=1),i=this.closed||0<o?n[(o-1)%r]:(oc.subVectors(n[0],n[1]).add(n[0]),oc);e=n[o%r];var l=n[(o+1)%r];if(a=this.closed||o+2<r?n[(o+2)%r]:(oc.subVectors(n[r-1],n[r-2]).add(n[r-1]),oc),"centripetal"===this.curveType||"chordal"===this.curveType){n="chordal"===this.curveType?.5:.25;let t=Math.pow(i.distanceToSquared(e),n),r=Math.pow(e.distanceToSquared(l),n),o=Math.pow(l.distanceToSquared(a),n);r<1e-4&&(r=1),t<1e-4&&(t=r),o<1e-4&&(o=r),sc.initNonuniformCatmullRom(i.x,e.x,l.x,a.x,t,r,o),lc.initNonuniformCatmullRom(i.y,e.y,l.y,a.y,t,r,o),cc.initNonuniformCatmullRom(i.z,e.z,l.z,a.z,t,r,o)}else"catmullrom"===this.curveType&&(sc.initCatmullRom(i.x,e.x,l.x,a.x,this.tension),lc.initCatmullRom(i.y,e.y,l.y,a.y,this.tension),cc.initCatmullRom(i.z,e.z,l.z,a.z,this.tension));return t.set(sc.calc(s),lc.calc(s),cc.calc(s)),t}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){var t=e.points[n];this.points.push(t.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){var e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){var t=this.points[n];e.points.push(t.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){var t=e.points[n];this.points.push((new Tn).fromArray(t))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function hc(e,t,n,r,i){var a=e*e;return(2*n-2*r+(t=.5*(r-t))+(i=.5*(i-n)))*(e*a)+(-3*n+3*r-2*t-i)*a+t*e+n}function dc(e,t,n,r){return(i=1-(i=e))*i*t+2*(1-e)*e*n+e*e*r;var i}function pc(e,t,n,r,i){return(a=1-(a=e))*a*a*t+3*(a=1-e)*a*e*n+3*(1-e)*e*e*r+e*e*e*i;var a}class fc extends nc{constructor(e=new vn,t=new vn,n=new vn,r=new vn){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new vn){var n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(pc(e,n.x,r.x,i.x,a.x),pc(e,n.y,r.y,i.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}fc.prototype.isCubicBezierCurve=uc.prototype.isCatmullRomCurve3=!0;class mc extends nc{constructor(e=new Tn,t=new Tn,n=new Tn,r=new Tn){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Tn){var n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(pc(e,n.x,r.x,i.x,a.x),pc(e,n.y,r.y,i.y,a.y),pc(e,n.z,r.z,i.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vc extends nc{constructor(e=new vn,t=new vn){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new vn){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){return(t=t||new vn).copy(this.v2).sub(this.v1).normalize(),t}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}vc.prototype.isLineCurve=mc.prototype.isCubicBezierCurve3=!0;class gc extends nc{constructor(e=new vn,t=new vn,n=new vn){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new vn){var n=this.v0,r=this.v1,i=this.v2;return t.set(dc(e,n.x,r.x,i.x),dc(e,n.y,r.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}gc.prototype.isQuadraticBezierCurve=!0;class yc extends nc{constructor(e=new Tn,t=new Tn,n=new Tn){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Tn){var n=this.v0,r=this.v1,i=this.v2;return t.set(dc(e,n.x,r.x,i.x),dc(e,n.y,r.y,i.y),dc(e,n.z,r.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xc extends nc{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new vn){e=((o=this.points).length-1)*e;var n=Math.floor(e),r=(e=e-n,o[0===n?n:n-1]),i=o[n],a=o[n>o.length-2?o.length-1:n+1],o=o[n>o.length-3?o.length-1:n+2];return t.set(hc(e,r.x,i.x,a.x,o.x),hc(e,r.y,i.y,a.y,o.y)),t}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){var t=e.points[n];this.points.push(t.clone())}return this}toJSON(){var e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){var t=this.points[n];e.points.push(t.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){var t=e.points[n];this.points.push((new vn).fromArray(t))}return this}}xc.prototype.isSplineCurve=yc.prototype.isQuadraticBezierCurve3=!0;var wc=Object.freeze({__proto__:null,ArcCurve:ic,CatmullRomCurve3:uc,CubicBezierCurve:fc,CubicBezierCurve3:mc,EllipseCurve:rc,LineCurve:vc,LineCurve3:class extends nc{constructor(e=new Tn,t=new Tn){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Tn){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){var e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:gc,QuadraticBezierCurve3:yc,SplineCurve:xc});class bc extends nc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new vc(t,e))}getPoint(e){var t,n,r,i=e*this.getLength(),a=this.getCurveLengths();let o=0;for(;o<a.length;){if(a[o]>=i)return t=a[o]-i,r=(n=this.curves[o]).getLength(),n.getPointAt(0===r?0:1-t/r);o++}return null}getLength(){var e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e}getSpacedPoints(e=40){var t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){var t=[];let n;for(let s=0,l=this.curves;s<l.length;s++){var r=l[s],i=r&&r.isEllipseCurve?2*e:r&&(r.isLineCurve||r.isLineCurve3)?1:r&&r.isSplineCurve?e*r.points.length:e,a=r.getPoints(i);for(let e=0;e<a.length;e++){var o=a[e];n&&n.equals(o)||(t.push(o),n=o)}}return this.autoClose&&1<t.length&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){var t=e.curves[n];this.curves.push(t.clone())}return this.autoClose=e.autoClose,this}toJSON(){var e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,r=this.curves.length;n<r;n++){var t=this.curves[n];e.curves.push(t.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){var t=e.curves[n];this.curves.push((new wc[t.type]).fromJSON(t))}return this}}class _c extends bc{constructor(e){super(),this.type="Path",this.currentPoint=new vn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){var n=new vc(this.currentPoint.clone(),new vn(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){return e=new gc(this.currentPoint.clone(),new vn(e,t),new vn(n,r)),this.curves.push(e),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){return e=new fc(this.currentPoint.clone(),new vn(e,t),new vn(n,r),new vn(i,a)),this.curves.push(e),this.currentPoint.set(i,a),this}splineThru(e){var t=[this.currentPoint.clone()].concat(e);t=new xc(t);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,a,o,s),this}absellipse(e,t,n,r,i,a,o,s){return e=new rc(e,t,n,r,i,a,o,s),0<this.curves.length&&((t=e.getPoint(0)).equals(this.currentPoint)||this.lineTo(t.x,t.y)),this.curves.push(e),n=e.getPoint(1),this.currentPoint.copy(n),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){var e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Mc extends _c{constructor(e){super(e),this.uuid=mn.generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(e){var t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){var t=e.holes[n];this.holes.push(t.clone())}return this}toJSON(){var e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,r=this.holes.length;n<r;n++){var t=this.holes[n];e.holes.push(t.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){var t=e.holes[n];this.holes.push((new _c).fromJSON(t))}return this}}class Ec extends Sr{constructor(e,t=1){super(),this.type="Light",this.color=new Zr(e),this.intensity=t}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){return(e=super.toJSON(e)).object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}Ec.prototype.isLight=!0;(class extends Ec{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Sr.DefaultUp),this.updateMatrix(),this.groundColor=new Zr(t)}copy(e){return Ec.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const Sc=new er,Tc=new Tn,Ac=new Tn;class Lc{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new vn(512,512),this.map=null,this.mapPass=null,this.matrix=new er,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Qi,this._frameExtents=new vn(1,1),this._viewportCount=1,this._viewports=[new Mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){var t=this.camera,n=this.matrix;Tc.setFromMatrixPosition(e.matrixWorld),t.position.copy(Tc),Ac.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Ac),t.updateMatrixWorld(),Sc.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sc),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Cc extends Lc{constructor(){super(new Wi(50,1,.5,500)),this.focus=1}updateMatrices(e){var t=this.camera,n=2*mn.RAD2DEG*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}}Cc.prototype.isSpotLightShadow=!0;(class extends Ec{constructor(e,t,n=0,r=Math.PI/3,i=0,a=1){super(e,t),this.type="SpotLight",this.position.copy(Sr.DefaultUp),this.updateMatrix(),this.target=new Sr,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.shadow=new Cc}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const Pc=new er,Rc=new Tn,Ic=new Tn;class kc extends Lc{constructor(){super(new Wi(90,1,.5,500)),this._frameExtents=new vn(4,2),this._viewportCount=6,this._viewports=[new Mn(2,1,1,1),new Mn(0,1,1,1),new Mn(3,1,1,1),new Mn(1,1,1,1),new Mn(3,0,1,1),new Mn(1,0,1,1)],this._cubeDirections=[new Tn(1,0,0),new Tn(-1,0,0),new Tn(0,0,1),new Tn(0,0,-1),new Tn(0,1,0),new Tn(0,-1,0)],this._cubeUps=[new Tn(0,1,0),new Tn(0,1,0),new Tn(0,1,0),new Tn(0,1,0),new Tn(0,0,1),new Tn(0,0,-1)]}updateMatrices(e,t=0){var n=this.camera,r=this.matrix;Rc.setFromMatrixPosition(e.matrixWorld),n.position.copy(Rc),Ic.copy(n.position),Ic.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Ic),n.updateMatrixWorld(),r.makeTranslation(-Rc.x,-Rc.y,-Rc.z),Pc.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Pc)}}kc.prototype.isPointLightShadow=!0;(class extends Ec{constructor(e,t,n=0,r=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new kc}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class Dc extends Gi{constructor(e=-1,t=1,n=1,r=-1,i=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,o=r+t,s=r-t;null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom,i+=n*this.view.offsetX,a=i+n*this.view.width,o-=e*this.view.offsetY,s=o-e*this.view.height),this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){return(e=Sr.prototype.toJSON.call(this,e)).object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}Dc.prototype.isOrthographicCamera=!0;class zc extends Lc{constructor(){super(new Dc(-5,5,5,-5,.5,500))}}zc.prototype.isDirectionalLightShadow=!0;(class extends Ec{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Sr.DefaultUp),this.updateMatrix(),this.target=new Sr,this.shadow=new zc}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class extends Ec{constructor(e,t){super(e,t),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class extends Ec{constructor(e,t,n=10,r=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=r}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){return(e=super.toJSON(e)).object.width=this.width,e.object.height=this.height,e}}).prototype.isRectAreaLight=!0;class Nc{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Tn)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){var n=e.x,r=e.y,i=(e=e.z,this.coefficients);return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*r),t.addScaledVector(i[2],.488603*e),t.addScaledVector(i[3],.488603*n),t.addScaledVector(i[4],n*r*1.092548),t.addScaledVector(i[5],r*e*1.092548),t.addScaledVector(i[6],.315392*(3*e*e-1)),t.addScaledVector(i[7],n*e*1.092548),t.addScaledVector(i[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){var n=e.x,r=e.y,i=(e=e.z,this.coefficients);return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*r),t.addScaledVector(i[2],1.023328*e),t.addScaledVector(i[3],1.023328*n),t.addScaledVector(i[4],.858086*n*r),t.addScaledVector(i[5],.858086*r*e),t.addScaledVector(i[6],.743125*e*e-.247708),t.addScaledVector(i[7],.858086*n*e),t.addScaledVector(i[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){var n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){var n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){var n=e.x,r=e.y;e=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*e,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*n*e,t[8]=.546274*(n*n-r*r)}}Nc.prototype.isSphericalHarmonics3=!0;class Oc extends Ec{constructor(e=new Nc,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){return(e=super.toJSON(e)).object.sh=this.sh.toArray(),e}}Oc.prototype.isLightProbe=!0;const Bc=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function Fc(){yi.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Uc(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),$r.call(this,e,t,n),this.meshPerAttribute=r||1}function Hc(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Yl.call(this,e),this.options={premultiplyAlpha:"none"}}Fc.prototype=Object.assign(Object.create(yi.prototype),{constructor:Fc,isInstancedBufferGeometry:!0,copy:function(e){return yi.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=yi.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Uc.prototype=Object.assign(Object.create($r.prototype),{constructor:Uc,isInstancedBufferAttribute:!0,copy:function(e){return $r.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=$r.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Hc.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Hc,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=ql.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){ql.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}});class Vc{constructor(){this.type="ShapePath",this.color=new Zr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new _c,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){var t=[];for(let i=0,a=e.length;i<a;i++){var n=e[i],r=new Mc;r.curves=n.curves,t.push(r)}return t}var r=bl.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===t)return n(i);let a,o,s;var l=[];if(1===i.length)o=i[0],(s=new Mc).curves=o.curves,l.push(s);else{var c,u,h=!r(i[0].getPoints()),d=(h=e?!h:h,[]),p=[];let t=[],g=0;p[g]=void 0,t[g]=[];for(let n=0,s=i.length;n<s;n++)a=r(c=(o=i[n]).getPoints()),(e?!a:a)?(!h&&p[g]&&g++,p[g]={s:new Mc,p:c},p[g].s.curves=o.curves,h&&g++,t[g]=[]):t[g].push({h:o,p:c[0]});if(!p[0])return n(i);if(1<p.length){let e=!1;var f=[];for(let e=0,t=p.length;e<t;e++)d[e]=[];for(let n=0,r=p.length;n<r;n++){var m=t[n];for(let t=0;t<m.length;t++){var v=m[t];let r=!0;for(let i=0;i<p.length;i++)!function(e,t){var n=t.length;let r=!1;for(let a=n-1,o=0;o<n;a=o++){let n=t[a],s=t[o],l=s.x-n.x,c=s.y-n.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(n=t[o],l=-l,s=t[a],c=-c),!(e.y<n.y||e.y>s.y))if(e.y===n.y){if(e.x===n.x)return 1}else{var i=c*(e.x-n.x)-l*(e.y-n.y);if(0==i)return 1;i<0||(r=!r)}}else if(e.y===n.y&&(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x))return 1}return r}(v.p,p[i].p)||(n!==i&&f.push({froms:n,tos:i,hole:t}),r?(r=!1,d[i].push(v)):e=!0);r&&d[n].push(v)}}0<f.length&&(e||(t=d))}for(let e=0,n=p.length;e<n;e++){s=p[e].s,l.push(s);for(let n=0,r=(u=t[e]).length;n<r;n++)s.holes.push(u[n].h)}}return l}}let Gc;(class{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){var n=[],r=function(e,t,n){var r=Array.from(e),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[];let s=0,l=0;for(let e=0;e<r.length;e++){var c=r[e];"\n"===c?(s=0,l-=a):(c=function(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o=new Vc;let e,i,l,c,u,h,d,p;if(a.o){var s=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(let a=0,f=s.length;a<f;)switch(s[a++]){case"m":e=s[a++]*t+n,i=s[a++]*t+r,o.moveTo(e,i);break;case"l":e=s[a++]*t+n,i=s[a++]*t+r,o.lineTo(e,i);break;case"q":l=s[a++]*t+n,c=s[a++]*t+r,u=s[a++]*t+n,h=s[a++]*t+r,o.quadraticCurveTo(u,h,l,c);break;case"b":l=s[a++]*t+n,c=s[a++]*t+r,u=s[a++]*t+n,h=s[a++]*t+r,d=s[a++]*t+n,p=s[a++]*t+r,o.bezierCurveTo(u,h,d,p,l,c)}}return{offsetX:a.ha*t,path:o}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}(c,i,s,l,n),s+=c.offsetX,o.push(c.path))}return o}(e,t,this.data);for(let e=0,t=r.length;e<t;e++)Array.prototype.push.apply(n,r[e].toShapes());return n}}).prototype.isFont=!0;const Wc=function(){return Gc=void 0===Gc?new(window.AudioContext||window.webkitAudioContext):Gc};class jc extends Yl{constructor(e){super(e)}load(e,t,n,r){const i=this;var a=new Jl(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{var a=n.slice(0);Wc().decodeAudioData(a,(function(e){t(e)}))}catch(n){r?r(n):console.error(n),i.manager.itemError(e)}}),n,r)}}(class extends Oc{constructor(e,t=1){super(void 0,t),t=(new Zr).set(e),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}}).prototype.isAmbientLightProbe=class extends Oc{constructor(e,t,n=1){super(void 0,n);n=(new Zr).set(e),e=(new Zr).set(t),t=new Tn(n.r,n.g,n.b),n=new Tn(e.r,e.g,e.b);var r=(e=Math.sqrt(Math.PI))*Math.sqrt(.75);this.sh.coefficients[0].copy(t).add(n).multiplyScalar(e),this.sh.coefficients[1].copy(t).sub(n).multiplyScalar(r)}}.prototype.isHemisphereLightProbe=!0,new er,new er;class qc{constructor(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Xc(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;var t;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=Xc())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}function Xc(){return("undefined"==typeof performance?Date:performance).now()}class Yc{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else e=t/(a+=t),this._mixBufferRegion(n,i,0,e,r);this.cumulativeWeight=a}accumulateAdditive(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){var t,n=this.valueSize,r=this.buffer,i=e*n+n,a=(e=this.cumulativeWeight,this.cumulativeWeightAdditive),o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,e<1&&(t=n*this._origIndex,this._mixBufferRegion(r,i,t,1-e,n)),0<a&&this._mixBufferRegionAdditive(r,i,this._addIndex*n,1,n);for(let e=n,t=n+n;e!==t;++e)if(r[e]!==r[e+n]){o.setValue(r,i);break}}saveOriginalState(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let e=n,i=r;e!==i;++e)t[e]=t[r+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){var e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(.5<=r)for(let r=0;r!==i;++r)e[t+r]=e[n+r]}_slerp(e,t,n,r){Sn.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){i=this._workIndex*i,Sn.multiplyQuaternionsFlat(e,i,e,t,e,n),Sn.slerpFlat(e,t,e,t,e,i,r)}_lerp(e,t,n,r,i){var a=1-r;for(let s=0;s!==i;++s){var o=t+s;e[o]=e[o]*a+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let o=0;o!==i;++o){var a=t+o;e[a]=e[a]+e[n+o]*r}}}Ye="\\[\\]\\.:\\/";const Zc=new RegExp("["+Ye+"]","g");dt="[^"+Ye+"]",h="[^"+Ye.replace("\\.","")+"]",Ye=/((?:WC+[\/:])*)/.source.replace("WC",dt),h=/(WCOD+)?/.source.replace("WCOD",h);var Jc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",dt);dt=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",dt);const Qc=new RegExp("^"+Ye+h+Jc+dt+"$"),Kc=["material","materials","bones"];function $c(e,t,n){n=n||eu.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function eu(e,t,n){this.path=t,this.parsedPath=n||eu.parseTrackName(t),this.node=eu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign($c.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_;void 0!==(n=this._bindings[n])&&n.getValue(e,t)},setValue:function(e,t){var n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){var e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){var e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(eu,{Composite:$c,create:function(e,t,n){return new(e&&e.isAnimationObjectGroup?eu.Composite:eu)(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Zc,"")},parseTrackName:function(e){if(!(n=Qc.exec(e)))throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t,n,r=(n={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]}).nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r&&(t=n.nodeName.substring(r+1),-1!==Kc.indexOf(t))&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t),null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const r=function(e){for(let i=0;i<e.length;i++){var n=e[i];if(n.name===t||n.uuid===t)return n;if(n=r(n.children))return n}return null};if(n=r(e.children))return n}return null}}),Object.assign(eu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){var n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){var n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){var n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){var n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node;var t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=eu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}var a=e[r];if(void 0===a)t=t.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+t+"."+r+" but it wasn't found.",e);else{let t=this.Versioning.None,n=(void 0!==(this.targetObject=e).needsUpdate?t=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(t=this.Versioning.MatrixWorldNeedsUpdate),this.BindingType.Direct);if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}n=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(n=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(n=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][t]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(eu.prototype,{_getValue_unbound:eu.prototype.getValue,_setValue_unbound:eu.prototype.setValue});class tu{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;var i=t.tracks,a=i.length,o=new Array(a),s={endingStart:2400,endingEnd:2400};for(let e=0;e!==a;++e){var l=i[e].createInterpolant(null);(o[e]=l).settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){var r,i;return e.fadeOut(t),this.fadeIn(t),n&&(i=(n=this._clip.duration)/(r=e._clip.duration),e.warp(1,r/n,t),this.warp(i,1,t)),this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){var r=(o=this._mixer).time,i=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=o._lendControlInterpolant(),this._timeScaleInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,o[1]=r+n,s[0]=e/i,s[1]=t/i,this}stopWarping(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){if((i=(e-i)*n)<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var a=this._updateTime(t),o=this._updateWeight(e);if(0<o){var s=this._interpolants,l=this._propertyBindings;if(2501===this.blendMode)for(let e=0,t=s.length;e!==t;++e)s[e].evaluate(a),l[e].accumulateAdditive(o);else for(let e=0,t=s.length;e!==t;++e)s[e].evaluate(a),l[e].accumulate(r,o)}}else this._updateWeight(e)}_updateWeight(e){let t=0;var n,r;return this.enabled&&(t=this.weight,null!==(n=this._weightInterpolant))&&(t*=r=n.evaluate(e)[0],e>n.parameterPositions[1])&&(this.stopFading(),0===r)&&(this.enabled=!1),this._effectiveWeight=t}_updateTimeScale(e){let t=0;var n;return this.paused||(t=this.timeScale,null!==(n=this._timeScaleInterpolant)&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1])&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)),this._effectiveTimeScale=t}_updateTime(e){var t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;var a,o=2202===n;if(0===e)return-1!==i&&o&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else if(-1===i&&(0<=e?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0?(r-=t*(n=Math.floor(r/t)),i+=Math.abs(n),(a=this.repetitions-i)<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=0<e?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(1==a?this._setEndings(a=e<0,!a,o):this._setEndings(!1,!1,o),this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n}))):this.time=r,o&&1==(1&i))return t-r;return r}_setEndings(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(e,t,n){var r=(a=this._mixer).time;let i=this._weightInterpolant;null===i&&(i=a._lendControlInterpolant(),this._weightInterpolant=i);var a=i.parameterPositions,o=i.sampleValues;return a[0]=r,o[0]=t,a[1]=r+e,o[1]=n,this}}function nu(e,t,n){os.call(this,e,t),this.meshPerAttribute=n||1}function ru(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function iu(e,t,n=0,r=1/0){this.ray=new $n(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new hr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function au(e,t){return e.distance-t.distance}function ou(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){var i=e.children;for(let e=0,r=i.length;e<r;e++)ou(i[e],t,n,!0)}}function su(e){Sr.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}(class extends dn{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid;let l=(e=this._bindingsByRootAndName)[s];void 0===l&&(l={},e[s]=l);for(let e=0;e!==i;++e){var c=r[e],u=c.name;let i=l[u];if(void 0===i){if(void 0!==(i=a[e])){null===i._cacheIndex&&(++i.referenceCount,this._addInactiveBinding(i,s,u));continue}var h=t&&t._propertyBindings[e].binding.parsedPath;++(i=new Yc(eu.create(n,u,h),c.ValueTypeName,c.getValueSize())).referenceCount,this._addInactiveBinding(i,s,u)}a[e]=i,o[e].resultBuffer=i.buffer}}_activateAction(e){if(!this._isActiveAction(e)){null===e._cacheIndex&&(t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n],this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t));var t,n,r,i=e._propertyBindings;for(let e=0,t=i.length;e!==t;++e){var a=i[e];0==a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){var t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){var n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){return null!==(e=e._cacheIndex)&&e<this._nActiveActions}_addInactiveAction(e,t,n){var r=this._actions,i=this._actionsByClip;let a=i[t];void 0===a?(a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a):(i=a.knownActions,e._byClipCacheIndex=i.length,i.push(e)),e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){var t,n=(t=this._actions)[t.length-1],r=e._cacheIndex,i=(r=(t[n._cacheIndex=r]=n,t.pop(),e._cacheIndex=null,e._clip.uuid),(t=(n=this._actionsByClip)[r]).knownActions),a=i[i.length-1],o=e._byClipCacheIndex;i[a._byClipCacheIndex=o]=a,i.pop(),e._byClipCacheIndex=null,delete t.actionByRoot[(e._localRoot||this._root).uuid],0===i.length&&delete n[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){var t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){var n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}_takeBackAction(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}_addInactiveBinding(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),(a[n]=e)._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){var t=this._bindings,n=(r=e.binding).rootNode.uuid,r=r.path,i=this._bindingsByRootAndName,a=i[n],o=t[t.length-1];e=e._cacheIndex;t[o._cacheIndex=e]=o,t.pop(),delete a[r],0===Object.keys(a).length&&delete i[n]}_lendBinding(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}_takeBackBinding(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i}_lendControlInterpolant(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(e[(n=new zl(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n}_takeBackControlInterpolant(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];t[e.__cacheIndex=r]=e,t[i.__cacheIndex=n]=i}clipAction(e,t,n){var r=t||this._root,i=r.uuid;let a="string"==typeof e?jl.findByName(r,e):e;r=null!==a?a.uuid:e,e=this._actionsByClip[r];let o=null;if(void 0===n&&(n=null!==a?a.blendMode:2500),void 0!==e){var s=e.actionByRoot[i];if(void 0!==s&&s.blendMode===n)return s;o=e.knownActions[0],null===a&&(a=o._clip)}return null===a?null:(s=new tu(this,a,t,n),this._bindAction(s,o),this._addInactiveAction(s,r,i),s)}existingAction(e,t){var n=(t=t||this._root).uuid;t=(t="string"==typeof e?jl.findByName(t,e):e)?t.uuid:e;return void 0!==(e=this._actionsByClip[t])&&e.actionByRoot[n]||null}stopAllAction(){var e=this._actions;for(let t=this._nActiveActions-1;0<=t;--t)e[t].stop();return this}update(e){e*=this.timeScale;var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==n;++o)t[o]._update(r,e,i,a);var o=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e)o[e].apply(a);return this}setTime(e){for(let e=this.time=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){var t=this._actions,n=(e=e.uuid,this._actionsByClip),r=n[e];if(void 0!==r){var i=r.knownActions;for(let e=0,n=i.length;e!==n;++e){var a=i[e],o=(this._deactivateAction(a),a._cacheIndex),s=t[t.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,t[s._cacheIndex=o]=s,t.pop(),this._removeInactiveBindingsForAction(a)}delete n[e]}}uncacheRoot(e){var t=e.uuid,n=this._actionsByClip;for(const e in n){var r=n[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var i=this._bindingsByRootAndName[t];if(void 0!==i)for(const e in i){var a=i[e];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){null!==(e=this.existingAction(e,t))&&(this._deactivateAction(e),this._removeInactiveAction(e))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1),nu.prototype=Object.assign(Object.create(os.prototype),{constructor:nu,isInstancedInterleavedBuffer:!0,copy:function(e){return os.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){return(e=os.prototype.clone.call(this,e)).meshPerAttribute=this.meshPerAttribute,e},toJSON:function(e){return(e=os.prototype.toJSON.call(this,e)).isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(ru.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(ru.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(iu.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e,t=!1,n=[]){return ou(e,this,n,t),n.sort(au),n},intersectObjects:function(e,t=!1,n=[]){for(let r=0,i=e.length;r<i;r++)ou(e[r],this,n,t);return n.sort(au),n}}),((su.prototype=Object.create(Sr.prototype)).constructor=su).prototype.isImmediateRenderObject=!0;const lu=new Tn,cu=new er,uu=new er,hu=new Float32Array(1);new Int32Array(hu.buffer),Math.pow(2,8);const du=[.125,.215,.35,.446,.526,.582],pu=5+du.length,fu=new Jr({side:1,depthWrite:!1,depthTest:!1}),{}=(new Ni(new Bi,fu),function(){var e=[],t=[],n=[];let r=8;for(let d=0;d<pu;d++){var i=Math.pow(2,r);t.push(i);let p=1/i;4<d?p=du[d-8+4-1]:0==d&&(p=0),n.push(p);var a=-(i=1/(i-1))/2,o=[a,a,i=1+i/2,a,i,i,a,a,i,i,a,i],s=new Float32Array(108),l=new Float32Array(72),c=new Float32Array(36);for(let e=0;e<6;e++){var u=e%3*2/3-1,h=2<e?0:-1;u=(s.set([u,h,0,u+2/3,h,0,u+2/3,1+h,0,u,h,0,u+2/3,1+h,0,u,1+h,0],18*e),l.set(o,12*e),[e,e,e,e,e,e]);c.set(u,6*e)}(a=new yi).setAttribute("position",new $r(s,3)),a.setAttribute("uv",new $r(l,2)),a.setAttribute("faceIndex",new $r(c,1)),e.push(a),4<r&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}());Math.sqrt(5),nc.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(nc.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},_c.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},class extends Js{constructor(e=10,t=10,n=4473924,r=8947848){n=new Zr(n),r=new Zr(r);var i=t/2,a=e/t,o=e/2,s=[],l=[];for(let e=0,u=0,h=-o;e<=t;e++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var c=e===i?n:r;c.toArray(l,u),u+=3,c.toArray(l,u),u+=3,c.toArray(l,u),u+=3,c.toArray(l,u),u+=3}var u=((e=new yi).setAttribute("position",new li(s,3)),e.setAttribute("color",new li(l,3)),new Hs({vertexColors:!0,toneMapped:!1}));super(e,u),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Js{constructor(e){var t=function e(t){const n=[];t&&t.isBone&&n.push(t);for(let r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new yi,r=[],i=[],a=new Zr(0,0,1),o=new Zr(0,1,0);for(let e=0;e<t.length;e++){var s=t[e];s.parent&&s.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new li(r,3)),n.setAttribute("color",new li(i,3)),super(n,new Hs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){var t=this.bones,n=this.geometry,r=n.getAttribute("position");uu.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){var i=t[e];i.parent&&i.parent.isBone&&(cu.multiplyMatrices(uu,i.matrixWorld),lu.setFromMatrixPosition(cu),r.setXYZ(n,lu.x,lu.y,lu.z),cu.multiplyMatrices(uu,i.parent.matrixWorld),lu.setFromMatrixPosition(cu),r.setXYZ(n+1,lu.x,lu.y,lu.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Yl.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Bc(e)},Yl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Cn.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Cn.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Cn.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Cn.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Cn.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},jn.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Qi.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},mn.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},mn.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),mn.floorPowerOfTwo(e)},mn.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),mn.ceilPowerOfTwo(e)},gn.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},gn.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},gn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},gn.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},gn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},gn.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},er.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},er.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},er.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Tn).setFromMatrixColumn(this,3)},er.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},er.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},er.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},er.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},er.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},er.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},er.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},er.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},er.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},er.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},er.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},er.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},er.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},er.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},er.prototype.makeFrustum=function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)},er.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Cr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Sn.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Sn.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},$n.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},$n.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},$n.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ur.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Ur.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Ur.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Ur.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Ur.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Ur.barycoordFromPoint=function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ur.getBarycoord(e,t,n,r,i)},Ur.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ur.getNormal(e,t,n,r)},Mc.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Mc.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new El(this,e)},Mc.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Al(this,e)},vn.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},vn.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},vn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Tn.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Tn.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Tn.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Tn.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Tn.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Tn.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Tn.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Tn.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Tn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Mn.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Mn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Sr.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Sr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Sr.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Sr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Sr.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Sr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ni.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ni.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(class extends Sr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);var t=e.levels;for(let e=0,r=t.length;e<r;e++){var n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);var n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){var t=this.levels;if(0<t.length){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){var n;0<this.levels.length&&(Es.setFromMatrixPosition(this.matrixWorld),n=e.ray.origin.distanceTo(Es),this.getObjectForDistance(n).raycast(e,t))}update(e){var t=this.levels;if(1<t.length){Es.setFromMatrixPosition(e.matrixWorld),Ss.setFromMatrixPosition(this.matrixWorld);var n=Es.distanceTo(Ss)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){var t=super.toJSON(e),n=(!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[],this.levels);for(let e=0,i=n.length;e<i;e++){var r=n[e];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(zs.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Rs.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(nc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Wi.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Ec.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties($r.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===hn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(hn)}}}),$r.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?hn:un),this},$r.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},$r.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},yi.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},yi.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new $r(t,arguments[2])))},yi.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},yi.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},yi.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},yi.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},yi.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(yi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Fc.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(iu.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(os.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===hn},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),os.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?hn:un),this},os.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},El.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},El.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},El.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},as.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(class e{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Vr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Zr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Rl.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Pl.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Vi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),ns.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},ns.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},ns.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ns.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ns.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ns.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ns.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ns.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ns.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ns.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ns.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ns.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ns.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ns.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ns.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},ns.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ns.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ns.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ns.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ns.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ns.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ns.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ns.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ns.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ns.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ns.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?3001:cn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Xo.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(En.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(class extends Sr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl)return this._startedAt=this.context.currentTime+e,(e=this.context.createBufferSource()).buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect();console.warn("THREE.Audio: this Audio has no playback control.")}}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e=e||[],!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new jc).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),ji.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},ji.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},xn.crossOrigin=void 0,xn.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=((i=new tc).setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},xn.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=((i=new $l).setCrossOrigin(this.crossOrigin),i.load(e,n,void 0,r));return t&&(i.mapping=t),i},xn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},xn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"126"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="126");var mu,vu,gu={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function yu(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}function xu(e){this._mesh=new Ni(vu,e)}function wu(e,t){yu.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Vi?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Hi.clone(e.uniforms),this.material=new Vi({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new yu.FullScreenQuad(this.material)}function bu(e,t){yu.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}function _u(){yu.call(this),this.needsSwap=!1}function Mu(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(yu.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),yu.FullScreenQuad=(mu=new Dc(-1,1,1,-1,0,1),vu=new ea(2,2),Object.defineProperty(xu.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(xu.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,mu)}}),xu),wu.prototype=Object.assign(Object.create(yu.prototype),{constructor:wu,render:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}}),bu.prototype=Object.assign(Object.create(yu.prototype),{constructor:bu,render:function(e,t,n){var r,i,a=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),i=this.inverse?(r=0,1):(r=1,0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(a.REPLACE,a.REPLACE,a.REPLACE),o.buffers.stencil.setFunc(a.ALWAYS,r,4294967295),o.buffers.stencil.setClear(i),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(a.EQUAL,1,4294967295),o.buffers.stencil.setOp(a.KEEP,a.KEEP,a.KEEP),o.buffers.stencil.setLocked(!0)}}),_u.prototype=Object.create(yu.prototype),Object.assign(_u.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var Eu,Su,Tu=function(e,t){var n,r;this.renderer=e,void 0===t?(n={minFilter:en,magFilter:en,format:on},r=e.getSize(new vn),this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,(t=new En(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=t.width,this._height=t.height),this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new wu(gu),this.clock=new qc};function Au(e){this._mesh=new Ni(Su,e)}Object.assign(Tu.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},removePass:function(e){-1!==(e=this.passes.indexOf(e))&&this.passes.splice(e,1)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());for(var t,n,r,i=this.renderer.getRenderTarget(),a=!1,o=this.passes.length,s=0;s<o;s++)!1!==(r=this.passes[s]).enabled&&(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),r.needsSwap&&(a&&(t=this.renderer.getContext(),(n=this.renderer.state.buffers.stencil).setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)),this.swapBuffers()),r instanceof bu?a=!0:r instanceof _u&&(a=!1));this.renderer.setRenderTarget(i)},reset:function(e){var t;void 0===e&&(t=this.renderer.getSize(new vn),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}),Object.assign(Mu.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Mu.FullScreenQuad=(Eu=new Dc(-1,1,1,-1,0,1),Su=new ea(2,2),Object.defineProperty(Au.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(Au.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(e){e.render(this._mesh,Eu)}}),Au);var Lu=function(e,t,n,r,i){yu.call(this),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Zr},Cu=(Lu.prototype=Object.assign(Object.create(yu.prototype),{constructor:Lu,render:function(e,t,n){var r,i,a=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=a}}),{defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new vn(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new er},cameraInverseProjectionMatrix:{value:new er},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")}),Pu={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new vn(512,512)},sampleUvOffsets:{value:[new vn(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},Ru={createSampleWeights:function(e,t){for(var n,r,i=[],a=0;a<=e;a++)i.push((n=a,r=t,Math.exp(-n*n/(r*r*2))/(Math.sqrt(2*Math.PI)*r)));return i},createSampleOffsets:function(e,t){for(var n=[],r=0;r<=e;r++)n.push(t.clone().multiplyScalar(r));return n},configure:function(e,t,n,r){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=Ru.createSampleOffsets(t,r),e.uniforms.sampleWeights.value=Ru.createSampleWeights(t,n),e.needsUpdate=!0}},Iu={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","\tgl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},ku=function(e,t,n,r,i){yu.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==n&&n,this.supportsNormalTexture=void 0!==r&&r,this.originalClearColor=new v.Color,this._oldClearColor=new v.Color,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==i?new v.Vector2(i.x,i.y):new v.Vector2(256,256),this.saoRenderTarget=new v.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:v.LinearFilter,magFilter:v.LinearFilter,format:v.RGBAFormat}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new v.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:v.NearestFilter,magFilter:v.NearestFilter,format:v.RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&((n=new v.DepthTexture).type=v.UnsignedShortType,this.beautyRenderTarget.depthTexture=n,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new v.MeshDepthMaterial,this.depthMaterial.depthPacking=v.RGBADepthPacking,this.depthMaterial.blending=v.NoBlending,this.normalMaterial=new v.MeshNormalMaterial,this.normalMaterial.blending=v.NoBlending,this.saoMaterial=new v.ShaderMaterial({defines:u()({},Cu.defines),fragmentShader:Cu.fragmentShader,vertexShader:Cu.vertexShader,uniforms:v.UniformsUtils.clone(Cu.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=v.NoBlending,this.vBlurMaterial=new v.ShaderMaterial({uniforms:v.UniformsUtils.clone(Pu.uniforms),defines:u()({},Pu.defines),vertexShader:Pu.vertexShader,fragmentShader:Pu.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=v.NoBlending,this.hBlurMaterial=new v.ShaderMaterial({uniforms:v.UniformsUtils.clone(Pu.uniforms),defines:u()({},Pu.defines),vertexShader:Pu.vertexShader,fragmentShader:Pu.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=v.NoBlending,this.materialCopy=new v.ShaderMaterial({uniforms:v.UniformsUtils.clone(gu.uniforms),vertexShader:gu.vertexShader,fragmentShader:gu.fragmentShader,blending:v.NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=v.CustomBlending,this.materialCopy.blendSrc=v.DstColorFactor,this.materialCopy.blendDst=v.ZeroFactor,this.materialCopy.blendEquation=v.AddEquation,this.materialCopy.blendSrcAlpha=v.DstAlphaFactor,this.materialCopy.blendDstAlpha=v.ZeroFactor,this.materialCopy.blendEquationAlpha=v.AddEquation,this.depthCopy=new v.ShaderMaterial({uniforms:v.UniformsUtils.clone(Iu.uniforms),vertexShader:Iu.vertexShader,fragmentShader:Iu.fragmentShader,blending:v.NoBlending}),this.fsQuad=new yu.FullScreenQuad(null)};function Du(e){var t=new Object;return t.enableRenderSAO=function(n){var r,i=e.scene,a=i.renderer,o=i.camera;0==n?e.RenderSAO.saoPass.enabled=!1:(r=new Tu(a),n=new Lu(i,o),r.addPass(n),n=new ku(i,o,!1,!0),t.saoPass=n,r.addPass(n),t.composer=r,window.addEventListener("resize",(function(){var e=window.innerWidth||1,t=window.innerHeight||1;o.aspect=e/t,o.updateProjectionMatrix(),a.setSize(e,t),r.setSize(e,t)})))},t.render=function(){null!=t.composer&&t.composer.render()},t}ku.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},ku.prototype=u()(r()(yu.prototype),{constructor:ku,render:function(e,t,n){var r,i;this.renderToScreen&&(this.materialCopy.blending=v.NoBlending,this.materialCopy.uniforms.tDiffuse.value=n.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1!==this.params.output&&(e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha(),r=e.autoClear,e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=10,i=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near),this.vBlurMaterial.uniforms.depthCutoff.value=i,this.hBlurMaterial.uniforms.depthCutoff.value=i,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(Ru.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new v.Vector2(0,1)),Ru.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new v.Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1)),i=this.materialCopy,3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,i=this.depthCopy):(4===this.params.output?this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture:this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?i.blending=v.CustomBlending:i.blending=v.NoBlending,this.renderPass(e,i,this.renderToScreen?null:n),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=r)},renderPass:function(e,t,n,r,i){e.getClearColor(this.originalClearColor);var a=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(n),e.autoClear=!1,null!=r&&(e.setClearColor(r),e.setClearAlpha(i||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(a)},renderOverride:function(e,t,n,r,i){e.getClearColor(this.originalClearColor);var a=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(n),e.autoClear=!1,r=t.clearColor||r,i=t.clearAlpha||i,null!=r&&(e.setClearColor(r),e.setClearAlpha(i||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(a)},setSize:function(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}),n(2);var zu=n(168);function Nu(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Ou(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ou(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ou(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bu=n(2);function Fu(e,t){n(565)("./"+F()+"/mainstyle.scss");var r=new Object;function i(e){var t=new Bu.BoxGeometry(e.a,e.b,e.c),n=new Bu.MeshBasicMaterial({color:"yellow",transparent:!0,opacity:.01});return(t=new Bu.Mesh(t,n)).name=e.name,t.position.set(e.point.x,e.point.y,e.point.z),r.sceneOrtho.add(t),t}return r.scene=e,r.init=function(){var e=document.createElement("div"),a=((a=(e.id="viewCube",e.className="ViewCube",document.getElementById(t).appendChild(e),document.createElement("div"))).className="homeViewWrapper",a.addEventListener("click",(function(){console.log(""),r.cameraGoHome(),window.bimEngine.loadedDoneFun()})),e.appendChild(a),x()),o=(s=window.innerWidth,(o=window.innerHeight)<s?s/o:o/s),s=(r.cameraOrtho=new Bu.OrthographicCamera(200*o/-2,200*o/2,200,-140,0,1e4),document.getElementById(e.id).clientWidth),l=(o=document.getElementById(e.id).clientHeight,s=((l=new Bu.WebGLRenderer({alpha:!0})).setSize(s,o),l.setClearAlpha(0),r.renderer=l,a.renderer=l,w(e.id,l),new Bu.AmbientLight(16777215,.8)),o=(a.add(s),r.sceneOrtho=a,[]),new Bu.TextureLoader,n(566)),c=(s=n(567),a=n(568),n(569)),u=n(570),h=n(571);o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(u)})),o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(c)})),o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(h)})),o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(a)})),o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(l)})),o.push(new Bu.MeshBasicMaterial({color:16777215,map:(new Bu.TextureLoader).load(s)})),u=new Bu.Mesh(new Bu.BoxBufferGeometry(130,130,130,1,1,1),o);r.sceneOrtho.add(u);c=.5*(c=146)-20;var d=[{name:"right",a:30,b:80,c:80,point:new Bu.Vector3(c,0,0)},{name:"back",a:80,b:80,c:30,point:new Bu.Vector3(0,0,-c)},{name:"left",a:30,b:80,c:80,point:new Bu.Vector3(-c,0,0)},{name:"front",a:80,b:80,c:30,point:new Bu.Vector3(0,0,c)},{name:"top",a:80,b:30,c:80,point:new Bu.Vector3(0,c,0)},{name:"button",a:80,b:30,c:80,point:new Bu.Vector3(0,-c,0)}],p=[{name:"top_right_back",a:30,b:30,c:30,point:new Bu.Vector3(-c,c,c)},{name:"button_front_right",a:30,b:30,c:30,point:new Bu.Vector3(-c,-c,c)},{name:"top_front_right",a:30,b:30,c:30,point:new Bu.Vector3(c,c,c)},{name:"button_right_back",a:30,b:30,c:30,point:new Bu.Vector3(c,-c,c)},{name:"top_back_left",a:30,b:30,c:30,point:new Bu.Vector3(-c,c,-c)},{name:"button_back_left",a:30,b:30,c:30,point:new Bu.Vector3(-c,-c,-c)},{name:"top_left_front",a:30,b:30,c:30,point:new Bu.Vector3(c,c,-c)},{name:"button_left_front",a:30,b:30,c:30,point:new Bu.Vector3(c,-c,-c)}],f=[{name:"top_front",a:30,b:30,c:80,point:new Bu.Vector3(c,c,0)},{name:"top_right",a:80,b:30,c:30,point:new Bu.Vector3(0,c,c)},{name:"top_back",a:30,b:30,c:80,point:new Bu.Vector3(-c,c,0)},{name:"top_left",a:80,b:30,c:30,point:new Bu.Vector3(0,c,-c)},{name:"button_front",a:30,b:30,c:80,point:new Bu.Vector3(c,-c,0)},{name:"button_right",a:80,b:30,c:30,point:new Bu.Vector3(0,-c,c)},{name:"button_back",a:30,b:30,c:80,point:new Bu.Vector3(-c,-c,0)},{name:"button_left",a:80,b:30,c:30,point:new Bu.Vector3(0,-c,-c)},{name:"front_right",a:30,b:80,c:30,point:new Bu.Vector3(c,0,c)},{name:"right_back",a:30,b:80,c:30,point:new Bu.Vector3(-c,0,c)},{name:"back_left",a:30,b:80,c:30,point:new Bu.Vector3(-c,0,-c)},{name:"left_front",a:30,b:80,c:30,point:new Bu.Vector3(c,0,-c)}];r.clickBoundary=[];for(var m=0;m<d.length;m++)r.clickBoundary.push(i(d[m]));for(m=0;m<p.length;m++)r.clickBoundary.push(i(p[m]));for(m=0;m<f.length;m++)r.clickBoundary.push(i(f[m]));e.addEventListener("click",(function(t){var n;(n={}).x=t.offsetX/e.clientWidth*2-1,n.y=-t.offsetY/e.clientHeight*2+1,t=new Bu.Raycaster;0<(n=(t.setFromCamera(n,r.cameraOrtho),t.intersectObjects(r.clickBoundary,!1))).length&&r.cameraGoToSpecialView(n[0].object.name)})),e.addEventListener("mousemove",(function(t){var n,i=((t=((i={}).x=t.offsetX/e.clientWidth*2-1,i.y=-t.offsetY/e.clientHeight*2+1,new Bu.Raycaster)).setFromCamera(i,r.cameraOrtho),t.intersectObjects(r.clickBoundary,!1)),a=Nu(r.clickBoundary);try{for(a.s();!(n=a.n()).done;)n.value.material.opacity=.01}catch(t){a.e(t)}finally{a.f()}0<i.length&&(i[0].object.material.opacity=.2)}))},r.renderScene=function(){r.cameraOrtho.quaternion.copy(r.scene.camera.quaternion);var e=new Bu.Vector3(0,0,-1).clone().applyMatrix4(r.scene.camera.matrixWorld.clone());e=r.scene.camera.position.clone().sub(e.clone()).setLength(1e3);r.cameraOrtho.position.copy(e),r.cameraOrtho.lookAt(new Bu.Vector3),r.renderer.render(r.sceneOrtho,r.cameraOrtho)},r.getBoundingBox=j,r.cameraGoToSpecialView=function(e){console.log(e);var t=new Bu.Vector3(0,0,0),n=(e=("top"==e?t=new Bu.Vector3(0,1,0):"down"==e?t=new Bu.Vector3(0,-1,0):"front"==e?t=new Bu.Vector3(0,0,1):"left"==e?t=new Bu.Vector3(-1,0,0):"back"==e?t=new Bu.Vector3(0,0,-1):"right"==e?t=new Bu.Vector3(1,0,0):"top_front"==e?t=new Bu.Vector3(1,1,0):"top_left"==e?t=new Bu.Vector3(0,1,-1):"top_back"==e?t=new Bu.Vector3(-1,1,0):"top_right"==e?t=new Bu.Vector3(0,1,1):"down_front"==e?t=new Bu.Vector3(1,-1,0):"down_left"==e?t=new Bu.Vector3(0,-1,-1):"down_back"==e?t=new Bu.Vector3(-1,-1,0):"down_right"==e?t=new Bu.Vector3(0,-1,1):"front_right"==e?t=new Bu.Vector3(1,0,1):"right_back"==e?t=new Bu.Vector3(-1,0,1):"back_left"==e?t=new Bu.Vector3(-1,0,-1):"left_front"==e?t=new Bu.Vector3(1,0,-1):"top_left_front"==e?t=new Bu.Vector3(1,1,-1):"top_front_right"==e?t=new Bu.Vector3(1,1,1):"top_right_back"==e?t=new Bu.Vector3(-1,1,1):"top_back_left"==e?t=new Bu.Vector3(-1,1,-1):"button_left_front"==e?t=new Bu.Vector3(1,-1,-1):"button_front_right"==e?t=new Bu.Vector3(1,-1,1):"button_right_back"==e?t=new Bu.Vector3(-1,1,1):"button_back_left"==e&&(t=new Bu.Vector3(-1,-1,-1)),r.getBoundingBox())).min,i=(e=e.max,n.clone().add(e.clone()).multiplyScalar(.5));t=i.clone().add(t.multiplyScalar(+e.distanceTo(n)));r.animateCamera(r.scene.camera.position,t,r.scene.controls.target.clone(),i)},r.GetCameraPose=function(){return{quaternion:r.scene.camera.quaternion,position:r.scene.camera.position,target:r.scene.controls.target}},r.ReductionCameraPose=function(e){new Bu.Quaternion(e.quaternion._x,e.quaternion._y,e.quaternion._z,e.quaternion._w);var t=new Bu.Vector3(e.position.x,e.position.y,e.position.z);e=new Bu.Vector3(e.target.x,e.target.y,e.target.z);r.animateCamera(r.scene.camera.position,t,r.scene.controls.target.clone(),e)},r.cameraGoHome=function(){var e=(t=r.getBoundingBox()).min,t=t.max,n=e.clone().add(t.clone()).multiplyScalar(.5),i=new Bu.Vector3(1,1,1);i=n.clone().add(i.multiplyScalar(+t.distanceTo(e)));r.animateCamera(r.scene.camera.position,i,r.scene.controls.target.clone(),n)},r.animateCamera=function(e,t,n,i){var a=new zu.a.Tween({x1:e.x,y1:e.y,z1:e.z,x2:n.x,y2:n.y,z2:n.z});a.to({x1:t.x,y1:t.y,z1:t.z,x2:i.x,y2:i.y,z2:i.z},1e3),a.onUpdate((function(e){r.scene.controls.auto=!0,r.scene.camera.position.x=e.x1,r.scene.camera.position.y=e.y1,r.scene.camera.position.z=e.z1,r.scene.controls.target.x=e.x2,r.scene.controls.target.y=e.y2,r.scene.controls.target.z=e.z2,r.scene.controls.update(),r.renderScene()})),a.onComplete((function(e){r.scene.controls.auto=!1})),a.easing(zu.a.Easing.Cubic.InOut),a.start(),function e(t){requestAnimationFrame(e),a.update()}()},r}function Uu(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Hu(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hu(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vu=n(2);function Gu(){var e=new Object;return e.ClearFillColor=function(e){for(var t=0;t<e.material.length;t++)e.material[t]=e.cloneMaterialArray[t]},e.SetFillColor=function(e,t,n){for(var r=0;r<t.length;r++)e.material[t[r]]=new Vu.MeshStandardMaterial({color:n})},e.HideElements=function(e,t){null==e.hideElements&&(e.hideElements=[]);var n,r=Uu(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.hideElements.push(a)}}catch(e){r.e(e)}finally{r.f()}var o,s=new Vu.MeshStandardMaterial({transparent:!0,opacity:0}),l=Uu(t);try{for(l.s();!(o=l.n()).done;)a=o.value,e.material[t[i]]=s}catch(e){l.e(e)}finally{l.f()}},e.ShowElements=function(e,t){null==e.hideElements&&(e.hideElements=[]);var n,r=Uu(t);try{for(r.s();!(n=r.n()).done;){var a,o,s=n.value,l=M()(a=e.hideElements).call(a,(function(e){return e==s}));-1!=l&&p()(o=e.hideElements).call(o,l,1)}}catch(e){r.e(e)}finally{r.f()}var c,u=Uu(t);try{for(u.s();!(c=u.n()).done;)s=c.value,e.material[t[i]]=e.cloneMaterialArray[t[i]]}catch(e){u.e(e)}finally{u.f()}},e.showAllElements=function(e){e.hideElements=[];for(var t=0;t<e.material.length;t++)e.material[t]=e.cloneMaterialArray[t]},e}function Wu(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function r(n){for(var r=0;r<t.children.length;r++)t.children[r].style.display=r===n?"block":"none";e=n}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",(function(n){n.preventDefault(),r(++e%t.children.length)}),!1);var i,a=ju()(),o=a,s=0,l=n(new Wu.Panel("FPS","#0ff","#002")),c=n(new Wu.Panel("MS","#0f0","#020"));return self.performance&&self.performance.memory&&(i=n(new Wu.Panel("MB","#f08","#201"))),r(0),{REVISION:16,dom:t,addPanel:n,showPanel:r,begin:function(){a=ju()()},end:function(){s++;var e,t=ju()();return c.update(t-a,200),o+1e3<=t&&(l.update(1e3*s/(t-o),100),o=t,s=0,i)&&(e=performance.memory,i.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)),t},update:function(){a=this.end()},domElement:t,setMode:r}}Ye=n(96);var ju=n.n(Ye),qu=(Wu.Panel=function(e,t,n){var r=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,p=74*o,f=30*o,m=document.createElement("canvas"),v=(m.width=s,m.height=l,m.style.cssText="width:80px;height:48px",m.getContext("2d"));return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,c,u),v.fillRect(h,d,p,f),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(h,d,p,f),{dom:m,update:function(l,g){r=Math.min(r,l),i=Math.max(i,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,d),v.fillStyle=t,v.fillText(a(l)+" "+e+" ("+a(r)+"-"+a(i)+")",c,u),v.drawImage(m,h+o,d,p-o,f,h,d,p-o,f),v.fillRect(h+p-o,d,o,f),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(h+p-o,d,o,a((1-l/g)*f))}}},Wu);function Xu(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Yu(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yu(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zu=n(2);function Ju(e){n(163)("./"+F()+"/measuresStyle.scss");var t,r,i=new Object,a=e.scene.renderer.domElement.parentElement,o=e.scene.camera,s="MeasureLine",c=(i.TotalMeasures=[],i.MouseEvent=null,i.isActive=!1,null),u=null;function h(e){i.MouseEvent={x:e.clientX,y:e.clientY,event:e}}function d(e){e.preventDefault(),r={x:e.x,y:e.y}}function p(n){var a;v(),0===n.button&&Math.abs(n.x-r.x)<2&&Math.abs(n.y-r.y)<2&&e.CaptureMark.Position&&(n=JSON.parse(_()(e.CaptureMark.Position)),a=new Zu.Vector3(n.worldPoint.x,n.worldPoint.y,n.worldPoint.z),window.bimEngine.scene.controls.origin=a,!n.capture||"point"!==n.capture.type&&"line"!==n.capture.type||(a=new Zu.Vector3(n.capture.val.x,n.capture.val.y,n.capture.val.z)),null==i.currentMeasure.start&&null==i.currentMeasure.end?(i.currentMeasure={},i.currentMeasure.start=a,i.currentMeasure.start_normal=new Zu.Vector3(n.capture.faceNormal.x,n.capture.faceNormal.y,n.capture.faceNormal.z),i.currentMeasure.id=y()):null!=i.currentMeasure.start&&null==i.currentMeasure.end&&(i.currentMeasure.end=i.currentMeasure.chuiDian||a,i.currentMeasure.dis=i.currentMeasure.start.distanceTo(i.currentMeasure.end),i.TotalMeasures.push(JSON.parse(_()(i.currentMeasure))),(n=document.getElementById(i.currentMeasure.id)).className="LineItem Temporary LineFinal Actived",t=n,i.currentMeasure={},u.style.display="none"))}function f(t){var n,r,o,s,l,c,u,h;null==i.currentMeasure?0<(u=document.getElementsByClassName("LineItem Temporary")).length&&u[0].parentNode.removeChild(u[0]):null==i.currentMeasure.start&&null==i.currentMeasure.end||(null!=i.currentMeasure.start&&null==i.currentMeasure.end&&null!=i.currentMeasure.temp_end&&(n=q(i.currentMeasure.start.clone(),e.scene.camera),r=q(i.currentMeasure.temp_end.clone(),e.scene.camera)),null!=i.currentMeasure.start&&null!=i.currentMeasure.end&&(n=q(i.currentMeasure.start.clone(),e.scene.camera),r=q(i.currentMeasure.end.clone(),e.scene.camera)),null!=n&&null!=r&&(u=g(a),null==(h=document.getElementById(i.currentMeasure.id))&&((h=document.createElement("div")).id=i.currentMeasure.id,h.className="LineItem Temporary",h.dataset.dataId=i.currentMeasure.id,h.dataset.cameraId=bimEngine.scene.camera.type+"_"+bimEngine.scene.camera.Id,h.addEventListener("click",(function(e){e.target.dataset.dataId?v(e.target.dataset.dataId):v()})),(o=document.createElement("div")).className="dom_start BoxControllerUI",o.dataset.dataId=i.currentMeasure.id,(s=document.createElement("div")).className="dom_end BoxControllerUI",s.dataset.dataId=i.currentMeasure.id,(l=document.createElement("div")).className="dom_line",l.dataset.dataId=i.currentMeasure.id,(c=document.createElement("div")).className="dom_text",c.dataset.dataId=i.currentMeasure.id,c.style.display="none",h.appendChild(o),h.appendChild(s),h.appendChild(l),h.appendChild(c),u.appendChild(h)),s=(o=h.children)[0],l=o[1],c=o[2],u=o[3],s.style.top=n.y+"px",s.style.left=n.x+"px",t?(l.style.top=r.y+"px",l.style.left=r.x+"px",h=Math.sqrt((n.y-r.y)*(n.y-r.y)+(n.x-r.x)*(n.x-r.x)),c.style.top=.5*(n.y+r.y)+"px",c.style.left=.5*(n.x+r.x-h)+"px",c.style.width=h+"px",c.style.transformOrigin=.5*(n.y+r.y)+"px"+.5*(n.x+r.x)+"px ",c.style.transform="rotate("+180*Math.atan((n.y-r.y)/(n.x-r.x))/Math.PI+"deg)",l.style.display="block",c.style.display="block"):(l.style.display="none",c.style.display="none"),u.style.display="none"))}function m(e){var n,r;"Delete"===e.key&&t&&(r=M()(r=i.TotalMeasures).call(r,(function(e){return e.id===t.id})),l()(n=i.TotalMeasures).call(n,r,1),document.getElementById(s).removeChild(t),v()),27==e.keyCode&&(document.getElementById(i.currentMeasure.id).remove(),i.currentMeasure={})}function v(e){var n,r=document.getElementById(s)?document.getElementById(s).children:[],i=Xu(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id&&(a.className="LineItem Temporary LineFinal")}}catch(e){i.e(e)}finally{i.f()}if(t=null,e){var o,l=Xu(r);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c.id===e){c.className="LineItem Temporary LineFinal Actived",t=c;break}}}catch(e){l.e(e)}finally{l.f()}}}function g(e){var t=document.getElementById(s);return null==t&&((t=document.createElement("div")).id=s,e.appendChild(t)),t}function y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}return i.currentMeasure={start:null,end:null,start_normal:null,end_normal:null,temp_end:null,dis:0,id:"",chuiDian:null},i.Active=function(){e.CaptureMark.Active(),i.models=e.GetAllVisibilityModel();var t=g(a);(u=document.createElement("div")).id="MeasureChuiDianPink",t.appendChild(u),a.addEventListener("pointerdown",d),a.addEventListener("pointermove",h),a.addEventListener("pointerup",p),window.addEventListener("keydown",m),e.StopClick=!0,function t(){var n;if(c=requestAnimationFrame(t),i.MouseEvent&&(i.MouseEvent,e.CaptureMark.Position?(n=JSON.parse(_()(e.CaptureMark.Position)),null==i.currentMeasure.start&&i.currentMeasure.end,null!=i.currentMeasure.start&&null==i.currentMeasure.end&&((r=function(e){var t;if(null!=i.currentMeasure.start)return 0<(t=new Zu.Raycaster(i.currentMeasure.start.clone().add(i.currentMeasure.start_normal.clone().multiplyScalar(.01)),i.currentMeasure.start_normal).intersectObjects(i.models)).length&&(t=t[0].point).distanceTo(e)<.1?(e=q(new Zu.Vector3(t.x,t.y,t.z),o),u.style.top=e.y+"px",u.style.left=e.x+"px",u.style.display="block",t):null}(new Zu.Vector3(n.worldPoint.x,n.worldPoint.y,n.worldPoint.z)))&&(i.currentMeasure.chuiDian=r),i.currentMeasure.temp_end=new Zu.Vector3(n.worldPoint.x,n.worldPoint.y,n.worldPoint.z),i.currentMeasure.dis=i.currentMeasure.start.distanceTo(i.currentMeasure.temp_end)),f(!0)):f(!1)),i.TotalMeasures){var r=i.TotalMeasures;if(0!=r.length){var s,l,h,d,p,m,v,y=g(a),x=Xu(r);try{for(x.s();!(s=x.n()).done;){var w,b,M,E,S,T,A,L,C,P,R,I,k,D,z,N,O=s.value;null!=O.start&&(w=new Zu.Vector3(O.start.x,O.start.y,O.start.z),b=new Zu.Vector3(O.end.x,O.end.y,O.end.z),M=new Zu.Vector3((O.start.x+O.end.x)/2,(O.start.y+O.end.y)/2,(O.start.z+O.end.z)/2),E=w.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),S=1<Math.abs(E.x)||1<Math.abs(E.y)||1<Math.abs(E.z),T=b.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),A=1<Math.abs(T.x)||1<Math.abs(T.y)||1<Math.abs(T.z),L=M.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),C=1<Math.abs(L.x)||1<Math.abs(L.y)||1<Math.abs(L.z),P=document.getElementById(O.id),S&&A&&C?P&&(P.style.display="none"):(P&&(P.style.display="block"),l=q(w,o),h=q(b,o),null!=l&&null!=h&&(null==(P=document.getElementById(O.id))&&((P=document.createElement("div")).id=O.id,P.className="LineItem",P.dataset.cameraId=bimEngine.scene.camera.type+"_"+bimEngine.scene.camera.Id,(R=document.createElement("div")).className="dom_start BoxControllerUI",(I=document.createElement("div")).className="dom_end BoxControllerUI",(k=document.createElement("div")).className="dom_line",(D=document.createElement("div")).className="dom_text",D.innerText=Math.round(1e3*O.dis)/1e3+" m",D.style.display="block",P.appendChild(R),P.appendChild(I),P.appendChild(k),P.appendChild(D),y.appendChild(P)),d=(z=P.children)[0],p=z[1],m=z[2],v=z[3],d.style.top=l.y+"px",d.style.left=l.x+"px",p.style.top=h.y+"px",p.style.left=h.x+"px",N=Math.sqrt((l.y-h.y)*(l.y-h.y)+(l.x-h.x)*(l.x-h.x)),m.style.top=.5*(l.y+h.y)+"px",m.style.left=.5*(l.x+h.x-N)+"px",m.style.width=N+"px",m.style.transformOrigin=.5*(l.y+h.y)+"px"+.5*(l.x+h.x)+"px ",m.style.transform="rotate("+180*Math.atan((l.y-h.y)/(l.x-h.x))/Math.PI+"deg)",v.style.top=.5*(l.y+h.y)+"px",v.style.left=.5*(l.x+h.x)+"px",v.innerText=Math.round(1e3*O.dis)/1e3+" m",v.style.display="block")))}}catch(t){x.e(t)}finally{x.f()}(r=document.getElementById(i.currentMeasure.id))&&(l=q(new Zu.Vector3(i.currentMeasure.start.x,i.currentMeasure.start.y,i.currentMeasure.start.z),o),h=q(new Zu.Vector3(i.currentMeasure.temp_end.x,i.currentMeasure.temp_end.y,i.currentMeasure.temp_end.z),o),d=(r=r.children)[0],p=r[1],m=r[2],v=r[3],d.style.top=l.y+"px",d.style.left=l.x+"px",p.style.top=h.y+"px",p.style.left=h.x+"px",r=Math.sqrt((l.y-h.y)*(l.y-h.y)+(l.x-h.x)*(l.x-h.x)),m.style.top=.5*(l.y+h.y)+"px",m.style.left=.5*(l.x+h.x-r)+"px",m.style.width=r+"px",m.style.transformOrigin=.5*(l.y+h.y)+"px"+.5*(l.x+h.x)+"px ",m.style.transform="rotate("+180*Math.atan((l.y-h.y)/(l.x-h.x))/Math.PI+"deg)",v.style.display="none")}}}(),i.isActive=!0},i.DisActive=function(){e.CaptureMark.DisActive();var t=g(a);t&&t.remove(),i.TotalMeasures=[],i.currentMeasure={start:null,end:null,temp_end:null,dis:0,id:""},a.removeEventListener("pointerdown",d),a.removeEventListener("pointermove",h),a.removeEventListener("pointerup",p),window.removeEventListener("keydown",m),e.StopClick=!1,cancelAnimationFrame(c),i.isActive=!1,i.TotalMeasures=[]},i.SetMeasureLine=function(e,t){e={start:e,end:t,dis:e.distanceTo(t),id:y()},i.TotalMeasures.push(e)},i.GetMeasureList=function(){return i.TotalMeasures},i.ReductionMeasureList=function(e){var t,n=Xu(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=new Zu.Vector3(r.start.x,r.start.y,r.start.z),o=new Zu.Vector3(r.end.x,r.end.y,r.end.z),s=a.distanceTo(o),l={start:a,end:o,dis:s,id:y()};i.TotalMeasures.push(l)}}catch(e){n.e(e)}finally{n.f()}},i.MeasurePointPinkOnMouseMove=function(e){},ju()(),i}function Qu(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Ku(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ku(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ku(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $u=n(2);function eh(e){n(163)("./"+F()+"/measuresStyle.scss");var t,r,i,a=new Object,o=e.scene.renderer.domElement.parentElement,s=e.scene.camera,c="MeasureDistance",u=(a.TotalMeasures=[],a.isActive=!1,null),h=!1;function d(e){e.preventDefault(),r={x:e.x,y:e.y}}function p(t){var n,r;h&&(i.style.display="none",r=e.CaptureMark.Position)&&(n=new $u.Vector3(r.worldPoint.x,r.worldPoint.y,r.worldPoint.z),r=new $u.Vector3(r.capture.faceNormal.x,r.capture.faceNormal.y,r.capture.faceNormal.z),console.log(r),null!=(r=function(e,t){return 0<(e=new $u.Raycaster(e.clone().add(t.clone().multiplyScalar(.01)),t.clone()).intersectObjects(a.models,!0)).length?e:null}(n,r)))&&(r=r[0],a.currentMeasure={start:n,end:r.point,dis:n.distanceTo(r.point),id:"temp"})}function f(t){var n;v(),0===t.button&&Math.abs(t.x-r.x)<2&&Math.abs(t.y-r.y)<2&&(e.CaptureMark.Position&&(n=JSON.parse(_()(e.CaptureMark.Position)),n=new $u.Vector3(n.worldPoint.x,n.worldPoint.y,n.worldPoint.z),window.bimEngine.scene.controls.origin=n),!h&&e.CaptureMark.Position?(i.style.display="block",i.style.left=t.x+"px",i.style.top=t.y+"px",h=!0):h&&a.currentMeasure&&((n=JSON.parse(_()(a.currentMeasure))).id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),a.TotalMeasures.push(n),t=document.getElementById("temp"),document.getElementById(c).removeChild(t),a.currentMeasure=null,h=!1))}function m(e){var n;"Delete"===e.key&&t&&(e=M()(e=a.TotalMeasures).call(e,(function(e){return e.id===t.id})),l()(n=a.TotalMeasures).call(n,e,1),document.getElementById(c).removeChild(t),v())}function v(e){var n,r=document.getElementById(c).children,i=Qu(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id&&(a.className="LineItem Temporary LineFinal")}}catch(e){i.e(e)}finally{i.f()}if(t=null,e){var o,s=Qu(r);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l.id===e){l.className="LineItem Temporary LineFinal Actived",t=l;break}}}catch(e){s.e(e)}finally{s.f()}}}function g(e){var t=document.getElementById(e);return null==t&&((t=document.createElement("div")).id=e,o.appendChild(t)),t}return a.currentMeasure,a.Active=function(){var n,r;e.CaptureMark.Active(),a.models=e.GetAllVisibilityModel(),n=g(n=c),(r=document.createElement("div")).className="PointMark",n.appendChild(r),i=r,o.addEventListener("pointerdown",d),o.addEventListener("pointermove",p),o.addEventListener("pointerup",f),window.addEventListener("keydown",m),e.StopClick=!0,function n(){var r,i,o,l,h;if(u=requestAnimationFrame(n),a.currentMeasure&&a.currentMeasure.start&&a.currentMeasure.end&&a.currentMeasure.dis&&(i=g(c),null==(o=document.getElementById(a.currentMeasure.id))&&((o=document.createElement("div")).id=a.currentMeasure.id,o.className="LineItem",(l=document.createElement("div")).className="dom_start BoxControllerUI",(h=document.createElement("div")).className="dom_end BoxControllerUI",(d=document.createElement("div")).className="dom_line",(r=document.createElement("div")).className="dom_text",r.innerText=Math.round(1e3*a.currentMeasure.dis)/1e3+" m",o.appendChild(l),o.appendChild(h),o.appendChild(d),o.appendChild(r),i.appendChild(o)),h=(l=o.children)[0],d=l[1],r=l[2],i=l[3],o=q(a.currentMeasure.start.clone(),e.scene.camera),l=q(a.currentMeasure.end.clone(),e.scene.camera),h.style.top=o.y+"px",h.style.left=o.x+"px",d.style.top=l.y+"px",d.style.left=l.x+"px",h=Math.sqrt((o.y-l.y)*(o.y-l.y)+(o.x-l.x)*(o.x-l.x)),r.style.top=.5*(o.y+l.y)+"px",r.style.left=.5*(o.x+l.x-h)+"px",r.style.width=h+"px",r.style.transformOrigin=.5*(o.y+l.y)+"px"+.5*(o.x+l.x)+"px ",r.style.transform="rotate("+180*Math.atan((o.y-l.y)/(o.x-l.x))/Math.PI+"deg)",i.style.top=.5*(o.y+l.y)+"px",i.style.left=.5*(o.x+l.x)+"px",i.innerText=Math.round(1e3*a.currentMeasure.dis)/1e3+" m"),a.TotalMeasures){var d=a.TotalMeasures;if(0!=d.length){var p,f=g(c),m=Qu(d);try{for(m.s();!(p=m.n()).done;){var y,x,w,b,_,M,E,S,T,A,L,C,P,R,I,k,D,z,N,O,B,F,U=p.value;null!=U.start&&(y=new $u.Vector3(U.start.x,U.start.y,U.start.z),x=new $u.Vector3(U.end.x,U.end.y,U.end.z),w=new $u.Vector3((U.start.x+U.end.x)/2,(U.start.y+U.end.y)/2,(U.start.z+U.end.z)/2),b=y.clone().applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix),_=1<Math.abs(b.x)||1<Math.abs(b.y)||1<Math.abs(b.z),M=x.clone().applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix),E=1<Math.abs(M.x)||1<Math.abs(M.y)||1<Math.abs(M.z),S=w.clone().applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix),T=1<Math.abs(S.x)||1<Math.abs(S.y)||1<Math.abs(S.z),C=document.getElementById(U.id),_&&E&&T?C&&(C.style.display="none"):(C&&(C.style.display="block"),A=q(y,s),L=q(x,s),null!=A&&null!=L&&(null==(C=document.getElementById(U.id))&&((C=document.createElement("div")).id=U.id,C.className="LineItem Temporary LineFinal Actived",C.dataset.dataId=U.id,C.dataset.cameraId=e.scene.camera.type+"_"+e.scene.camera.Id,C.addEventListener("click",(function(e){e.target.dataset.dataId?v(e.target.dataset.dataId):v()})),(P=document.createElement("div")).className="dom_start BoxControllerUI",P.dataset.dataId=U.id,(R=document.createElement("div")).className="dom_end BoxControllerUI",R.dataset.dataId=U.id,(I=document.createElement("div")).className="dom_line",I.dataset.dataId=U.id,(k=document.createElement("div")).className="dom_text",k.dataset.dataId=U.id,k.innerText=Math.round(1e3*U.dis)/1e3+" m",C.appendChild(P),C.appendChild(R),C.appendChild(I),C.appendChild(k),t=C,f.appendChild(C)),z=(D=C.children)[0],N=D[1],O=D[2],B=D[3],z.style.top=A.y+"px",z.style.left=A.x+"px",N.style.top=L.y+"px",N.style.left=L.x+"px",F=Math.sqrt((A.y-L.y)*(A.y-L.y)+(A.x-L.x)*(A.x-L.x)),O.style.top=.5*(A.y+L.y)+"px",O.style.left=.5*(A.x+L.x-F)+"px",O.style.width=F+"px",O.style.transformOrigin=.5*(A.y+L.y)+"px"+.5*(A.x+L.x)+"px ",O.style.transform="rotate("+180*Math.atan((A.y-L.y)/(A.x-L.x))/Math.PI+"deg)",B.style.top=.5*(A.y+L.y)+"px",B.style.left=.5*(A.x+L.x)+"px",B.innerText=Math.round(1e3*U.dis)/1e3+" m")))}}catch(n){m.e(n)}finally{m.f()}}}}(),a.isActive=!0},a.DisActive=function(){e.CaptureMark.DisActive();var t=g(c);a.TotalMeasures=[],t&&t.remove(),o.removeEventListener("pointerdown",d),o.removeEventListener("pointermove",p),o.removeEventListener("pointerup",f),window.removeEventListener("keydown",m),e.StopClick=!1,cancelAnimationFrame(u),a.isActive=!1,a.TotalMeasures=[]},a}function th(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?nh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rh=n(2);function ih(e){var t,n,r=new Object,i=e.scene.renderer.domElement.parentElement,a=e.scene.camera,o="MeasurePoint",s=(r.TotalMeasures=[],r.isActive=!1,null);function c(e){e.preventDefault(),n={x:e.x,y:e.y}}function u(a){var o,s,l,c;d(),0===a.button&&Math.abs(a.x-n.x)<2&&Math.abs(a.y-n.y)<2&&e.CaptureMark.Position&&(a=JSON.parse(_()(e.CaptureMark.Position)),o=new rh.Vector3(a.worldPoint.x,a.worldPoint.y,a.worldPoint.z),o={position:window.bimEngine.scene.controls.origin=o,id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},!a.capture||"point"!==a.capture.type&&"line"!==a.capture.type||(o.position=new rh.Vector3(a.capture.val.x,a.capture.val.y,a.capture.val.z)),r.TotalMeasures.push(JSON.parse(_()(o))),a=o,o=p(i),(s=document.createElement("div")).className="PointItem Actived",s.dataset.dataId=a.id,s.dataset.cameraId=e.scene.camera.type+"_"+e.scene.camera.Id,(t=s).id=a.id,o.appendChild(s),(o=document.createElement("div")).className="ItemContain",o.dataset.dataId=a.id,s.appendChild(o),s.addEventListener("click",(function(e){e.target.dataset.dataId?d(e.target.dataset.dataId):d()})),(l=document.createElement("div")).className="PointXYZ",l.dataset.dataId=a.id,o.appendChild(l),(o=document.createElement("div")).className="Point PointX",o.dataset.dataId=a.id,(c=document.createElement("span")).className="Span",c.dataset.dataId=a.id,c.innerText="X",o.appendChild(c),(c=document.createElement("span")).className="Text",c.dataset.dataId=a.id,c.innerText=Math.round(1e3*a.position.x)/1e3+" m",o.appendChild(c),l.appendChild(o),(c=document.createElement("div")).className="Point PointY",c.dataset.dataId=a.id,(o=document.createElement("span")).className="Span",o.dataset.dataId=a.id,o.innerText="Y",c.appendChild(o),(o=document.createElement("span")).className="Text",o.dataset.dataId=a.id,o.innerText=Math.round(1e3*a.position.y)/1e3+" m",c.appendChild(o),l.appendChild(c),(o=document.createElement("div")).className="Point PointZ",o.dataset.dataId=a.id,(c=document.createElement("span")).className="Span",c.dataset.dataId=a.id,c.innerText="Z",o.appendChild(c),(c=document.createElement("span")).className="Text",c.dataset.dataId=a.id,c.innerText=Math.round(1e3*a.position.z)/1e3+" m",o.appendChild(c),l.appendChild(o),c=q(a.position,e.scene.camera),s.style.top=c.y-5+"px",s.style.left=c.x-5+"px")}function h(e){var n;"Delete"===e.key&&t&&(e=M()(e=r.TotalMeasures).call(e,(function(e){return e.id===t.id})),l()(n=r.TotalMeasures).call(n,e,1),document.getElementById(o).removeChild(t),d())}function d(e){if(document.getElementById(o)){var n,r=document.getElementById(o).children,i=th(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id&&(a.className="PointItem")}}catch(e){i.e(e)}finally{i.f()}if(t=null,e){var s,l=th(r);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c.id===e){c.className="PointItem Actived",t=c;break}}}catch(e){l.e(e)}finally{l.f()}}}}function p(e){var t=document.getElementById(o);return null==t&&((t=document.createElement("div")).id=o,e.appendChild(t)),t}return r.Active=function(){e.CaptureMark.Active(),i.addEventListener("pointerdown",c),i.addEventListener("pointerup",u),window.addEventListener("keydown",h),e.StopClick=!0,function t(){if(s=requestAnimationFrame(t),r.TotalMeasures){var n=r.TotalMeasures;if(null!=e.scene){var i,o=th(n);try{for(o.s();!(i=o.n()).done;){var l,c,u,h=i.value,d=document.getElementById(h.id),p=new rh.Vector3(h.position.x,h.position.y,h.position.z).applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix);1<Math.abs(p.x)||1<Math.abs(p.y)||1<Math.abs(p.z)?d&&(d.style.display="none"):(d&&(d.style.display="block"),null!=(l=q(new rh.Vector3(h.position.x,h.position.y,h.position.z),e.scene.camera))&&(c=l.y,u=l.x,d.style.top=c+"px",d.style.left=u+"px"))}}catch(t){o.e(t)}finally{o.f()}}}}(),r.isActive=!0},r.DisActive=function(){e.CaptureMark.DisActive();var t=p(i);t&&t.remove(),i.removeEventListener("pointerdown",c),i.removeEventListener("pointerup",u),window.removeEventListener("keydown",h),e.StopClick=!1,cancelAnimationFrame(s),r.isActive=!1,r.TotalMeasures=[]},r}function ah(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?oh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sh=n(2);function lh(e){n(163)("./"+F()+"/measuresStyle.scss");var t,r,i=new Object,a=e.scene.renderer.domElement,o=e.scene.camera,s="MeasureHeight",c=(i.TotalMeasures=[],null),u=[{name:"HType",checked:"0",children:[{label:"",value:"0"},{label:"",value:"1"},{label:"",value:"2"}]},{name:"VerticalType",checked:"0",children:[{label:"",value:"0"},{label:"",value:"1"}]},{name:"Direction",checked:"1",children:[{label:"",value:"0"},{label:"",value:"1"}]}];function h(e){e.preventDefault(),r={x:e.x,y:e.y}}function d(){}function p(t){if(m(),0===t.button&&Math.abs(t.x-r.x)<2&&Math.abs(t.y-r.y)<2){var n=null,a=new sh.Raycaster;if(0<(t=((d=new sh.Vector2).x=(t.clientX-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,d.y=-(t.clientY-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,a.setFromCamera(d,e.scene.camera),a.intersectObjects(i.models,!0))).length){e.scene.controls.origin=t[0].point;var o,s=ah(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;if("Mesh"==l.object.TypeName||"PipeMesh"==l.object.TypeName){var c=ue(l.object,l.point);if(c&&!1!==l.object.geometry.groups[c.dbid].visibility){n={dbid:c.dbid,name:c.name,glb:l.object.url,TypeName:l.object.TypeName,basePath:c.basePath,relativePath:c.relativePath,indexs:[l.object.index,c.dbid]};break}}else if(("InstancedMesh"==l.object.TypeName||"InstancedMesh-Pipe"==l.object.TypeName)&&!he(l.object.ElementInfos[l.instanceId].min,l.object.ElementInfos[l.instanceId].max,l.object.material.clippingPlanes)){n={dbid:l.instanceId,name:l.object.ElementInfos[l.instanceId].name,glb:l.object.url,TypeName:l.object.TypeName,basePath:l.object.ElementInfos[0].basePath,relativePath:l.object.ElementInfos[0].relativePath,indexs:[l.object.index,l.instanceId]};break}}}catch(t){s.e(t)}finally{s.f()}}if(null!=n&&null!=n.glb){var h=e.scene.children[n.indexs[0]].ElementInfos[n.dbid],d={HType:u[0].checked,VerticalType:u[1].checked,Direction:u[2].checked};if(null!=(a=t?t[0]:null)){var p,f,g=a;switch(d.HType){case"0":f=new sh.Vector3(g.point.x,h.min.y,g.point.z);break;case"1":f=new sh.Vector3(g.point.x,h.center.y,g.point.z);break;case"2":f=new sh.Vector3(g.point.x,h.max.y,g.point.z)}switch(d.Direction){case"0":p=new sh.Vector3(0,1,0);break;case"1":p=new sh.Vector3(0,-1,0)}if("1"==d.VerticalType){if(!(t=v(f,p)))return;p=t[0].face.normal.clone().multiplyScalar(-1)}var y=v(f,p);if(y)for(var x=1;x<y.length;x++){var w=y[x].point;if(!(w.x>=h.min.x&&w.y>=h.min.y&&w.z>=h.min.z&&w.x<=h.max.x&&w.y<=h.max.y&&w.z<=h.max.z)){w={start:f,end:w,dis:f.distanceTo(w),id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},i.TotalMeasures.push(w),e.CurrentSelect=null;break}}}}}}function f(e){var n;"Delete"===e.key&&t&&(e=M()(e=i.TotalMeasures).call(e,(function(e){return e.id===t.id})),l()(n=i.TotalMeasures).call(n,e,1),document.getElementById(s).removeChild(t),m())}function m(e){var n,r=document.getElementById(s)?document.getElementById(s).children:[],i=ah(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id&&(a.className="LineItem Temporary LineFinal")}}catch(e){i.e(e)}finally{i.f()}if(t=null,e){var o,l=ah(r);try{for(l.s();!(o=l.n()).done;){var c=o.value;if(c.id===e){c.className="LineItem Temporary LineFinal Actived",t=c;break}}}catch(e){l.e(e)}finally{l.f()}}}function v(e,t){return 0<(e=new sh.Raycaster(e.clone().add(t.clone().multiplyScalar(.01)),t.clone()).intersectObjects(i.models)).length?e:null}return i.Active=function(){for(var n=e.scene.renderer.domElement.parentElement,r=document.createElement("div"),l=(r.id="HeightMeasuePanel",function(e){var t,n=u[e],i=document.createElement("div"),a=(i.className="form_item",ah(n.children));try{for(a.s();!(t=a.n()).done;)!function(){var r=t.value,a=document.createElement("label"),o=(a.className="label",document.createElement("input")),s=(o.className="radio_input",o.type="radio",o.name=n.name,o.value=r.value,o.checked=n.checked===r.value,o.addEventListener("change",(function(){u[e].checked=o.value})),document.createElement("span"));s.className="label_txt",s.innerText=r.label,a.appendChild(o),a.appendChild(s),i.appendChild(a)}()}catch(e){a.e(e)}finally{a.f()}r.appendChild(i)}),v=0;v<u.length;v++)l(v);["<div style='margin-top: 15px;'>","<label style='margin-left: 10px;'><input class='measure_HType radio_input' type='radio' name='HType' checked='true' value='0'></label>","<label style='margin-left: 10px;'><input class='measure_HType radio_input' type='radio' name='HType' value='1'></label>","<label style='margin-left: 10px;'><input class='measure_HType radio_input' type='radio' name='HType' value='2'></label>","</div>","<div style='margin-top: 15px;'>","<label style='margin-left: 10px;'><input class='measure_VerticalType radio_input' type='radio' checked='true' name='VerticalType' value='0'></label>","<label style='margin-left: 10px;'><input class='measure_VerticalType radio_input' type='radio' name='VerticalType' value='1'></label>","</div>","<div style='margin-top: 15px;'>","<label style='margin-left: 10px;'><input class='measure_Direction radio_input' type='radio' name='Direction' value='0'></label>","<label style='margin-left: 38px;'><input class='measure_Direction radio_input' type='radio' checked='true' name='Direction' value='1'></label>","</div>"].join(""),n.appendChild(r),i.models=e.GetAllVisibilityModel(),a.addEventListener("pointerdown",h),a.addEventListener("pointermove",d),a.addEventListener("pointerup",p),window.addEventListener("keydown",f),e.StopClick=!0,function n(){if(c=requestAnimationFrame(n),i.TotalMeasures){var r=i.TotalMeasures;if(0!=r.length){var a,l=function(t){var n=document.getElementById(t);return null==n&&((n=document.createElement("div")).id=t,e.scene.renderer.domElement.parentElement.appendChild(n)),n}(s),u=ah(r);try{for(u.s();!(a=u.n()).done;){var h,d,p,f,v,g,y,x,w,b,_,M,E,S,T,A,L,C,P,R,I,k,D=a.value;null!=D.start&&(h=new sh.Vector3(D.start.x,D.start.y,D.start.z),d=new sh.Vector3(D.end.x,D.end.y,D.end.z),p=new sh.Vector3((D.start.x+D.end.x)/2,(D.start.y+D.end.y)/2,(D.start.z+D.end.z)/2),f=h.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),v=1<Math.abs(f.x)||1<Math.abs(f.y)||1<Math.abs(f.z),g=d.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),y=1<Math.abs(g.x)||1<Math.abs(g.y)||1<Math.abs(g.z),x=p.clone().applyMatrix4(o.matrixWorldInverse).applyMatrix4(o.projectionMatrix),w=1<Math.abs(x.x)||1<Math.abs(x.y)||1<Math.abs(x.z),M=document.getElementById(D.id),v&&y&&w?M&&(M.style.display="none"):(M&&(M.style.display="block"),b=q(h,o),_=q(d,o),null!=b&&null!=_&&(null==(M=document.getElementById(D.id))&&((M=document.createElement("div")).id=D.id,M.className="LineItem Temporary LineFinal Actived",M.dataset.dataId=D.id,M.dataset.cameraId=e.scene.camera.type+"_"+e.scene.camera.Id,M.addEventListener("click",(function(e){e.target.dataset.dataId?m(e.target.dataset.dataId):m()})),(E=document.createElement("div")).className="dom_start BoxControllerUI",E.dataset.dataId=D.id,(S=document.createElement("div")).className="dom_end BoxControllerUI",S.dataset.dataId=D.id,(T=document.createElement("div")).className="dom_line",T.dataset.dataId=D.id,(A=document.createElement("div")).className="dom_text",A.dataset.dataId=D.id,A.innerText=Math.round(1e3*D.dis)/1e3+" m",M.appendChild(E),M.appendChild(S),M.appendChild(T),M.appendChild(A),t=M,l.appendChild(M)),C=(L=M.children)[0],P=L[1],R=L[2],I=L[3],C.style.top=b.y+"px",C.style.left=b.x+"px",P.style.top=_.y+"px",P.style.left=_.x+"px",k=Math.sqrt((b.y-_.y)*(b.y-_.y)+(b.x-_.x)*(b.x-_.x)),R.style.top=.5*(b.y+_.y)+"px",R.style.left=.5*(b.x+_.x-k)+"px",R.style.width=k+"px",R.style.transformOrigin=.5*(b.y+_.y)+"px"+.5*(b.x+_.x)+"px ",R.style.transform="rotate("+180*Math.atan((b.y-_.y)/(b.x-_.x))/Math.PI+"deg)",I.style.top=.5*(b.y+_.y)+"px",I.style.left=.5*(b.x+_.x)+"px",I.innerText=Math.round(1e3*D.dis)/1e3+" m")))}}catch(n){u.e(n)}finally{u.f()}}}}()},i.DisActive=function(){a.removeEventListener("pointerdown",h),a.removeEventListener("pointermove",d),a.removeEventListener("pointerup",p),window.removeEventListener("keydown",f),e.StopClick=!1,cancelAnimationFrame(c),document.getElementById("HeightMeasuePanel").remove();var t=document.getElementById(s);t&&t.remove(),i.TotalMeasures=[]},i}function ch(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?uh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function uh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hh=n(2);function dh(e){var t,n,r=new Object,i=e.scene.renderer.domElement.parentElement,a=e.scene.camera,o="MeasureElevationHeight",s=(r.TotalMeasures=[],r.isActive=!1,null);function c(e){e.preventDefault(),n={x:e.x,y:e.y}}function u(a){var o,s,l,c;d(),0===a.button&&Math.abs(a.x-n.x)<2&&Math.abs(a.y-n.y)<2&&e.CaptureMark.Position&&(a=JSON.parse(_()(e.CaptureMark.Position)),o=new hh.Vector3(a.worldPoint.x,a.worldPoint.y,a.worldPoint.z),o={position:window.bimEngine.scene.controls.origin=o,id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},!a.capture||"point"!==a.capture.type&&"line"!==a.capture.type||(o.position=new hh.Vector3(a.capture.val.x,a.capture.val.y,a.capture.val.z)),r.TotalMeasures.push(JSON.parse(_()(o))),a=o,o=p(i),(s=document.createElement("div")).className="HeightItem Actived",s.dataset.dataId=a.id,s.dataset.cameraId=e.scene.camera.type+"_"+e.scene.camera.Id,s.id=a.id,t=s,(l=document.createElement("div")).className="Box",l.dataset.dataId=a.id,l.innerText=Math.floor(1e3*a.position.y)/1e3+"m",s.appendChild(l),l="http://www.w3.org/2000/svg",(c=document.createElementNS(l,"svg")).setAttribute("style","width:65px;height:13px;display:block;pointer-events:none;"),c.dataset.dataId=a.id,(l=document.createElementNS(l,"polygon")).setAttribute("points","0,0 65,0 26,0 13,13 0,0"),l.setAttribute("style","fill:none;stroke:rgba(0,155,255,1);stroke-width:2;pointer-events:none;"),c.appendChild(l),s.appendChild(c),o.appendChild(s),s.addEventListener("click",(function(e){console.log(e.target.dataset.dataId),e.target.dataset.dataId?d(e.target.dataset.dataId):d()})),l=q(a.position,e.scene.camera),s.style.top=l.y-40+"px",s.style.left=l.x-13+"px")}function h(e){var n;"Delete"===e.key&&t&&(e=M()(e=r.TotalMeasures).call(e,(function(e){return e.id===t.id})),l()(n=r.TotalMeasures).call(n,e,1),document.getElementById(o).removeChild(t),d())}function d(e){if(document.getElementById(o)){var n,r=document.getElementById(o).children,i=ch(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.id&&(a.className="HeightItem")}}catch(e){i.e(e)}finally{i.f()}if(t=null,e){var s,l=ch(r);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(c.id===e){c.className="HeightItem Actived",t=c;break}}}catch(e){l.e(e)}finally{l.f()}}}}function p(e){var t=document.getElementById(o);return null==t&&((t=document.createElement("div")).id=o,e.appendChild(t)),t}return r.Active=function(){e.CaptureMark.Active(),i.addEventListener("pointerdown",c),i.addEventListener("pointerup",u),window.addEventListener("keydown",h),e.StopClick=!0,function t(){if(s=requestAnimationFrame(t),r.TotalMeasures){var n=r.TotalMeasures;if(null!=e.scene){var i,o=ch(n);try{for(o.s();!(i=o.n()).done;){var l,c,u,h=i.value,d=document.getElementById(h.id),p=new hh.Vector3(h.position.x,h.position.y,h.position.z).applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix);1<Math.abs(p.x)||1<Math.abs(p.y)||1<Math.abs(p.z)?d&&(d.style.display="none"):(d&&(d.style.display="block"),null!=(l=q(new hh.Vector3(h.position.x,h.position.y,h.position.z),e.scene.camera))&&(c=l.y,u=l.x,d.style.top=c-40+"px",d.style.left=u-13+"px"))}}catch(t){o.e(t)}finally{o.f()}}}}(),r.isActive=!0},r.DisActive=function(){e.CaptureMark.DisActive();var t=p(i);t&&t.remove(),i.removeEventListener("pointerdown",c),i.removeEventListener("pointerup",u),window.removeEventListener("keydown",h),e.StopClick=!1,cancelAnimationFrame(s),r.isActive=!1,r.TotalMeasures=[]},r}function ph(){var e=new Object;return e.GetSelectModels=function(){},e}function fh(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?mh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(2);var vh=n(2);function gh(e,t){n(575)("./"+F()+"/multiview.scss");var r,i,a,s=new Object;return null==e.ArrayCamera&&(r=new vh.ArrayCamera([t]),t.IsActive=!0,t.IsVisibility=!0,t.Id="a",t.ControlType="D3",i=window.bimEngine.scene.renderer.domElement.width,a=window.bimEngine.scene.renderer.domElement.height,window.bimEngine.scene.renderer.domElement.width,window.bimEngine.scene.renderer.domElement.height,t.viewport=new vh.Vector4(0,0,Math.ceil(i),Math.ceil(a)),e.ArrayCamera=r,yh(e)),document.addEventListener("click",(function(t){var n,r=fh(e.ArrayCamera.cameras);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.viewport.x,l=i.viewport.y,c=i.viewport.x+i.viewport.z,u=i.viewport.y+i.viewport.w;if(1==i.IsVisibility&&0==i.IsActive&&t.clientX>a&&t.clientX<c&&t.clientY>l&&t.clientY<u){i.IsActive=!0,e.scene.controls.dispose(),s.ReplaceView(e,i);var h,d=(null==i.target?e.scene.controls:i).target.clone();e.scene.controls=new vh.OrbitControls(i,e.scene.renderer.domElement),e.scene.controls.target=d,e.scene.controls.update(),"D3"==i.ControlType?(window.bimEngine.scene.controls.enableRotate=!0,document.getElementsByClassName("ViewCube")[0].style.visibility="visible"):"Plane"==i.ControlType&&(window.bimEngine.scene.controls.enableRotate=!1,document.getElementsByClassName("ViewCube")[0].style.visibility="hidden");var p,f=fh(o()(h=e.ArrayCamera.cameras).call(h,(function(e){return 1==e.IsActive&&e.uuid!=i.uuid})));try{for(f.s();!(p=f.n()).done;)p.value.IsActive=!1}catch(t){f.e(t)}finally{f.f()}var m=new CustomEvent("bimengine:camerachange",{detail:""});e.scene.controls.addEventListener("change",(function(){e.move=!0,window.dispatchEvent(m)}));break}}}catch(t){r.e(t)}finally{r.f()}})),s.updaterender=function(){for(var t=window.innerHeight,n=0;n<e.ArrayCamera.cameras.length;n++){var r=e.ArrayCamera.cameras[n];r.IsVisibility&&(e.scene.renderer.setScissorTest(!0),e.scene.renderer.setViewport(r.viewport.x,t-r.viewport.y-r.viewport.w,r.viewport.z,r.viewport.w),e.scene.renderer.setScissor(r.viewport.x,t-r.viewport.y-r.viewport.w,r.viewport.z,r.viewport.w),e.scene.renderer.render(e.scene,r),r.IsActive)&&(r.target=e.scene.controls.target.clone())}},s.creatorView=function(e,t){var n,r;e=e,r=window.bimEngine.scene.renderer.domElement.width/window.bimEngine.scene.renderer.domElement.height,(r=new vh.PerspectiveCamera(40,r,.1,10)).viewport=new vh.Vector4(1,2,2,2),r.IsActive=!1,r.IsVisibility=!0,r.name=""+e.ArrayCamera.cameras.length,l()(n=e.ArrayCamera.cameras).call(n,0,0,r),yh(e)},s.TileView=function(e){var t,n=fh(e.ArrayCamera.cameras);try{for(n.s();!(t=n.n()).done;)t.value.IsVisibility=!0}catch(e){n.e(e)}finally{n.f()}yh(e)},s.ClearView=function(e){e=e,window.bimEngine.ArrayCamera.cameras=[],window.bimEngine.ArrayCamera.cameras.push(e.scene.camera),yh(e);var t=document.getElementsByClassName("ViewControlPanel");1===t.length&&(t[0].childNodes[0].style.display="none"),e.RenderUpdata()},s.SwitchView=function(e,t){var n,r=fh(e.ArrayCamera.cameras);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.Id==t.Id?(i.IsActive=!0,i.IsVisibility=!0):(i.IsActive=!1,i.IsVisibility=!1)}}catch(e){r.e(e)}finally{r.f()}e.scene.controls.dispose(),s.ReplaceView(e,t);var a=null==t.target?e.scene.controls.target:t.target.clone(),o=(e.scene.controls=new vh.OrbitControls(t,e.scene.renderer.domElement),e.scene.controls.target=a,e.scene.controls.update(),"D3"==t.ControlType?(window.bimEngine.scene.controls.enableRotate=!0,document.getElementsByClassName("ViewCube")[0].style.visibility="visible",window.bimEngine.Render.DisplayEdge(!1)):"Plane"==t.ControlType&&(window.bimEngine.scene.controls.enableRotate=!1,document.getElementsByClassName("ViewCube")[0].style.visibility="hidden",window.bimEngine.Render.DisplayEdge(!0)),yh(e),s.updaterender(),new CustomEvent("bimengine:camerachange",{detail:""}));e.scene.controls.addEventListener("change",(function(){e.move=!0,window.dispatchEvent(o)})),e.RenderUpdata()},s.New3DOrthogonal=function(e){var t,n,r,i=s.Get3DOrthogonalData(),a=M()(a=e.ArrayCamera.cameras).call(a,(function(e){return e.Id==i.Id}));-1==a?(t=window.innerWidth,n=window.innerHeight,(r=new vh.OrthographicCamera(-100*(r=t/n),100*r,100,-100,1,1e3)).name=i.label,r.Id=i.Id,r.viewport=new vh.Vector4(0,0,t,n),r.ControlType="D3",l()(t=e.ArrayCamera.cameras).call(t,0,0,r),s.SwitchView(e,r),e.ViewCube.cameraGoHome()):s.SwitchView(e,e.ArrayCamera.cameras[a]),window.bimEngine.scene.controls.enableRotate=!0},s.New3DPerspective=function(e){var t,n,r,i=s.Get3DPerspectiveData(),a=M()(a=e.ArrayCamera.cameras).call(a,(function(e){return e.Id==i.Id}));-1==a?(t=window.bimEngine.scene.renderer.domElement.width,n=window.bimEngine.scene.renderer.domElement.height,(r=new vh.PerspectiveCamera(50,window.bimEngine.scene.renderer.domElement.width/window.bimEngine.scene.renderer.domElement.height,.01,3e4)).name=i.label,r.Id=i.Id,r.viewport=new vh.Vector4(0,0,t,n),r.ControlType="D3",l()(t=e.ArrayCamera.cameras).call(t,0,0,r),s.SwitchView(e,r),e.ViewCube.cameraGoHome()):s.SwitchView(e,e.ArrayCamera.cameras[a]),window.bimEngine.scene.controls.enableRotate=!0,document.getElementsByClassName("ViewCube")[0].style.visibility="visible"},s.NewPlaneView=function(e,t){var n,r,i,a=M()(a=e.ArrayCamera.cameras).call(a,(function(e){return e.Id==t.Id}));-1==a?(i=window.bimEngine.scene.renderer.domElement.width,r=window.bimEngine.scene.renderer.domElement.height,(n=new vh.OrthographicCamera(-100*(n=i/r),100*n,100,-100,.001,1e6)).name=t.label,n.Id=t.Id,n.viewport=new vh.Vector4(0,0,i,r),n.ControlType="Plane",l()(i=e.ArrayCamera.cameras).call(i,0,0,n),i=(r=e.ViewCube.getBoundingBox()).min,r=r.max,i=i.clone().add(r.clone()).multiplyScalar(.5),r=new vh.Vector3(i.x,.3048*t.ViewData.Evevation,i.z),i=new vh.Vector3(t.ViewData.ViewDirection.X,t.ViewData.ViewDirection.Z,t.ViewData.ViewDirection.Y),i=r.clone().add(i),e.ViewCube.animateCamera(e.scene.camera.position,r,e.scene.controls.target.clone(),i),s.SwitchView(e,n)):s.SwitchView(e,e.ArrayCamera.cameras[a]),window.bimEngine.scene.controls.enableRotate=!1,document.getElementsByClassName("ViewCube")[0].style.visibility="hidden"},s.NewElevationView=function(e,t){var n,r,i,a=M()(a=e.ArrayCamera.cameras).call(a,(function(e){return e.Id==t.Id}));-1==a?(i=window.bimEngine.scene.renderer.domElement.width,r=window.bimEngine.scene.renderer.domElement.height,(n=new vh.OrthographicCamera(-100*(n=i/r),100*n,100,-100,1,1e3)).name=t.label,n.Id=t.Id,n.ControlType="Plane",n.viewport=new vh.Vector4(0,0,i,r),l()(i=e.ArrayCamera.cameras).call(i,0,0,n),null==t.ViewData.Origin.X?(r=new vh.Vector3(t.ViewData.Origin.x,t.ViewData.Origin.y,t.ViewData.Origin.z),i=new vh.Vector3(t.ViewData.ViewDirection.x,t.ViewData.ViewDirection.y,t.ViewData.ViewDirection.z),i=r.clone().add(i),e.ViewCube.animateCamera(e.scene.camera.position,r,e.scene.controls.target.clone(),i)):(r=new vh.Vector3(.3048*t.ViewData.Origin.X,.3048*t.ViewData.Origin.Z,.3048*t.ViewData.Origin.Y),i=new vh.Vector3(t.ViewData.ViewDirection.X,t.ViewData.ViewDirection.Z,t.ViewData.ViewDirection.Y),i=r.clone().add(i),e.ViewCube.animateCamera(e.scene.camera.position,r,e.scene.controls.target.clone(),i)),s.SwitchView(e,n)):s.SwitchView(e,e.ArrayCamera.cameras[a]),window.bimEngine.scene.controls.enableRotate=!1,document.getElementsByClassName("ViewCube")[0].style.visibility="hidden"},s.Get3DOrthogonalData=function(){var e=o()(e=window.bimEngine.D3Measure.ViewList).call(e,(function(e){return"3DOrthogonal"==e.ViewType}));return e&&e.length?e[0]:{}},s.Get3DPerspectiveData=function(){var e=o()(e=window.bimEngine.D3Measure.ViewList).call(e,(function(e){return"3DPerspective"==e.ViewType}));return e&&e.length?e[0]:{}},s.ReplaceView=function(e,t){var n=e.scene.camera;if(e.scene.camera=t,e.scene.camera.Id!==n.Id){if(console.log(""),e=document.getElementById("MeasurePoint"))for(var r=e.getElementsByClassName("PointItem"),i=0;i<r.length;i++)r[i].dataset.cameraId===t.type+"_"+t.Id?r[i].style.display="block":r[i].style.display="none";if(n=document.getElementById("MeasureLine"))for(var a=n.getElementsByClassName("LineItem"),o=0;o<a.length;o++)a[o].dataset.cameraId===t.type+"_"+t.Id?a[o].style.display="block":a[o].style.display="none"}},s}function yh(e){for(var t,n=o()(n=e.ArrayCamera.cameras).call(n,(function(e){return 1==e.IsVisibility})),r=n.length,i=window.bimEngine.scene.renderer.domElement.width,a=window.bimEngine.scene.renderer.domElement.height,s=(window.bimEngine.scene.renderer.domElement.width,window.bimEngine.scene.renderer.domElement.height,document.getElementsByClassName("ViewControlPanel"));0<s.length;)s[0].remove();1==r&&((t=n[0]).viewport=new vh.Vector4(0,0,Math.ceil(i),Math.ceil(a)),xh(t),wh(e,t,r)),2==r&&((t=n[0]).viewport=new vh.Vector4(0,0,Math.ceil(.5*i),Math.ceil(a)),t.aspect=Math.ceil(.5*i)/Math.ceil(a),xh(t),wh(e,t),(t=n[1]).viewport=new vh.Vector4(Math.floor(.5*i),0,Math.ceil(.5*i),Math.ceil(a)),t.aspect=Math.ceil(.5*i)/Math.ceil(a),xh(t),wh(e,t)),3==r&&((t=n[0]).viewport=new vh.Vector4(0,0,Math.ceil(.5*i),Math.ceil(.5*a)),t.aspect=Math.ceil(.5*i)/Math.ceil(.5*a),xh(t),wh(e,t),(t=n[1]).viewport=new vh.Vector4(0,Math.floor(.5*a),Math.ceil(.5*i),Math.ceil(.5*a)),t.aspect=Math.ceil(.5*i)/Math.ceil(.5*a),xh(t),wh(e,t),(t=n[2]).viewport=new vh.Vector4(Math.floor(.5*i),0,Math.ceil(.5*i),Math.ceil(a)),t.aspect=Math.ceil(.5*i)/Math.ceil(a),xh(t),wh(e,t)),4<=r&&((t=n[0]).viewport=new vh.Vector4(0,0,Math.ceil(.5*i),Math.ceil(.5*a)),t.aspect=Math.ceil(.5*i)/Math.ceil(.5*a),xh(t),wh(e,t),(t=n[1]).viewport=new vh.Vector4(0,Math.floor(.5*a),Math.ceil(.5*i),Math.ceil(.5*a)),t.aspect=Math.ceil(.5*i)/Math.ceil(.5*a),xh(t),wh(e,t),(t=n[2]).viewport=new vh.Vector4(Math.floor(.5*i),0,Math.ceil(.5*i),Math.ceil(.5*a)),t.aspect=Math.ceil(.5*i)/Math.ceil(.5*a),xh(t),wh(e,t),(t=n[3]).viewport=new vh.Vector4(Math.floor(.5*i),Math.floor(.5*a),Math.ceil(.5*i),Math.ceil(.5*a)),xh(t),wh(e,t)),1<r&&e.RenderUpdata()}function xh(e){var t,n;"OrthographicCamera"==e.type?(t=e.viewport.z/e.viewport.w,e.aspect=t,e.left=-100*t/2,e.right=100*t/2,e.top=50,e.bottom=-50,e.updateProjectionMatrix()):"PerspectiveCamera"==e.type&&(t=e.viewport.z,n=e.viewport.w,e.aspect=t/n,e.updateProjectionMatrix())}function wh(e,t,n){var r=t.viewport.x,i=t.viewport.y,a=t.viewport.z,o=t.viewport.w,s=document.createElement("div");s.className="ViewControlPanel",s.style.top=i+"px",s.style.left=r+"px",s.style.width=a+"px",s.style.height=o+"px",s.style.outline="1px solid rgb(10,10,10,0.2)",i="block",r=["<div style='display:"+(i=1===n?"none":i)+"'>","<div id='"+t.uuid+"closeButton' class='ViewControlClose'></div>","<div id='"+t.uuid+"maxButton' class='ViewControlMax'></div>","<div id='"+t.uuid+"minButton' class='ViewControlMin'></div>","</div>"].join("");s.innerHTML=r,e.scene.renderer.domElement.parentElement.appendChild(s),document.getElementById(t.uuid+"closeButton").addEventListener("click",(function(t){var n,r;1!=e.ArrayCamera.cameras.length&&(-1!=(n=M()(n=e.ArrayCamera.cameras).call(n,(function(e){return e.uuid==t.target.id.replace("closeButton","")})))&&l()(r=e.ArrayCamera.cameras).call(r,n,1),-1==M()(r=e.ArrayCamera.cameras).call(r,(function(t){return t.uuid==e.scene.camera.uuid}))&&e.MultiView.ReplaceView(e,e.ArrayCamera.cameras[0]),yh(e),bimEngine.RenderUpdata())})),document.getElementById(t.uuid+"minButton").addEventListener("click",(function(n){var r;1!=e.ArrayCamera.cameras.length&&(r=n.target.id.replace("minButton",""),-1!=(n=M()(n=e.ArrayCamera.cameras).call(n,(function(e){return e.uuid==r})))&&(e.ArrayCamera.cameras[n],t.IsVisibility=!1,yh(e)),bimEngine.RenderUpdata())})),document.getElementById(t.uuid+"maxButton").addEventListener("click",(function(t){if(1!=e.ArrayCamera.cameras.length){var n=t.target.id.replace("maxButton","");if(-1!=(t=M()(t=e.ArrayCamera.cameras).call(t,(function(e){return e.uuid==n})))){var r,i=e.ArrayCamera.cameras[t],a=(console.log(i.name),fh(e.ArrayCamera.cameras));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.uuid!=i.uuid&&(o.IsVisibility=!1,o.IsActive=!1)}}catch(t){a.e(t)}finally{a.f()}i.IsActive=!0,i.IsVisibility=!0,e.MultiView.ReplaceView(e,i),yh(e)}bimEngine.RenderUpdata()}}))}var bh=n(2);function _h(e){n(576)("./"+F()+"/minMap.scss");var t=new Object;return t.visible=!1,window.innerHeight,window.devicePixelRatio,t.renderUpdata=function(){var n,r,i,a;null!=t.camera&&0!=t.visible&&(r=t.camera,n=e.scene.camera.position.x,a=e.scene.camera.position.y,i=e.scene.camera.position.z,t.camera.position.set(n,a,i),t.renderer.render(e.scene,r),n=(n=t.camera.position).project(t.camera),a=window.innerWidth/2,i=window.innerHeight/2,a=Math.round(n.x*a+a),n=Math.round(-n.y*i+i),i=(r=new bh.Vector2(a,n)).x/window.innerWidth*200,a=r.y/window.innerHeight*200,t.OriginPoint.style.left=i+"px",t.OriginPoint.style.top=a+"px",t.OriginDirection.style.left=i+"px",t.OriginDirection.style.top=a+"px",n=e.scene.camera.getWorldDirection(new bh.Vector3),n=new bh.Vector3(n.x,0,n.z),r=new bh.Vector3(0,0,1),i=n.angleTo(r),a=0<n.clone().cross(r).y?1:-1,t.OriginDirection.style.transform="rotate("+(45+a*i*57.2974)+"deg)")},t.show=function(){var n=document.createElement("div"),r=("Mobile"===e.DeviceType?n.className="miniMap-Mobile":n.className="miniMap",n.id="miniMapRoot",document.body.appendChild(n),['<div id="OriginPoint" class="OriginPoint"></div>','<div id="OriginDirection" class="OriginDirection"></div>'].join(""));n.innerHTML=r,t.OriginPoint=document.getElementById("OriginPoint"),t.OriginDirection=document.getElementById("OriginDirection"),(r=new bh.WebGLRenderer).setPixelRatio(window.devicePixelRatio),r.setSize(n.clientWidth,n.clientHeight),r.domElement.id="minimap",r.setClearColor("rgb(200,200,200)",1),t.renderer=r,n.appendChild(r.domElement),n.addEventListener("pointerdown",(function(e){var t=n.offsetLeft,r=n.offsetTop,i=e.clientX-t,a=e.clientY-r;function s(e){var t=e.clientX-i,r=(e=e.clientY-a,o.offsetWidth-n.offsetWidth),s=o.offsetHeight-n.offsetHeight;s<(e=e<0?0:e)&&(e=s),n.style.left=(t=r<(t=t<0?0:t)?r:t)+"px",n.style.top=e+"px"}n.style.cursor="move",document.addEventListener("pointermove",s),document.addEventListener("pointerup",(function(){n.style.cursor="auto",document.removeEventListener("pointermove",s)}))}));var i,a,o=e.scene.renderer.domElement.parentElement;null!=(r=r.domElement)&&(i=r.offsetWidth,i/=a=r.offsetHeight,a=new bh.OrthographicCamera(-100*i,100*i,100,-100,.01,3e3),(t.camera=a).name="miniMap",a.viewport=new bh.Vector4(r.getBoundingClientRect().x,r.getBoundingClientRect().y,200,200),(i=new bh.OrbitControls(a,r)).enableRotate=!1,r=(a=e.scene.camera.position).clone().add(new bh.Vector3(0,-1,0)),t.camera.position.set(a.x,a.y,a.z),t.camera.lookAt(r),i.update()),t.visible=!0,document.getElementById("minimap").addEventListener("click",(function(n){var r,i,a,o=e.scene.camera;(n=(r=(n={x:n.offsetX,y:n.offsetY}).x,n=n.y,i=new bh.Raycaster,(a=new bh.Vector2).x=r/t.camera.viewport.z*2-1,a.y=-n/t.camera.viewport.w*2+1,i.setFromCamera(a,t.camera),0<(r=i.intersectObjects(e.GetAllVisibilityModel(),!0)).length?r[0].point:null))&&o.position.set(n.x,o.position.y,n.z)}))},t.close=function(){t.visible=!1,t.camera=null,document.getElementById("miniMapRoot")&&document.getElementById("miniMapRoot").remove()},t}var Mh=n(2);function Eh(){function e(e,t,n){var i=r(e,t,n);return function(e,t,n){var i=(e=r(e,t,n)).distanceTo(t);e=e.distanceTo(n),t=t.distanceTo(n);return Math.abs(i+e-t)<.01}(e,t,n)?i.distanceTo(e):1e8}function t(t,n,r){var i=r.clone().sub(n.clone()).setLength(1e4);return e(t,n=n.clone().sub(i),r=r.clone().add(i))}function n(e,t){var n=new Mh.Raycaster,r=new Mh.Vector3(t.normal.x,t.normal.y,t.normal.z),i=r.clone().setLength(2e7),a=r.clone().setLength(-1e7);n.set(e.clone().add(a.clone()),i),e=new Mh.Plane(r.clone().multiplyScalar(1),t.constant),a=n.ray.intersectPlane(e);return console.log(a,e),a}var r=function(e,t,n){n=n.clone().sub(t.clone());var r=e.clone().sub(t.clone());n=n.clone().normalize(),r=r.clone().normalize(),r=n.dot(r),e=t.distanceTo(e)*r;return t.clone().add(n.clone().setLength(e))};return{PointDistanceLine:e,PointPointDis:function(e,t){return e.distanceTo(t)},PointProjectLine:r,GetProjectPoints:function(e,t,n){var r,i;return n*=.1,0==t.x&&0==t.z?(r=new Mh.Vector3(1,0,0),i=new Mh.Vector3(0,0,1),[e.clone().add(r.clone().multiplyScalar(n)).add(i.clone().multiplyScalar(n)),e.clone().add(r.clone().multiplyScalar(n)).add(i.clone().multiplyScalar(-n)),e.clone().add(r.clone().multiplyScalar(-n)).add(i.clone().multiplyScalar(-n)),e.clone().add(r.clone().multiplyScalar(-n)).add(i.clone().multiplyScalar(n))]):(r=t.clone().cross(new Mh.Vector3(0,1,0)).normalize(),i=t.clone().cross(r).normalize(),[e.clone().add(r.clone().multiplyScalar(n)).add(i.clone().multiplyScalar(n)),e.clone().add(r.clone().multiplyScalar(n)).add(i.clone().multiplyScalar(-n)),e.clone().add(r.clone().multiplyScalar(-n)).add(i.clone().multiplyScalar(-n)),e.clone().add(r.clone().multiplyScalar(-n)).add(i.clone().multiplyScalar(n))])},PointDistanceLineExtend:t,LineProjectFace:function(e,t,n){},LineFaceIntersection:function(e,t,n){},LineplaneParallel:function(e,t,n){},LineLineWorldIntersection:function(e,t,n,r){},LineLineIntersection:function(e,t,n,r){},LineLineParallel:function(e,t,n,r){},IsPointInFace:function(e,t){return n(e,t).distanceTo(e)<.01},PointProjectFace:n,IsPointProjectFace:function(e,t){},PointDistanceFace:function(e,t){var n=t.normal,r=new Mh.Raycaster,i=n.clone().setLength(2e7);n=n.clone().setLength(-1e7);return r.set(e.clone().add(n.clone()),i),r.ray.intersectPlane(t)},IsPointInLine:function(e,t,n){var r=e.distanceTo(t);e=e.distanceTo(n),t=t.distanceTo(n);return Math.abs(r+e-t)<.01},PointProjectPointDirDis:function(e,t,n){var i=t.clone().add(e.clone().multiplyScalar(1e5));e=t.clone().add(e.clone().multiplyScalar(-1e5));return r(n,i,e).clone().distanceTo(t.clone())},PointDistanceToVector:function(e,n,r){return r=n.clone().add(r),t(e,n,r)}}}function Sh(){v.InstancedBufferGeometry.call(this),this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new v.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new v.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}h=n(33);var Th,Ah,Lh=n.n(h),Ch=(v.UniformsLib.line={linewidth:{value:1},resolution:{value:new v.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1},opacity:{value:1}},v.ShaderLib.line={uniforms:v.UniformsUtils.merge([v.UniformsLib.common,v.UniformsLib.fog,v.UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"},function(e){v.ShaderMaterial.call(this,{type:"LineMaterial",uniforms:v.UniformsUtils.clone(v.ShaderLib.line.uniforms),vertexShader:v.ShaderLib.line.vertexShader,fragmentShader:v.ShaderLib.line.fragmentShader,clipping:!0}),this.dashed=!1,Lh()(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}}}),this.setValues(e)}),Ph=(Ch.prototype=r()(v.ShaderMaterial.prototype),(Ch.prototype.constructor=Ch).prototype.isLineMaterial=!0,Sh.prototype=u()(r()(v.InstancedBufferGeometry.prototype),{constructor:Sh,isLineSegmentsGeometry:!0,applyMatrix4:function(e){var t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(e){e instanceof Float32Array?t=e:C()(e)&&(t=new Float32Array(e));var t;e=new v.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new v.InterleavedBufferAttribute(e,3,0)),this.setAttribute("instanceEnd",new v.InterleavedBufferAttribute(e,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(e){e instanceof Float32Array?t=e:C()(e)&&(t=new Float32Array(e));var t;e=new v.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceColorStart",new v.InterleavedBufferAttribute(e,3,0)),this.setAttribute("instanceColorEnd",new v.InterleavedBufferAttribute(e,3,3)),this},fromWireframeGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromEdgesGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromMesh:function(e){return this.fromWireframeGeometry(new v.WireframeGeometry(e.geometry)),this},fromLineSegments:function(e){if(!(e=e.geometry).isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this;console.error("THREE.LineSegmentsGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.")},computeBoundingBox:(Ah=new v.Box3,function(){null===this.boundingBox&&(this.boundingBox=new v.Box3);var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Ah.setFromBufferAttribute(t),this.boundingBox.union(Ah))}),computeBoundingSphere:(Th=new v.Vector3,function(){null===this.boundingSphere&&(this.boundingSphere=new v.Sphere),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){for(var n=this.boundingSphere.center,r=(this.boundingBox.getCenter(n),0),i=0,a=e.count;i<a;i++)Th.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(Th)),Th.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(Th));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}),toJSON:function(){},applyMatrix:function(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}),function(){Sh.call(this),this.type="LineGeometry"});function Rh(e){for(var t=e.children.length-1;0<=t;t--)"MeasurePinkEdge"===e.children[t].Name&&e.remove(e.children[t])}function Ih(e,t,n){for(var r={type:"area",val:Eh().GetProjectPoints(t.point,t.face.normal,1),isCenter:!1},i=[],a=0;a<n.length;a+=6){var o=new THREE.Vector3(n[a],n[a+1],n[a+2]),s=new THREE.Vector3(n[a+3],n[a+4],n[a+5]);o=Eh().PointDistanceLine(t.point,o,s);i.push({start:{x:n[a],y:n[a+1],z:n[a+2]},end:{x:n[a+3],y:n[a+4],z:n[a+5]},distance:o})}var l,c,u,h=S()(i).call(i,(function(e,t){return e.distance-t.distance}))[0],d=((d=e.camera.position.clone()).x=d.x+.1,d.y=d.y+.1,d.z=d.z+.1,Eh().PointPointDis(t.point,e.camera.position));return h.distance<=.025*d&&(r={type:"line",val:Eh().PointProjectLine(t.point,new THREE.Vector3(h.start.x,h.start.y,h.start.z),new THREE.Vector3(h.end.x,h.end.y,h.end.z)),isCenter:!1,line:[h.start.x,h.start.y,h.start.z,h.end.x,h.end.y,h.end.z]},(e=new THREE.Line3).start=new THREE.Vector3(h.start.x,h.start.y,h.start.z),e.end=new THREE.Vector3(h.end.x,h.end.y,h.end.z),e=e.getCenter(),l=Eh().PointPointDis(t.point,e),c=Eh().PointPointDis(t.point,h.start),u=Eh().PointPointDis(t.point,h.end),c<=.015*d||u<=.015*d||l<=.01*d)&&(r={type:"point",val:h.start,isCenter:!1},l<(d=c)&&(d=l,r={type:"point",val:e,isCenter:!0}),u<d)&&(d=u,r={type:"point",val:h.end,isCenter:!1}),r}function kh(e,t){return null==e||0==e.length||0==(e=o()(e).call(e,(function(e){return n=e.min,e=e.max,(r=t).x>=n.x-.001&&r.y>=n.y-.001&&r.z>=n.z-.001&&r.x<=e.x+.001&&r.y<=e.y+.001&&r.z<=e.z+.001;var n,r}))).length?null:(S()(e).call(e,(function(e,n){return e.center.distanceTo(t)-n.center.distanceTo(t)})),e[0])}function Dh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zh(e,t){function n(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}lt(t+"/viewlist.json",(function(t){if(t){t=JSON.parse(t).viewList;var r,i=c()(i=t.CeilingPlans).call(i,t.FloorPlans),a=c()(a=t.Elevations).call(a,t.Sections),o=function(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Dh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(c()(i).call(i,a));try{for(o.s();!(r=o.n()).done;)!function(){var t,i=r.value,a=M()(a=e.D3Measure.ViewList).call(a,(function(e){return e.label==i.Rules}));-1!=a?-1!=(t=M()(t=e.D3Measure.ViewList[a].children).call(t,(function(e){return e.label==i.ViewType})))?e.D3Measure.ViewList[a].children[t].children.push({label:i.Name,Id:i.Id,ViewType:i.ViewType,ViewData:i}):e.D3Measure.ViewList[a].children.push({label:i.ViewType,Id:n(),children:[{label:i.Name,Id:i.Id,ViewType:i.ViewType,ViewData:i}]}):e.D3Measure.ViewList.unshift({label:i.Rules,Id:n(),children:[{label:i.ViewType,Id:n(),children:[{label:i.Name,Id:i.Id,ViewType:i.ViewType,ViewData:i}]}]})}()}catch(t){o.e(t)}finally{o.f()}}}))}function Nh(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Oh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Oh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bh(e){n(164)("./"+F()+"/d3measure.scss");var t=new Object;function r(){var t=e.scene.renderer.domElement.parentElement;t.addEventListener("pointerdown",c),t.addEventListener("pointerup",u),t.addEventListener("pointermove",s),t.setAttribute("tabindex",0),t.focus(),t.onkeydown=a}function i(){var t;null!=(t=((t=e.scene.renderer.domElement.parentElement).removeEventListener("pointerdown",c),t.removeEventListener("pointerup",u),t.removeEventListener("pointermove",s),t.removeEventListener("keydown",a),Rh(e.scene),document.getElementById("MeasurePoint")))&&t.remove(),e.StopClick=!1}function a(n){var r,a;27==n.keyCode?i():8!=n.keyCode&&46!=n.keyCode||(r=t.HighLightMeasure,-1!=(n=M()(n=e.scene.children).call(n,(function(e){return e.Id==r.Id})))&&l()(a=e.scene.children).call(a,n,1),-1!=(n=M()(a=t.Measures).call(a,(function(e){return e.Id==r.Id})))&&l()(a=t.Measures).call(a,n,1),-1!=(n=M()(a=t.Controls).call(a,(function(e){return e.Id==r.Id})))&&t.Controls[n].remove())}function s(n){var r,i,a,s;t.mouse=h(n),"DrawLine"==t.MouseType&&(n=n,s=e.scene.camera,null!=e.D3Measure.MeasurePink_Quadrangle&&(e.D3Measure.MeasurePink_Quadrangle.style.display="none"),null!=e.D3Measure.MeasurePink_Triangle&&(e.D3Measure.MeasurePink_Triangle.style.display="none"),null!=e.D3Measure.MeasurePink_Area&&(e.D3Measure.MeasurePink_Area.style.display="none"),Rh(e.scene),t.PINK_DETAILS={type:"area",val:null,isCenter:!1},n.target instanceof HTMLCanvasElement&&(r=new THREE.Raycaster,(i=new THREE.Vector2).x=(n.x-document.body.getBoundingClientRect().left)/document.body.offsetWidth*2-1,i.y=-(n.y-document.body.getBoundingClientRect().top)/document.body.offsetHeight*2+1,r.setFromCamera(i,s),(n=r.intersectObjects(e.D3Measure.AllModels,!0)).length&&("Mesh"==(i=n[0]).object.TypeName||"PipeMesh"==i.object.TypeName?null==(s=kh(i.object.ElementInfos,i.point))||null!=i.object.hideElements&&O()(r=i.object.hideElements).call(r,s.dbid)||(r=i.object.ElementInfos[s.dbid].EdgeList,t.PINK_DETAILS=Ih(e.scene,i,r)):"InstancedMesh"!=n[0].object.TypeName&&"InstancedMesh-Pipe"!=n[0].object.TypeName||(s=i.object.ElementInfos[i.instanceId].EdgeList,t.PINK_DETAILS=Ih(e.scene,i,s))),"line"===t.PINK_DETAILS.type)&&(r=e.scene,n=t.PINK_DETAILS.line,(i=new Ph).setPositions(n),(n=new Ch({color:"#00ff00",linewidth:1,vertexColors:!1})).resolution.set(window.innerWidth,window.innerHeight),(i=new THREE.LineSegments(i,n)).Name="MeasurePinkEdge",r.add(i)),s=m(t.mouse),t.CurrentMeasure.currentPoint=s.clone(),0!=(n=t.CurrentMeasure).Points.length)&&(1==n.Points.length?((r=[]).push(n.Points[0]),r.push(n.currentPoint),a=n.currentPoint.clone().sub(n.Points[0]),i=n.workerPlane.normal,n.disDir=a.clone().cross(i.clone()).normalize(),p(n,r,n.workerPlane)):2==n.Points.length&&((a=[]).push(n.Points[0]),a.push(n.Points[1]),a.push(n.currentPoint),p(n,a,n.workerPlane))),"DragMeasure"==t.MouseType&&(s=m(t.mouse),t.HighLightMeasure.currentPoint=s.clone(),3==t.HighLightMeasure.Points.length&&(t.HighLightMeasure.Points=[new THREE.Vector3(t.HighLightMeasure.Points[0].x,t.HighLightMeasure.Points[0].y,t.HighLightMeasure.Points[0].z),new THREE.Vector3(t.HighLightMeasure.Points[1].x,t.HighLightMeasure.Points[1].y,t.HighLightMeasure.Points[1].z),t.HighLightMeasure.currentPoint]),t.HighLightMeasure.MeasureText=o()(a=t.Controls).call(a,(function(e){return e.Id==t.HighLightMeasure.Id}))[0],t.HighLightMeasure.diry=f(t.HighLightMeasure.diry),t.HighLightMeasure.interCenter=f(t.HighLightMeasure.interCenter),p(t.HighLightMeasure,t.HighLightMeasure.Points,t.HighLightMeasure.workerPlane)),t.MouseType}function c(e){if(0==e.button){if(t.mouse=h(e),"DrawLine"==t.MouseType)if(e=m(t.mouse),0==t.CurrentMeasure.Points.length){if(null==t.PINK_DETAILS.line||6!=t.PINK_DETAILS.line.length)return;var n=new THREE.Vector3(t.PINK_DETAILS.line[0],t.PINK_DETAILS.line[1],t.PINK_DETAILS.line[2]);n=new THREE.Vector3(t.PINK_DETAILS.line[3],t.PINK_DETAILS.line[4],t.PINK_DETAILS.line[5]).clone().sub(n.clone()).normalize();"point"!==t.PINK_DETAILS.type&&"line"!==t.PINK_DETAILS.type||(e=new THREE.Vector3(t.PINK_DETAILS.val.x,t.PINK_DETAILS.val.y,t.PINK_DETAILS.val.z)),t.CurrentMeasure.Points.push(e),t.CurrentMeasure.diry=n}else 1==t.CurrentMeasure.Points.length?("point"!==t.PINK_DETAILS.type&&"line"!==t.PINK_DETAILS.type||(e=new THREE.Vector3(t.PINK_DETAILS.val.x,t.PINK_DETAILS.val.y,t.PINK_DETAILS.val.z)),t.CurrentMeasure.Points.push(e)):2==t.CurrentMeasure.Points.length&&(t.CurrentMeasure.Points.push(e),t.Measures.push(JSON.parse(_()(t.CurrentMeasure))),i(),t.CreatorMeasure());t.MouseType}}function u(e){0==e.button&&"DragMeasure"==t.MouseType&&(t.MouseType="none",t.HighLightControl.style.pointerevents="all",t.HighLightControl=null,i())}function h(t){var n={};return n.x=(t.clientX-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,n.y=-(t.clientY-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,n}function d(t){t=t.project(e.scene.camera);var n=e.scene.camera.viewport.z/2,r=e.scene.camera.viewport.w/2;n=Math.round(t.x*n+n),t=Math.round(-t.y*r+r);return new THREE.Vector2(n,t)}function p(n,i,a){null!=i[0]&&(i[0]=Eh().PointProjectFace(f(i[0]),a)),null!=i[1]&&(i[1]=Eh().PointProjectFace(f(i[1]),a)),null!=i[2]&&(i[2]=Eh().PointProjectFace(f(i[2]),a));var o=(a=i[0]).clone().add(n.diry.clone()),s=n.diry,l=(o=Eh().PointProjectLine(i[1],a,o),o=i[1].clone().sub(o.clone()),a.clone().add(o.clone())),c=(o=o.normalize(),null==(i=3==i.length?i[2]:null)?.1:Eh().PointDistanceLineExtend(i,a,l)),u=(i=null==i||0<i.clone().sub(a.clone()).dot(s)?1:-1,s=s.multiplyScalar(i),n.dis=c,[]);i=a.clone().add(s.clone().setLength(c)),c=l.clone().add(s.clone().setLength(c)),u.push(a.clone()),u.push(i.clone().add(s.clone().multiplyScalar(.05))),u.push(i.clone().add(o.clone().multiplyScalar(-.05))),u.push(c.clone().add(o.clone().multiplyScalar(.05))),u.push(l.clone()),u.push(c.clone().add(s.clone().multiplyScalar(.05))),a=o.clone().add(s.clone()).normalize(),u.push(i.clone().add(a.clone().multiplyScalar(.05))),u.push(i.clone().add(a.clone().multiplyScalar(-.05))),u.push(c.clone().add(a.clone().multiplyScalar(.05))),u.push(c.clone().add(a.clone().multiplyScalar(-.05))),n.linePoints=u,o=M()(l=e.scene.children).call(l,(function(e){return e.Id==n.Id})),s=i.clone().add(c.clone()).multiplyScalar(.5);if(n.interCenter=s.clone(),-1!=o){for(var h,p=e.scene.children[o],m=0;m<u.length;m++)p.geometry.attributes.position.array[3*m+0]=u[m].x,p.geometry.attributes.position.array[3*m+1]=u[m].y,p.geometry.attributes.position.array[3*m+2]=u[m].z;p.geometry.attributes.position.needsUpdate=!0,null!=n.MeasureText&&null!=n.MeasureText.style&&(window.innerHeight,window.devicePixelRatio,a=e.scene.camera.viewport.x,l=e.scene.camera.viewport.y,o=a+e.scene.camera.viewport.z,v=l+e.scene.camera.viewport.w,h=l+d(s.clone()).y,g=a+d(s.clone()).x,console.log(a,d(s.clone()).x,g),n.MeasureText.style.visibility=o<g||v<h||g<a||h<l?"hidden":"visible",n.MeasureText.innerHTML=Math.round(1e3*i.clone().distanceTo(c.clone()))+"mm")}else{var v=((o=new THREE.BufferGeometry).setFromPoints(u),new THREE.LineBasicMaterial({color:0,wireframe:!0,linewidth:100,depthTest:!1})),g=new THREE.LineSegments(o,v);(a=(g.name="ViewSection",g.Id=n.Id,e.scene.add(g),document.createElement("div"))).className="MeasureText",a.Id=n.Id,a.innerHTML=Math.round(1e3*i.clone().distanceTo(c.clone()))+"mm",t.Controls.push(a),n.MeasureText=a,n.MeasureText.style.top=d(s.clone()).y+"px",n.MeasureText.style.left=d(s.clone()).x+"px",e.scene.renderer.domElement.parentElement.appendChild(a),a.addEventListener("click",(function(e){var n,r=Nh(t.Controls);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.Id==e.target.Id?i.style.color="blue":i.style.color="black"}}catch(n){r.e(n)}finally{r.f()}var a=M()(a=t.Measures).call(a,(function(t){return t.Id==e.target.Id}));-1!=a&&(t.HighLightMeasure=t.Measures[a])})),a.addEventListener("mousedown",(function(e){var n=M()(n=t.Measures).call(n,(function(t){return t.Id==e.target.Id}));-1!=n&&(t.HighLightMeasure=t.Measures[n]),t.HighLightControl=e.target,t.HighLightControl.style.pointerevents="none",t.MouseType="DragMeasure",r()}))}}function f(e){return new THREE.Vector3(e.x,e.y,e.z)}function m(n){var r=n.x,i=(n=n.y,new THREE.Vector3(r,n,-1).unproject(e.scene.camera));r=new THREE.Vector3(r,n,-1e9).unproject(e.scene.camera),n=i,i=new THREE.Raycaster,r=n.clone().sub(r).setLength(1e6),i.set(n.clone().sub(r),r),n=t.CurrentMeasure.workerPlane;return i.ray.intersectPlane(n)}return t.MouseType="none",t.Measures=[],t.Controls=[],t.CurrentMeasure=null,t.HighLightMeasure=null,t.HighLightControl=null,e.D3Measure,t.GetMeasureList=function(){},t.ReductionMeasure=function(e){},t.Active=function(){},t.CreatorMeasure=function(){e.Measures.DistanceMeasure.DisActive(),e.Measures.HeightMeasure.DisActive(),e.Measures.PointMeasure.DisActive(),e.Measures.SimpleMeasure.DisActive(),t.MouseType="DrawLine";var n=e.D3Measure.GetCurrentWorkPlane();n=new THREE.Plane(n.normal.clone().normalize(),n.constant);t.CurrentMeasure={Points:[],Id:"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),workerPlane:n},e.StopClick=!0,r()},t.DisActive=function(){},t}function Fh(e){return new Object}function Uh(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Hh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vh(e){n(164)("./"+F()+"/d3measure.scss");var t=new Object;function r(){var t=e.scene.renderer.domElement.parentElement;t.addEventListener("pointerdown",s),t.addEventListener("pointerup",c),t.addEventListener("pointermove",u),t.setAttribute("tabindex",0),t.focus(),t.onkeydown=h}function i(){var t;null!=(t=((t=e.scene.renderer.domElement.parentElement).removeEventListener("pointerdown",s),t.removeEventListener("pointerup",c),t.removeEventListener("pointermove",u),e.scene,document.getElementById("MeasurePoint")))&&t.remove(),e.StopClick=!1}function s(e){0==e.button&&(t.drag=!1,a()((function(){t.drag=!0}),1e3))}function c(n){if(0==n.button){if(t.mouse=y(n),"DrawPoint"==t.MouseType){n=m(t.mouse);if(0==t.CurrentMeasure.Points.length){if(null==(n=f(t.mouse)))return;t.CurrentMeasure.Points.push(n);var r=p(n);t.CurrentMeasure.workerPlane=r}else 1==t.CurrentMeasure.Points.length?t.CurrentMeasure.Points.push(n):2==t.CurrentMeasure.Points.length&&(t.CurrentMeasure.Points.push(n),t.Measures.push(JSON.parse(_()(t.CurrentMeasure))),-1!=(n=M()(r=e.scene.children).call(r,(function(e){return"temp"==e.Id})))&&(e.scene.children[n].Id=t.CurrentMeasure.Id),t.MouseType="none",i(),e.StopClick=!1)}"none"==t.MouseType&&i(),"DragMeasure"==t.MouseType&&(t.MouseType="none",t.HighLightControl.style.pointerevents="all",t.HighLightControl=null,i())}}function u(e){if(t.mouse=y(e),"DrawPoint"==t.MouseType){if(null==(e=m(t.mouse))||"undefined"==e||null==e){if(0!=t.CurrentMeasure.Points.length)return;if(null==(e=f(t.mouse)))return;var n=p(e);t.CurrentMeasure.workerPlane=n}t.CurrentMeasure.currentPoint=v(e).clone(),e=[],0==(n=t.CurrentMeasure).Points.length?(e.push(n.currentPoint),e.push(n.currentPoint),e.push(n.currentPoint),d(n,e)):1==n.Points.length?((e=[]).push(n.Points[0]),e.push(n.currentPoint),e.push(n.currentPoint),d(n,e)):2==n.Points.length&&((e=[]).push(n.Points[0]),e.push(n.Points[1]),e.push(n.currentPoint),d(n,e))}"DragMeasure"==t.MouseType&&(e=m(t.mouse),t.HighLightMeasure.currentPoint=e.clone(),3==t.HighLightMeasure.Points.length&&(t.HighLightMeasure.Points=[new THREE.Vector3(t.HighLightMeasure.Points[0].x,t.HighLightMeasure.Points[0].y,t.HighLightMeasure.Points[0].z),new THREE.Vector3(t.HighLightMeasure.Points[1].x,t.HighLightMeasure.Points[1].y,t.HighLightMeasure.Points[1].z),t.HighLightMeasure.currentPoint]),t.HighLightMeasure.MeasureText=o()(e=t.Controls).call(e,(function(e){return e.Id==t.HighLightMeasure.Id}))[0],d(t.HighLightMeasure,t.HighLightMeasure.Points)),t.MouseType}function h(n){var r;27==n.keyCode?i():8!=n.keyCode&&46!=n.keyCode||null!=t.HighLightMeasure&&(-1!=(n=M()(n=e.scene.children).call(n,(function(e){return e.Id==t.HighLightMeasure.Id})))&&l()(r=e.scene.children).call(r,n,1),-1!=(n=M()(r=t.Controls).call(r,(function(e){return e.Id==t.HighLightMeasure.Id})))&&t.Controls[n].remove(),-1!=(n=M()(r=t.Measures).call(r,(function(e){return e.Id==t.HighLightMeasure.Id})))&&l()(r=t.Measures).call(r,n,1),i())}function d(n,i){var a=v(i[0]),o=v(i[1]),s=v(i[2]),l=g(o.clone()),c=g(s.clone()),u=(c=new THREE.Vector2(c.x,l.y),[]),h=(c=(s=m(((h={}).x=((c=c).x-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,h.y=-(c.y-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,h))).clone().sub(o.clone()).normalize()).clone().cross(t.CurrentMeasure.workerPlane.normal.clone()).normalize();g(o.clone().add(h)).y<l.y&&h.multiplyScalar(-1),l=c.clone().add(h.clone()),h=c.clone().multiplyScalar(-1).add(h.clone());if(-1!=(o=(u.push(a),u.push(o),u.push(o),u.push(s.clone().add(c.clone().multiplyScalar(.2))),u.push(s),u.push(s.clone().sub(h.clone().multiplyScalar(.2))),u.push(s),u.push(s.clone().sub(l.clone().multiplyScalar(.2))),u.push(s.clone().add(c.clone().multiplyScalar(3*.2)).sub(h.clone().multiplyScalar(.2))),u.push(s.clone().sub(l.clone().multiplyScalar(.2))),n.linePoints=u,n.interCenter=u[5].clone().add(u[7].clone()).multiplyScalar(.5),M()(a=e.scene.children).call(a,(function(e){return e.Id==n.Id}))))){for(var d=e.scene.children[o],p=0;p<u.length;p++)d.geometry.attributes.position.array[3*p+0]=u[p].x,d.geometry.attributes.position.array[3*p+1]=u[p].y,d.geometry.attributes.position.array[3*p+2]=u[p].z;d.geometry.attributes.position.needsUpdate=!0,n.MeasureText.innerHTML=Math.round(1e3*i[0].y)+"mm"}else(c=new THREE.BufferGeometry).setFromPoints(u),h=new THREE.LineBasicMaterial({color:0,wireframe:!0,linewidth:100,depthTest:!1}),(s=new THREE.LineSegments(c,h)).name="MeasureLevel",s.Id=n.Id,e.scene.add(s),(l=document.createElement("div")).className="MeasureLevelText",l.Id=n.Id,l.innerHTML=Math.round(1e3*i[0].y)+"mm",n.MeasureText=l,t.Controls.push(l),e.scene.renderer.domElement.parentElement.appendChild(l),l.addEventListener("click",(function(e){var n,r=Uh(t.Controls);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.Id==e.target.Id?i.style.color="blue":i.style.color="black"}}catch(n){r.e(n)}finally{r.f()}var a=M()(a=t.Measures).call(a,(function(t){return t.Id==e.target.Id}));-1!=a&&(t.HighLightMeasure=t.Measures[a])})),l.addEventListener("mousedown",(function(e){var n=M()(n=t.Measures).call(n,(function(t){return t.Id==e.target.Id}));-1!=n&&(t.HighLightMeasure=t.Measures[n]),t.HighLightControl=e.target,t.HighLightControl.style.pointerevents="none",t.MouseType="DragMeasure",r()}))}function p(t){t=v(t);var n=new THREE.Vector3,r=(e.scene.camera.getWorldDirection(n),Eh().PointProjectPointDirDis(n.clone().normalize(),new THREE.Vector3,t));t=t.clone().sub(new THREE.Vector3).dot(n.clone());return new THREE.Plane(n.clone().multiplyScalar(-1).normalize().multiplyScalar(t<0?-1:1).clone().normalize(),r)}function f(t){var n;if(null!=t)return(n=new THREE.Raycaster).setFromCamera(t,e.scene.camera),0<(t=n.intersectObjects(e.GetAllVisibilityModel(),!0)).length?t[0].point:null}function m(n){var r,i;return 0==t.CurrentMeasure.Points.length?null:(r=p(t.CurrentMeasure.Points[0]),(i=new THREE.Raycaster).setFromCamera(n,e.scene.camera),i.ray.intersectPlane(r))}function v(e){if(null!=e)return new THREE.Vector3(e.x,e.y,e.z)}function g(t){t=t.project(e.scene.camera);var n=e.scene.camera.viewport.z/2,r=e.scene.camera.viewport.w/2;n=Math.round(t.x*n+n),t=Math.round(-t.y*r+r);return new THREE.Vector2(n,t)}function y(t){var n={};return n.x=(t.clientX-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,n.y=-(t.clientY-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,n}return t.MouseType="none",t.Measures=[],t.Controls=[],t.CurrentMeasure=null,t.HighLightMeasure=null,t.HighLightControl=null,e.D3Measure,function n(){if(requestAnimationFrame(n),null!=e.scene&&null!=e.scene.camera.viewport){var r,i,a=e.scene.camera.viewport.x,o=e.scene.camera.viewport.y,s=a+e.scene.camera.viewport.z,l=o+e.scene.camera.viewport.w,c=Uh(t.Measures);try{for(c.s();!(r=c.n()).done;)!function(){var n,c=r.value,u=(h=q(v(c.interCenter).clone(),e.scene.camera)).y,h=h.x;-1!=(i=M()(n=t.Controls).call(n,(function(e){return e.Id==c.Id})))&&(t.Controls[i].style.visibility=s<h||l<u||h<a||u<o?"hidden":"visible",t.Controls[i].style.left=h+"px",t.Controls[i].style.top=u+"px")}()}catch(n){c.e(n)}finally{c.f()}}}(),t.GetMeasureList=function(){},t.ReductionMeasure=function(e){},t.Active=function(){},t.CreatorMeasure=function(){t.MouseType="DrawPoint",t.CurrentMeasure={Points:[],Id:"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.StopClick=!0,r()},t.drag=!0,t}function Gh(e){return new Object}function Wh(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?jh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Ph.prototype=u()(r()(Sh.prototype),{constructor:Ph,isLineGeometry:!0,setPositions:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return Sh.prototype.setPositions.call(this,n),this},setColors:function(e){for(var t=e.length-3,n=new Float32Array(2*t),r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return Sh.prototype.setColors.call(this,n),this},fromLine:function(e){if(!(e=e.geometry).isGeometry)return e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this;console.error("THREE.LineGeometry no longer supports Geometry. Use THREE.BufferGeometry instead.")},copy:function(){return this}}),n(2),n(2);var qh=n(2);function Xh(e){n(164)("./"+F()+"/d3measure.scss");var t=new Object;function r(){var e,n=M()(e=t.ViewList).call(e,(function(e){return""==e.label}));if(-1==n&&(t.ViewList.push({Id:b(),label:"",children:[]}),n=M()(e=t.ViewList).call(e,(function(e){return""==e.label}))),0==t.SectionViewLists.length)t.ViewList[n].children=[];else for(var r=t.ViewList[n].children.length-1;0<=r;r--)!function(e){var r;-1==M()(r=t.SectionViewLists).call(r,(function(r){return r.Id==t.ViewList[n].children[e].Id}))&&l()(r=t.ViewList[n].children).call(r,e,1)}(r);var i,a=Wh(t.SectionViewLists);try{var o=function(){var e,r=i.value,a=M()(a=t.ViewList[n].children).call(a,(function(e){return e.Id==r.Id}));r.ViewData={Id:(e=r).Id,Name:e.label,Origin:x(e.viewPoints[0]).add(x(e.viewPoints[1])).multiplyScalar(.5),ViewType:"",ViewDirection:x(e.diry)},-1==a?t.ViewList[n].children.push(r):t.ViewList[n].children[a]=r};for(a.s();!(i=a.n()).done;)o()}catch(e){a.e(e)}finally{a.f()}}function i(){var t=e.scene.renderer.domElement.parentElement;t.addEventListener("pointerdown",h),t.addEventListener("pointerup",d),t.addEventListener("pointermove",p),t.setAttribute("tabindex",0),t.focus(),t.onkeydown=u}function c(){var t;null!=(t=((t=e.scene.renderer.domElement.parentElement).removeEventListener("pointerdown",h),t.removeEventListener("pointermove",p),Rh(e.scene),document.getElementById("MeasurePoint")))&&t.remove(),e.StopClick=!1}function u(e){27==e.keyCode?c():8!=e.keyCode&&46!=e.keyCode||(e=t.HighLightView,t.DeleteSectionView(e.Id,!0))}function h(n){if(0==n.button){if(t.mouse=g(n),"HandlePlane"==t.MouseType&&(i=g(n),(r=new qh.Raycaster).setFromCamera(i,e.scene.camera),0<(i=r.intersectObjects(e.GetAllVisibilityModel(),!0)).length)&&(r=Eh().PointProjectPointDirDis(i[0].face.normal.clone().normalize(),new qh.Vector3,i[0].point),o=i[0].point.clone().sub(new qh.Vector3).dot(i[0].face.normal.clone()),i=new qh.Plane(i[0].face.normal.multiplyScalar(0<o?-1:1).clone().normalize(),r),e.WorkPlane=i,t.MouseType="none",c()),"DrawSection"==t.MouseType){var r,i,o=w(t.mouse);if(null==o)return;0==t.CurrentView.viewPoints.length?t.CurrentView.viewPoints.push(o):1==t.CurrentView.viewPoints.length?(1!=n.shiftKey&&(o=E(t.CurrentView.viewPoints[0],o,t.CurrentView.workerPlane)),t.CurrentView.viewPoints.push(o)):2==t.CurrentView.viewPoints.length&&(t.CurrentView.viewPoints.push(o),t.SectionViewLists.push(JSON.parse(_()(t.CurrentView))),i=M()(r=e.scene.children).call(r,(function(e){return"temp"==e.Id})),e.scene.children[i].Id=t.CurrentView.Id,t.MouseType="none")}"none"==t.MouseType&&a()((function(){var e=S(w(t.mouse));"DragView"!=t.MouseType&&(t.HighLightView=e)}),100)}}function d(e){0==e.button&&(r(),t.mouse=g(e),"DragView"==t.MouseType)&&(t.MouseType="none",t.CurrentDragType="none",t.CurrentDragClone=null)}function p(n){var r,i,a,o,l,c,u,h;if(t.mouse=g(n),"HandlePlane"==t.MouseType&&(i=n,r=e.scene.camera,t.MeasurePink_Quadrangle.style.display="none",t.MeasurePink_Triangle.style.display="none",t.MeasurePink_Area.style.display="none",Rh(e.scene),a={type:"area",val:null,isCenter:!1},i.target instanceof HTMLCanvasElement)&&(d=new qh.Raycaster,(h=new qh.Vector2).x=(i.x-document.body.getBoundingClientRect().left)/document.body.offsetWidth*2-1,h.y=-(i.y-document.body.getBoundingClientRect().top)/document.body.offsetHeight*2+1,d.setFromCamera(h,r),(i=d.intersectObjects(t.AllModels,!0)).length&&("Mesh"==(h=i[0]).object.TypeName||"PipeMesh"==h.object.TypeName?null==(d=kh(h.object.ElementInfos,h.point))||null!=h.object.hideElements&&O()(o=h.object.hideElements).call(o,d.dbid)||(o=h.object.ElementInfos[d.dbid].EdgeList,a=Ih(e.scene,h,o)):"InstancedMesh"!=i[0].object.TypeName&&"InstancedMesh-Pipe"!=i[0].object.TypeName||(d=h.object.ElementInfos[h.instanceId].EdgeList,a=Ih(e.scene,h,d))),"area"===a.type)&&i.length&&(h=s()(o=a.val).call(o,(function(e){return(e=q(new qh.Vector3(e.x,e.y,e.z),r)).x+","+e.y})),t.MeasurePink_Area.style.display="block",t.MeasurePink_Area.firstChild.setAttribute("points",h.join(" "))),"DrawSection"==t.MouseType){var d=w(t.mouse);if(null==d)return;1!=n.shiftKey&&0<t.CurrentView.viewPoints.length&&(d=E(t.CurrentView.viewPoints[0],d,t.CurrentView.workerPlane)),t.CurrentView.currentPoint=d.clone(),0!=(i=t.CurrentView).viewPoints.length&&(1==i.viewPoints.length?((a=[]).push(i.viewPoints[0]),a.push(i.currentPoint),l=i.currentPoint.clone().sub(i.viewPoints[0]),o=i.workerPlane.normal,i.disDir=l.clone().cross(o.clone()).normalize(),f("temp",a)):2==i.viewPoints.length&&((l=[]).push(i.viewPoints[0]),l.push(i.viewPoints[1]),l.push(i.currentPoint),f("temp",l)))}"none"==t.MouseType&&S(w(t.mouse)),"DragView"==t.MouseType&&(h=w(t.mouse),n=t.HighLightView,"Top"==t.CurrentDragType&&((c=[]).push(n.viewPoints[0]),c.push(n.viewPoints[1]),c.push(h),f(t.HighLightView.Id,c)),"Right"==t.CurrentDragType&&(c=[],x(t.HighLightView.diry).clone().dot(x(t.HighLightView.disDir).clone())<0?(u=Eh().PointDistanceToVector(h,x(n.viewPoints[0]),x(n.diry)),c.push(n.viewPoints[0]),c.push(x(n.viewPoints[0]).clone().add(x(n.dirx).multiplyScalar(u)))):(u=Eh().PointDistanceToVector(h,x(n.viewPoints[1]),x(n.diry)),c.push(x(n.viewPoints[1]).clone().sub(x(n.dirx).multiplyScalar(u))),c.push(n.viewPoints[1])),c.push(n.viewPoints[2]),f(t.HighLightView.Id,c)),"Left"==t.CurrentDragType&&(u=[],x(t.HighLightView.diry).clone().dot(x(t.HighLightView.disDir).clone())<0?(c=Eh().PointDistanceToVector(h,x(n.viewPoints[1]),x(n.diry)),u.push(x(n.viewPoints[1]).clone().sub(x(n.dirx).multiplyScalar(c))),u.push(n.viewPoints[1])):(c=Eh().PointDistanceToVector(h,x(n.viewPoints[0]),x(n.diry)),u.push(n.viewPoints[0]),u.push(x(n.viewPoints[0]).clone().add(x(n.dirx).multiplyScalar(c)))),u.push(n.viewPoints[2]),f(t.HighLightView.Id,u)),t.CurrentDragType,"Range"==t.CurrentDragType&&null!=t.CurrentDragClone&&(n=t.CurrentDragClone,t.CurrentDragStart,c=h.clone().sub(t.CurrentDragStart.clone()),(u=[]).push(x(n.viewPoints[0]).add(c)),u.push(x(n.viewPoints[1]).add(c)),u.push(x(n.viewPoints[2]).add(c)),f(t.HighLightView.Id,u)),m())}function f(n,r){var i=x(r[0]),a=x(r[1]),o=3==r.length?x(r[2]):null,s=[],l=1/t.DrawingScale,c=t.GetCameraWorkPlane(),u=a.clone().sub(i.clone()).normalize(),h=(c=u.clone().cross(c.normal).normalize(),null==o?1:Eh().PointDistanceLineExtend(o,i,a));o=null==o||0<o.clone().sub(i.clone()).dot(c)?1:-1,c=c.multiplyScalar(o);if(-1!=(i=(t.CurrentView.dis=h,t.CurrentView.diry=c,t.CurrentView.dirx=u,i.clone().add(c.clone().setLength(h)),a.clone().add(c.clone().setLength(h)),s.push(i.clone().add(u.clone().setLength(-l)).add(c.clone().setLength(l))),s.push(i.clone().add(u.clone().setLength(-l))),s.push(a.clone().add(u.clone().setLength(l))),s.push(a.clone().add(u.clone().setLength(l)).add(c.clone().setLength(l))),M()(o=e.scene.children).call(o,(function(e){return e.Id==n}))))){for(var d=e.scene.children[i],p=0;p<s.length;p++)d.geometry.attributes.position.array[3*p+0]=s[p].x,d.geometry.attributes.position.array[3*p+1]=s[p].y,d.geometry.attributes.position.array[3*p+2]=s[p].z;d.geometry.attributes.position.needsUpdate=!0,-1!=(l=M()(a=t.SectionViewLists).call(a,(function(e){return e.Id==n})))&&(t.SectionViewLists[l].viewPoints=r,t.SectionViewLists[l].dis=h,t.SectionViewLists[l].diry=c,t.SectionViewLists[l].dirx=u)}else(o=new qh.BufferGeometry).setFromPoints(s),i=new qh.LineBasicMaterial({color:0,wireframe:!0,linewidth:100,depthTest:!1}),(a=new qh.Line(o,i)).name="ViewSection",a.Id=n,e.scene.add(a)}function m(){var n,r,i,a,o,s,l,c,u,h;0!=t.Controls.length&&(i=t.Controls[0],null==t.HighLightView?i.style.visibility="hidden":(i.style.visibility="visible",i=x(t.HighLightView.diry),x(t.HighLightView.viewPoints[0]).clone().add(x(t.HighLightView.viewPoints[1]).clone()).multiplyScalar(.5).clone().add(x(i.clone().multiplyScalar(t.HighLightView.dis).clone())),a=x(t.HighLightView.viewPoints[0]).add(x(i.clone().multiplyScalar(t.HighLightView.dis).clone())),s=x(t.HighLightView.viewPoints[1]).add(x(i.clone().multiplyScalar(t.HighLightView.dis).clone())),h=x(t.HighLightView.viewPoints[0]).add(a.clone()).multiplyScalar(.5),n=x(t.HighLightView.viewPoints[1]).add(s.clone()).multiplyScalar(.5),x(t.HighLightView.viewPoints[0]).sub(x(i.clone().multiplyScalar(.5).clone())),x(t.HighLightView.viewPoints[0]).add(x(i.clone().multiplyScalar(.5).clone())),i=y(x(t.HighLightView.viewPoints[0]).clone()),r=y(x(t.HighLightView.viewPoints[1]).clone()),a=y(a.clone()),y(s.clone()),s=y(new qh.Vector3),o=y(x(t.HighLightView.diry)),r=new qh.Vector2(i.x,i.y).distanceTo(new qh.Vector2(r.x,r.y)),i=new qh.Vector2(i.x,i.y).distanceTo(new qh.Vector2(a.x,a.y)),a=180*(a=new qh.Vector2(o.x-s.x,o.y-s.y).angle(new qh.Vector2(0,1)))/Math.PI,window.innerHeight,window.devicePixelRatio,o=e.scene.camera.viewport.x,s=e.scene.camera.viewport.y,l=o+e.scene.camera.viewport.z,c=s+e.scene.camera.viewport.w,u=o+(.5*y(h.clone()).y+.5*y(n.clone()).y),h=s+(.5*y(h.clone()).x+.5*y(n.clone()).x),t.Controls[0].style.top=u+"px",t.Controls[0].style.left=h+"px",l<u||c<h||u<o||h<s?(t.Controls[0].style.visibility="hidden",console.log(o,s,u,h,l,c)):t.Controls[0].style.visibility="visible",t.Controls[0].style.transform="translate(-50%,-50%) rotate("+(90+a)+"deg) ",t.Controls[0].style.width=r+"px",t.Controls[0].style.height=i+"px",t.Controls[4].innerHTML=t.HighLightView.label))}function v(){return"D3"==e.scene.camera.ControlType?"D3":"Plane"}function g(t){var n={};return n.x=(t.clientX-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,n.y=-(t.clientY-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,n}function y(t){t=t.project(e.scene.camera);var n=e.scene.camera.viewport.z/2,r=e.scene.camera.viewport.w/2;n=Math.round(t.x*n+n),t=Math.round(-t.y*r+r);return new qh.Vector2(n,t)}function x(e){return new qh.Vector3(e.x,e.y,e.z)}function w(n){var r=t.GetCurrentWorkPlane(),i=n.x,a=(n=n.y,new qh.Vector3(i,n,-1).unproject(e.scene.camera));i=new qh.Vector3(i,n,-1e9).unproject(e.scene.camera),n=a,a=new qh.Raycaster,i=n.clone().sub(i).setLength(1e6);return a.set(n.clone().sub(i),i),a.ray.intersectPlane(r)}function b(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function E(e,t,n){n=n.normal;var r=new qh.Vector3(1,0,0),i=new qh.Vector3(0,0,1),a=(n=(0==n.x&&0==n.z?(new qh.Vector3(1,0,0),new qh.Vector3(0,0,1)):(a=n.clone().cross(new qh.Vector3(0,1,0)).normalize(),n.clone().cross(a).normalize()),t.clone().sub(e.clone()))).angleTo(r);return(Math.abs(a)<=.01*Math.PI||Math.abs(a)>=.99*Math.PI?Eh().PointProjectLine(t,e,e.clone().add(r)):(a=n.angleTo(i),Math.abs(a)<=.01*Math.PI||Math.abs(a)>=.99*Math.PI?Eh().PointProjectLine(t,e,e.clone().add(i)):t)).clone()}function S(n){if(null!=n){var r,i=Wh(t.SectionViewLists);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(Eh().PointDistanceLine(new qh.Vector3(n.x,n.y,n.z),new qh.Vector3(a.viewPoints[0].x,a.viewPoints[0].y,a.viewPoints[0].z),new qh.Vector3(a.viewPoints[1].x,a.viewPoints[1].y,a.viewPoints[1].z))<.5){var s,l,c=Wh(o()(s=e.scene.children).call(s,(function(e){return"ViewSection"==e.name})));try{for(c.s();!(l=c.n()).done;){var u=l.value;u.Id==a.Id?u.material.color=new qh.Color(0,0,1):u.material.color=new qh.Color(0,0,0)}}catch(n){c.e(n)}finally{c.f()}return a}}}catch(n){i.e(n)}finally{i.f()}var h,d,p=Wh(o()(h=e.scene.children).call(h,(function(e){return"ViewSection"==e.name})));try{for(p.s();!(d=p.n()).done;)d.value.material.color=new qh.Color(0,0,0)}catch(n){p.e(n)}finally{p.f()}return null}}return t.SignMeasure=new Bh(e),t.SignLineText=new Fh,t.SignMeasureLevel=new Vh(e),t.SignText=new Gh,t.MouseType="none",t.DrawingScale=1,t.CurrentView=null,t.HighLightView=null,t.SectionViewLists=[],t.ViewList=[],t.Controls=[],t.CurrentDragType="none",t.CurrentDragStart=null,t.Callback=null,t.ViewList.push({label:"",Id:b(),ViewType:"3DOrthogonal"}),t.ViewList.push({label:"",Id:b(),ViewType:"3DPerspective"}),function e(){requestAnimationFrame(e),m()}(),t.UpdateViewList=function(t){zh(e,t)},t.UpdateCallback=function(e){t.Callback=e},t.DeleteView=function(){},t.CreatorUI=function(){},t.Active=function(){var n,r,i,a,o,s,l;(n=document.createElement("div")).id="ViewControlRoot",n.className="ViewControlRoot",n.style.visibility="hidden",t.Controls.push(n),(r=document.createElement("div")).className="ViewControl_Top",r.id="ViewControl_Top",r.innerHTML="",n.appendChild(r),(i=document.createElement("div")).className="ViewControl_Left",i.id="ViewControl_Left",i.innerHTML="",n.appendChild(i),(a=document.createElement("div")).className="ViewControl_Right",a.id="ViewControl_Right",a.innerHTML="",n.appendChild(a),t.Controls.push(r),t.Controls.push(i),t.Controls.push(a),(o=document.createElement("div")).className="ViewText",o.id="ViewText",o.innerHTML="222",n.appendChild(o),t.Controls.push(o),(s=document.createElement("div")).className="ViewhandleDir",s.id="ViewhandleDir",s.innerHTML="",n.appendChild(s),t.Controls.push(s),(l=document.createElement("div")).className="ViewhandleRange",l.id="ViewhandleRange",n.appendChild(l),t.Controls.push(l),e.scene.renderer.domElement.parentElement.appendChild(n),r.addEventListener("mousedown",(function(e){event.stopPropagation(),t.MouseType="DragView",t.CurrentDragType="Top"})),i.addEventListener("mousedown",(function(e){event.stopPropagation(),t.MouseType="DragView",t.CurrentDragType="Left"})),a.addEventListener("mousedown",(function(e){event.stopPropagation(),t.MouseType="DragView",t.CurrentDragType="Right"})),o.addEventListener("mousedown",(function(e){var n=prompt("",t.HighLightView.label);t.HighLightView.label=n})),s.addEventListener("mousedown",(function(e){t.HighLightView.disDir=x(t.HighLightView.disDir).clone().multiplyScalar(-1),t.HighLightView.diry=x(t.HighLightView.diry).clone().multiplyScalar(-1)})),l.addEventListener("mousedown",(function(e){event.stopPropagation(),t.MouseType="DragView",t.CurrentDragType="Range";var n=w(t.mouse);t.CurrentDragStart=n.clone(),t.CurrentDragClone=JSON.parse(_()(t.HighLightView))}))},t.DisActive=function(){},t.GetCurrentViewType=function(){return v()},t.GetCameraWorkPlane=function(){var t=new qh.Vector3,n=(e.scene.camera.getWorldDirection(t),e.scene.camera.position),r=Eh().PointProjectPointDirDis(t.clone().normalize(),new qh.Vector3,n)+1;n=n.clone().sub(new qh.Vector3).dot(t.clone());return new qh.Plane(t.clone().multiplyScalar(-1).normalize().multiplyScalar(0<n?-1:1).clone().normalize(),r)},t.CreatorSection=function(){"D3"!=v()&&(t.MouseType="DrawSection",t.CurrentView={viewPoints:[],Id:b(),workerPlane:t.GetCurrentWorkPlane(),type:"UserDraw",label:"",ViewType:""},i())},t.DrawSelectLines=function(e){var t,n=Wh(e);try{for(n.s();!(t=n.n()).done;)t.value,new qh.Vector3,new qh.Vector3(1,0,0)}catch(e){n.e(e)}finally{n.f()}},t.Clear=function(){},t.DeleteSectionView=function(n){var i,a;(a=1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&0==confirm("")||(-1!=(a=(-1!=(a=(1!=(a=M()(a=t.SectionViewLists).call(a,(function(e){return e.Id==n})))&&l()(i=t.SectionViewLists).call(i,a,1),M()(i=e.ArrayCamera.cameras).call(i,(function(e){return e.Id==n}))))&&l()(i=e.ArrayCamera.cameras).call(i,a,1),M()(i=e.scene.children).call(i,(function(e){return e.Id==n}))))&&l()(i=e.scene.children).call(i,a,1),0<e.ArrayCamera.cameras.length?e.MultiView.SwitchView(e,e.ArrayCamera.cameras[0]):window.bimEngine.MultiView.New3DPerspective(window.bimEngine),t.HighLightView=null,r())},t.GetCurrentWorkPlane=function(){var n;return null!=e.WorkPlane?e.WorkPlane:(n=t.GetCameraWorkPlane(),e.WorkPlane=n)},t.HandleWorkPlane=function(){var n=function(e,t){e=function(e){var t=document.getElementById(e);return null==t&&((t=document.createElement("div")).id=e,window.bimEngine.scene.renderer.domElement.parentElement.appendChild(t)),t}(e);var n,r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),a=((n=((n=(i.setAttribute("style","position:absolute;width:20px;height:20px;display:none;pointer-events:none;"),document.createElementNS(r,"polygon"))).setAttribute("points","5,0 10,10 0,10"),n.setAttribute("style","fill:rgba(0,255,0,0.2);stroke:rgba(0,255,0,1);stroke-width:2;pointer-events:none;"),i.appendChild(n),e.appendChild(i),document.createElement("div"))).className="MeasurePointPink",e.appendChild(n),document.createElementNS(r,"svg"));return(r=(a.setAttribute("style","position:absolute;width:100vw;height:100vh;display:none;pointer-events: none;"),document.createElementNS(r,"polygon"))).setAttribute("points","0,0 10,0 10,10 0,10"),r.setAttribute("style","fill:rgba(0,255,0,0.2);stroke:rgba(0,255,0,1);stroke-width:2;pointer-events:none;"),a.appendChild(r),e.appendChild(a),r=null,t&&((r=document.createElement("div")).id="MeasureChuiDianPink",e.appendChild(r)),{Triangle:i,Quadrangle:n,Area:a,ChuiDian:r}}("MeasurePoint");t.MeasurePink_Triangle=n.Triangle,t.MeasurePink_Quadrangle=n.Quadrangle,t.MeasurePink_Area=n.Area,t.MouseType="HandlePlane",i(),t.AllModels=e.GetAllVisibilityModel(),e.StopClick=!0},t}Jc=n(52);var Yh=n.n(Jc);function Zh(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?Jh(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jh(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Jh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qh=n(2);function Kh(e,t,n){var r,i=[{type:"X",vector:new Qh.Vector3(-1,0,0),color:16711680,show:"showX"},{type:"Y",vector:new Qh.Vector3(0,-1,0),color:65280,show:"showY"},{type:"Z",vector:new Qh.Vector3(0,0,-1),color:255,show:"showZ"}],a=o()(u=window.bimEngine.scene.children).call(u,(function(e){return"TransformControlsClipping"===e.name}))[0];s()(i).call(i,(function(e){a[e.show]=!1})),x();for(var l=window.bimEngine.scene.children,c=l.length-1;0<=c;c--)"ClippingMesh"===l[c].name&&(t?window.bimEngine.scene.remove(l[c]):l[c].visible=!1);if(t){var u=function(){var e,t,r,a=window.bimEngine.ViewCube.getBoundingBox(),o=0,s=0,l=null;switch(e=a.center,n){case"X":l="y",o=a.max.z-a.min.z,s=a.max.y-a.min.y,e.x=a.max.x,r=a.max.x,t=i[0];break;case"Y":l="x",o=a.max.x-a.min.x,s=a.max.z-a.min.z,e.y=a.max.y,r=a.max.y,t=i[1];break;case"Z":o=a.max.x-a.min.x,s=a.max.y-a.min.y,e.z=a.max.z,r=a.max.z,t=i[2]}return{position:e,width:o,height:s,direction:l,plane:t,constant:r}}(),h=((r=new Qh.Plane(u.plane.vector,0)).constant=u.constant,new Qh.PlaneGeometry(u.width,u.height)),d=new Qh.MeshBasicMaterial({color:"#252525",opacity:.2,wireframeLinewidth:10,depthWrite:!1,side:Qh.DoubleSide,transparent:!0}),p=new Qh.Mesh(h,d);p.visible=!1;for(var f=((d=new Qh.Group).add(p),d.name="ClippingMesh",d.position.set(u.position.x,u.position.y,u.position.z),u.direction&&(d.rotation[u.direction]=Math.PI/2),e.add(d),new Qh.BufferGeometry),m=[],v=new Qh.EdgesGeometry(h,1).attributes.position.array,g=0;g<v.length;g+=3){var y=new Qh.Vector3(v[g],v[g+1],v[g+2]).clone();m.push(y.x),m.push(y.y),m.push(y.z)}f.setAttribute("position",new Qh.Float32BufferAttribute(m,3)),h=new Qh.LineSegments(f,new Qh.LineBasicMaterial({color:"#E3B951"})),d.add(h),a.attach(d),a[u.plane.show]=!0,a.addEventListener("change",(function(e){switch(n){case"X":r.constant=+e.target.worldPosition.x;break;case"Y":r.constant=+e.target.worldPosition.y;break;case"Z":r.constant=+e.target.worldPosition.z}window.bimEngine.UpdateRender()})),a.addEventListener("dragging-changed",(function(t){e.controls.enabled=!t.value,e.controls.enabled?p.visible=!1:p.visible=!0,window.bimEngine.UpdateRender()})),x(r)}function x(e){var t=window.bimEngine.scene.children,n=e?[e]:null;Yh()(t).call(t,(function(e){var t;"rootModel"===e.name&&(e.material instanceof Array?(Yh()(t=e.material).call(t,(function(e){e.clippingPlanes=n})),Yh()(t=e.cloneMaterialArray).call(t,(function(e){e.clippingPlanes=n}))):(e.material.clippingPlanes=n,e.cloneMaterialArray.clippingPlanes=n))})),ed(n),td(n)}window.bimEngine.UpdateRender()}function $h(e,t){var n,r=[],i=window.bimEngine.ViewCube.getBoundingBox(),a=(n=i.center,[{name:"side-z-max",width:i.max.x-i.min.x,height:i.max.y-i.min.y,position:{x:n.x,y:n.y,z:i.max.z},show:"showZ",direction:null,vector:new Qh.Vector3(0,0,-1),type:"Z",oppositeSize:"side-z-min"},{name:"side-z-min",width:i.max.x-i.min.x,height:i.max.y-i.min.y,position:{x:n.x,y:n.y,z:i.min.z},show:"showZ",direction:null,vector:new Qh.Vector3(0,0,1),type:"-Z",oppositeSize:"side-z-max"},{name:"side-x-max",width:i.max.z-i.min.z,height:i.max.y-i.min.y,position:{x:i.max.x,y:n.y,z:n.z},show:"showX",direction:"y",vector:new Qh.Vector3(-1,0,0),type:"X",oppositeSize:"side-x-min"},{name:"side-x-min",width:i.max.z-i.min.z,height:i.max.y-i.min.y,position:{x:i.min.x,y:n.y,z:n.z},show:"showX",direction:"y",vector:new Qh.Vector3(1,0,0),type:"-X",oppositeSize:"side-x-max"},{name:"side-y-max",width:i.max.x-i.min.x,height:i.max.z-i.min.z,position:{x:n.x,y:i.max.y,z:n.z},show:"showY",direction:"x",vector:new Qh.Vector3(0,-1,0),type:"Y",oppositeSize:"side-y-min"},{name:"side-y-min",width:i.max.x-i.min.x,height:i.max.z-i.min.z,position:{x:n.x,y:i.min.y,z:n.z},show:"showY",direction:"x",vector:new Qh.Vector3(0,1,0),type:"-Y",oppositeSize:"side-y-max"}]),l=i.center,u={x:i.max.x-i.min.x,y:i.max.y-i.min.y,z:i.max.z-i.min.z};g();for(var h=window.bimEngine.scene.children,d=h.length-1;0<=d;d--)"ClippingBox"!==h[d].name&&"ClippingMesh"!==h[d].name&&"TransformControlsClipping-MultiSide"!==h[d].name||window.bimEngine.scene.remove(h[d]);if(t){v(u,l,!0);for(var p=new Qh.MeshBasicMaterial({color:"#252525",opacity:.2,wireframeLinewidth:10,depthWrite:!1,side:Qh.DoubleSide,transparent:!0}),f=function(t){var n=new Qh.TransformControls(e.camera,e.renderer.domElement),h=(n.size=.5,n.name="TransformControlsClipping-MultiSide",n.data_name=a[t].name,n.data_opposite_size=a[t].oppositeSize,n.data_show=a[t].show,n.visible=!1,"showX"===a[t].show?n.showX=!0:n.showX=!1,"showY"===a[t].show?n.showY=!0:n.showY=!1,"showZ"===a[t].show?n.showZ=!0:n.showZ=!1,e.add(n),new Qh.Plane(a[t].vector,0));switch(h.visible=!0,r=c()(d=[]).call(d,b()(r),[h]),a[t].type){case"X":h.constant=+i.max.x;break;case"-X":h.constant=-i.min.x;break;case"Y":h.constant=+i.max.y;break;case"-Y":h.constant=-i.min.y;break;case"Z":h.constant=+i.max.z;break;case"-Z":h.constant=-i.min.z}var d=new Qh.PlaneGeometry(a[t].width,a[t].height),f=(d.name=a[t].name,new Qh.Mesh(d,p));f.name="ClippingMesh",f.data_name=a[t].name,f.data_show=a[t].show,f.visible=!1,f.position.set(a[t].position.x,a[t].position.y,a[t].position.z),a[t].direction&&(f.rotation[a[t].direction]=Math.PI/2),e.add(f),n.attach(f),n.addEventListener("change",(function(e){switch(a[t].type){case"X":h.constant=+e.target.worldPosition.x;break;case"-X":h.constant=-e.target.worldPosition.x;break;case"Y":h.constant=+e.target.worldPosition.y;break;case"-Y":h.constant=-e.target.worldPosition.y;break;case"Z":h.constant=+e.target.worldPosition.z;break;case"-Z":h.constant=-e.target.worldPosition.z}window.bimEngine.UpdateRender()})),n.addEventListener("dragging-changed",(function(t){var n,r,i,a,c,h,d;e.controls.enabled=!t.value,e.controls.enabled?(f.visible=!1,n=window.bimEngine.scene.children,n=o()(n).call(n,(function(e){return"TransformControlsClipping-MultiSide"===e.name})),d=h=c=a=i=r=0,s()(n).call(n,(function(e){switch(e.data_name){case"side-x-max":r=e.worldPosition.x;break;case"side-x-min":c=e.worldPosition.x;break;case"side-y-max":i=e.worldPosition.y;break;case"side-y-min":h=e.worldPosition.y;break;case"side-z-max":a=e.worldPosition.z;break;case"side-z-min":d=e.worldPosition.z}})),l={x:c+(u={x:r-c,y:i-h,z:a-d}).x/2,y:h+u.y/2,z:d+u.z/2},v(u,l,t.target.data_show)):f.visible=!0,window.bimEngine.UpdateRender()}))},m=0;m<a.length;m++)f(m);g(r)}function v(t,n,r,s){s=3<arguments.length&&void 0!==s&&s;var l=window.bimEngine.scene.children;if(!s)for(var c=l.length-1;0<=c;c--)if("ClippingBox"===l[c].name){window.bimEngine.scene.remove(l[c]);break}for(var u=new Qh.BoxGeometry(t.x,t.y,t.z),h=new Qh.MeshBasicMaterial({color:"#252525",opacity:1e-4,wireframeLinewidth:10,depthWrite:!1,side:Qh.DoubleSide,transparent:!0}),d=(h=new Qh.Mesh(u,h),new Qh.Group),p=(h=(d.add(h),d.name="ClippingBox",d.position.set(n.x,n.y,n.z),i.direction&&(d.rotation[i.direction]=Math.PI/2),e.add(d),new Qh.BufferGeometry),[]),f=new Qh.EdgesGeometry(u,1).attributes.position.array,m=0;m<f.length;m+=3){var v=new Qh.Vector3(f[m],f[m+1],f[m+2]).clone();p.push(v.x),p.push(v.y),p.push(v.z)}if(h.setAttribute("position",new Qh.Float32BufferAttribute(p,3)),u=new Qh.LineSegments(h,new Qh.LineBasicMaterial({color:"#E3B951"})),d.add(u),!s)for(var g=l.length-1;0<=g;g--)!function(e){var r,i,s,c;if("ClippingMesh"===l[e].name)switch(l[e].data_name){case"side-x-max":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.z,s=t.y,c={x:n.x+t.x/2,y:n.y,z:n.z},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z);break;case"side-x-min":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.z,s=t.y,c={x:n.x-t.x/2,y:n.y,z:n.z},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z);break;case"side-y-max":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.x,s=t.z,c={x:n.x,y:n.y+t.y/2,z:n.z},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z);break;case"side-y-min":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.x,s=t.z,c={x:n.x,y:n.y-t.y/2,z:n.z},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z);break;case"side-z-max":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.x,s=t.y,c={x:n.x,y:n.y,z:n.z+t.z/2},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z);break;case"side-z-min":r=o()(a).call(a,(function(t){return t.name===l[e].data_name}))[0],i=t.x,s=t.y,c={x:n.x,y:n.y,z:n.z-t.z/2},l[e].scale.set(i/r.width,s/r.height,1),l[e].position.set(c.x,c.y,c.z)}}(g)}function g(e){var t=window.bimEngine.scene.children;Yh()(t).call(t,(function(t){var n;"rootModel"===t.name&&(t.material instanceof Array?(Yh()(n=t.material).call(n,(function(t){t.clippingPlanes=e||null})),Yh()(n=t.cloneMaterialArray).call(n,(function(t){t.clippingPlanes=e||null}))):(t.material.clippingPlanes=e||null,t.cloneMaterialArray.clippingPlanes=e||null))})),ed(e),td(e)}window.bimEngine.UpdateRender()}function ed(e){var t,n,r=Zh(o()(t=window.bimEngine.scene.children).call(t,(function(e){return"HighLightGroup"==e.name}))[0].children);try{for(r.s();!(n=r.n()).done;){var i,a=n.value;s()(i=a.children).call(i,(function(t){t.material.clippingPlanes=e||null}))}}catch(t){r.e(t)}finally{r.f()}}function td(e){var t,n,r=Zh(o()(t=window.bimEngine.scene.children).call(t,(function(e){return"ModelEdges"==e.TypeName})));try{for(r.s();!(n=r.n()).done;)n.value.material.clippingPlanes=e||null}catch(e){r.e(e)}finally{r.f()}}function nd(e){var t=new Object;return t.SingleSideOpen=function(t){Kh(e,!0,t)},t.SingleSideClose=function(){Kh(e,!1)},t.MultiSideOpen=function(){$h(e,!0)},t.MultiSideClose=function(){$h(e,!1)},t}dt=n(0);var rd=n.n(dt),id=(Ye=n(1),n.n(Ye)),ad=n(2),od=function(){function e(t,n,r){rd()(this,e),this.camera=t,this.domElement=n,this._isEnabled=!1,this._rayOriginOffset=new ad.Vector3(0,-1,0),this._camerLocalDirection=new ad.Vector3,this._tmpVector=new ad.Vector3,this._rayCaster=new ad.Raycaster,this._fallingTime=0,this._euler=new ad.Euler(0,0,0,"YZX"),this._prevMouseX=0,this._prevMouseY=0,this.applyGravity=!0,this.applyCollision=!0,this.positionEasing=!0,this.lookflag=1,this.lookSpeed=.008,this.moveSpeed=.02,this.playerHeight=1.4,this.g=9.8,this.bindmousedown=Ht()(t=this.onMouseDown).call(t,this),this.bindmouseup=Ht()(n=this.onMouseUp).call(n,this),this.bindmousemove=Ht()(t=this.onMouseMove).call(t,this),this.bindonKeyDown=Ht()(n=this.onKeyDown).call(n,this),this.bindonKeyUp=Ht()(t=this.onKeyUp).call(t,this),this.bindMousewheel=Ht()(n=this.onMousewheel).call(n,this),this.moveWheelRun=!0,this.moveWheelStop=!1,this.wheelClock}return id()(e,[{key:"colliders",set:function(e){this._rayCastObjects=e}},{key:"enabled",get:function(){return this._isEnabled},set:function(e){this._isEnabled=e,this._euler.setFromQuaternion(this.camera.quaternion),e?this.addEvents():this.removeEvents()}},{key:"addEvents",value:function(){this.domElement.addEventListener("pointerdown",this.bindmousedown,!1),this.domElement.addEventListener("pointerup",this.bindmouseup,!1),document.body.addEventListener("keydown",this.bindonKeyDown,!1),document.body.addEventListener("keyup",this.bindonKeyUp,!1),document.addEventListener&&document.addEventListener("DOMMouseScroll",this.bindMousewheel,!1),document.body.addEventListener("mousewheel",this.bindMousewheel,!1)}},{key:"removeEvents",value:function(){this.domElement.removeEventListener("pointerdown",this.bindmousedown),this.domElement.removeEventListener("pointerup",this.bindmouseup),document.body.removeEventListener("keydown",this.bindonKeyDown),document.body.removeEventListener("keyup",this.bindonKeyUp),document.addEventListener&&document.removeEventListener("DOMMouseScroll",this.bindMousewheel),document.body.removeEventListener("mousewheel",this.bindMousewheel)}},{key:"onMousewheel",value:function(e){var t,n=this;switch(e.wheelDelta?(0<e.wheelDelta&&(t="up"),e.wheelDelta<0&&(t="down")):e.detail&&(e.detail<0&&(t="up"),0<e.detail)&&(t="down"),t){case"up":this._camerLocalDirection.z=1;break;case"down":this._camerLocalDirection.z=-1}1==this.moveWheelRun?(this.moveWheelRun=!1,this.moveWheelStop=!0,this.wheelClock=a()((function(){1==n.moveWheelStop&&(n.moveWheelStop=!1,n.moveWheelRun=!0,n._camerLocalDirection.z=0)}),200)):(clearTimeout(this.wheelClock),this.wheelClock=a()((function(){1==n.moveWheelStop&&(n.moveWheelStop=!1,n.moveWheelRun=!0,n._camerLocalDirection.z=0)}),150))}},{key:"onMouseDown",value:function(e){this.domElement.addEventListener("pointermove",this.bindmousemove,!1),this._prevMouseX=e.screenX,this._prevMouseY=e.screenY}},{key:"onMouseMove",value:function(e){var t,n;0!=this._isEnabled&&(n=this._prevMouseX?e.screenX-this._prevMouseX:0,t=this._prevMouseY?e.screenY-this._prevMouseY:0,this._euler.y-=n*this.lookSpeed,this._euler.x-=t*this.lookflag*this.lookSpeed,this.camera.quaternion.setFromEuler(this._euler),this._prevMouseX=e.screenX,this._prevMouseY=e.screenY,n=new CustomEvent("bimengine:camerachange",{detail:""}),window.dispatchEvent(n))}},{key:"onMouseUp",value:function(e){this.domElement.removeEventListener("pointermove",this.bindmousemove)}},{key:"onKeyDown",value:function(e){var t=new CustomEvent("bimengine:camerachange",{detail:""});switch(window.dispatchEvent(t),e.keyCode){case 38:this.rotateY(-1);break;case 81:this._camerLocalDirection.y=1;break;case 69:this._camerLocalDirection.y=-1;break;case 87:this._camerLocalDirection.z=1;break;case 37:this.rotateX(-1);break;case 65:this._camerLocalDirection.x=-1;break;case 40:this.rotateY(1);break;case 83:this._camerLocalDirection.z=-1;break;case 39:this.rotateX(1);break;case 68:this._camerLocalDirection.x=1}}},{key:"onKeyUp",value:function(e){switch(e.keyCode){case 38:case 87:this._camerLocalDirection.z=0;break;case 37:case 65:this._camerLocalDirection.x=0;break;case 40:case 83:this._camerLocalDirection.z=0;break;case 39:case 68:this._camerLocalDirection.x=0;break;case 81:case 69:this._camerLocalDirection.y=0}}},{key:"rotateX",value:function(e){this._euler.y-=e*this.lookSpeed,this.camera.quaternion.setFromEuler(this._euler)}},{key:"rotateY",value:function(e){this._euler.x-=e*this.lookflag*.5*this.lookSpeed,this.camera.quaternion.setFromEuler(this._euler)}},{key:"update",value:function(){this.gravityTest(),this.collisionTest()}},{key:"gravityTest",value:function(){if(this.applyGravity){var e=!0,t=(this._fallingTime+=.01,this._tmpVector.set(0,-1,0),this.hitTest());if(t){var n=t.point.add(new ad.Vector3(0,this.playerHeight,0));if(this.positionEasing){if(n.y>=this.camera.position.y||n.y-this.camera.position.y<.2)return this.camera.position.y+=.08*(n.y-this.camera.position.y),this._fallingTime=0,void(e=!1)}else t.distance<this.playerHeight&&(this.camera.position.y=n.y,this._fallingTime=0,e=!1)}e&&(this.camera.position.y-=this.g*Math.pow(this._fallingTime,2))}}},{key:"collisionTest",value:function(){0!==this._camerLocalDirection.x&&this.collisionTestX(),0!==this._camerLocalDirection.z&&this.collisionTestZ(),0!==this._camerLocalDirection.y&&this.collisionTestY()}},{key:"collisionTestX",value:function(){if(this._tmpVector.setFromMatrixColumn(this.camera.matrix,0),this._tmpVector.multiplyScalar(this._camerLocalDirection.x),this.applyCollision){var e=this.hitTest();if(e&&e.distance<.3)return}this.camera.position.addScaledVector(this._tmpVector,this.moveSpeed)}},{key:"collisionTestZ",value:function(){if(this._tmpVector.setFromMatrixColumn(this.camera.matrix,0),this._tmpVector.crossVectors(this.camera.up,this._tmpVector),this._tmpVector.multiplyScalar(this._camerLocalDirection.z),this.applyCollision){var e=this.hitTest();if(e&&e.distance<.3)return}this.camera.position.addScaledVector(this._tmpVector,this.moveSpeed)}},{key:"collisionTestY",value:function(){if(this._tmpVector.setFromMatrixColumn(this.camera.matrix,0),this._tmpVector=new ad.Vector3(0,1,0),this._tmpVector.multiplyScalar(this._camerLocalDirection.y),this.applyCollision){var e=this.hitTest();if(e&&e.distance<.3)return}this.camera.position.addScaledVector(this._tmpVector,this.moveSpeed)}},{key:"hitTest",value:function(){var e=null,t=this.camera.position.clone().add(this._rayOriginOffset);return(t=(this._rayCaster.ray.origin=t,this._rayCaster.ray.direction=this._tmpVector,this._rayCaster.intersectObjects(window.bimEngine.GetAllVisibilityModel(),!0)))&&0<t.length?t[0]:e}}]),e}();function sd(e){n(577)("./"+F()+"/FirstPersonRoaming.scss"),n(232)("./"+F()+"/FormStyle.scss");var t,r,i,a,s,l=new Object,c=e.scene.renderer.domElement.parentElement,u=1;function h(){return document.getElementById("MobileRoamContainer")}function d(){"Mobile"===e.DeviceType?(i.style.display="block",a.style.display="none",s.style.display="none"):(i.style.display="none",a.style.display="block",s.style.display="block")}function p(){e.scene.camera.aspect=window.innerWidth/window.innerHeight,e.scene.camera.updateProjectionMatrix(),e.scene.renderer.setSize(window.innerWidth,window.innerHeight)}function f(){e.scene.renderer.render(e.scene,e.scene.camera),t=requestAnimationFrame(f),l.controls&&l.controls.enabled&&l.controls.update(),e.MinMap&&e.MinMap.visible&&e.MinMap.renderUpdata()}return l.isActive=!1,l.Active=function(){var t,n,m,v,g,y,x,w,b,_,M,E,S;e.scene.controls&&(e.scene.controls.enabled=!1),l.controls||(l.controls=new od(e.scene.camera,e.scene.renderer.domElement,e.GetAllVisibilityModel()),S=!0,y=!(l.controls.name="FirstPersonControls"),b=!(w=!1),_=.02,l.controls.enabled=S,l.controls.applyGravity=y,l.controls.applyCollision=w,l.controls.positionEasing=b,l.controls.moveSpeed=_),l.controls.enabled=!0,l.isActive=!0,e.MinMap.show(),"Mobile"===B()&&((S=h())?S.style.display="block":((S=document.createElement("div")).id="MobileRoamContainer",c.appendChild(S),(y=document.createElement("div")).className="containCircle",S.appendChild(y),(S=document.createElement("div")).className="controllerPanel",(x=document.createElement("div")).className="ball",S.appendChild(x),t=29,S.style.width="100px",S.style.height="100px",S.style.borderWidth="2px",x.style.width="40px",x.style.height="40px",x.style.left="29px",x.style.top=t+"px",x.addEventListener("touchstart",(function(e){var n=e.targetTouches[0].clientX-x.offsetLeft-20,r=e.targetTouches[0].clientY-x.offsetTop-20;x.addEventListener("touchmove",(function(e){var i=(i=e.targetTouches[0].clientX-20-n)-29,a=(e=(e=e.targetTouches[0].clientY-20-r)-t,Math.atan2(e,i));i=Math.sqrt(i*i+e*e),i=(e=(e=a,{x:i=(a=49<=i?49:i)*Math.cos(e)+29,y:a=a*Math.sin(e)+t})).x,a=e.y;x.style.left=i+"px",x.style.top=a+"px",l.controls._camerLocalDirection.x=(i-29)/49*1,l.controls._camerLocalDirection.z=(a-t)/49*1})),x.addEventListener("touchend",(function(e){l.controls._camerLocalDirection.x=0,l.controls._camerLocalDirection.z=0,x.style.left="29px",x.style.top=t+"px"}))})),y.appendChild(S),w=Y("icon-roam-up"),S.appendChild(w),w.className.baseVal=w.className.baseVal+" icon-roam-up",b=Y("icon-roam-down"),S.appendChild(b),b.className.baseVal=b.className.baseVal+" icon-roam-down",b=Y("icon-roam-left"),S.appendChild(b),b.className.baseVal=b.className.baseVal+" icon-roam-left",b=Y("icon-roam-right"),S.appendChild(b),b.className.baseVal=b.className.baseVal+" icon-roam-right",(S=document.createElement("div")).className="SelectPanel",(b=document.createElement("div")).className="InsideContain",(_=document.createElement("div")).className="ControlContain",(M=Y("icon-roam-up")).addEventListener("touchstart",(function(e){l.controls._camerLocalDirection.y=1,console.log(l.controls._camerLocalDirection),M.addEventListener("touchend",(function(e){l.controls._camerLocalDirection.y=0}))})),_.appendChild(M),M.className.baseVal=w.className.baseVal+" to_top",(E=Y("icon-roam-down")).addEventListener("touchstart",(function(e){l.controls._camerLocalDirection.y=-1,console.log(l.controls._camerLocalDirection),E.addEventListener("touchend",(function(e){l.controls._camerLocalDirection.y=0}))})),_.appendChild(E),E.className.baseVal=w.className.baseVal+" to_down",b.appendChild(_),S.appendChild(b),y.appendChild(S))),r?r.style.display="block":(r=document.createElement("div"),"Mobile"===e.DeviceType?r.className="Roam_Dialog-Mobile":r.className="Roam_Dialog",(n=document.createElement("div")).className="Header_Contain",r.appendChild(n),(g=document.createElement("div")).className="Header_Title",g.innerText="",n.appendChild(g),(g=document.createElement("div")).className="Header_Btns",n.appendChild(g),(a=document.createElement("div")).className="Header_Min Btn",a.onclick=function(){i.style.display="block",a.style.display="none",s.style.display="none"},(n=document.createElement("div")).className="Header_Min_Inside",a.appendChild(n),g.appendChild(a),(i=document.createElement("div")).className="Header_Max Btn",i.onclick=function(){i.style.display="none",a.style.display="block",s.style.display="block"},g.appendChild(i),(n=document.createElement("div")).className="Header_Close Btn",n.innerText="",n.onclick=function(){var t;o()(t=e.TopMenu.MenuList).call(t,(function(e){return""===e.label}))[0].domEl.click()},g.appendChild(n),(s=document.createElement("div")).className="Header_Main Btn",r.appendChild(s),(g=document.createElement("div")).className="Form_Contain",s.appendChild(g),(n=document.createElement("div")).className="Form_Item",g.appendChild(n),(v=document.createElement("div")).className="Form_Item_Label",v.innerText="",n.appendChild(v),(v=document.createElement("input")).className="switch",v.type="checkbox",v.checked=!0,v.onchange=function(t){t.target.checked?e.MinMap.show():e.MinMap.close()},n.appendChild(v),(n=document.createElement("div")).className="Form_Item",g.appendChild(n),(v=document.createElement("div")).className="Form_Item_Label",v.innerText="",n.appendChild(v),(v=document.createElement("input")).className="switch",v.type="checkbox",v.checked=!1,v.onchange=function(t){e.FirstPersonControls.controls.applyGravity=t.target.checked},n.appendChild(v),(n=document.createElement("div")).className="Form_Item",g.appendChild(n),(v=document.createElement("div")).className="Form_Item_Label",v.innerText="",n.appendChild(v),(v=document.createElement("input")).className="switch",v.type="checkbox",v.checked=!1,v.onchange=function(t){e.FirstPersonControls.controls.applyCollision=t.target.checked},n.appendChild(v),(n=document.createElement("div")).className="Form_Item",g.appendChild(n),(v=document.createElement("div")).className="Form_Item_Label",v.innerText="",n.appendChild(v),(g=document.createElement("div")).className="Btn_Contain",v=Y("icon-jianhao"),g.appendChild(v),g.onclick=function(t){1<u&&(u/=2,m.innerText=u+"X",e.FirstPersonControls.controls.moveSpeed=.02*u)},n.appendChild(g),(m=document.createElement("div")).className="Speed_Text",m.innerText=u+"X",n.appendChild(m),(v=document.createElement("div")).className="Btn_Contain",g=Y("icon-jiahao"),v.appendChild(g),v.onclick=function(t){u<16&&(u*=2,m.innerText=u+"X",e.FirstPersonControls.controls.moveSpeed=.02*u)},n.appendChild(v),c.appendChild(r),d()),window.addEventListener("resize",p,!1),f()},l.DisActive=function(){e.scene.controls&&(e.scene.controls.enabled=!0),window.removeEventListener("resize",p),cancelAnimationFrame(t),l.isActive=!1,"Mobile"===B()&&(h().style.display="none"),r.style.display="none",d(),e.MinMap.close(),l.controls.enabled=!1,l.controls._isEnabled=!1},l}var ld=n(2);function cd(){var e=new Object;return e.curveCamera=null,e.curveTarget=null,e.isPaused=!1,e.isCancle=!1,e.SetPointRoam=function(t){for(var n=[],r=[],i=0;i<t.length;i++)n.push(new ld.Vector3(t[i].target.x,t[i].target.y,t[i].target.z)),r.push(new ld.Vector3(t[i].position.x,t[i].position.y,t[i].position.z));e.curveTarget=new ld.CatmullRomCurve3(n),e.curveCamera=new ld.CatmullRomCurve3(r)},e.RunAnimation=function(t){var n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5,i=(e.isCancle=!1,0);!function a(){var o,s;n=window.requestAnimationFrame(a),e.isCancle?(window.cancelAnimationFrame(n),n=null):e.isPaused||(e.curveCamera&&e.curveTarget&&i<=1?(o=e.curveCamera.getPointAt(i),s=e.curveTarget.getPointAt(i),s=new ld.Vector3(s.x,s.y,s.z),s=e.curveTarget.getTangentAt(i).add(s),t.position.set(o.x,o.y,o.z),t.lookAt(s),i+=1/(60*r)):(window.cancelAnimationFrame(n),n=null))}()},e.StartAnimation=function(t,n,r){e.CancleAnimation(),e.SetPointRoam(t),e.RunAnimation(n,r)},e.PausedAnimation=function(){e.isPaused=!0},e.ContinueAnimation=function(){e.isPaused=!1},e.CancleAnimation=function(){e.curveCamera=null,e.curveTarget=null,e.isPaused=!1,e.isCancle=!0},e}function ud(e){n(578)("./"+F()+"/TopMenu.scss");var t,r,i=new Object,a=(i.ShowMenu=!0,e.scene.renderer.domElement.parentElement),s=[],l=null,c=null,u=null,h=[{pId:"0",value:"8",label:"",icon:"icon-View-All",status:!1,showType:"Mobile",children:[{pId:"8",value:"81",label:"",icon:"icon-View-Top",status:!1,dir:"top"},{pId:"8",value:"82",label:"",icon:"icon-View-Bottom",status:!1,dir:"down"},{pId:"8",value:"83",label:"",icon:"icon-View-East",status:!1,dir:"right"},{pId:"8",value:"84",label:"",icon:"icon-View-South",status:!1,dir:"front"},{pId:"8",value:"85",label:"",icon:"icon-View-West",status:!1,dir:"left"},{pId:"8",value:"86",label:"",icon:"icon-View-North",status:!1,dir:"back"}]},{pId:"0",value:"1",label:"",icon:"icon-roam",status:!1,showType:"PC Mobile"},{pId:"0",value:"2",label:"",icon:"icon-kuangxuan",status:!1,showType:"PC"},{pId:"0",value:"3",label:"",icon:"icon-pouqie",status:!1,showType:"PC Mobile",children:[{pId:"3",value:"31",label:"",icon:"icon-codepen",status:!1},{pId:"3",value:"32",label:"X",icon:"icon-xalxe",status:!1},{pId:"3",value:"33",label:"Y",icon:"icon-zaxle",status:!1},{pId:"3",value:"34",label:"Z",icon:"icon-yaxle",status:!1}]},{pId:"0",value:"6",label:"",icon:"icon-celianggongju",status:!1,showType:"PC Mobile",children:[{pId:"6",value:"61",label:"",icon:"icon-celiang",status:!1},{pId:"6",value:"62",label:"",icon:"icon-arrowsv",status:!1},{pId:"6",value:"63",label:"",icon:"icon-arrowsh",status:!1},{pId:"6",value:"64",label:"",icon:"icon-dingwei",status:!1},{pId:"6",value:"65",label:"",icon:"icon-biaogao",status:!1}]},{pId:"0",value:"4",label:"",icon:"icon-setting",status:!1,showType:"PC Mobile"},{pId:"0",value:"5",label:"",icon:"icon-lock-screen",status:!1,showType:"Mobile"}],d=B();function p(e,t){var n;"0"===e.pId?(e.children?O()(s).call(s,e.value)?(n=M()(n=e.children).call(n,(function(e){return e.value===l})),c=n<0?(u=l,s=[],l=null):(u=l,e.value)):(u=l,s=[e.value],c=e.value,m()):(c=l===e.value?(u=l,s=[],l=null):(u=l,l=e.value,s=[e.value],null),m()),e.domEl.className=O()(s).call(s,e.value)?"Item Actived":"Item"):(c=l===e.value?(u=l,s=[],l=null):(u=l,l=e.value,s=[e.pId,e.value],null),m(),e.domEl.className=l===e.value?"Item Actived":"Item",t.domEl.className=l===e.value?"Item Actived":"Item");for(var r=0;r<i.MenuList.length;r++)i.MenuList[r].children&&i.MenuList[r].children.length&&(i.MenuList[r].domEl.childEls.style.display="none");e&&e.children&&c===e.value?e.domEl.childEls.style.display="block":e.domEl.childEls&&(e.domEl.childEls.style.display="none"),f()}function f(){if(u!==l){switch(u){case"1":e.FirstPersonControls&&e.FirstPersonControls.DisActive();break;case"2":e.SelectionBox&&e.SelectionBox.DisActive();break;case"31":e.Clipping&&e.Clipping.MultiSideClose();break;case"32":case"33":case"34":e.Clipping&&e.Clipping.SingleSideClose();break;case"4":e.Render&&e.Render.DisActive();break;case"5":e.scene.controls.enabled=!e.scene.controls.enabled;break;case"61":e.Measures&&e.Measures.SimpleMeasure.DisActive();break;case"62":e.Measures&&e.Measures.HeightMeasure.DisActive();break;case"63":e.Measures&&e.Measures.DistanceMeasure.DisActive();break;case"64":e.Measures&&e.Measures.PointMeasure.DisActive();break;case"65":e.Measures&&e.Measures.ElevationHeightMeasure.DisActive()}switch(l){case"81":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("top");break;case"82":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("down");break;case"83":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("right");break;case"84":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("front");break;case"85":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("left");break;case"86":e.ViewCube&&e.ViewCube.cameraGoToSpecialView("back");break;case"1":e.FirstPersonControls&&e.FirstPersonControls.Active();break;case"2":e.SelectionBox&&e.SelectionBox.Active();break;case"31":e.Clipping&&e.Clipping.MultiSideOpen();break;case"32":e.Clipping&&e.Clipping.SingleSideOpen("X");break;case"33":e.Clipping&&e.Clipping.SingleSideOpen("Y");break;case"34":e.Clipping&&e.Clipping.SingleSideOpen("Z");break;case"4":e.Render&&e.Render.Active();break;case"5":e.scene.controls.enabled=!e.scene.controls.enabled;break;case"61":e.Measures&&e.Measures.SimpleMeasure.Active();break;case"62":e.Measures&&e.Measures.HeightMeasure.Active();break;case"63":e.Measures&&e.Measures.DistanceMeasure.Active();break;case"64":e.Measures&&e.Measures.PointMeasure.Active();break;case"65":e.Measures&&e.Measures.ElevationHeightMeasure.Active()}}"Mobile"===B()&&(t.className=l&&"81"!==l&&"82"!==l&&"83"!==l&&"84"!==l&&"85"!==l&&"86"!==l?"Top-Menu-Container-Mask Hide-Menu-Contain":"Top-Menu-Container-Mask Show-Menu-Contain")}function m(){for(var e=0;e<i.MenuList.length;e++)if(i.MenuList[e].domEl.className="Item",i.MenuList[e].children&&i.MenuList[e].children.length)for(var t=0;t<i.MenuList[e].children.length;t++)i.MenuList[e].children[t].domEl.className="Item"}i.MenuList=o()(h).call(h,(function(e){return O()(e=e.showType).call(e,d)})),i.ShowMenu=function(){r.style.display="block"},i.HideMenu=function(){r.style.display="none"},i.ClickItem=function(e){var t;o()(t=i.MenuList).call(t,(function(t){return t.label===e}))[0].domEl.click()},(t=document.createElement("div")).className="Top-Menu-Container-Mask Show-Menu-Contain";for(var v=((h=document.createElement("div")).className="Close-Menu-Btn",Y("icon-close-btn")),g=(h.appendChild(v),t.appendChild(h),h.onclick=function(e){u=l,s=[],c=l=null,m(),f()},(r=document.createElement("div")).className="Top-Menu-Container",document.createElement("div")),y=(g.className="Menu-List",function(t){var n=document.createElement("div"),r=(n.className="Item",document.createElement("div")),a=(r.className="Icon-Contain",n.appendChild(r),Y(i.MenuList[t].icon));if(r.appendChild(a),(i.MenuList[t].domEl=n).onclick=function(n){""===i.MenuList[t].label&&!e.FirstPersonControls.isActive&&""===sessionStorage.getItem("RootMenuSelect")||p(i.MenuList[t],null)},g.appendChild(n),i.MenuList[t].children)for(var o=document.createElement("div"),s=(o.className="Child-List",o.style.display="none",n.childShow=!1,n.appendChild(o),n.childEls=o,0);s<i.MenuList[t].children.length;s++)!function(e){var n=document.createElement("div"),r=(n.className="Item",o.appendChild(n),document.createElement("div")),a=(r.className="Icon-Contain",n.appendChild(r),Y(i.MenuList[t].children[e].icon));r.appendChild(a),(i.MenuList[t].children[e].domEl=n).onclick=function(n){n.stopPropagation(),p(i.MenuList[t].children[e],i.MenuList[t])}}(s)}),x=0;x<i.MenuList.length;x++)y(x);return r.appendChild(g),t.appendChild(r),a.appendChild(t),i}var hd=n(2);function dd(e){n(579)("./"+F()+"/CaptureMark.scss");var t,r,i,a,l=new Object,c=e.scene.renderer.domElement.parentElement,u="CaptureMarkContain",h="CaptureMarkEdgeLine",d=(l.MouseEvent=null,l.Position=null,l.isActive=!1,null),f={type:"area",val:null,isCenter:!1};function m(e){l.MouseEvent={x:e.clientX,y:e.clientY,event:e}}function v(e,t,n,r){for(var i={type:"area",val:Eh().GetProjectPoints(t.point,r.clone(),1),isCenter:!1,faceNormal:r.clone()},a=[],o=0;o<n.length;o+=6){var s=new hd.Vector3(n[o],n[o+1],n[o+2]),l=new hd.Vector3(n[o+3],n[o+4],n[o+5]);s=Eh().PointDistanceLine(t.point,s,l);a.push({start:{x:n[o],y:n[o+1],z:n[o+2]},end:{x:n[o+3],y:n[o+4],z:n[o+5]},distance:s})}var c,u,h,d,p=S()(a).call(a,(function(e,t){return e.distance-t.distance}))[0];e=Eh().PointPointDis(t.point,e.camera.position);return p&&p.distance<=.025*e&&(i={type:"line",val:Eh().PointProjectLine(t.point,new hd.Vector3(p.start.x,p.start.y,p.start.z),new hd.Vector3(p.end.x,p.end.y,p.end.z)),isCenter:!1,line:[p.start.x,p.start.y,p.start.z,p.end.x,p.end.y,p.end.z],faceNormal:r.clone()},(c=new hd.Line3).start=new hd.Vector3(p.start.x,p.start.y,p.start.z),c.end=new hd.Vector3(p.end.x,p.end.y,p.end.z),c=c.getCenter(),u=Eh().PointPointDis(t.point,c),h=Eh().PointPointDis(t.point,p.start),d=Eh().PointPointDis(t.point,p.end),h<=.015*e||d<=.015*e||u<=.01*e)&&(e=h,i={type:"point",val:p.start,isCenter:!1,faceNormal:r.clone()},u<e&&(e=u,i={type:"point",val:c,isCenter:!0,faceNormal:r.clone()}),d<e)&&(e=d,i={type:"point",val:p.end,isCenter:!1,faceNormal:r.clone()}),i}function g(){t.style.display="none",r.style.display="none",i.style.display="none",a.style.display="none";for(var n=e.scene,o=n.children.length-1;0<=o;o--)n.children[o].Name===h&&n.remove(n.children[o]);f={type:"area",val:null,isCenter:!1}}return l.Active=function(){var n,y,x,w,b,_;l.isActive||(n=function n(){if(d=requestAnimationFrame(n),l.MouseEvent){var a=l.MouseEvent;if(l.Position=null,g(),a.event.target instanceof HTMLCanvasElement){var u,m,y,x,w=new hd.Raycaster(new hd.Vector3,new hd.Vector3,0,30),b=new hd.Vector2,_=(b.x=(a.x-e.scene.camera.viewport.x)/e.scene.camera.viewport.z*2-1,b.y=-(a.y-e.scene.camera.viewport.y)/e.scene.camera.viewport.w*2+1,w.setFromCamera(b,e.scene.camera),w.intersectObjects(l.models,!0));switch(_.length&&("HighlightMesh"==(a=_[0]).object.TypeName?null==(b=(m=e.scene.children[a.object.Indexs[0]]).ElementInfos[a.object.Indexs[1]])||null!=m.hideElements&&O()(w=m.hideElements).call(w,b.dbid)||(w=b.EdgeList,f=v(e.scene,a,w,a.face.normal.clone())):"Mesh"==a.object.TypeName||"PipeMesh"==a.object.TypeName?null==(m=function(e,t){return null==e||0==e.length?null:0!=(e=o()(e).call(e,(function(e){return n=e.min,e=e.max,(r=t).x>=n.x-.001&&r.y>=n.y-.001&&r.z>=n.z-.001&&r.x<=e.x+.001&&r.y<=e.y+.001&&r.z<=e.z+.001;var n,r}))).length?(S()(e).call(e,(function(e,n){return e.center.distanceTo(t)-n.center.distanceTo(t)})),e[0]):null}(a.object.ElementInfos,a.point))||null!=a.object.hideElements&&O()(b=a.object.hideElements).call(b,m.dbid)||(w=a.object.ElementInfos[m.dbid].EdgeList,f=v(e.scene,a,w,a.face.normal.clone())):"InstancedMesh"!=_[0].object.TypeName&&"InstancedMesh-Pipe"!=_[0].object.TypeName||(b=a.object.ElementInfos[a.instanceId].EdgeList,w=p()(m=a.object.instanceMatrix.array).call(m,16*a.instanceId,16*(a.instanceId+1)),(m=new hd.Matrix4).elements=w,w=new hd.Vector3,u=new hd.Quaternion,y=new hd.Vector3,m.decompose(w,u,y),m=(new hd.Matrix4).makeRotationFromQuaternion(u),w=a.face.normal.clone().applyMatrix4(m.clone()).normalize(),f=v(e.scene,a,b,w)),y={worldPoint:_[0].point.clone(),screenPoint:q(_[0].point.clone(),e.scene.camera),capture:f},l.Position=y),f.type){case"area":_.length&&f.val&&(x=s()(x=f.val).call(x,(function(t){return(t=q(new hd.Vector3(t.x,t.y,t.z),e.scene.camera)).x+","+t.y})),i.style.display="block",i.firstChild.setAttribute("points",x.join(" ")));break;case"line":!function(e,t){var n;(n=new Ph).setPositions(t),t=new Ch({color:"#00ff00",linewidth:1,vertexColors:!1});(n=(t.resolution.set(c.clientWidth,c.clientHeight),new hd.LineSegments(n,t))).Name=h,e.add(n)}(e.scene,f.line);break;case"point":f.isCenter?(x=q(new hd.Vector3(f.val.x,f.val.y,f.val.z),e.scene.camera),r.style.display="block",r.style.top=x.y-5+"px",r.style.left=x.x-5+"px"):(x=q(new hd.Vector3(f.val.x,f.val.y,f.val.z),e.scene.camera),t.style.top=x.y+"px",t.style.left=x.x+"px",t.style.width="10px",t.style.height="10px",t.style.transform="translate(-50%,-50%)",t.style.display="block")}}}},l.models=e.GetAllVisibilityModel(),e.EngineRay&&(e.EngineRay.Active(),l.models=o()(y=l.models).call(y,(function(e){return"InstancedMesh"==e.TypeName||"InstancedMesh-Pipe"==e.TypeName})),l.models.push(e.scene.children[5])),y=function(e){var t=document.getElementById(e);return null==t&&((t=document.createElement("div")).id=e,c.appendChild(t)),t}(y=u),x="http://www.w3.org/2000/svg",(w=document.createElementNS(x,"svg")).setAttribute("style","position:absolute;width:20px;height:20px;display:none;pointer-events:none;"),(b=document.createElementNS(x,"polygon")).setAttribute("points","5,0 10,10 0,10"),b.setAttribute("style","fill:rgba(0,255,0,0.2);stroke:rgba(0,255,0,1);stroke-width:2;pointer-events:none;"),w.appendChild(b),y.appendChild(w),(b=document.createElement("div")).className="CapturePointMark",y.appendChild(b),(_=document.createElementNS(x,"svg")).setAttribute("style","position:absolute;width:100vw;height:100vh;display:none;pointer-events: none;"),(x=document.createElementNS(x,"polygon")).setAttribute("points","0,0 10,0 10,10 0,10"),x.setAttribute("style","fill:rgba(0,255,0,0.2);stroke:rgba(0,255,0,1);stroke-width:2;pointer-events:none;"),_.appendChild(x),y.appendChild(_),(x=document.createElement("div")).className="CaptureChuiDianPointMark",y.appendChild(x),r=(w={Triangle:w,Quadrangle:b,Area:_,ChuiDian:x}).Triangle,t=w.Quadrangle,i=w.Area,a=w.ChuiDian,c.className="custom-cursor",c.addEventListener("pointermove",m),n(),l.isActive=!0)},l.DisActive=function(){var t;l.isActive&&(e.EngineRay&&e.EngineRay.DisActive(),(t=document.getElementById(u))&&t.remove(),c.className="default-cursor",c.removeEventListener("pointermove",m),cancelAnimationFrame(d),l.isActive=!1)},l}function pd(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?fd(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fd(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function md(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?vd(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vd(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(240);var gd=n(2);function yd(e,t){var n,r,i,a,o=void 0!==A.a&&L()(e)||e["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return n=e.done,e},e:function(e){r=!0,i=e},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw i}}};if(C()(e)||(o=function(e,t){var n;if(e)return"string"==typeof e?xd(e,t):"Map"===(n="Object"===(n=p()(n=Object.prototype.toString.call(e)).call(n,8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?T()(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xd(e,t):void 0}(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wd=n(2);function bd(e,t){var n,r=new Object,i=(r.isActive=!1,window.bimEngine.scene),a=window.bimEngine.scene.camera,o=window.bimEngine.scene.renderer,s=new wd.MeshBasicMaterial({vertexColors:!0});function l(e,t){for(var n=e.attributes.position,r=[],i=0;i<n.count;i++)r.push(t.r,t.g,t.b);e.setAttribute("color",new wd.Float32BufferAttribute(r,3))}new wd.MeshPhongMaterial({color:16777215,flatShading:!0,vertexColors:!0,shininess:0}),o.domElement.addEventListener("pointermove",(function(e){c.x=e.clientX,c.y=e.clientY}));for(var c=new wd.Vector3,u=[],h=[],d=[],p=[],f=new wd.Color,m=new wd.Scene,v=new wd.WebGLRenderTarget(1,1),g=window.bimEngine.scene.children,y=0,x=0;x<g.length;x++){var w=g[x];if("InstancedMesh"!=w.TypeName&&w.TypeName,"Mesh"==w.TypeName)for(var b=0;b<w.ElementInfos.length;b++){A=T=S=E=void 0;var _=x,M=b,E=g[_],S=E.meshs[M],T=E.meshs[M].geometry.clone(),A=f.setHex(16777215*Math.random());l(T,A),l(T=T.clone(),f.setHex(y++)),null==T.index?((A=(A=new wd.Matrix4).makeRotationFromEuler(S.rotation)).elements[12]=S.position.x,A.elements[13]=S.position.y,A.elements[14]=S.position.z,d.push(T.applyMatrix4(A.clone()))):p.push(T.applyMatrix4(S.matrix.clone())),u.push({i:_,j:M,geometry:T,name:E.ElementInfos[M].name})}}return 0<h.length&&m.add(new wd.Mesh(wd.BufferGeometryUtils.mergeBufferGeometries(h),s)),0<d.length&&m.add(new wd.Mesh(wd.BufferGeometryUtils.mergeBufferGeometries(d),s)),0<p.length&&m.add(new wd.Mesh(wd.BufferGeometryUtils.mergeBufferGeometries(p),s)),r.Active=function(){!function e(){var t,r;n=requestAnimationFrame(e),a.setViewOffset(o.domElement.width,o.domElement.height,c.x*window.devicePixelRatio|0,c.y*window.devicePixelRatio|0,1,1),o.setRenderTarget(v),o.render(m,a),a.clearViewOffset(),r=new Uint8Array(4),o.readRenderTargetPixels(v,0,0,1,1,r),0!=(r=r[0]<<16|r[1]<<8|r[2])&&(r=u[r])&&((t=new wd.Mesh(r.geometry,new wd.MeshBasicMaterial({color:16776960,transparent:!0,opacity:0}))).TypeName="HighlightMesh",t.Indexs=[r.i,r.j],i.children[5].children[0]=t),o.setRenderTarget(null)}(),r.isActive=!0},r.DisActive=function(){cancelAnimationFrame(n),r.isActive=!1},r}var _d=n(2);console.log(":import '(webpack.config.jsoutput.library)',{''} from '';\n\n<srcipt src=''><\/script>\n\n:import happycookie,{hc} from 'happycookie'"),t.default=function(e,t,n){var r=new Object;return r.RenderSAO=new Du(r),r.DisPlayModel=new Gu,r.ModelSelection=new ph,r.MinMap=new _h(r),r.D3Measure=new Xh(r),r.PointRoam=new cd,r.scene=null,r.GLTFLoader=n,r.StopClick=!1,r.RightClickActive=!0,r.ModelPaths=[],r.doneModels=[],r.move=!0,r.SelectedModels={indexesModels:[],loadedModels:[],requiredModels:[]},r.LoadedStatus={glbModelsLoadedNum:0,pipeModelsLoadedNum:0,structureModelsLoadedNum:0},r.handleLoadDoneFunOnce=!1,r.FPS=1,r.DeviceType=B(),r.SetBuild=!1,window.THREE=_d,sessionStorage.removeItem("SelectedSingleModelInfo"),sessionStorage.setItem("ShowAllModel","true"),r.init=function(){var t,n,i,s=document.getElementById(e),l=("PC"===r.DeviceType?s.parentElement.className=s.parentElement.className+" PCView-page-container":"Mobile"===r.DeviceType&&(s.parentElement.className=s.parentElement.className+" MobileView-page-container"),r.scene=x(),window.bimEngine=r,s=r.scene,c=new y.AxesHelper(5),s.add(c),r.scene),c=((s=l).perCamera||((c=new y.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.01,3e4)).position.set(1e3,500,1e3),c.lookAt(s.position),s.perCamera=c),s.perCamera),u=(c.name="",l.camera=c,s=e,i=document.getElementById(s).clientWidth,s=document.getElementById(s).clientHeight,(h=new y.WebGLRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:!0})).setSize(i,s),h.setClearAlpha(0),h.shadowMap.enabled=!0,h.localClippingEnabled=!0,h),h=(r.scene.renderer=u,w(e,u),function(e){(t=new y.PointLight(16777215,.3)).position.set(0,200,0),e.add(t),(t=new y.PointLight(16777215,.3)).position.set(0,-200,0),e.add(t);var t=new y.AmbientLight(16777215,.8);e.add(t),e.ambientLight=t}(l),t=l,(new g).setPath("static/img/").load("quarry_01_1k.hdr",(function(e){e.mapping=y.EquirectangularReflectionMapping,t.environment=e})),i=e,s=c,h=u,n=document.getElementById(i).clientWidth,i=document.getElementById(i).clientHeight,s=new le.OrbitControls(s,h.domElement),new le.AnaglyphEffect(h).setSize(n,i),s),d=(l.controls=h,r.controls=h,new qu),p=(d.domElement.style.position="absolute",d.domElement.style.left="0px",d.domElement.style.top="0px",document.getElementById(e).appendChild(d.domElement),r.ViewCube=new Fu(l,e),r.ViewCube.init(),r.Render=new Qt(r),r.MultiView=new gh(r,c),window.addEventListener("resize",(function(){var e=window.bimEngine.scene.renderer.domElement.parentElement.clientWidth,t=window.bimEngine.scene.renderer.domElement.parentElement.clientHeight,n=(window.bimEngine.scene.renderer.domElement.width=e,window.bimEngine.scene.renderer.domElement.height=t,window.bimEngine.scene.renderer.setSize(e,t),e/t);(n=(window.bimEngine.scene.camera.aspect=n,window.bimEngine.scene.camera.viewport=new le.Vector4(0,0,Math.ceil(e),Math.ceil(t)),window.bimEngine.scene.camera.updateProjectionMatrix(),document.getElementsByClassName("ViewControlPanel")))&&(n[0].style.width=e+"px",n[0].style.height=t+"px"),window.bimEngine.RenderUpdata()})),r.SetBuild?r.TopMenu=new ud(r):r.TopMenu="PC"===r.DeviceType?new ud(r):null,new CustomEvent("bimengine:camerachange",{detail:""})),f=(h.addEventListener("change",(function(){r.move=!0,window.dispatchEvent(p)})),r.UpdateRender=function(){r.move=!0},new _d.Clock),m=0;!function e(){requestAnimationFrame(e),d.update();var t=f.getDelta();(m+=t)>1/r.FPS&&1==r.move&&(u.setViewport(0,0,window.bimEngine.scene.renderer.domElement.parentElement.innerWidth,window.bimEngine.scene.renderer.domElement.parentElement.innerHeight),r.MultiView.updaterender(),r.ViewCube.renderScene(),r.MinMap.renderUpdata(),r.move=!1,null!=r.CurrentSelect?null!=(t=r.scene.children[r.CurrentSelect.indexs[0]])&&null!=t.ElementInfos&&null!=(t=t.ElementInfos[r.CurrentSelect.indexs[1]])&&(t=t.center.clone().distanceTo(r.scene.camera.position),r.controls.zoomSpeed=.1*t,r.controls.panSpeed=.03*t,r.controls.zoomSpeed<.1&&(r.controls.zoomSpeed=.1),5<r.controls.zoomSpeed&&(r.controls.zoomSpeed=5),1<r.controls.panSpeed)&&(r.controls.panSpeed=1):(r.controls.zoomSpeed=1,r.controls.panSpeed=1),m=0,a()((function(){u.render(l,l.camera)}),200)),r.RenderSAO.render()}(),r.CaptureMark=new dd(r),r.Measures={},r.Measures.SimpleMeasure=new Ju(r),r.Measures.DistanceMeasure=new eh(r),r.Measures.PointMeasure=new ih(r),r.Measures.HeightMeasure=new lh(r),r.Measures.ElevationHeightMeasure=new dh(r),r.Clipping=new nd(l),r.SelectionBox=new Xt(r),r.FirstPersonControls=new sd(r),n=l,i=c,(i=new le.TransformControls(i,u.domElement)).name="TransformControlsClipping",i.visible=!1,n.add(i),yt(r),s=l,(h=o()(h=s.children).call(h,(function(e){return"HighLightGroup"==e.name}))[0])||((h=new bt.Group).name="HighLightGroup",s.add(h)),r.RightClickActive&&ce(r,(function(e){null!=e&&(e=new CustomEvent("bimengine:click",{detail:e}),window.dispatchEvent(e))}))},r.RenderUpdata=function(){r.MultiView.updaterender()},r.start=function(e,t,n,i,a){var l,u=e+"/"+t,h=r.scene;"glb"==n?((e=new _d.Group).data_glb=u,h.add(e),_t(e,u,i.position,(function(e){a()}))):"glbjson"==n&&(r.ModelPaths.push(t),r.D3Measure.UpdateViewList(u),l=u,window.bimEngine.MaterialMapList=window.bimEngine.MaterialMapList||[],window.bimEngine.MaterialList=window.bimEngine.MaterialList||[],new me.a((function(e,t){lt(l+"/materialMapList.json",(function(t){t&&window.bimEngine.MaterialMapList.push(JSON.parse(t)),t?lt(l+"/materialList.json",(function(t){var n;t&&(t=JSON.parse(t)?s()(t=JSON.parse(t)).call(t,(function(e){return e.Param=JSON.parse(e.Param),e.Param&&(e.Param.envMap&&e.Param.envMap.url&&(e.Param.envMap.url="/materialFile"+e.Param.envMap.url.split("/api/file")[1]),s()(e.Param)&&s()(e.Param).url&&(s()(e.Param).url="/materialFile"+s()(e.Param).url.split("/api/file")[1]),e.Param.normalMap&&e.Param.normalMap.url&&(e.Param.normalMap.url="/materialFile"+e.Param.normalMap.url.split("/api/file")[1]),e.Param.roughnessMap&&e.Param.roughnessMap.url&&(e.Param.roughnessMap.url="/materialFile"+e.Param.roughnessMap.url.split("/api/file")[1]),e.Param.alphaMap)&&e.Param.alphaMap.url&&(e.Param.alphaMap.url="/materialFile"+e.Param.alphaMap.url.split("/api/file")[1]),e})):[],window.bimEngine.MaterialList=c()(n=[]).call(n,b()(window.bimEngine.MaterialList),b()(t))),e("")})):e("")}))})).then((function(e){!function(e,t,n,r){var i=2<arguments.length&&void 0!==n?n:"/file/gis/fl/bim/100004",a=3<arguments.length?r:void 0,o=0;function s(){2==o&&(window.bimEngine.doneModels.push(i),window.bimEngine.loadedDone("glbModelsLoadedNum"))}ct(i+"/modelList.zip",(function(n){var r,l=JSON.parse(n);l&&l.length?(r=0,function(){var n=de()(pe.a.mark((function n(){var c,u;return pe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c=function(n){return new me.a((function(c,u){a.Point=n.Point,a.Rotate=n.angle_a,_t(e,t,i,n.fullPath,{name:"modelList",position:a},(function(e){(r+=1)==l.length&&(o+=1,s()),c(e)}))}))},u=0;case 2:if(u<l.length)return l[u].fullPath=i+"/"+l[u].category+".glb",n.next=6,c(l[u]);n.next=10;break;case 6:n.sent;case 7:u++,n.next=2;break;case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()()):o+=1})),ct(i+"/instanceList.zip",(function(n){var r,a=JSON.parse(n);a&&a.length?(r=0,function(){var n=de()(pe.a.mark((function n(){var l,c;return pe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=function(n){return new me.a((function(l,c){_t(e,t,i,n.fullPath,{name:"instanceList",children:n.children},(function(e){1==(r+=1)&&window.bimEngine.ViewCube.cameraGoHome(),r==a.length&&(o+=1,s()),l(e)}))}))},c=0;case 2:if(c<a.length)return a[c].fullPath=i+"/"+a[c].category+".glb",n.next=6,l(a[c]);n.next=10;break;case 6:n.sent;case 7:c++,n.next=2;break;case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()()):o+=1}))}(h,t,u,i)})),function(e,t,n){var r=[],i=[],a=new Mt.MeshStandardMaterial({color:new Mt.Color("rgb(220,220,220)"),side:Mt.DoubleSide,depthTest:!0});function o(e){for(var t,n=0;n<e.length;n++){for(var o=e[n],l=[],c=0;c<o.routes.length;c++)l.push((t=o.routes[c],new Mt.Vector3(.3048*t.X,.3048*t.Z,.3048*-t.Y)));for(var u=0;u<o.outline.length;u++){var h=new Mt.Shape;h.moveTo(s(o.outline[u][0]).x,s(o.outline[u][0]).y);for(var d=o.outline[u].length-1;0<=d;d--)o.outline[u][d],h.lineTo(s(o.outline[u][d]).x,s(o.outline[u][d]).y);if(null!=o.cutline)for(var p=0;p<o.cutline.length;p++){var f=new Mt.Path;f.moveTo(s(o.cutline[p][0]).x,s(o.cutline[p][0]).y);for(var m=o.cutline[p].length-1;0<=m;m--)o.cutline[p][m],f.lineTo(s(o.cutline[p][m]).x,s(o.cutline[p][m]).y);h.holes.push(f)}for(var v=0;v<l.length-1;v++){var g=l[v],y=l[v+1],x={depth:g.distanceTo(y),bevelEnabled:!1};y={startPoint:g,endPoint:y,name:o.Name},x=function(e,t,n,i,o){e=new Mt.ExtrudeGeometry(e,t),t=M()(r).call(r,(function(e){return e.EId==n}));var s=a;s=-1==t?a:r[t];t=new Mt.Mesh(e,s),e=new Mt.Vector3(o.startPoint.x,0,o.startPoint.z),s=new Mt.Vector3(o.endPoint.x,0,o.endPoint.z);var l,c=new Mt.Vector3(o.startPoint.x,o.startPoint.y,o.startPoint.z),u=new Mt.Vector3(o.endPoint.x,o.endPoint.y,o.endPoint.z),h=0,d=0,p=0;return Math.abs(s.clone().sub(e.clone()).z)<1e-4&&Math.abs(s.clone().sub(e.clone()).x)<1e-4?(h=(l=o.startPoint.y>o.endPoint.y?1:-1)*Math.PI*.5,null!=o.base_x&&(p=((l=new Mt.Vector3(o.base_x.x,0,o.base_x.y)).clone().cross(new Mt.Vector3(1,0,1)).y<0?1:-1)*l.angleTo(new Mt.Vector3(1,0,0)))):(d=(0<=s.clone().sub(e.clone()).cross(new Mt.Vector3(0,0,1)).y?-1:1)*s.clone().sub(e.clone()).angleTo(new Mt.Vector3(0,0,1)),h=(l=o.startPoint.y>o.endPoint.y?1:-1)*s.clone().sub(e.clone()).angleTo(u.clone().sub(c.clone()))),t.position.set(i.x,i.y,i.z),t.rotation._order="YXZ",t.rotation.set(h,d,p),t.name=o.name,t.IsMerge=!1,t.MergeIndex=0,t.MergeCount=1,t.MergeName=o.name,t.startPoint=o.startPoint,t.endPoint=o.endPoint,t}(h,x,o.MaterialId,g,y);i.push(x)}}}}function s(e){return null==e?new Mt.Vector2(0,0,0):new Mt.Vector2(.3048*e.X,.3048*e.Y)}ct(n+"/semantics.zip",(function(a){for(var s=(a=JSON.parse(a)).materials,l=0;l<s.length;l++){var c=new Mt.MeshStandardMaterial({color:new Mt.Color("rgb(".concat(s[l].color,")")),side:Mt.DoubleSide,depthTest:!0});c.map=s[l].materialImage?(new Mt.TextureLoader).load(n+"/"+s[l].materialImage,(function(e){e.wrapS=Mt.RepeatWrapping,e.wrapT=Mt.RepeatWrapping})):null,c.EId=s[l].Id,r.push(c)}o(a.models.columns);var u=(o(u=a.models.beams),a.models.floors);o(u),u=a.models.walls;if(o(u),a.cuts,i&&i.length){u=e;for(var h=i,d=(a=n+"/sysmodelList.json",n),p=t,f=[],m=[],v=[],g=[],y=0;y<h.length;y++){var x,w,b,_=h[y];null!=_.geometry&&null!=_.matrix&&((b=(b=new Mt.Matrix4).makeRotationFromEuler(_.rotation)).elements[12]=_.position.x,b.elements[13]=_.position.y,b.elements[14]=_.position.z,w=_.geometry.clone().applyMatrix4(b.clone()),_.material.side=Mt.DoubleSide,f.push(w),m.push(_.material),v.push(_.material.clone()),_.geometry.computeBoundingBox(),w=_.geometry.boundingBox.min.clone().applyMatrix4(b.clone()),b=_.geometry.boundingBox.max.clone().applyMatrix4(b.clone()),x=new Mt.Vector3(Math.min(w.x,b.x),Math.min(w.y,b.y),Math.min(w.z,b.z)),w=new Mt.Vector3(Math.max(w.x,b.x),Math.max(w.y,b.y),Math.max(w.z,b.z)),b=x.clone().add(w.clone()).multiplyScalar(.5),g.push({name:_.name,min:x,max:w,center:b,dbid:y,IsMerge:_.IsMerge,MergeIndex:_.MergeIndex,MergeCount:_.MergeCount,MergeName:_.MergeName,EdgeList:[],basePath:d}))}var M=Mt.BufferGeometryUtils.mergeBufferGeometries(f,!0);(M=new Mt.Mesh(M,m)).ElementInfos=g,M.cloneMaterialArray=v,M.relativePath=p,M.name="rootModel",M.TypeName="Mesh",M.meshs=h,M.url=a,M.basePath=d,u.add(M),window.bimEngine.doneModels.push(a)}window.bimEngine.loadedDone("structureModelsLoadedNum")}))}(h,t,u),function(e,t,n){var r=n+"/sysmodelList.zip",i=0;function a(){3===(i+=1)&&(window.bimEngine.doneModels.push(r),window.bimEngine.loadedDone("pipeModelsLoadedNum"))}function s(e,t){var n=new gd.Shape;switch(t.width=.3048*t.width,t.height=.3048*t.height,t.diameter=.3048*t.diameter,e){case"Rect":n.moveTo(-t.width/2,-t.height/2),n.lineTo(-t.width/2,t.height/2),n.lineTo(t.width/2,t.height/2),n.lineTo(t.width/2,-t.height/2),n.lineTo(-t.width/2,-t.height/2);break;case"Bridge":n.moveTo(-t.width/2,-t.height/2),n.lineTo(-t.width/2,t.height/2),n.lineTo(-t.width/2+.01,t.height/2),n.lineTo(-t.width/2+.01,-t.height/2+.01),n.lineTo(t.width/2-.01,-t.height/2+.01),n.lineTo(t.width/2-.01,t.height/2),n.lineTo(t.width/2,t.height/2),n.lineTo(t.width/2,-t.height/2),n.lineTo(-t.width/2,-t.height/2);break;case"Circle":n.moveTo(0,0),n.absarc(0,0,.5*t.diameter,0,2*Math.PI,!1)}e={depth:.3048*t.length,bevelEnabled:!1};var r=n,i=t.color,a=t.position,o=t.rotation;return r=new gd.ExtrudeGeometry(r,e),e=new gd.MeshPhongMaterial({color:i,side:gd.DoubleSide}),(i=new gd.Mesh(r,e)).position.set(a.x,a.y,a.z),i.rotation._order="YXZ",i.rotation.set(o.x,o.y,o.z),i}function l(e,t,n,r,i,o){var l,c,u={width:1,height:1,length:1,diameter:1,color:new gd.Color,position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}};switch(e){case"Rect":c=s("Rect",u),l=new gd.InstancedMesh(c.geometry,c.material,n.length);break;case"Bridge":c=s("Bridge",u),l=new gd.InstancedMesh(c.geometry,c.material,n.length);break;case"Circle":c=s("Circle",u),l=new gd.InstancedMesh(c.geometry,c.material,n.length)}var h=[];window.color=new gd.Color;for(var d=0;d<n.length;d++){var p=n[d],f=new gd.Vector3(p.startPoint.X,0,-p.startPoint.Y),m=new gd.Vector3(p.endPoint.X,0,-p.endPoint.Y),v=new gd.Vector3(p.startPoint.X,p.startPoint.Z,-p.startPoint.Y),g=new gd.Vector3(p.endPoint.X,p.endPoint.Z,-p.endPoint.Y),y=0,x=0,w=(Math.abs(m.clone().sub(f.clone()).z)<.01&&Math.abs(m.clone().sub(f.clone()).x)<.01?(y=(p.startPoint.Z>p.endPoint.Z?1:-1)*Math.PI*.5,null!=p.base_x&&(x=((w=new gd.Vector3(p.base_x.X,0,-p.base_x.Y)).clone().cross(new gd.Vector3(0,0,1)).y<=0?1:-1)*w.angleTo(new gd.Vector3(0,0,1))+.5*Math.PI)):(x=(0<m.clone().sub(f.clone()).cross(new gd.Vector3(0,0,1)).y?-1:1)*m.clone().sub(f.clone()).angleTo(new gd.Vector3(0,0,1)),y=(p.startPoint.Z>p.endPoint.Z?1:-1)*m.clone().sub(f.clone()).angleTo(g.clone().sub(v.clone()))),new gd.Matrix4);m=new gd.Euler(y,x,0,"YXZ"),f=w.clone().makeRotationFromEuler(m),g=void 0,v=void 0,v="Circle"===e?(g=p.diameter,p.diameter):(g=p.width,p.height),y=w.clone().makeScale(g,v,p.length),x=(w.multiplyMatrices(f,y),w.setPosition(p.position.x,p.position.y,p.position.z),l.setMatrixAt(d,w.clone()),l.setColorAt(d,p.color),l.geometry.computeBoundingBox(),l.geometry.boundingBox.min.clone().applyMatrix4(w.clone())),m=l.geometry.boundingBox.max.clone().applyMatrix4(w.clone()),g=new gd.Vector3(Math.min(x.x,m.x),Math.min(x.y,m.y),Math.min(x.z,m.z)),v=new gd.Vector3(Math.max(x.x,m.x),Math.max(x.y,m.y),Math.max(x.z,m.z)),f=g.clone().add(v.clone()).multiplyScalar(.5);h.push({name:p.name,min:g,max:v,center:f,dbid:d,IsMerge:!1,MergeIndex:0,MergeCount:1,MergeName:p.MergeName,url:o,EdgeList:[],matrix:w,basePath:i,relativePath:r})}l.ElementInfos=h,l.name="rootModel",l.TypeName="InstancedMesh-Pipe",l.MeshId=null,l.cloneMaterialArray=l.material.clone(),l.basePath=i,l.relativePath=r,(l.meshs=l).url=o,l.cloneInstanceColor=T()(l.instanceColor.array),l.cloneInstanceMatrix=T()(l.instanceMatrix.array),t.add(l),a()}ct(r,(function(i){var s=(i=JSON.parse(i)).circularMeps,c=o()(c=i.rectMeps).call(c,(function(e){return""===e.type})),u=o()(u=i.rectMeps).call(u,(function(e){return""===e.type}));if(i.ellipseMeps,s&&s.length){var h,d=[],p=md(s);try{for(p.s();!(h=p.n()).done;){var f=h.value;f.color=new gd.Color("rgb(".concat(f.color,")")),f.position={x:.3048*f.startPoint.X,y:.3048*f.startPoint.Z,z:.3048*-f.startPoint.Y},f.rotation={x:0,y:0,z:0},d.push(f)}}catch(i){p.e(i)}finally{p.f()}l("Circle",e,d,t,n,r)}else a();if(c&&c.length){var m,v=[],g=md(c);try{for(g.s();!(m=g.n()).done;){var y=m.value;y.color=new gd.Color("rgb(".concat(y.color,")")),y.position={x:.3048*y.startPoint.X,y:.3048*y.startPoint.Z,z:.3048*-y.startPoint.Y},y.rotation={x:0,y:0,z:0},v.push(y)}}catch(i){g.e(i)}finally{g.f()}l("Rect",e,v,t,n,r)}else a();if(u&&u.length){var x,w=[],b=md(u);try{for(b.s();!(x=b.n()).done;){var _=x.value;_.color=new gd.Color("rgb(".concat(_.color,")")),_.position={x:.3048*_.startPoint.X,y:.3048*_.startPoint.Z,z:.3048*-_.startPoint.Y},_.rotation={x:0,y:0,z:0},w.push(_)}}catch(i){b.e(i)}finally{b.f()}l("Bridge",e,w,t,n,r)}else a()}))}(h,t,u))},r.loadedDone=function(e){var t;switch(r.LoadedStatus[e]++,e){case"glbModelsLoadedNum":t="glb";break;case"pipeModelsLoadedNum":t="";break;case"structureModelsLoadedNum":t=""}console.log((new Date).getMinutes()+":"+(new Date).getSeconds(),t+"",r.LoadedStatus[e]),r.LoadedStatus.glbModelsLoadedNum===r.LoadedStatus.pipeModelsLoadedNum&&r.LoadedStatus.glbModelsLoadedNum===r.LoadedStatus.structureModelsLoadedNum&&r.LoadedStatus.glbModelsLoadedNum===r.ModelPaths.length&&(console.log("------------"),r.loadedDoneFun())},r.loadedDoneFun=function(){if(!r.handleLoadDoneFunOnce){r.handleLoadDoneFunOnce=!0,r.FPS=60,r.EngineRay=new bd,r.LoadModelTree(),r.ModelOctree();var e,t,n=0,i=window.bimEngine.scene.children,a=o()(u=window.bimEngine.scene.children).call(u,(function(e){return"rootModel"==e.name}));if(window.bimEngine.AllEdgeList=[],console.log((new Date).getMinutes()+":"+(new Date).getSeconds(),""),i&&i.length){var s,u=function r(){t=[];var o=n;if(a[o]){if("InstancedMesh"==a[o].TypeName)for(var s=0;s<a[o].ElementInfos.length;s++){var u={TypeName:a[o].TypeName,indexes:[a[o].index,s],geometry:T()(a[o].meshs.geometry.attributes.position.array),indexA:T()(a[o].meshs.geometry.index.array),matrix:T()(a[o].ElementInfos[s].matrix.elements)};t.push(u)}else if("Mesh"==a[o].TypeName)for(var h=0;h<a[o].ElementInfos.length;h++){var d=a[o].meshs[h].geometry.index?{TypeName:a[o].TypeName,indexes:[a[o].index,h],geometry:T()(a[o].meshs[h].geometry.attributes.position.array),indexA:a[o].meshs[h].geometry.index?T()(a[o].meshs[h].geometry.index.array):null,matrix:T()(a[o].meshs[h].matrix.elements)}:{TypeName:a[o].TypeName,indexes:[a[o].index,h],geometry:T()(a[o].meshs[h].geometry.attributes.position.array),position:{x:a[o].meshs[h].position.x,y:a[o].meshs[h].position.y,z:a[o].meshs[h].position.z},rotation:{x:a[o].meshs[h].rotation._x,y:a[o].meshs[h].rotation._y,z:a[o].meshs[h].rotation._z,order:a[o].meshs[h].rotation._order},matrix:T()(a[o].meshs[h].matrix.elements)};t.push(d)}else if("InstancedMesh-Pipe"==a[o].TypeName)for(var f=0;f<a[o].ElementInfos.length;f++){var m={TypeName:a[o].TypeName,indexes:[a[o].index,f],geometry:T()(a[o].geometry.attributes.position.array),matrix:T()(p()(m=a[o].instanceMatrix.array).call(m,16*f,16*(f+1)))};t.push(m)}t&&t.length&&(e&&e.terminate(),(e=new Worker("static/js/edge.worker.js")).postMessage(t),e.onmessage=function(t){for(var o=t.data,s=[],u={clonePositions:[],children:[]},h=0;h<o.length;h++){i[o[h].indexes[0]].ElementInfos[o[h].indexes[1]].EdgeList=o[h].EdgeList;var d={index:o[h].indexes[1],startIndex:s.length,endIndex:s.length+o[h].EdgeList.length-1,EdgeList:o[h].EdgeList};u.children.push(d),l()(Array.prototype).apply(s,c()(d=[s.length,o[h].EdgeList.length]).call(d,o[h].EdgeList))}window.bimEngine.AllEdgeList.push({Indexs:o[0].indexes[0],EdgeList:s,ElementInfos:u}),u.clonePositions=T()(s),e.terminate(),e=null,n+=1,r(),a.length===n&&console.log((new Date).getMinutes()+":"+(new Date).getSeconds(),"")},e.onerror=function(t){e.terminate(),e=null})}},h=(new THREE.LineBasicMaterial({color:"#000000"}),yd(a));try{for(h.s();!(s=h.n()).done;){var d=s.value;if(d.material instanceof Array&&d.material.length){d.material[0].clippingPlanes;break}d.material.clippingPlanes;break}}catch(s){h.e(s)}finally{h.f()}u()}}},r.ModelOctree=function(){!function(e){for(var t,n,r,i=e.GetAllVisibilityModel(),a=e,s=a.GetAllVisibilityModel(),l=o()(t=a.scene.children).call(t,(function(e){return"rootModel"==e.name&&("InstancedMesh"==e.TypeName||"InstancedMesh-Pipe"==e.TypeName)})),c=(window.idindex=0,a.ModelInstanceBox=[],function(e){n=[];var t=M()(s).call(s,(function(t){return t.uuid==l[e].uuid&&t.url==l[e].url}));if(-1==t)return"continue";if(-1!=t)for(var i=0;i<l[e].ElementInfos.length;i++)n.push({min:l[e].ElementInfos[i].min,max:l[e].ElementInfos[i].max});if(0==n.length)return"continue";(r=function(e){var t,n=[],r=[],i=[],a=mt(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;n.push(o.min.x),r.push(o.min.y),i.push(o.min.z),n.push(o.max.x),r.push(o.max.y),i.push(o.max.z)}}catch(e){a.e(e)}finally{a.f()}return n=S()(n).call(n,(function(e,t){return e-t})),r=S()(r).call(r,(function(e,t){return e-t})),i=S()(i).call(i,(function(e,t){return e-t})),{min:new gt.Vector3(n[0],r[0],i[0]),max:new gt.Vector3(n[n.length-1],r[r.length-1],i[i.length-1])}}(n)).length=8*n[0].min.distanceTo(n[0].max),r.DensePoint=function(e){for(var t=[],n=0;;n++){var r=e.min.x+5*n;r>=e.max.x&&(r=e.max.x);for(var i=0;;i++){var a=e.min.y+5*i;a>=e.max.y&&(a=e.max.y);for(var o=0;;o++){var s=e.min.z+5*o;if(s>=e.max.z&&(s=e.max.z),t.push(new gt.Vector3(r,a,s)),s==e.max.z)break}if(a==e.max.y)break}if(r==e.max.x)break}return t}(r);var o,c=mt(n);try{for(c.s();!(o=c.n()).done;){var u=o.value;r.DensePoint.push(u.min.clone().add(u.max.clone()).multiplyScalar(.5))}}catch(t){c.e(t)}finally{c.f()}r.id=window.idindex++,t={i:t,box:r},a.ModelInstanceBox.push(t)}),u=0;u<l.length;u++)c(u);for(var h=o()(t=e.scene.children).call(t,(function(e){return"rootModel"==e.name&&("Mesh"==e.TypeName||"PipeMesh"==e.TypeName)})),d=(null==window.idindex&&(window.idindex=0),[]),p=0;p<h.length;p++)!function(e){if(-1!=M()(i).call(i,(function(t){return t.uuid==h[e].uuid})))for(var t=0;t<h[e].ElementInfos.length;t++)d.push({min:h[e].ElementInfos[t].min,max:h[e].ElementInfos[t].max})}(p);if(0!=d.length){var f=function e(t){var n,r,i=[],a=[],o=[],s=.5*(t.max.x-t.min.x),l=.5*(t.max.y-t.min.y),c=.5*(t.max.z-t.min.z);if(50<s&&(r={min:(n=t).min,max:new gt.Vector3(n.min.x+s,n.max.y,n.max.z)},s={min:new gt.Vector3(n.min.x+s,n.min.y,n.min.z),max:n.max},i.push(r),i.push(s)),50<l){var u,h=mt(i);try{for(h.s();!(u=h.n()).done;){var d=u.value,p={min:d.min,max:new gt.Vector3(d.max.x,d.min.y+l,d.max.z)},f={min:new gt.Vector3(d.min.x,d.min.y+l,d.min.z),max:d.max};a.push(p),a.push(f)}}catch(e){h.e(e)}finally{h.f()}}else a=i;if(50<c){var m,v=mt(a);try{for(v.s();!(m=v.n()).done;){var g=m.value,x={min:g.min,max:new gt.Vector3(g.max.x,g.max.y,g.min.z+c)},w={min:new gt.Vector3(g.min.x,g.min.y,g.min.z+c),max:g.max};o.push(x),o.push(w)}}catch(e){v.e(e)}finally{v.f()}}else o=a;if(t.children=o,0<t.children.length){t.isLeaf=!1;for(var b=0;b<t.children.length;b++)t.children[b]=e(t.children[b])}else t.isLeaf=!0;return t.DensePoint=y(t),t.length=t.min.distanceTo(t.max),t.id=window.idindex++,t.isLeaf&&(t.DensePoint=[]),t}(function(e){var t,n=[],r=[],i=[],a=mt(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;n.push(o.min.x),r.push(o.min.y),i.push(o.min.z),n.push(o.max.x),r.push(o.max.y),i.push(o.max.z)}}catch(e){a.e(e)}finally{a.f()}return n=S()(n).call(n,(function(e,t){return e-t})),r=S()(r).call(r,(function(e,t){return e-t})),i=S()(i).call(i,(function(e,t){return e-t})),{min:new gt.Vector3(n[0],r[0],i[0]),max:new gt.Vector3(n[n.length-1],r[r.length-1],i[i.length-1])}}(d));null==e.ModelOctreeBox&&(e.ModelOctreeBox=[]),e.ModelOctreeBox.push(f);for(var m=function(e){var t=M()(i).call(i,(function(t){return t.uuid==h[e].uuid}));if(-1==t)return"continue";for(var n=0;n<h[e].ElementInfos.length;n++)!function e(t,n,r,i){var a={min:t.min,max:t.max};if(1!=(a=g(i,a)))return!1;if(null==i.elements&&(i.elements=[]),0==i.isLeaf){for(var o=!1,s=0;s<i.children.length;s++){if(1==e(t,n,r,i.children[s])){o=!0;break}}0==o&&(i.elements.push({i:n,j:r}),i.isLeaf)&&i.DensePoint.push(t.min)}else i.elements.push({i:n,j:r}),i.isLeaf&&i.DensePoint.push(t.min);return!0}(h[e].ElementInfos[n],t,n,f)},v=0;v<h.length;v++)m(v)}function g(e,t){return t.min.x>=e.min.x&&t.min.y>=e.min.y&&t.min.z>=e.min.z&&t.max.x<=e.max.x&&t.max.y<=e.max.y&&t.max.z<=e.max.z}function y(e){for(var t=[],n=0;;n++){var r=e.min.x+30*n;r>=e.max.x&&(r=e.max.x);for(var i=0;;i++){var a=e.min.y+30*i;a>=e.max.y&&(a=e.max.y);for(var o=0;;o++){var s=e.min.z+30*o;if(s>=e.max.z&&(s=e.max.z),t.push(new gt.Vector3(r,a,s)),s==e.max.z)break}if(a==e.max.y)break}if(r==e.max.x)break}return t}}(r)},r.LoadModelTree=function(){!function(e){var t,n,r=e.ModelPaths,i=0,a=s()(t=e.scene.children).call(t,(function(e){return{relativePath:e.relativePath,ElementInfos:null==e.ElementInfos?null:s()(e=e.ElementInfos).call(e,(function(e){return{name:function(e){return e.split("][")[1].split("]")[0]}(e.name).toString().replace(" ","")}}))}})),o=pd(r);try{for(o.s();!(n=o.n()).done;)!function(t){ct("file/"+t+"/modelTreeMapping.zip",(function(n){n=JSON.parse(n),r=t,function e(t,n){if(t&&t.length)for(var a=0;a<t.length;a++)t[a].Isleaf?(t[a].key=i++,t[a].path=r,t[a].T_Name=n,o.push(t[a])):(t[a].key=i++,t[a].path=r,e(t[a].children,t[a].Name))}([{Isleaf:!(o=[]),children:n}],"");var r,o,s,l,c,u={modelDatas:a,treeDatas:o};null==e.treeData&&(e.treeData=[]),n={Name:t,Isleaf:!1,children:n,path:t,key:i++};e.treeData.push(n),s=u,console.log((new Date).getMinutes()+":"+(new Date).getSeconds(),":",s.treeDatas.length),e.treeMapper=e.treeMapper||[],l=0,(c=new Worker("static/js/modeltree.worker.js")).postMessage(s),c.onmessage=function(t){delete(t=t.data).ModelId,e.treeMapper.push(t),++l==s.treeDatas.length&&(console.log((new Date).getMinutes()+":"+(new Date).getSeconds(),""),c.terminate())},c.onerror=function(e){c.terminate()}}))}(n.value)}catch(t){o.e(t)}finally{o.f()}}(r)},r.addEventListener=function(e){},r.ListenerEvent=function(e,t){window.addEventListener(e,(function(e){e=e.detail,t(e)}))},r.LockingSelect=function(){r.LockingSelect=!0},r.UnLockingSelect=function(){r.LockingSelect=!1},r.loadExtension=function(){},r.getExtension=function(){},r.GetAllVisibilityModel=function(){for(var e,t=0;t<window.bimEngine.scene.children.length;t++)window.bimEngine.scene.children[t].index=t;return o()(e=window.bimEngine.scene.children).call(e,(function(e){return"rootModel"==e.name}))},r.GetAllIndexesModel=function(){var e,t=[];return r.treeMapper&&s()(e=r.treeMapper).call(e,(function(e){var n;e.ModelIds&&e.ModelIds.length&&l()(Array.prototype).apply(t,c()(n=[t.length,e.ModelIds.length]).call(n,e.ModelIds))})),t},r.ResetSelectedModels_=function(e,t,n){switch(e){case"visible":re(t,n);break;case"highlight":for(var i=r.SelectedModels.indexesModels=t,a=n,s=new THREE.Color(.375,.63,1),l=new THREE.MeshBasicMaterial({color:s,transparent:!0,opacity:.9,depthTest:!1}),c=(new THREE.LineBasicMaterial({color:s,depthTest:!1}),o()(s=window.bimEngine.scene.children).call(s,(function(e){return"HighLightGroup"==e.name}))[0]),u=(c.children=[],window.bimEngine.scene.children),h=0;h<i.length;h++){var d=u[i[h][0]];if(null!=d)if(null==d.instanceMatrix&&null!=d.geometry&&null!=d.geometry.groups[i[h][1]])if(a){var f=d.meshs[i[h][1]],m=new THREE.Group;m.indexs=i[h];var v=ae(f.geometry,f.matrix,l).mesh,g=isNaN(f.rotation.x)?0:f.rotation.x,y=isNaN(f.rotation.y)?0:f.rotation.y,x=isNaN(f.rotation.z)?0:f.rotation.z,w=isNaN(f.position.x)?0:f.position.x,b=isNaN(f.position.y)?0:f.position.y;f=isNaN(f.position.z)?0:f.position.z;0==g&&0==y&&0==x||v.rotation.set(g,y,x),0==w&&0==b&&0==f||v.position.set(w,b,f),v.material.clippingPlanes=d.material[i[h][1]].clippingPlanes,m.add(v),c.add(m)}else{var _,M=ee(c.children);try{for(M.s();!(_=M.n()).done;){var E=_.value;E.indexs==i[h]&&c.remove(E)}}catch(e){M.e(e)}finally{M.f()}}else if(null!=d.instanceMatrix)if(1==a)(g=new THREE.Group).indexs=i[h],x=p()(y=d.cloneInstanceMatrix).call(y,16*i[h][1],16*(i[h][1]+1)),(w=new THREE.Matrix4).elements=x,(b=ae(d.geometry,w,l).mesh).material.clippingPlanes=d.material.clippingPlanes,g.add(b),c.add(g);else{var S,T=ee(c.children);try{for(T.s();!(S=T.n()).done;){var A=S.value;A.indexs==i[h]&&c.remove(A)}}catch(e){T.e(e)}finally{T.f()}}}window.bimEngine.RenderUpdata()}console.log(r.SelectedModels)},r.ResetSelectedModels=function(e,t){switch(r.SelectedModels.requiredModels.length&&ie(r.SelectedModels.requiredModels,[{key:"material"}]),r.SelectedModels.requiredModels=[],r.SelectedModels.loadedModels.length&&ne(r.SelectedModels.loadedModels,[{key:"material"}]),r.SelectedModels.loadedModels=[],e){case"loaded":t.length&&ne(t,[{key:"material",val:new _d.MeshStandardMaterial({color:new _d.Color(.375,.63,1),side:_d.DoubleSide})}]),r.SelectedModels.loadedModels=t;break;case"required":t.length&&ie(t,[{key:"material",val:new _d.MeshStandardMaterial({color:new _d.Color(.375,.63,1),side:_d.DoubleSide})}]),r.SelectedModels.requiredModels=t}console.log(r.SelectedModels)},r}},function(e,t){},,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){}],n={},e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(e){return t[e]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="./build/",e(e.s=588).default;function e(r){var i;return(n[r]||(i=n[r]={i:r,l:!1,exports:{}},t[r].call(i.exports,i,i.exports,e),i.l=!0,i)).exports}var t,n}));